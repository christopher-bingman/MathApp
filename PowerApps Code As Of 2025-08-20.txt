//App - Run on Start

Container_Add_Access_00.Visible = false;

ClearCollect(colYesNo, {answer: Blank()}, {answer: "YES"}, {answer: "NO"}, {answer: "N/A"});

ClearCollect(colPerson, 
    {usma_pers_id: Blank(), tour_id:Blank(), last_name: Blank(), first_name: Blank(), sex: Blank(), wp_email: Blank(), middle_name: Blank(), service: Blank(), perm_email: Blank(), cell_num: Blank(), birthday: Blank(), com_source: Blank(),year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date: Blank(), depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()}, 
    {usma_pers_id: Blank(), tour_id:Blank(), last_name: Blank(), first_name: Blank(), sex: Blank(), wp_email: Blank(), middle_name: Blank(), service: Blank(), perm_email: Blank(), cell_num: Blank(), birthday: Blank(), com_source: Blank(),year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date: Blank(), depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()});

ClearCollect(colProject, 
    {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()},
    {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()});

ClearCollect(colTrip,
    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()},
    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});

ClearCollect(colPurchase, 
    {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: "SUPPLY", purchase_type: Blank(), purchase_cost_status: "PROJECTED", date_ordered: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: varUser.tour_id, requestor_name: varUser.name, recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()}, 
    {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: "SUPPLY", purchase_type: Blank(), purchase_cost_status: "PROJECTED", date_ordered: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: varUser.tour_id, requestor_name: varUser.name, recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()});

ClearCollect(colSalaryCost, 
        {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});

ClearCollect(colAddSalary, 
        {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

ClearCollect(colRPFReasons, 
    {reason: Blank()}, {reason: "Award"}, {reason: "Extend Term"}, {reason: "Funding Change"}, {reason: "Initial Request"}, {reason: "Payroll/Fringe Changes"}, {reason: "Step Increase"}, {reason: "Terminal Leave"}); 

ClearCollect(colPermissionAdmin, 
    ShowColumns(Filter(current_permissions_view, permission = "ADMIN"), permission_id, wp_email, name));

ClearCollect(colPermissionS1, 
    ShowColumns(Filter(current_permissions_view, permission = "S1"), permission_id, wp_email, name));

ClearCollect(colPermissionMaster, 
    ShowColumns(Filter(current_permissions_view, permission = "MASTER"), permission_id, wp_email, name));

ClearCollect(colPermissionResearch, 
    ShowColumns(Filter(current_permissions_view, permission = "RESEARCH"), permission_id, wp_email, name));

ClearCollect(colCostStatus, ShowColumns(lookup_cost_status, cost_status));

Set(
    varUser,
        With(
            {userRecord: LookUp(current_fac_view, wp_email = Upper(User().Email))},
            {name: userRecord.name,
            wp_email: Upper(User().Email),
            usma_pers_id: userRecord.usma_pers_id,
            dept_pos: userRecord.dept_pos,
            apd: userRecord.program_pos_id,
            tour_id: userRecord.tour_id}));

Set(varPermissions, 
    If( 
        Not(IsBlank(LookUp(permissions_master, wp_email = Upper(User().Email)).wp_email)), "Master",
            If(
                Not(IsBlank(LookUp(permissions_admin, wp_email = Upper(User().Email)).wp_email)), "Admin", 
                    If(
                        Not(IsBlank(LookUp(permissions_S1, wp_email = Upper(User().Email)).wp_email)), "S1",
                        If(
                            Not(IsBlank(LookUp(permissions_research, wp_email = Upper(User().Email)).wp_email)), "Research", 
                            "User")))));





// Screen_Welcome_User_00

Screens:
  Screen_Welcome_User_00:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_User_00:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height-Container_User_Header_00.Height
            Width: =Parent.Width
            Y: =Container_User_Header_00.Height
          Children:
            - Container_Supply_Print_00:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height - Self.Y - Parent.Height/20
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Container_Travel_TDY_00.X + Container_Travel_TDY_00.Width + Parent.Width/30
                  Y: =Container_Leave_Pass_00.Y
                Children:
                  - Text_Supply_Print_00:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Purchase Request"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Supply_Print_00.Height + Parent.Height/10
                  - Icon_Supply_Print_00:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              Not(IsBlank(varUser.tour_id)), DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.ShoppingCart
                        OnSelect: |-
                          =Refresh(purchase_cost_view);

                          ClearCollect(colFaculty, 
                              {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});

                          Collect(colFaculty, 
                              ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));

                          ClearCollect(colPurchaseTypes, {purchase_type: Blank()});

                          Collect(colPurchaseTypes, ShowColumns(lookup_purchase_types, purchase_type, special_instructions));

                          ClearCollect(colBudgets, 
                              {budget_id: Blank(), budget_name: Blank(), budget_type: Blank(), funding_type: Blank(), loa: Blank(), mipr_num: Blank(), wbs_cost_center: Blank(), received_date: Blank(), expire_date: Blank(), pop_date: Blank(), center_id: Blank(), center_abbrev: Blank(), fee_amount: Blank(), gift_amount: Blank(), supply_amount: Blank(), print_amount: Blank(),salary_amount: Blank(), travel_amount: Blank(), total_amount: Blank(), director_tour: Blank(), director_name: Blank(), budget_updated_on: Blank(), spend_plan_updated_on: Blank()});

                          Collect(colBudgets, 
                              Sort(ShowColumns(current_budget_view, budget_id, budget_name, budget_type, funding_type, loa, mipr_num, wbs_cost_center, received_date, expire_date, pop_date, center_id, center_abbrev, fee_amount, gift_amount, supply_amount, print_amount, salary_amount, travel_amount, total_amount, director_tour, director_name, budget_updated_on, days_to_expire),budget_name, SortOrder.Ascending));

                          Reset(Gallery_Purchases_70);

                          Navigate(Screen_Purchase_Overview_70);
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
            - Container_Travel_TDY_00:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height - Self.Y - Parent.Height/20
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Container_Leave_Pass_00.X + Container_Leave_Pass_00.Width + Parent.Width/30
                  Y: =Container_Leave_Pass_00.Y
                Children:
                  - Text_Travel_TDY_00:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Travel/TDY Request"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Travel_TDY_00.Height + Parent.Height/10
                  - Icon_Travel_TDY_00:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              Not(IsBlank(varUser.tour_id)), DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.Airplane
                        OnSelect: "=Refresh(current_travel_view);\r\n\r\nRefresh(current_trips_view);\r\n\r\nClearCollect(colStates, {state:Blank()}, {state:\"AK\"}, {state:\"AL\"}, {state:\"AR\"}, {state:\"AS\"}, {state:\"AZ\"}, {state:\"CA\"}, {state:\"CO\"}, {state:\"CT\"}, {state:\"DC\"}, {state:\"DE\"}, {state:\"FL\"}, {state:\"GA\"}, {state:\"GU\"}, {state:\"HI\"}, {state:\"IA\"}, {state:\"ID\"}, {state:\"IL\"}, {state:\"IN\"}, {state:\"KS\"}, {state:\"KY\"}, {state:\"LA\"}, {state:\"MA\"}, {state:\"MD\"}, {state:\"ME\"}, {state:\"MI\"}, {state:\"MN\"}, {state:\"MO\"}, {state:\"MP\"}, {state:\"MS\"}, {state:\"MT\"}, {state:\"NC\"}, {state:\"ND\"}, {state:\"NE\"}, {state:\"NH\"}, {state:\"NJ\"}, {state:\"NM\"}, {state:\"NV\"}, {state:\"NY\"}, {state:\"OH\"}, {state:\"OK\"}, {state:\"OR\"}, {state:\"PA\"}, {state:\"PR\"}, {state:\"RI\"}, {state:\"SC\"}, {state:\"SD\"}, {state:\"TN\"}, {state:\"TT\"}, {state:\"TX\"}, {state:\"UT\"}, {state:\"VA\"}, {state:\"VI\"}, {state:\"VT\"}, {state:\"WA\"}, {state:\"WI\"}, {state:\"WV\"}, {state:\"WY\"});\r\n\r\nClearCollect(colFaculty, \r\n    {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});\r\n\r\nCollect(colFaculty, \r\n    ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));\r\n\r\nClearCollect(colBudgets, \r\n    {budget_id: Blank(), budget_name: Blank(), budget_type: Blank(), funding_type: Blank(), loa: Blank(), mipr_num: Blank(), wbs_cost_center: Blank(), received_date: Blank(),expire_date: Blank(), pop_date: Blank(), center_id: Blank(), center_abbrev: Blank(), fee_amount: Blank(), gift_amount: Blank(), supply_amount: Blank(), print_amount: Blank(),salary_amount: Blank(), travel_amount: Blank(), total_amount: Blank(), director_tour: Blank(), director_name: Blank(), budget_updated_on: Blank(), spend_plan_updated_on: Blank()});\r\n    \r\nCollect(colBudgets, \r\n    Sort(ShowColumns(current_budget_view, budget_id, budget_name, budget_type, funding_type, loa, mipr_num, wbs_cost_center, received_date, expire_date, pop_date, center_id, center_abbrev, fee_amount, gift_amount, supply_amount, print_amount, salary_amount, travel_amount, total_amount, director_tour, director_name, budget_updated_on, days_to_expire),budget_name, SortOrder.Ascending));\r\n\r\nReset(Gallery_Trips_50);\r\n\r\nNavigate(Screen_Trips_Overview_50)"
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
            - Container_Leave_Pass_00:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height - Self.Y - Parent.Height/20
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Parent.Width/30
                  Y: =Container_Personal_Info_00.Height + Container_Personal_Info_00.Y + Parent.Height/20
                Children:
                  - Text_Leave_Pass_00:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Leave/Pass Request"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Leave_Pass_00.Height + Parent.Height/10
                  - Icon_Leave_Pass_00:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Self.Width
                        Icon: =Icon.Leave
                        Tooltip: ="Coming Soon"
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
                  - Image1:
                      Control: Image@2.2.3
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height
                        Image: =UnderConstruction
                        Width: =Parent.Width
            - Container_Projects_00:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =(Parent.Height - 3*Self.Y)/2
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Parent.Width/30 + Container_Personal_Info_00.X + Container_Personal_Info_00.Width
                  Y: =Parent.Height/20
                Children:
                  - Text_Projects_00:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Project Information"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Projects_00.Height + Parent.Height/10
                  - Icon_Projects_00:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              Not(IsBlank(varUser.tour_id)), DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.Lightbulb
                        OnSelect: |-
                          =Refresh(current_projects_view);

                          ClearCollect(colProjectStatus, {status: Blank()}, {status: "ACTIVE"}, {status: "COMPLETE"}, {status: "DROPPED"});

                          ClearCollect(colResearchClasses, {class_num: Blank()});

                          Collect(colResearchClasses, ShowColumns(current_research_classes_view, offering_id, ay, semester, class_num));

                          ClearCollect(colRoles, {role: "ADVISOR"}, {role: "CO-ADVISOR"});

                          Reset(Gallery_Projects_30);

                          Navigate(Screen_Projects_Overview_30)
                        Tooltip: =
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
            - Container_Add_Access_00:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =(Parent.Height - 3*Self.Y)/2
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Visible: |-
                    =Or(
                        varPermissions = "Master",
                        varPermissions = "Admin",
                        varPermissions = "S1",
                        varPermissions = "Research",
                        varUser.dept_pos = "P5",
                        varUser.dept_pos = "P6"
                    )
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: |-
                    =If(
                        Or(
                        varPermissions = "Master",
                        varPermissions = "Admin",
                        varPermissions = "Research",
                        varPermissions = "S1",
                        varUser.dept_pos = "P5",
                        varUser.dept_pos = "P6"
                        ),
                        Container_Leave_Pass_00.X, 
                        Container_Leave_Pass_00.X + Container_Leave_Pass_00.Width + Parent.Width/30)
                  Y: =Parent.Height/20
                Children:
                  - Text_Add_Access_00:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Additional Access"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Add_Access_00.Height + Parent.Height/10
                  - Icon_Add_Access_00:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              varPermissions <> "User" || 
                              varUser.dept_pos = "P5" || 
                              varUser.dept_pos = "P6", 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.Lock
                        OnSelect: |-
                          =
                          If(Not(varPermissions = "User") ||
                          varUser.dept_pos = "P5" ||
                          varUser.dept_pos = "P6" ||
                          Not(IsBlank(varUser.apd)),
                          Navigate(Screen_Welcome_Add_Access_110),false);
                        Tooltip: =
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
            - Container_Personal_Info_00:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =(Parent.Height - 3*Self.Y)/2
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: |-
                    =If(
                        varPermissions = "User" && 
                        (varUser.dept_pos <> "P5" && varUser.dept_pos <> "P6"),
                        Parent.Width/2 - Self.Width - Parent.Width/40, 
                        Container_Leave_Pass_00.X + Container_Leave_Pass_00.Width + Parent.Width/30)
                  Y: =Parent.Height/20
                Children:
                  - Text_Personal_Info_00:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Update Personal Information"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Personal_Info_00.Height + Parent.Height/10
                  - Icon_Personal_Info_00:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        Height: =Self.Width
                        Icon: =Icon.People
                        OnSelect: |-
                          =Refresh(add_pers_view);

                          Refresh(current_fac_view);

                          ClearCollect(colServices, {service: Blank()}, {service: "CIVILIAN"}, {service: "ARMY"}, {service: "AIR FORCE"}, {service: "COAST GUARD"}, {service: "MARINE CORPS"}, {service: "SPACE FORCE"}, {service: "NAVY"});

                          ClearCollect(colAssign, {assign_type: Blank()});

                          Collect(colAssign, ShowColumns(lookup_assign_type, assign_type));

                          ClearCollect(colTitles, {rank_title: Blank()});

                          Collect(colTitles, ShowColumns(lookup_rank, rank_title));

                          ClearCollect(colAcadRank, {acad_rank: Blank()});

                          Collect(colAcadRank, ShowColumns(lookup_acad_rank, acad_rank));

                          ClearCollect(colStates, {state:Blank()}, {state:"AK"}, {state:"AL"}, {state:"AR"}, {state:"AS"}, {state:"AZ"}, {state:"CA"}, {state:"CO"}, {state:"CT"}, {state:"DC"}, {state:"DE"}, {state:"FL"}, {state:"GA"}, {state:"GU"}, {state:"HI"}, {state:"IA"}, {state:"ID"}, {state:"IL"}, {state:"IN"}, {state:"KS"}, {state:"KY"}, {state:"LA"}, {state:"MA"}, {state:"MD"}, {state:"ME"}, {state:"MI"}, {state:"MN"}, {state:"MO"}, {state:"MP"}, {state:"MS"}, {state:"MT"}, {state:"NC"}, {state:"ND"}, {state:"NE"}, {state:"NH"}, {state:"NJ"}, {state:"NM"}, {state:"NV"}, {state:"NY"}, {state:"OH"}, {state:"OK"}, {state:"OR"}, {state:"PA"}, {state:"PR"}, {state:"RI"}, {state:"SC"}, {state:"SD"}, {state:"TN"}, {state:"TT"}, {state:"TX"}, {state:"UT"}, {state:"VA"}, {state:"VI"}, {state:"VT"}, {state:"WA"}, {state:"WI"}, {state:"WV"}, {state:"WY"});

                          ClearCollect(colDegreeTypes, {degree_abbrev: Blank()});

                          Collect(colDegreeTypes, ShowColumns(lookup_degree, degree_abbrev));

                          ClearCollect(colCommSources, {com_source: Blank()});

                          Collect(colCommSources, ShowColumns(lookup_com_source, com_source));

                          ClearCollect(colBranches, {br_abbrev: Blank()});

                          Collect(colBranches, ShowColumns(lookup_br, br_abbrev));

                          ClearCollect(colFAs, {func_num: Blank()});

                          Collect(colFAs, ShowColumns(lookup_fa, func_num));

                          ClearCollect(colSexes, {sex: Blank()}, {sex: "MALE"}, {sex: "FEMALE"}, {sex: "OTHER"});

                          Reset(Gallery_Personnel_10);

                          Navigate(Screen_Personnel_Overview_10)
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
      - Container_User_Header_00:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - User_Header_00:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =
                  Style: ='Header.Style'.Primary
                  Title: ="Welcome to the Math App"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_00:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_00:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40





// Screen_Personnel_Overview_10

Screens:
  Screen_Personnel_Overview_10:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Personnel_Overview_New_10:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Personnel_Header_10.Height
            Visible: =If(varNewPerson = true, true, false)
            Width: =Parent.Width
            Y: =Container_Personnel_Header_10.Height
          Children:
            - Button_Cancel_10:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_10.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varNewPerson:Blank()});

                    Reset(Text_Input_Last_Name_Search_11);

                    Refresh(current_fac_view);

                    Refresh(add_pers_view);

                    Reset(Gallery_Personnel_10); 

                    Reset(Gallery_Personnel_11)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Cancel"
                  Width: =Parent.Width/11
                  X: =Gallery_Personnel_11.X + Gallery_Personnel_11.Width - Self.Width
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Text_Input_Last_Name_Search_11:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_10.Height
                  HintText: ="Search Last Name"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Button_Cancel_10.X - Self.X - Parent.Width/50
                  X: =Gallery_Personnel_11.X
                  Y: =Button_Cancel_10.Y
            - Icon_Cancel_Search_11:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Last_Name_Search_11.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: =Reset(Text_Input_Last_Name_Search_11)
                  Width: =Self.Height
                  X: =Text_Input_Last_Name_Search_11.X + Text_Input_Last_Name_Search_11.Width - Self.Width
                  Y: =Text_Input_Last_Name_Search_11.Y + Text_Input_Last_Name_Search_11.Height/8
            - Gallery_Personnel_11:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =1
                  Height: =Text_Input_Last_Name_Search_11.Y - Text_Last_Name_12.Y - Text_Last_Name_12.Height - Parent.Height/40
                  Items: |-
                    =Filter(
                        Sort(add_pers_view, last_name, SortOrder.Ascending), StartsWith(last_name, Text_Input_Last_Name_Search_11.Text))
                  OnSelect: =
                  TemplateFill: =If(ThisItem.IsSelected, RGBA(177, 179, 179, 1), RGBA(0, 0, 0, 0))
                  TemplateSize: =Text_Input_Change_User_10.Height*1.5
                  Width: =Parent.Width/1.5
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Text_Last_Name_12.Y + Text_Last_Name_12.Height
                Children:
                  - Separator_Gallery_Personnel_11:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Person_10:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\n    IsBlank(varReturnScreen), \n    \n    If(\n        Upper(User().Email) = ThisItem.wp_email || \n        varPermissions = \"Admin\" ||\n        varPermissions = \"Master\" || \n        varPermissions = \"S1\",\n        DisplayMode.Edit, DisplayMode.Disabled),\n\n    If(\n        varReturnScreen = Screen_Trip_Details_60, \n        If(\n            varPermissions = \"Master\" ||\n            varPermissions = \"Admin\" ||\n            varPermissions = \"S1\" || \n            varUser.usma_pers_id = ThisItem.usma_pers_id ||\n            varUser.tour_id = Index(colTrip,1).trip_oic || \n            varUser.tour_id = Index(colTrip,2).trip_oic,\n            DisplayMode.Edit, \n            DisplayMode.Disabled), \n        DisplayMode.Disabled))"
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.AddUser
                        OnSelect: "=If(IsBlank(varReturnScreen),\r\n    Select(Parent);\r\n\r\n    Set(\r\n        varPerson, ShowColumns(LookUp(add_pers_view, wp_email = ThisItem.wp_email), usma_pers_id, last_name, first_name, middle_name, sex, wp_email, perm_email, service, cell_num, birthday));\r\n\r\n    If(varUser.wp_email <> varPerson.wp_email && varPermissions = \"User\", \r\n        Notify(\"YOU CANNOT EDIT ANOTHER PERSON\", NotificationType.Error),\r\n\r\n        ClearCollect(colPerson, \r\n            {usma_pers_id: varPerson.usma_pers_id, tour_id: Blank(), last_name: varPerson.last_name, first_name: varPerson.first_name, sex: varPerson.sex, wp_email: varPerson.wp_email, middle_name: varPerson.middle_name, service: varPerson.service, perm_email: varPerson.perm_email, cell_num: varPerson.cell_num, birthday: varPerson.birthday, com_source: Blank(), year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date:Blank(),  depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()}, \r\n            {usma_pers_id: varPerson.usma_pers_id, tour_id: Blank(), last_name: varPerson.last_name, first_name: varPerson.first_name, sex: varPerson.sex, wp_email: varPerson.wp_email, middle_name: varPerson.middle_name, service: varPerson.service, perm_email: varPerson.perm_email, cell_num: varPerson.cell_num, birthday: varPerson.birthday, com_source: Blank(), year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date:Blank(),  depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()});\r\n\r\n        Clear(colDegrees);\r\n\r\n        Clear(colChildren);\r\n        \r\n        Navigate(Screen_Personnel_Details_20)),\r\n\r\n    Set(varTraveler, \r\n        {new_traveler_num: Max(colTravelers, new_traveler_num) + 1,\r\n        usma_pers_id: Gallery_Personnel_11.Selected.usma_pers_id, \r\n        pers_type: \"FACULTY\", \r\n        traveler_email: Gallery_Personnel_11.Selected.wp_email, \r\n        traveler_last_name: Gallery_Personnel_11.Selected.last_name, \r\n        traveler_first_name: Gallery_Personnel_11.Selected.first_name,\r\n        traveler_name: Concatenate(Gallery_Personnel_11.Selected.last_name, \", \", Gallery_Personnel_11.Selected.first_name),\r\n        split_loa: \"NO\",\r\n        travel_cost_status: \"PROJECTED\",\r\n        missing_class: \"N/A\", \r\n        pd_approved_on: \r\n            If(\r\n                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                Today(),\r\n                If( \r\n                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                    Today(),\r\n                    Blank())), \r\n        pd_tour: \r\n            If(\r\n                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                If( \r\n                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                    LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                    Blank()))});\r\n\r\n    Collect(colTravelers, \r\n        {new_traveler_num: Max(colTravelers, new_traveler_num) + 1,\r\n        usma_pers_id: Gallery_Personnel_11.Selected.usma_pers_id, \r\n        pers_type: \"FACULTY\", \r\n        traveler_email: Gallery_Personnel_11.Selected.wp_email, \r\n        traveler_last_name: Gallery_Personnel_11.Selected.last_name, \r\n        traveler_first_name: Gallery_Personnel_11.Selected.first_name,\r\n        traveler_name: Concatenate(Gallery_Personnel_11.Selected.last_name, \", \", Gallery_Personnel_11.Selected.first_name),\r\n        split_loa: \"NO\",\r\n        travel_cost_status: \"PROJECTED\",\r\n        missing_class: \"N/A\", \r\n        pd_approved_on: \r\n            If(\r\n                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                Today(),\r\n                If( \r\n                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                    Today(),\r\n                    Blank())), \r\n        pd_tour: \r\n            If(\r\n                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                If( \r\n                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                    LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                    Blank()))});\r\n    Navigate(varReturnScreen);\r\n    Set(varReturnScreen, Blank());\r\n    Set(varAddFacTraveler, false);\r\n    UpdateContext({varNewPerson:Blank()}));\r\nReset(Text_Input_Last_Name_Search_11);"
                        Width: =Self.Height
                        X: =Text_wp_Email_13.X + Text_wp_Email_13.Width
                  - Text_wp_Email_13:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.wp_email
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_wp_Email_12.Width
                        X: =Text_wp_Email_12.X - Gallery_Personnel_11.X
                  - Text_First_Name_13:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.first_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_First_Name_12.Width
                        X: =Text_First_Name_12.X - Gallery_Personnel_11.X
                  - Text_Last_Name_13:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.last_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Last_Name_12.Width
            - Text_wp_Email_12:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="Email"
                  VerticalAlign: =VerticalAlign.Middle
                  Visible: =Gallery_Personnel_11.Visible
                  Width: =Gallery_Personnel_11.Width*11/20 - 30 - Icon_Add_Person_10.Width
                  X: =Text_First_Name_12.X + Text_First_Name_12.Width + 10
                  Y: =Text_Last_Name_12.Y
            - Text_First_Name_12:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="First Name"
                  VerticalAlign: =VerticalAlign.Middle
                  Visible: =Gallery_Personnel_11.Visible
                  Width: =Gallery_Personnel_11.Width/5
                  X: =Text_Last_Name_12.X + Text_Last_Name_12.Width + 10
                  Y: =Text_Last_Name_12.Y
            - Text_Last_Name_12:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="Last Name"
                  VerticalAlign: =VerticalAlign.Middle
                  Visible: =Gallery_Personnel_11.Visible
                  Width: =Gallery_Personnel_11.Width/4
                  X: =Gallery_Personnel_11.X
                  Y: =Parent.Height/40
      - Container_Personnel_Overview_Existing_10:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Personnel_Header_10.Height
            Visible: =If(varNewPerson = Blank(), true, false)
            Width: =Parent.Width
            Y: =Container_Personnel_Header_10.Height
          Children:
            - Button_Edit_Person_10:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_10.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =//Set(varPermissions, "Master");
                    If(IsBlank(varReturnScreen),
                        Set(
                            varPerson, ShowColumns(LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email), usma_pers_id, last_name, first_name, middle_name, sex, wp_email, perm_email, service, cell_num, birthday, tour_id));

                        //If(varUser.wp_email <> varPerson.wp_email && varPermissions = "User", 
                        //    Notify("YOU CANNOT EDIT ANOTHER PERSON", NotificationType.Error),

                            ClearCollect(colPerson, {usma_pers_id: varPerson.usma_pers_id, 
                                tour_id: varPerson.tour_id, 
                                last_name: varPerson.last_name, 
                                first_name: varPerson.first_name, 
                                sex: varPerson.sex, 
                                wp_email: varPerson.wp_email, 
                                middle_name: varPerson.middle_name, 
                                service: varPerson.service, 
                                perm_email: varPerson.perm_email, 
                                cell_num: varPerson.cell_num, 
                                birthday: varPerson.birthday, 
                                com_source: LookUp(commission, usma_pers_id = varPerson.usma_pers_id).com_source, 
                                year_group: LookUp(commission, usma_pers_id = varPerson.usma_pers_id).year_group, 
                                sp_name: LookUp(spouse, usma_pers_id=varPerson.usma_pers_id).sp_name, 
                                sp_email: LookUp(spouse, usma_pers_id=varPerson.usma_pers_id).sp_email, 
                                sp_cell_num: LookUp(spouse, usma_pers_id=varPerson.usma_pers_id).sp_cell_num, 
                                assign_type: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).assign_type, 
                                arrival_date: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).arrival_date, 
                                depart_date: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).depart_date, 
                                rank_title: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).rank_title, 
                                date_of_rank: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).date_of_rank, 
                                acad_rank: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).acad_rank, 
                                office: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).office, 
                                office_phone: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).office_phone, 
                                address: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).address, 
                                city: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).city, 
                                state: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).state, 
                                zip_code: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).zip_code, 
                                func_num: LookUp(officer_fa, tour_id=varPerson.tour_id).func_num, 
                                br_abbrev: LookUp(officer_br, tour_id=varPerson.tour_id).br_abbrev, 
                                acs_start_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).acs_start_date, 
                                acs_end_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).acs_end_date, 
                                last_oer_thru_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).last_oer_thru_date, 
                                last_aer_thru_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).last_aer_thru_date, 
                                date_aer_submitted: LookUp(mil_eval_info, tour_id=varPerson.tour_id).date_aer_submitted,
                                date_pcs_started: LookUp(mil_eval_info, tour_id = varPerson.tour_id).date_pcs_started});

                            Collect(colPerson, {usma_pers_id: varPerson.usma_pers_id, 
                                tour_id: varPerson.tour_id, 
                                last_name: varPerson.last_name, 
                                first_name: varPerson.first_name, 
                                sex: varPerson.sex, 
                                wp_email: varPerson.wp_email, 
                                middle_name: varPerson.middle_name, 
                                service: varPerson.service, 
                                perm_email: varPerson.perm_email, 
                                cell_num: varPerson.cell_num, 
                                birthday: varPerson.birthday, 
                                com_source: LookUp(commission, usma_pers_id = varPerson.usma_pers_id).com_source, 
                                year_group: LookUp(commission, usma_pers_id = varPerson.usma_pers_id).year_group, 
                                sp_name: LookUp(spouse, usma_pers_id=varPerson.usma_pers_id).sp_name, 
                                sp_email: LookUp(spouse, usma_pers_id=varPerson.usma_pers_id).sp_email, 
                                sp_cell_num: LookUp(spouse, usma_pers_id=varPerson.usma_pers_id).sp_cell_num, 
                                assign_type: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).assign_type, 
                                arrival_date: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).arrival_date, 
                                depart_date: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).depart_date, 
                                rank_title: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).rank_title, 
                                date_of_rank: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).date_of_rank, 
                                acad_rank: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).acad_rank, 
                                office: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).office, 
                                office_phone: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).office_phone, 
                                address: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).address, 
                                city: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).city, 
                                state: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).state, 
                                zip_code: LookUp(tours, usma_pers_id=varPerson.usma_pers_id).zip_code, 
                                func_num: LookUp(officer_fa, tour_id=varPerson.tour_id).func_num, 
                                br_abbrev: LookUp(officer_br, tour_id=varPerson.tour_id).br_abbrev, 
                                acs_start_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).acs_start_date, 
                                acs_end_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).acs_end_date, 
                                last_oer_thru_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).last_oer_thru_date, 
                                last_aer_thru_date: LookUp(mil_eval_info, tour_id=varPerson.tour_id).last_aer_thru_date, 
                                date_aer_submitted: LookUp(mil_eval_info, tour_id=varPerson.tour_id).date_aer_submitted,
                                date_pcs_started: LookUp(mil_eval_info, tour_id = varPerson.tour_id).date_pcs_started});

                            ClearCollect(colDegrees, ShowColumns(Filter(current_degree_view, usma_pers_id = varPerson.usma_pers_id), usma_pers_id, degree_id, degree_abbrev, degree_year, degree_name, degree_school));

                            ClearCollect(colChildren, ShowColumns(Filter(child, usma_pers_id = varPerson.usma_pers_id), usma_pers_id, child_id, child_name, child_birthday));

                            Navigate(Screen_Personnel_Details_20),

                        //), 
                        UpdateContext({varNewPerson:true}))
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: |-
                    =If(varReturnScreen = Screen_Trip_Details_60,
                        "Show More",
                        "Edit Person")
                  Visible: |-
                    =If(IsBlank(varReturnScreen), true, 
                        If(varAddFacTraveler, 
                        true, false))
                  Width: =Parent.Width/11
                  X: =Gallery_Personnel_10.X + Gallery_Personnel_10.Width - Self.Width
                  Y: =Text_Input_Last_Name_Search_10.Y
            - Button_Add_Person_10:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_10.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=If(varReturnScreen = Screen_Project_Details_40,   \r\n    Collect(colProjectFaculty, \r\n        {tour_id:Gallery_Personnel_10.Selected.tour_id, \r\n        fac_first_name:Gallery_Personnel_10.Selected.first_name, \r\n        fac_last_name:Gallery_Personnel_10.Selected.last_name, \r\n        fac_wp_email:Gallery_Personnel_10.Selected.wp_email, \r\n        new_fac_num: Max(colProjectFaculty, new_fac_num)+1});\r\n    Navigate(varReturnScreen);\r\n    Set(varReturnScreen, Blank()),\r\n        If(varReturnScreen = Screen_Trip_Details_60, \r\n            If(varAddFacTraveler, \r\n                If(\r\n                    varUser.usma_pers_id = Gallery_Personnel_10.Selected.usma_pers_id || \r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" || \r\n                    varPermissions = \"Research\",\r\n                \r\n                    Set(varTraveler, \r\n                        {new_traveler_num: Max(colTravelers, new_traveler_num) + 1,\r\n                        usma_pers_id: Gallery_Personnel_10.Selected.usma_pers_id,\r\n                        pers_type: \"FACULTY\", \r\n                        traveler_email: Gallery_Personnel_10.Selected.wp_email, \r\n                        traveler_last_name: Gallery_Personnel_10.Selected.last_name, \r\n                        traveler_first_name: Gallery_Personnel_10.Selected.first_name,\r\n                        traveler_name: Concatenate(Gallery_Personnel_10.Selected.last_name, \", \", Gallery_Personnel_10.Selected.first_name),\r\n                        split_loa: \"NO\",\r\n                        travel_cost_status: \"PROJECTED\",\r\n                        missing_class: \r\n                            If(\r\n                                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                                \"N/A\",\r\n                                If( \r\n                                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                                    \"N/A\",\r\n                                    Blank())), \r\n                        pd_approved_on: \r\n                            If(\r\n                                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                                Today(),\r\n                                If( \r\n                                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                                    Today(),\r\n                                    Blank())), \r\n                        pd_tour: \r\n                            If(\r\n                                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                                LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                                If( \r\n                                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                                    LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                                    Blank()))});\r\n                    Collect(colTravelers, \r\n                        {new_traveler_num: Max(colTravelers, new_traveler_num) + 1,\r\n                        usma_pers_id: Gallery_Personnel_10.Selected.usma_pers_id, \r\n                        pers_type: \"FACULTY\", \r\n                        traveler_email: Gallery_Personnel_10.Selected.wp_email, \r\n                        traveler_last_name: Gallery_Personnel_10.Selected.last_name, \r\n                        traveler_first_name: Gallery_Personnel_10.Selected.first_name,\r\n                        traveler_name: Concatenate(Gallery_Personnel_10.Selected.last_name, \", \", Gallery_Personnel_10.Selected.first_name),\r\n                        split_loa: \"NO\",\r\n                        travel_cost_status: \"PROJECTED\",\r\n                        missing_class: \r\n                            If(\r\n                                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                                \"N/A\",\r\n                                If( \r\n                                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                                    \"N/A\",\r\n                                    Blank())), \r\n                        pd_approved_on: \r\n                            If(\r\n                                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                                Today(),\r\n                                If( \r\n                                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                                    Today(),\r\n                                    Blank())), \r\n                        pd_tour: \r\n                            If(\r\n                                LookUp(current_fac_view, wp_email = Gallery_Personnel_10.Selected.wp_email).acad_rank = \"NOT APPLICABLE\", \r\n                                LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                                If( \r\n                                    Index(colTrip,1).trip_start > Date(Year(Today()), 5, 31) &&\r\n                                    Index(colTrip,1).trip_end < Date(Year(Today()), 7, 31),\r\n                                    LookUp(colFaculty, wp_email = First(colPermissionMaster).wp_email).tour_id,\r\n                                    Blank()))});\r\n                    Navigate(varReturnScreen);\r\n                    Set(varReturnScreen, Blank());\r\n                    Set(varAddFacTraveler, false),\r\n\r\n                    Notify(\"YOU CANNOT ADD SOMEONE ELSE TO THIS TRIP\", NotificationType.Error)), \r\n                     \r\n                    Patch(colTrip, Index(colTrip,1), \r\n                        {trip_oic: Gallery_Personnel_10.Selected.tour_id, \r\n                        oic_last_name: Gallery_Personnel_10.Selected.last_name, \r\n                        oic_first_name: Gallery_Personnel_10.Selected.first_name, \r\n                        oic_name: Concatenate(Gallery_Personnel_10.Selected.last_name, \", \", Gallery_Personnel_10.Selected.first_name)});\r\n                    Navigate(varReturnScreen);\r\n                    Set(varReturnScreen, Blank())),\r\n                    UpdateContext({varNewPerson: true})));"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: |-
                    =If(varReturnScreen = Screen_Project_Details_40, 
                        "Add Advisor",
                        If(varReturnScreen = Screen_Trip_Details_60,
                            If(varAddFacTraveler,
                                "Add Traveler",
                                "Assign OIC"),
                            "Add Person"))
                  Width: =Parent.Width/11
                  X: =Button_Edit_Person_10.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Last_Name_Search_10.Y
            - Button_Home_10:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_10.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(Not(IsBlank(varReturnScreen)), Navigate(varReturnScreen),
                        Navigate(Screen_Welcome_User_00));

                    Set(varReturnScreen, Blank());

                    Set(varAddFacTraveler, false);

                    Reset(Gallery_Personnel_10)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: =If(IsBlank(varReturnScreen), "Home", "Cancel")
                  Width: =Parent.Width/11
                  X: =Button_Add_Person_10.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Last_Name_Search_10.Y
            - Text_Input_Last_Name_Search_10:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_10.Height
                  HintText: ="Search Last Name"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Button_Home_10.X - Self.X - Parent.Width/50
                  X: =Gallery_Personnel_10.X
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Search_10:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Last_Name_Search_10.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Last_Name_Search_10);

                    Reset(Gallery_Personnel_10)
                  Width: =Self.Height
                  X: =Text_Input_Last_Name_Search_10.X + Text_Input_Last_Name_Search_10.Width - Self.Width
                  Y: =Text_Input_Last_Name_Search_10.Y + Text_Input_Last_Name_Search_10.Height/8
            - Gallery_Sections_Taught_10:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Height: =Text_Function_10.Y + Text_Function_10.Height- Self.Y
                  Items: =Filter(fac_courses_view, tour_id = Gallery_Personnel_10.Selected.tour_id)
                  TemplateSize: =30
                  Width: =Text_Sections_Taught_10.Width
                  X: =Text_Sections_Taught_10.X
                  Y: =Text_Sections_Taught_10.Y + Text_Sections_Taught_10.Height
                Children:
                  - Separator_Gallery_Sections_Taught_10:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =8
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                  - Text_Num_Sections_10:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =16
                        Text: =Concatenate("x ",ThisItem.instances)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width - Text_Class_Num_10.Width
                        X: =Text_Class_Num_10.Width
                  - Text_Class_Num_10:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.class_num
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width/1.5
            - Text_Sections_Taught_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Sections Taught"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/10
                  X: =Text_Add_Duty_10.X + Text_Add_Duty_10.Width + Parent.Width/40
                  Y: =Text_Add_Duty_10.Y
            - Text_Function_11:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Height: =Text_Input_Change_User_10.Height
                  Size: =20
                  Text: =LookUp(officer_fa, tour_id = Gallery_Personnel_10.Selected.tour_id).func_num
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Branch_11.Width
                  X: =Text_Branch_11.X
                  Y: =Text_Function_10.Y
            - Text_Function_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="FA:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/15
                  X: =Text_Branch_10.X
                  Y: =Text_Branch_10.Y + Text_Branch_10.Height + Parent.Height/40
            - Text_Branch_11:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Height: =Text_Input_Change_User_10.Height
                  Size: =20
                  Text: =LookUp(officer_br, tour_id = Gallery_Personnel_10.Selected.tour_id).br_abbrev
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Add_Duty_10.Width - Text_Branch_10.Width
                  X: =Text_Branch_10.X + Text_Branch_10.Width
                  Y: =Text_Branch_10.Y
            - Text_Branch_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Branch:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/15
                  X: =Text_Office_10.X
                  Y: =Text_Office_10.Y + Text_Office_10.Height + Parent.Height/40
            - Text_Office_11:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Height: =Text_Input_Change_User_10.Height
                  Size: =20
                  Text: =LookUp(current_fac_view, tour_id=Gallery_Personnel_10.Selected.tour_id).office
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Add_Duty_10.Width - Text_Office_10.Width
                  X: =Text_Office_10.X + Text_Office_10.Width
                  Y: =Text_Office_10.Y
            - Text_Office_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Office:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/15
                  X: =Gallery_Add_Duty_10.X
                  Y: =Gallery_Add_Duty_10.Y + Gallery_Add_Duty_10.Height + Parent.Height/40
            - Gallery_Add_Duty_10:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  Height: =60
                  Items: =Filter(add_duty_view, tour_id = Gallery_Personnel_10.Selected.tour_id)
                  TemplateSize: =30
                  Width: =Text_Add_Duty_10.Width
                  X: =Text_Add_Duty_10.X
                  Y: =Text_Add_Duty_10.Height + Text_Add_Duty_10.Y
                Children:
                  - Separator_Gallery_Add_Duty_10:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =8
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                  - Text_Add_Duty_11:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.committee_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
            - Text_Add_Duty_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Add. Duties"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/8
                  X: =Text_Acad_Rank_10.X + Text_Acad_Rank_10.Width + Parent.Width/40
                  Y: =Text_Acad_Rank_10.Y
            - Gallery_Course_Pos_10:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  Height: =60
                  Items: =Filter(Filter(course_pos_view, tour_id = Gallery_Personnel_10.Selected.tour_id), pos_title = "DIRECTOR").class_num
                  TemplateSize: =30
                  Width: =Text_Course_Pos_10.Width
                  X: =Text_Course_Pos_10.X
                  Y: =Text_Course_Pos_10.Y + Text_Course_Pos_10.Height
                Children:
                  - Separator_Gallery_Course_Pos_10:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =8
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                  - Text_Course_Pos_11:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        Height: =Parent.TemplateHeight
                        Size: =16
                        Text: =ThisItem.class_num
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
            - Text_Course_Pos_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Course Director"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Program_Pos_11.Width
                  X: =Text_Program_Pos_11.X
                  Y: =Text_Program_Pos_11.Y + Text_Program_Pos_11.Height + Parent.Height/40
            - Text_Program_Pos_11:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =1
                  Height: =30
                  Size: =16
                  Text: =LookUp(colFaculty, tour_id = Gallery_Personnel_10.Selected.tour_id).name_program
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Program_Pos_10.Width
                  X: =Text_Program_Pos_10.X
                  Y: =Text_Program_Pos_10.Y + Text_Program_Pos_10.Height
            - Text_Program_Pos_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Program Director"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Acad_Rank_11.Width
                  X: =Text_Acad_Rank_11.X
                  Y: =Text_Acad_Rank_11.Y + Text_Acad_Rank_11.Height + Parent.Height/40
            - Text_Acad_Rank_11:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Height: =Text_Input_Change_User_10.Height
                  Size: =16
                  Text: =LookUp(current_fac_view, tour_id=Gallery_Personnel_10.Selected.tour_id).acad_rank
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Acad_Rank_10.Width
                  X: =Text_Acad_Rank_10.X
                  Y: =Text_Acad_Rank_10.Height + Text_Acad_Rank_10.Y
            - Text_Acad_Rank_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  FontUnderline: =true
                  Height: =Text_Input_Change_User_10.Height
                  Size: =23
                  Text: ="Academic Rank"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =210
                  X: =Gallery_Personnel_10.X + Gallery_Personnel_10.Width + Parent.Width/50
                  Y: =Image_Person.Y + Image_Person.Height + Parent.Height/30
            - Image_Person:
                Control: Image@2.2.3
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Height: =Self.Width
                  Image: |-
                    =IfError(
                        With(
                            { photo: Office365Users.UserPhotoV2(Gallery_Personnel_10.Selected.wp_email) },
                            If(IsBlank(photo), SampleImage, photo)
                        ),
                        SampleImage
                    )
                  ImagePosition: =ImagePosition.Fill
                  RadiusBottomLeft: =50
                  RadiusBottomRight: =50
                  RadiusTopLeft: =50
                  RadiusTopRight: =50
                  Width: =Parent.Width/5
                  X: =((Parent.Width - (Gallery_Personnel_10.X + Gallery_Personnel_10.Width))/2) - Self.Width/2 + Parent.Width/2 + Gallery_Personnel_10.X/2
                  Y: =Gallery_Personnel_10.Y
            - Gallery_Personnel_10:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =1
                  Height: =Text_Input_Last_Name_Search_10.Y - Text_Last_Name_10.Y - Text_Last_Name_10.Height - Parent.Height/40
                  Items: |-
                    =Filter(
                        Sort(current_fac_view, last_name, SortOrder.Ascending), StartsWith(last_name, Text_Input_Last_Name_Search_10.Text))
                  TemplateFill: =If(ThisItem.IsSelected, RGBA(177, 179, 179, 1), RGBA(0, 0, 0, 0))
                  TemplateSize: =Text_Input_Change_User_10.Height*2
                  Width: =Parent.Width/2
                  X: =Parent.Width/50
                  Y: =Text_Last_Name_10.Y + Text_Last_Name_10.Height
                Children:
                  - Separator_Gallery_Personnel:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                  - Text_wp_Email_11:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =16
                        Text: =ThisItem.wp_email
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_wp_Email_10.Width
                        X: =Text_wp_Email_10.X - Gallery_Personnel_10.X
                  - Text_Rank_11:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =16
                        Text: =ThisItem.rank_title
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Rank_10.Width
                        X: =Text_Rank_10.X - Gallery_Personnel_10.X
                  - Text_First_Name_11:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =16
                        Text: =ThisItem.first_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_First_Name_10.Width
                        X: =Text_First_Name_10.X - Gallery_Personnel_10.X
                  - Text_Last_Name_11:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =16
                        Text: =ThisItem.last_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Last_Name_10.Width
            - Text_wp_Email_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="Email"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Personnel_10.Width*9/20 - 30
                  X: =Text_Rank_10.X + Text_Rank_10.Width + 10
                  Y: =Text_Last_Name_10.Y
            - Text_Rank_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="Rank"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Personnel_10.Width/10
                  X: =Text_First_Name_10.X + Text_First_Name_10.Width + 10
                  Y: =Text_Last_Name_10.Y
            - Text_First_Name_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="First Name"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Personnel_10.Width/5
                  X: =Text_Last_Name_10.X + Text_Last_Name_10.Width + 10
                  Y: =Text_Last_Name_10.Y
            - Text_Last_Name_10:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_10.Height
                  Size: =18
                  Text: ="Last Name"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Personnel_10.Width/4
                  X: =Gallery_Personnel_10.X
                  Y: =Parent.Height/40
      - Container_Personnel_Header_10:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Personnel_Header_10:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Personnel"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_10:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_10:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Personnel_Details_20

Screens:
  Screen_Personnel_Details_20:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Personnel_Details_Edit_20:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Personnel_Details_Header_20.Height
            Width: =Parent.Width
            Y: =Container_Personnel_Details_Header_20.Height
          Children:
            - Text_Input_Tour_ID_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =varPerson.tour_id
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width/15
                  X: =Parent.Width - Self.Width
                  Y: =Parent.Height - Self.Height
            - Text_Tour_ID_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Tour ID"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/12
                  X: =Text_Input_Tour_ID_20.X - Self.Width
                  Y: =Text_Input_Tour_ID_20.Y
            - Button_Submit_21:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit && 
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email), 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=UpdateContext({varShowSpinner:true});\r\n\r\n// UPDATE PERSONNEL TABLE\r\nIf( \r\n    Index(colPerson,1).perm_email <> Index(colPerson,2).perm_email ||\r\n    Index(colPerson,1).sex <> Index(colPerson,2).sex,\r\n    Patch(personnel, LookUp(personnel, usma_pers_id = Index(colPerson,1).usma_pers_id), \r\n        {perm_email: Index(colPerson,1).perm_email, \r\n        sex: If(\r\n                Index(colPerson,1).sex = \"MALE\", \r\n                \"M\", \r\n                If(\r\n                    Index(colPerson,1).sex = \"FEMALE\", \r\n                    \"F\",\r\n                    \"O\"))}));\r\n\r\n// UPDATE FACULTY TABLE\r\nIf( \r\n    Index(colPerson,1).service <> Index(colPerson,2).service ||\r\n    Index(colPerson,1).cell_num <> Index(colPerson,2).cell_num ||\r\n    Index(colPerson,1).birthday <> Index(colPerson,2).birthday,\r\n    Patch(faculty, LookUp(faculty, usma_pers_id = Index(colPerson,1).usma_pers_id), {service: Index(colPerson,1).service, cell_num: Index(colPerson,1).cell_num, birthday: Index(colPerson,1).birthday}));\r\n\r\n// UPDATE DEGREE TABLE\r\nIf(varDegreeChange,\r\nForAll(\r\n    colDegrees As DEGREE,\r\n    If(IsBlank(DEGREE.degree_id), \r\n        // PATCHES IN NEW DEGREES\r\n        Patch(degrees, Defaults(degrees),\r\n            {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n            degree_abbrev: DEGREE.degree_abbrev, \r\n            degree_year: DEGREE.degree_year, \r\n            degree_name: DEGREE.degree_name, \r\n            degree_school: DEGREE.degree_school}), \r\n        // UPDATES PRE-EXISTING DEGREES\r\n        Patch(degrees, LookUp(degrees, degree_id = DEGREE.degree_id), \r\n            {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n            degree_abbrev: DEGREE.degree_abbrev, \r\n            degree_year: DEGREE.degree_year, \r\n            degree_name: DEGREE.degree_name, \r\n            degree_school: DEGREE.degree_school}))));\r\n\r\n// UPDATE COMMISSION TABLE\r\nIf(\r\n    IsBlank(Index(colPerson,2).com_source) ||\r\n    IsBlank(Index(colPerson,2).year_group),\r\n    If(\r\n        Not(IsBlank(Index(colPerson,1).com_source)) && Not(IsBlank(Index(colPerson,1).year_group)),\r\n    // PATCHES IN NEW COMMISSION SOURCE AND YEAR GROUP\r\n        Patch(commission, Defaults(commission),\r\n            {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n            com_source: Index(colPerson,1).com_source,\r\n            year_group: Index(colPerson,1).year_group})), \r\n    If(\r\n        Index(colPerson,1).com_source <> Index(colPerson,2).com_source &&\r\n        Index(colPerson,1).year_group <> Index(colPerson,2).year_group,\r\n    // PATCHES IN UPDATES TO COMMISSION SOURCE AND YEAR GROUP\r\n        Patch(commission, LookUp(commission, usma_pers_id = Index(colPerson,1).usma_pers_id),\r\n            {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n            com_source: Index(colPerson,1).com_source,\r\n            year_group: Index(colPerson,1).year_group})));\r\n    \r\n// UPDATE SPOUSE TABLE\r\nIf(\r\n    IsBlank(Index(colPerson,2).sp_name) && Not(IsBlank(Index(colPerson,1).sp_name)),\r\n    // PATCHES IN NEW SPOUSE\r\n    Patch(spouse, Defaults(spouse),\r\n        {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n        sp_name: Index(colPerson,1).sp_name,\r\n        sp_cell_num: Index(colPerson,1).sp_cell_num, \r\n        sp_email: Index(colPerson,1).sp_email}), \r\n    If(\r\n        Not(IsBlank(Index(colPerson,1).sp_name)), \r\n        If(\r\n            Index(colPerson,1).sp_name <> Index(colPerson,2).sp_name ||\r\n            Index(colPerson,1).sp_cell_num <> Index(colPerson,2).sp_cell_num ||\r\n            Index(colPerson,1).sp_email <> Index(colPerson,2).sp_email,\r\n            // PATCHES IN UPDATES TO SPOUSE\r\n            Patch(spouse, LookUp(spouse, usma_pers_id = Index(colPerson,1).usma_pers_id),\r\n                {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n                sp_name: Index(colPerson,1).sp_name,\r\n                sp_cell_num: Index(colPerson,1).sp_cell_num, \r\n                sp_email: Index(colPerson,1).sp_email}))));\r\n\r\n// UPDATE CHILD TABLE\r\nIf(varChildChange,\r\nForAll(\r\n    colChildren As Children,\r\n    If(IsBlank(Children.child_id), \r\n        // PATCHES IN NEW CHILDREN\r\n        Patch(child, Defaults(child),\r\n            {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n            child_name: Children.child_name, \r\n            child_birthday: Children.child_birthday}), \r\n        // UPDATES PRE-EXISTING CHILDREN\r\n        Patch(child, LookUp(child, child_id = Children.child_id), \r\n            {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n            child_name: Children.child_name, \r\n            child_birthday: Children.child_birthday}))));\r\n	\r\n// UPDATE officer_br if needed\r\nIf(\r\n    IsBlank(LookUp(officer_br, tour_id = Index(colPerson, 1).tour_id)),\r\n    Patch(officer_br, Defaults(officer_br), {\r\n        tour_id: Index(colPerson, 1).tour_id,\r\n        br_abbrev: Index(colPerson,1).br_abbrev, \r\n        updated_on: Today()}),\r\n    Patch(officer_br, LookUp(officer_br, tour_id = Index(colPerson, 1).tour_id), {\r\n        br_abbrev: Index(colPerson,1).br_abbrev, \r\n        updated_on: Today()\r\n    })\r\n);\r\n\r\n// UPDATE officer_fa if needed\r\nIf(\r\n    Not(IsBlank(Index(colPerson, 1).func_num)),\r\n\r\n    If(\r\n        IsBlank(LookUp(officer_fa, tour_id = Index(colPerson, 1).tour_id)),\r\n        Patch(officer_fa, Defaults(officer_fa), {\r\n            tour_id: Index(colPerson, 1).tour_id,\r\n            func_num: Index(colPerson, 1).func_num,\r\n            updated_on: Today()\r\n        }),\r\n        Patch(officer_fa, LookUp(officer_fa, tour_id = Index(colPerson, 1).tour_id), {\r\n            func_num: Index(colPerson, 1).func_num,\r\n            updated_on: Today()\r\n        })\r\n    )\r\n\r\n);\r\n\r\n// UPDATE mil_eval_info if needed\r\nIf(\r\n    IsBlank(LookUp(mil_eval_info, tour_id = Index(colPerson, 1).tour_id)),\r\n    Patch(mil_eval_info, Defaults(mil_eval_info), {\r\n        tour_id: Index(colPerson, 1).tour_id,\r\n		last_oer_thru_date: Index(colPerson,1).last_oer_thru_date, \r\n		acs_start_date: Index(colPerson,1).acs_start_date, \r\n		acs_end_date: Index(colPerson,1).acs_end_date, \r\n		last_aer_thru_date: Index(colPerson,1).last_aer_thru_date, \r\n		date_aer_submitted: Index(colPerson,1).date_aer_submitted,\r\n		date_pcs_started: Index(colPerson,1).date_pcs_started\r\n    }),\r\n    Patch(mil_eval_info, LookUp(mil_eval_info, tour_id = Index(colPerson, 1).tour_id), {\r\n        last_oer_thru_date: Index(colPerson,1).last_oer_thru_date, \r\n		acs_start_date: Index(colPerson,1).acs_start_date, \r\n		acs_end_date: Index(colPerson,1).acs_end_date, \r\n		last_aer_thru_date: Index(colPerson,1).last_aer_thru_date, \r\n		date_aer_submitted: Index(colPerson,1).date_aer_submitted,\r\n		date_pcs_started: Index(colPerson,1).date_pcs_started\r\n    })\r\n);\r\n\r\n\r\n// UPDATE TOURS TABLE\r\nIf( \r\n    IsBlank(Index(colPerson,1).tour_id), \r\n    // PATCHES IN A NEW TOUR AND CAPTURES TOUR_ID\r\n    With({new_tour_id: \r\n                Patch(tours, Defaults(tours), \r\n        {usma_pers_id: Index(colPerson,1).usma_pers_id,\r\n        assign_type: Index(colPerson,1).assign_type, \r\n        arrival_date: Index(colPerson,1).arrival_date,\r\n        rank_title: Index(colPerson,1).rank_title,\r\n        date_of_rank: Index(colPerson,1).date_of_rank,\r\n        acad_rank: Index(colPerson,1).acad_rank,\r\n        office: Index(colPerson,1).office,\r\n        office_phone: Index(colPerson,1).office_phone,\r\n        address: Index(colPerson,1).address,\r\n        city: Index(colPerson,1).city,\r\n        state: Index(colPerson,1).state,\r\n        zip_code: Index(colPerson,1).zip_code}).tour_id},\r\n\r\n        // PATCH IN NEW BRANCH RECORD\r\n        If(\r\n            Index(colPerson,1).service <> \"CIVILIAN\" && Not(IsBlank(Index(colPerson,1).service)),\r\n            Patch(officer_br, Defaults(officer_br),\r\n                {tour_id: new_tour_id,\r\n                br_abbrev: Index(colPerson,1).br_abbrev, \r\n                updated_on: Today()}\r\n				); \r\n\r\n            // UPDATE OFFICER_FA TABLE\r\n            If( \r\n                Not(IsBlank(Index(colPerson,1).func_num)), \r\n                // PATCH IN NEW FA RECORD\r\n                Patch(officer_fa, Defaults(officer_fa),\r\n                    {tour_id: new_tour_id,\r\n                    func_num: Index(colPerson,1).func_num, \r\n                    updated_on: Today()})\r\n				); \r\n\r\n            // PATCH IN NEW MIL EVAL RECORD\r\n            Patch(mil_eval_info, Defaults(mil_eval_info),\r\n					{tour_id: new_tour_id,\r\n					last_oer_thru_date: Index(colPerson,1).last_oer_thru_date, \r\n					acs_start_date: Index(colPerson,1).acs_start_date, \r\n					acs_end_date: Index(colPerson,1).acs_end_date, \r\n					last_aer_thru_date: Index(colPerson,1).last_aer_thru_date, \r\n					date_aer_submitted: Index(colPerson,1).date_aer_submitted,\r\n					date_pcs_started: Index(colPerson,1).date_pcs_started\r\n					}\r\n				)\r\n			)\r\n		), \r\n\r\n    // CHECK FOR TOUR UPDATES\r\n    If(\r\n        Index(colPerson,1).assign_type <> Index(colPerson,2).assign_type ||\r\n        Index(colPerson,1).arrival_date <> Index(colPerson,2).arrival_date ||\r\n        Index(colPerson,1).depart_date <> Index(colPerson,2).depart_date ||\r\n        Index(colPerson,1).rank_title <> Index(colPerson,2).rank_title ||\r\n        Index(colPerson,1).date_of_rank <> Index(colPerson,2).date_of_rank ||\r\n        Index(colPerson,1).acad_rank <> Index(colPerson,2).acad_rank ||\r\n        Index(colPerson,1).office <> Index(colPerson,2).office ||\r\n        Index(colPerson,1).office_phone <> Index(colPerson,2).office_phone ||\r\n        Index(colPerson,1).address <> Index(colPerson,2).address ||\r\n        Index(colPerson,1).city <> Index(colPerson,2).city ||\r\n        Index(colPerson,1).state <> Index(colPerson,2).state ||\r\n        Index(colPerson,1).zip_code <> Index(colPerson,2).zip_code, \r\n        // PATCHES IN UPDATES TO EXISTING TOUR\r\n        Patch(tours, LookUp(tours, tour_id=Index(colPerson,1).tour_id), \r\n            {assign_type: Index(colPerson,1).assign_type, \r\n            arrival_date: Index(colPerson,1).arrival_date,\r\n            depart_date: Index(colPerson,1).depart_date,\r\n            rank_title: Index(colPerson,1).rank_title,\r\n            date_of_rank: Index(colPerson,1).date_of_rank,\r\n            acad_rank: Index(colPerson,1).acad_rank,\r\n            office: Index(colPerson,1).office,\r\n            office_phone: Index(colPerson,1).office_phone,\r\n            address: Index(colPerson,1).address,\r\n            city: Index(colPerson,1).city,\r\n            state: Index(colPerson,1).state,\r\n            zip_code: Index(colPerson,1).zip_code\r\n			}\r\n		)\r\n	)\r\n);\r\n\r\nRefresh(current_fac_view);\r\nRefresh(commission);\r\nRefresh(spouse);\r\nRefresh(tours); \r\nRefresh(officer_fa); \r\nRefresh(officer_br); \r\nRefresh(mil_eval_info); \r\nRefresh(current_degree_view); \r\nRefresh(child);\r\nRefresh(add_pers_view);\r\n\r\nClearCollect(colPerson, \r\n    {usma_pers_id: Blank(), tour_id:Blank(), last_name: Blank(), first_name: Blank(), sex: Blank(), wp_email: Blank(), middle_name: Blank(), service: Blank(), perm_email: Blank(), cell_num: Blank(), birthday: Blank(), com_source: Blank(),year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date: Blank(), depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()}, \r\n    {usma_pers_id: Blank(), tour_id:Blank(), last_name: Blank(), first_name: Blank(), sex: Blank(), wp_email: Blank(), middle_name: Blank(), service: Blank(), perm_email: Blank(), cell_num: Blank(), birthday: Blank(), com_source: Blank(),year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date: Blank(), depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()});\r\n\r\nClear(colChildren);\r\nClear(colDegrees);\r\n\r\nSet(varPerson, Blank());\r\n\r\nUpdateContext({varShowSpinner:false});\r\n\r\nReset(Gallery_Personnel_10);\r\nReset(Gallery_Personnel_11);\r\n\r\nNavigate(Screen_Personnel_Overview_10);"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Save"
                  Width: =Parent.Width/11
                  X: =Button_Check_20.X + Button_Check_20.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Check_20:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit = false &&
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email), 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(
                        Not(IsBlank(Index(colPerson,1).service)) && Not(IsBlank(Index(colPerson,1).sex)), 

                        // Make sure minimum required information for civilians is filled out
                        If(
                            Index(colPerson,1).service = "CIVILIAN", 

                            If(
                                Not(IsBlank(Index(colPerson,1).assign_type)) &&
                                Not(IsBlank(Index(colPerson,1).arrival_date)) &&
                                Not(IsBlank(Index(colPerson,1).rank_title)) &&
                                Not(IsBlank(Index(colPerson,1).acad_rank)) &&
                                Not(IsBlank(Index(colPerson,1).office)) &&
                                If(Index(colPerson,1).acad_rank <> "NOT APPLICABLE", 
                                    If(
                                        CountRows(Filter(
                                                            colDegrees,
                                                            !IsBlank(degree_school) &&
                                                            !IsBlank(degree_abbrev) &&
                                                            !IsBlank(degree_name) &&
                                                            !IsBlank(degree_year)
                                                        )
                                                    ) >= 2 &&
                                        CountRows(Filter(colDegrees, 
                                            IsBlank(degree_abbrev) && IsBlank(degree_name) && IsBlank(degree_year) && IsBlank(degree_school))) = 0,
                                        true, 
                                        false),
                                    true),
                                UpdateContext({varReadyToSubmit:true});
                                Notify("CLICK SAVE TO SUBMIT CHANGES",NotificationType.Success),
                                UpdateContext({varReadyToSubmit:Blank()});
                                Notify("PLEASE ENSURE ALL FIELDS IN RED ARE COMPLETE AND YOU HAVE PROVIDED AT LEAST TWO DEGREES IF IN A TEACHING CAPACITY",NotificationType.Error)),

                        // Make sure minimum required information for military is filled out
                            If(
                                Dropdown_ACS_20.Selected.answer = "NO",

                                If(
                                    Not(IsBlank(Index(colPerson,1).assign_type)) &&
                                    Not(IsBlank(Index(colPerson,1).arrival_date)) &&
                                    Not(IsBlank(Index(colPerson,1).rank_title)) &&
                                    Not(IsBlank(Index(colPerson,1).acad_rank)) &&
                                    Not(IsBlank(Index(colPerson,1).office)) &&
                                    If(Index(colPerson,1).acad_rank <> "NOT APPLICABLE", 
                                        If(
                                            CountRows(Filter(
                                                            colDegrees,
                                                            !IsBlank(degree_school) &&
                                                            !IsBlank(degree_abbrev) &&
                                                            !IsBlank(degree_name) &&
                                                            !IsBlank(degree_year)
                                                        )
                                                    ) >= 2 &&
                                            CountRows(Filter(colDegrees, 
                                                IsBlank(degree_abbrev) && IsBlank(degree_name) && IsBlank(degree_year) && IsBlank(degree_school))) = 0,
                                            true, 
                                            false),
                                        true) &&
                                    Not(IsBlank(Index(colPerson,1).com_source)) &&
                                    Not(IsBlank(Index(colPerson,1).year_group)) &&
                                    Not(IsBlank(Index(colPerson,1).br_abbrev)) &&
                                    Not(IsBlank(Index(colPerson,1).date_of_rank)) &&
                                    Not(IsBlank(Index(colPerson,1).last_oer_thru_date)),
                                    UpdateContext({varReadyToSubmit:true});
                                    Notify("CLICK SAVE TO SUBMIT CHANGES",NotificationType.Success),
                                    UpdateContext({varReadyToSubmit:Blank()});
                                    Notify("PLEASE ENSURE ALL FIELDS IN RED ARE COMPLETE AND YOU HAVE PROVIDED AT LEAST TWO DEGREES IF IN A TEACHING CAPACITY",NotificationType.Error)),

                            // If coming from ACS, make sure ACS info is not blank
                                If(
                                    Dropdown_ACS_20.Selected.answer = "YES",

                                    If(
                                        Not(IsBlank(Index(colPerson,1).assign_type)) &&
                                        Not(IsBlank(Index(colPerson,1).arrival_date)) &&
                                        Not(IsBlank(Index(colPerson,1).rank_title)) &&
                                        Not(IsBlank(Index(colPerson,1).acad_rank)) &&
                                        Not(IsBlank(Index(colPerson,1).office)) &&
                                        If(Index(colPerson,1).acad_rank <> "NOT APPLICABLE", 
                                            If(
                                                CountRows(Filter(
                                                            colDegrees,
                                                            !IsBlank(degree_school) &&
                                                            !IsBlank(degree_abbrev) &&
                                                            !IsBlank(degree_name) &&
                                                            !IsBlank(degree_year)
                                                        )
                                                    ) >= 2 &&
                                                CountRows(Filter(colDegrees, IsBlank(degree_abbrev) && IsBlank(degree_name) && IsBlank(degree_year) && IsBlank(degree_school))) = 0,
                                                true, 
                                                false), 
                                            true) &&
                                        Not(IsBlank(Index(colPerson,1).com_source)) &&
                                        Not(IsBlank(Index(colPerson,1).year_group)) &&
                                        Not(IsBlank(Index(colPerson,1).br_abbrev)) &&
                                        Not(IsBlank(Index(colPerson,1).date_of_rank)) &&
                                        Not(IsBlank(Index(colPerson,1).last_oer_thru_date)) &&
                                        Not(IsBlank(Index(colPerson,1).acs_start_date)) &&
                                        Not(IsBlank(Index(colPerson,1).acs_end_date)) &&
                                        Not(IsBlank(Index(colPerson,1).last_aer_thru_date)) &&
                                        Not(IsBlank(Index(colPerson,1).date_aer_submitted)) &&
                                        Not(IsBlank(Index(colPerson,1).date_pcs_started)),
                                        UpdateContext({varReadyToSubmit:true});
                                        Notify("CLICK SAVE TO SUBMIT CHANGES",NotificationType.Success),
                                        UpdateContext({varReadyToSubmit:Blank()});
                                        Notify("PLEASE ENSURE ALL FIELDS IN RED ARE COMPLETE AND YOU HAVE PROVIDED AT LEAST TWO DEGREES IF IN A TEACHING CAPACITY",NotificationType.Error)),
                                    UpdateContext({varReadyToSubmit:Blank()});
                                    Notify("PLEASE ENSURE ALL FIELDS IN RED ARE COMPLETE AND YOU HAVE PROVIDED AT LEAST TWO DEGREES IF IN A TEACHING CAPACITY",NotificationType.Error)))),
                        UpdateContext({varReadyToSubmit:Blank()});
                        Notify("PLEASE ENSURE ALL FIELDS IN RED ARE COMPLETE AND YOU HAVE PROVIDED AT LEAST TWO DEGREES IF IN A TEACHING CAPACITY",NotificationType.Error))
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Check"
                  Width: =Parent.Width/11
                  X: =Button_Return_21.X + Button_Return_21.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Return_21:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Reset(Gallery_Personnel_10);

                    Reset(Gallery_Personnel_11);

                    UpdateContext({varReadyToSubmit:Blank()});

                    Refresh(current_fac_view);

                    Refresh(add_pers_view);

                    ClearCollect(colPerson, 
                        {usma_pers_id: Blank(), tour_id:Blank(), last_name: Blank(), first_name: Blank(), sex: Blank(), wp_email: Blank(), middle_name: Blank(), service: Blank(), perm_email: Blank(), cell_num: Blank(), birthday: Blank(), com_source: Blank(),year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date: Blank(), depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()}, 
                        {usma_pers_id: Blank(), tour_id:Blank(), last_name: Blank(), first_name: Blank(), sex: Blank(), wp_email: Blank(), middle_name: Blank(), service: Blank(), perm_email: Blank(), cell_num: Blank(), birthday: Blank(), com_source: Blank(),year_group: Blank(), sp_name: Blank(), sp_email: Blank(), sp_cell_num: Blank(), assign_type: Blank(), arrival_date: Blank(), depart_date: Blank(), rank_title: Blank(), date_of_rank: Blank(), acad_rank: Blank(), office: Blank(), office_phone: Blank(), address: Blank(), city: Blank(), state: Blank(), zip_code: Blank(), func_num: Blank(), br_abbrev: Blank(), acs_start_date: Blank(), acs_end_date: Blank(), last_oer_thru_date: Blank(), last_aer_thru_date: Blank(), date_aer_submitted: Blank(), date_pcs_started: Blank()});

                    Clear(colChildren);

                    Clear(colDegrees);

                    Set(varPerson, Blank());

                    Navigate(Screen_Personnel_Overview_10)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Return"
                  Width: =Parent.Width/11
                  X: =40
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Container_Mil_Info_20:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Text_Input_Tour_ID_20.Y - Self.Y - Parent.Height/40
                  Visible: =If(Index(colPerson,1).service <> "CIVILIAN", true, false)
                  Width: =Parent.Width - Self.X - Parent.Width/40
                  X: =Text_Spouse_Email_20.X
                  Y: =Text_Spouse_Email_20.Y + Text_Spouse_Email_20.Height+ Parent.Height/40
                Children:
                  - Container_ACS_Info_20:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Height: =Parent.Height - Self.Y
                        Visible: =If(Dropdown_ACS_20.Selected.answer = "YES", true, false)
                        Width: =Parent.Width/2
                        X: =Parent.Width/2
                        Y: =Text_ACS_20.Y + Text_ACS_20.Height + Parent.Height/20
                      Children:
                        - Date_Picker_Date_PCS_Started_20:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "S1" || 
                                    varUser.usma_pers_id = varPerson.usma_pers_id ||
                                    Upper(User().Email) = varPerson.wp_email, 
                                    DisplayMode.Edit, 
                                    DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Change_User_20.Height
                              OnChange: |-
                                =Patch(colPerson, Index(colPerson,1), {date_pcs_started:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).date_pcs_started
                              Width: =Date_Picker_ACS_Start_Date_20.Width
                              X: =Text_Date_PCS_Started_20.X + Text_Date_PCS_Started_20.Width
                              Y: =Text_Date_PCS_Started_20.Y
                        - Text_Date_PCS_Started_20:
                            Control: Text@0.0.51
                            Properties:
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Text_Input_Change_User_20.Height
                              Size: =18
                              Text: ="Date PCS Started"
                              Width: =Text_ACS_20.Width
                              X: =Text_Date_AER_Submitted_20.X
                              Y: =Date_Picker_Last_OER_Date_20.Y - Parent.Y
                        - Date_Picker_Date_AER_Submitted_20:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "S1" || 
                                    varUser.usma_pers_id = varPerson.usma_pers_id ||
                                    Upper(User().Email) = varPerson.wp_email, 
                                    DisplayMode.Edit, 
                                    DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Change_User_20.Height
                              OnChange: |-
                                =Patch(colPerson, Index(colPerson,1), {date_aer_submitted:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).date_aer_submitted
                              Width: =Date_Picker_ACS_Start_Date_20.Width
                              X: =Text_Date_AER_Submitted_20.X + Text_Date_AER_Submitted_20.Width
                              Y: =Text_Date_AER_Submitted_20.Y
                        - Text_Date_AER_Submitted_20:
                            Control: Text@0.0.51
                            Properties:
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Text_Input_Change_User_20.Height
                              Size: =18
                              Text: ="Date AER Submitted"
                              Width: =Text_ACS_20.Width
                              X: =Text_Last_AER_Date_20.X
                              Y: =Date_Picker_Rank_Date_20.Y - Parent.Y
                        - Date_Picker_Last_AER_Date_20:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "S1" || 
                                    varUser.usma_pers_id = varPerson.usma_pers_id ||
                                    Upper(User().Email) = varPerson.wp_email, 
                                    DisplayMode.Edit, 
                                    DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Change_User_20.Height
                              OnChange: |-
                                =Patch(colPerson, Index(colPerson,1), {last_aer_thru_date:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).last_aer_thru_date
                              Width: =Date_Picker_ACS_Start_Date_20.Width
                              X: =Text_Last_AER_Date_20.X + Text_Last_AER_Date_20.Width
                              Y: =Text_Last_AER_Date_20.Y
                        - Text_Last_AER_Date_20:
                            Control: Text@0.0.51
                            Properties:
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Text_Input_Change_User_20.Height
                              Size: =18
                              Text: ="Last AER Thru Date:"
                              Width: =Text_ACS_20.Width
                              Y: =Dropdown_Function_22.Y - Parent.Y
                        - Date_Picker_ACS_End_Date_20:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "S1" || 
                                    varUser.usma_pers_id = varPerson.usma_pers_id ||
                                    Upper(User().Email) = varPerson.wp_email, 
                                    DisplayMode.Edit, 
                                    DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Change_User_20.Height
                              OnChange: |-
                                =Patch(colPerson, Index(colPerson,1), {acs_end_date:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).acs_end_date
                              Width: =Dropdown_ACS_20.Width
                              X: =Text_ACS_End_Date_20.X + Text_ACS_End_Date_20.Width
                              Y: =Text_ACS_End_Date_20.Y
                        - Text_ACS_End_Date_20:
                            Control: Text@0.0.51
                            Properties:
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Text_Input_Change_User_20.Height
                              Size: =18
                              Text: ="ACS End Date:"
                              Width: =Text_ACS_20.Width
                              X: =Text_ACS_Start_Date_20.X
                              Y: =Dropdown_Branch_22.Y - Parent.Y
                        - Date_Picker_ACS_Start_Date_20:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "S1" || 
                                    varUser.usma_pers_id = varPerson.usma_pers_id ||
                                    Upper(User().Email) = varPerson.wp_email, 
                                    DisplayMode.Edit, 
                                    DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Change_User_20.Height
                              OnChange: |-
                                =Patch(colPerson, Index(colPerson,1), {acs_start_date:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).acs_start_date
                              Width: =Dropdown_ACS_20.Width
                              X: =Text_ACS_Start_Date_20.X + Text_ACS_Start_Date_20.Width
                              Y: =Text_ACS_Start_Date_20.Y
                        - Text_ACS_Start_Date_20:
                            Control: Text@0.0.51
                            Properties:
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Text_Input_Change_User_20.Height
                              Size: =18
                              Text: ="ACS Start Date:"
                              Width: =Text_ACS_20.Width
                  - Dropdown_ACS_20:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: |-
                          =If(
                              Index(colPerson,1).service = "CIVILIAN", 
                              Filter(colYesNo, answer = "NO"),
                              If(
                                  Index(colPerson,1).acs_start_date = Blank(),
                                  Filter(colYesNo, answer = "NO"),
                                  Filter(colYesNo, answer = "YES")))
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_20.Height
                        Items: =colYesNo
                        OnChange: |+
                          =If(
                              Dropdown_ACS_20.Selected.answer = "NO" || Dropdown_ACS_20.Selected.answer = "N/A",
                              Patch(colPerson, Index(colPerson,1), {
                                  acs_start_date: Blank(),
                                  acs_end_date: Blank(),
                                  last_aer_thru_date: Blank(),
                                  date_aer_submitted: Blank(),
                                  date_pcs_started: Blank()
                              })
                          );

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Parent.Width - Self.X - Parent.Width/20
                        X: =Text_ACS_20.X + Text_ACS_20.Width
                        Y: =Text_ACS_20.Y
                      Children:
                        - answer1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="answer"
                              FieldName: ="answer"
                              FieldType: ="s"
                              Order: =1
                  - Text_ACS_20:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Coming From ACS?"
                        Width: =Parent.Width/4
                        X: =Dropdown_Comm_Source_20.X + Dropdown_Comm_Source_20.Width + Parent.Width/20
                        Y: =Dropdown_Comm_Source_20.Y
                  - Date_Picker_Last_OER_Date_20:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_20.Height
                        OnChange: |-
                          =Patch(colPerson, Index(colPerson,1), {last_oer_thru_date:Self.SelectedDate});

                          UpdateContext({varReadyToSubmit: false})
                        SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).last_oer_thru_date
                        Width: =Dropdown_Function_22.Width
                        X: =Dropdown_Comm_Source_20.X
                        Y: =Text_Last_OER_Date_20.Y
                  - Text_Last_OER_Date_20:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Last OER Thru Date:"
                        Width: =Parent.Width/4
                        X: =Text_Function_22.X
                        Y: =Text_Rank_Date_20.Height + Text_Rank_Date_20.Y + Parent.Height/20
                  - Date_Picker_Rank_Date_20:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_20.Height
                        OnChange: |-
                          =Patch(colPerson, Index(colPerson,1), {date_of_rank:Self.SelectedDate});

                          UpdateContext({varReadyToSubmit: false})
                        SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).date_of_rank
                        Width: =Dropdown_Function_22.Width
                        X: =Dropdown_Comm_Source_20.X
                        Y: =Text_Rank_Date_20.Y
                  - Text_Rank_Date_20:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Date of Rank:"
                        Width: =Parent.Width/4
                        X: =Text_Function_22.X
                        Y: =Text_Function_22.Height + Text_Function_22.Y + Parent.Height/20
                  - Dropdown_Function_22:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_20.Height
                        Items: =colFAs
                        OnChange: |-
                          =Patch(colPerson, Index(colPerson,1), {func_num:Self.Selected.func_num});

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Dropdown_Branch_22.Width
                        X: =Dropdown_Comm_Source_20.X
                        Y: =Text_Function_22.Y
                      Children:
                        - func_num1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="func_num"
                              FieldName: ="func_num"
                              FieldType: ="s"
                              Order: =1
                  - Text_Function_22:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Functional Area:"
                        Width: =Text_Branch_22.Width
                        X: =Text_Branch_22.X
                        Y: =Text_Branch_22.Y + Text_Branch_22.Height + Parent.Height/20
                  - Dropdown_Branch_22:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_20.Height
                        Items: =colBranches
                        OnChange: |-
                          =Patch(colPerson, Index(colPerson,1), {br_abbrev:Self.Selected.br_abbrev});

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Dropdown_Comm_Source_20.Width
                        X: =Dropdown_Comm_Source_20.X
                        Y: =Text_Branch_22.Y
                      Children:
                        - br_abbrev1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="br_abbrev"
                              FieldName: ="br_abbrev"
                              FieldType: ="s"
                              Order: =1
                  - Text_Branch_22:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Branch:"
                        Width: =Parent.Width/5
                        X: =Parent.Width/40
                        Y: =Text_YG_20.Y + Text_YG_20.Height + Parent.Height/20
                  - Text_Input_YG_20:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Index(colPerson,1).year_group
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_20.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Dropdown_Comm_Source_20.Width
                        X: =Dropdown_Comm_Source_20.X
                        Y: =Text_YG_20.Y
                  - Text_YG_20:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Year Group:"
                        Width: =Parent.Width/5
                        X: =Text_Comm_Source_20.X
                        Y: =Text_Comm_Source_20.Y + Text_Comm_Source_20.Height + Parent.Height/20
                  - Dropdown_Comm_Source_20:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_20.Height
                        Items: =colCommSources
                        OnChange: |-
                          =Patch(colPerson, Index(colPerson,1), {com_source:Self.Selected.com_source});

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Parent.Width/2 - Self.X - Parent.Width/20
                        X: =Text_Comm_Source_20.X + Text_Comm_Source_20.Width
                        Y: =Text_Comm_Source_20.Y
                      Children:
                        - com_source1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="com_source"
                              FieldName: ="com_source"
                              FieldType: ="s"
                              Order: =1
                  - Text_Comm_Source_20:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_20.Height
                        Size: =18
                        Text: ="Commission Source:"
                        Width: =Parent.Width/4
                        X: =Parent.Width/40
                        Y: =Parent.Height/40
            - Gallery_Children_Info_20:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =1
                  Height: =Text_Input_Spouse_Email_20.Y + Text_Input_Spouse_Email_20.Height - Self.Y
                  Items: =colChildren
                  TemplateSize: =Text_Input_Change_User_20.Height
                  Width: =Text_Children_Info_20.X + Text_Children_Info_20.Width - Self.X - Parent.Width/40
                  X: =Text_Child_Name_20.X
                  Y: =Text_Child_Name_20.Y + Text_Child_Name_20.Height
                Children:
                  - Icon_Remove_Child_20:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Remove(colChildren, ThisItem);

                          UpdateContext({varReadyToSubmit: false})
                        Visible: =If(ThisItem.child_id = Blank(),true, false)
                        Width: =Self.Height
                        X: =Parent.TemplateWidth - Self.Width
                  - Date_Picker_Child_Birthday_20:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderRadius: =10
                        DisplayMode: |-
                          =If(ThisItem.child_name <> Blank() &&
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id,
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Parent.TemplateHeight
                        OnChange: |-
                          =Patch(colChildren, ThisItem, {child_birthday: Self.SelectedDate});

                          UpdateContext({varReadyToSubmit: false});

                          UpdateContext({varChildChange: true});
                        SelectedDate: =ThisItem.child_birthday
                        Width: =Text_Child_Birthday_20.Width
                        X: =Text_Child_Birthday_20.X - Gallery_Children_Info_20.X
                  - Text_Input_Child_Name_20:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.child_name
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: |-
                          =Patch(colChildren, ThisItem, {child_name: Upper(Self.Text)});

                          UpdateContext({varReadyToSubmit: false});

                          UpdateContext({varChildChange: true});
                        OnSelect: =Select(Parent)
                        Width: =Text_Child_Name_20.Width
                  - Separator_Gallery_Children_Info_20:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Child_20:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Height: =Text_Input_Change_User_20.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Collect(colChildren, {usma_pers_id:varPerson.usma_pers_id, child_name: Blank(), child_birthday: Blank(), child_num: Max(colChildren, child_num) + 1});
                  Width: =Self.Height
                  X: =Gallery_Children_Info_20.X + Gallery_Children_Info_20.Width - Self.Width
                  Y: =Text_Child_Birthday_20.Y
            - Text_Child_Birthday_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="DOB"
                  Width: =Gallery_Children_Info_20.Width/2 - Icon_Add_Child_20.Width - 10
                  X: =Text_Child_Name_20.X + Text_Child_Name_20.Width + 10
                  Y: =Text_Input_Spouse_Name_20.Y
            - Text_Child_Name_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Name"
                  Width: =Gallery_Children_Info_20.Width/2 - 5
                  X: =Text_Children_Info_20.X + Parent.Width/80
                  Y: =Text_Input_Spouse_Name_20.Y
            - Text_Children_Info_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Children Information"
                  Width: =Gallery_Degree_Info_20.Width/2
                  X: =Text_Spouse_Info_20.X + Text_Spouse_Info_20.Width
                  Y: =Text_Spouse_Info_20.Y
            - Text_Input_Spouse_Email_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).sp_email
                  DisplayMode: "=If(\n    Index(colPerson,1).sp_name <> Blank() &&\n    (varPermissions = \"Master\" ||\n    varPermissions = \"Admin\" ||\n    varPermissions = \"S1\" || \n    varUser.usma_pers_id = varPerson.usma_pers_id ||\n    Upper(User().Email) = varPerson.wp_email), \n        \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {sp_email: Upper(Self.Text)});

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Text_Input_Spouse_Cell_20.Width
                  X: =Text_Input_Spouse_Cell_20.X
                  Y: =Text_Spouse_Email_20.Y
            - Text_Spouse_Email_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Email:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Degree_Info_20.Width/12
                  X: =Text_Spouse_Cell_20.X
                  Y: =Text_Spouse_Cell_20.Y + Text_Spouse_Cell_20.Height + Parent.Height/40
            - Text_Input_Spouse_Cell_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).sp_cell_num
                  DisplayMode: "=If(\n    Index(colPerson,1).sp_name <> Blank() &&\n    (varPermissions = \"Master\" ||\n    varPermissions = \"Admin\" ||\n    varPermissions = \"S1\" || \n    varUser.usma_pers_id = varPerson.usma_pers_id ||\n    Upper(User().Email) = varPerson.wp_email), \n        \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =If(Len(Self.Text) = 10 && IsMatch(Self.Text,"[0-9]+"),
                        Patch(colPerson, Index(colPerson,1), {sp_cell_num:Self.Text}),
                        Reset(Self);
                        Notify("PLEASE ENTER A 10-DIGIT PHONE NUMBER WITHOUT SPECIAL CHARACTERS",NotificationType.Warning));

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Text_Input_Spouse_Name_20.Width
                  X: =Text_Input_Spouse_Name_20.X
                  Y: =Text_Spouse_Cell_20.Y
            - Text_Spouse_Cell_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Cell:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_City_20.Width
                  X: =Text_Spouse_Name_20.X
                  Y: =Text_Spouse_Name_20.Y + Text_Spouse_Name_20.Height + Parent.Height/40
            - Text_Input_Spouse_Name_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).sp_name
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {sp_name: Upper(Self.Text)});

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Text_Spouse_Info_20.X + Text_Spouse_Info_20.Width - Self.X - Parent.Width/80
                  X: =Text_Spouse_Name_20.X + Text_Spouse_Name_20.Width
                  Y: =Text_Spouse_Name_20.Y
            - Text_Spouse_Name_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Name:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Address_20.Width
                  X: =Text_Spouse_Info_20.X
                  Y: =Text_Spouse_Info_20.Y + Text_Spouse_Info_20.Height + Parent.Height/40
            - Text_Spouse_Info_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Spouse Information"
                  Width: =Gallery_Degree_Info_20.Width/2
                  X: =Gallery_Degree_Info_20.X
                  Y: =Gallery_Degree_Info_20.Y + Gallery_Degree_Info_20.Height + Parent.Height/40
            - Gallery_Degree_Info_20:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =1
                  Height: =Text_Degree_Info_20.Height*3
                  Items: =colDegrees
                  TemplateSize: =Text_Input_Change_User_20.Height
                  Width: =Text_Degree_Info_20.Width
                  X: =Text_Degree_Info_20.X
                  Y: =Text_Degree_Year_20.Y + Text_Degree_Year_20.Height
                Children:
                  - Icon_Remove_Degree_20:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Remove(colDegrees, ThisItem);

                          UpdateContext({varReadyToSubmit: false})
                        Visible: =If(ThisItem.degree_id = Blank(),true, false)
                        Width: =Self.Height
                        X: =Parent.TemplateWidth - Self.Width
                  - Text_Input_Degree_School_20:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.degree_school
                        DisplayMode: |-
                          =If(ThisItem.degree_name <> Blank(),
                              DisplayMode.Edit,
                              DisplayMode.Disabled)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: |-
                          =Patch(colDegrees, ThisItem, {degree_school: Upper(Self.Text)});

                          UpdateContext({varReadyToSubmit: false});

                          UpdateContext({varDegreeChange: true});
                        OnSelect: =Select(Parent)
                        Width: =Text_Degree_Name_20.Width - Icon_Add_Degree_20.Width
                        X: =Text_Degree_School_20.X - Gallery_Degree_Info_20.X
                  - Text_Input_Degree_Name_20:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.degree_name
                        DisplayMode: |-
                          =If(ThisItem.degree_abbrev <> Blank(),
                              DisplayMode.Edit,
                              DisplayMode.Disabled)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: |-
                          =Patch(colDegrees, ThisItem, {degree_name: Upper(Self.Text)});

                          UpdateContext({varReadyToSubmit: false});

                          UpdateContext({varDegreeChange: true});
                        OnSelect: =Select(Parent)
                        Width: =Text_Degree_Name_20.Width
                        X: =Text_Degree_Name_20.X - Gallery_Degree_Info_20.X
                  - Dropdown_Degree_Type_20:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        DefaultSelectedItems: |-
                          =If(
                              ThisItem.degree_id = Blank(),
                              Filter(colDegrees, degree_num = ThisItem.degree_num), 
                              Filter(colDegrees, degree_id = ThisItem.degree_id))
                        DisplayMode: |-
                          =If(ThisItem.degree_year <> Blank(),
                              DisplayMode.Edit,
                              DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Text_Pers_ID_20.Height
                        Items: =colDegreeTypes
                        OnChange: |-
                          =Patch(colDegrees, ThisItem, {degree_abbrev: Self.Selected.degree_abbrev});

                          UpdateContext({varReadyToSubmit: false});

                          UpdateContext({varDegreeChange: true});
                        Width: =Text_Degree_Type_20.Width
                        X: =Text_Degree_Type_20.X - Gallery_Degree_Info_20.X
                      Children:
                        - degree_abbrev1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="degree_abbrev"
                              FieldName: ="degree_abbrev"
                              FieldType: ="s"
                              Order: =1
                  - Text_Input_Degree_Year_20:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.degree_year
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "S1" || 
                              varUser.usma_pers_id = varPerson.usma_pers_id ||
                              Upper(User().Email) = varPerson.wp_email, 
                              DisplayMode.Edit, 
                              DisplayMode.Disabled)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Value(Self.Text) > 1950 && Value(Self.Text) < 2100,
                              Patch(colDegrees, ThisItem, {degree_year: Value(Self.Text)}); 
                              UpdateContext({varReadyToSubmit: false});
                              UpdateContext({varDegreeChange: true}), 
                              Notify("YEAR DEGREE WAS EARNED MUST BE BETWEEN 1950 AND 2100",NotificationType.Error);
                              Reset(Self))
                        OnSelect: =Select(Parent)
                        Width: =Text_Degree_Year_20.Width
                  - Separator_Gallery_Degree_Info_20:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Degree_20:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Height: =Text_Input_Change_User_20.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Collect(colDegrees, {usma_pers_id:varPerson.usma_pers_id, degree_year: Blank(), degree_abbrev: Blank(), degree_name: Blank(), degree_school: Blank(), degree_num: Max(colDegrees, degree_num) + 1});
                  Width: =Self.Height
                  X: =Gallery_Degree_Info_20.X + Gallery_Degree_Info_20.Width - Self.Width
                  Y: =Text_Degree_School_20.Y
            - Text_Degree_School_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="School"
                  Width: =(Text_Degree_Info_20.Width*.8 - 30)/2 - Icon_Add_Degree_20.Width
                  X: =Text_Degree_Name_20.X + Text_Degree_Name_20.Width + 10
                  Y: =Text_Degree_Info_20.Y + Text_Degree_Info_20.Height
            - Text_Degree_Name_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Discipline"
                  Width: =(Text_Degree_Info_20.Width*.8 - 30)/2
                  X: =Text_Degree_Type_20.X + Text_Degree_Type_20.Width + 10
                  Y: =Text_Degree_Info_20.Y + Text_Degree_Info_20.Height
            - Text_Degree_Type_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Type"
                  Width: =Text_Degree_Info_20.Width/10
                  X: =Text_Degree_Year_20.X + Text_Degree_Year_20.Width + 10
                  Y: =Text_Degree_Info_20.Y + Text_Degree_Info_20.Height
            - Text_Degree_Year_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Year"
                  Width: =Text_Degree_Info_20.Width/10
                  X: =Text_Degree_Info_20.X
                  Y: =Text_Degree_Info_20.Y + Text_Degree_Info_20.Height
            - Text_Degree_Info_20:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =23
                  Text: ="Degree Info"
                  Width: =Parent.Width/2
                  X: =(Parent.Width - (Image_Person_20.X + Image_Person_20.Width) -Self.Width)/2 + Image_Person_20.X + Image_Person_20.Width
                  Y: =Text_Pers_ID_20.Y
            - Text_Input_Zip_Code_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).zip_code
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =5
                  OnChange: |-
                    =If(Len(Self.Text) = 5 && IsMatch(Self.Text,"[0-9]+"),
                        Patch(colPerson, Index(colPerson,1), {zip_code:Self.Text}),
                        Reset(Self);
                        Notify("PLEASE ENTER 5 DIGITS WITHOUT SPECIAL CHARACTERS",NotificationType.Warning));

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Container_Mil_Info_20.X - Self.X - Parent.Width/100
                  X: =Text_Zip_Code_20.X + Text_Zip_Code_20.Width
                  Y: =Text_City_20.Y
            - Text_Zip_Code_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Zip:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/30
                  X: =Dropdown_State_20.X + Dropdown_State_20.Width + Parent.Width/100
                  Y: =Text_City_20.Y
            - Dropdown_State_20:
                Control: DropDown@0.0.45
                Properties:
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  DefaultSelectedItems: =Filter(colStates, state = Index(colPerson,1).state)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_20.Height
                  Items: =colStates
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {state:Self.Selected.state});

                    UpdateContext({varReadyToSubmit: false})
                  Width: =Gallery_Degree_Info_20.Width/12
                  X: =Text_State_20.X + Text_State_20.Width
                  Y: =Text_State_20.Y
                Children:
                  - state1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="state"
                        FieldName: ="state"
                        FieldType: ="s"
                        Order: =1
            - Text_State_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="State:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Degree_Info_20.Width/12
                  X: =Text_Input_City_20.X + Text_Input_City_20.Width + Parent.Width/100
                  Y: =Text_City_20.Y
            - Text_Input_City_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).city
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {city:Upper(Self.Text)});

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Degree_Info_20.Width/8
                  X: =Text_City_20.X + Text_City_20.Width
                  Y: =Text_City_20.Y
            - Text_City_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="City:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Degree_Info_20.Width/15
                  X: =Text_Input_Address_20.X + Text_Input_Address_20.Width + Parent.Width/100
                  Y: =Text_Address_20.Y
            - Text_Input_Address_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).address
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {address:Upper(Self.Text)});

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Degree_Info_20.Width/5.5
                  X: =Text_Address_20.X + Text_Address_20.Width
                  Y: =Text_Address_20.Y
            - Text_Address_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Address:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Degree_Info_20.Width/8
                  X: =Text_Office_22.X
                  Y: =Text_Office_22.Y + Text_Office_22.Height + Parent.Height/40
            - Text_Input_Office_Num_22:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).office_phone
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =10
                  OnChange: |-
                    =If(Len(Self.Text) = 10 && IsMatch(Self.Text,"[0-9]+"),
                        Patch(colPerson, Index(colPerson,1), {office_phone:Self.Text}),
                        Reset(Self);
                        Notify("PLEASE ENTER A 10-DIGIT PHONE NUMBER WITHOUT SPECIAL CHARACTERS",NotificationType.Warning));

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Tooltip: ="Only numbers; no special characters; must be 10 digits"
                  Width: =Dropdown_Acad_Rank_20.Width
                  X: =Dropdown_Acad_Rank_20.X
                  Y: =Text_Office_Num_22.Y
            - Text_Office_Num_22:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Office Phone:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Acad_Rank_22.Width
                  X: =Text_Acad_Rank_22.X
                  Y: =Text_Input_Office_22.Y
            - Text_Input_Office_22:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colPerson,1).office
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {office:Upper(Self.Text)});

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Date_Picker_Depart_Date_20.Width
                  X: =Date_Picker_Depart_Date_20.X
                  Y: =Text_Office_22.Y
            - Text_Office_22:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Office:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Depart_Date_20.Width
                  X: =Text_Depart_Date_20.X
                  Y: =Text_Depart_Date_20.Y + Text_Depart_Date_20.Height + Parent.Height/40
            - Dropdown_Acad_Rank_20:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_20.Height
                  Items: =colAcadRank
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {acad_rank:Self.Selected.acad_rank});

                    UpdateContext({varReadyToSubmit: false})
                  Width: =Date_Picker_Birthday_20.Width
                  X: =Dropdown_Title_20.X
                  Y: =Text_Acad_Rank_22.Y
                Children:
                  - acad_rank1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="acad_rank"
                        FieldName: ="acad_rank"
                        FieldType: ="s"
                        Order: =1
            - Text_Acad_Rank_22:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Acad. Rank:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Birthday_20.Width
                  X: =Text_Title_20.X
                  Y: =Date_Picker_Depart_Date_20.Y
            - Date_Picker_Depart_Date_20:
                Control: DatePicker@0.0.46
                Properties:
                  BorderRadius: =10
                  DisplayMode: |-
                    =If(
                        varPermissions = "S1" || varPermissions = "Admin" || varPermissions = "Master", 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Format: ='DatePickerCanvas.Format'.Short
                  Height: =Text_Input_Change_User_20.Height
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {depart_date:Self.SelectedDate});

                    UpdateContext({varReadyToSubmit: false})
                  SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).depart_date
                  Width: =Text_Input_Cell_Num_20.Width
                  X: =Date_Picker_Arrival_Date_20.X
                  Y: =Text_Depart_Date_20.Y
            - Text_Depart_Date_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Depart Date:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Arrive_Date_20.X
                  Y: =Text_Arrive_Date_20.Y + Text_Arrive_Date_20.Height + Parent.Height/40
            - Dropdown_Title_20:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_20.Height
                  Items: =colTitles
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {rank_title:Self.Selected.rank_title});

                    UpdateContext({varReadyToSubmit: false})
                  Width: =Date_Picker_Birthday_20.Width
                  X: =Dropdown_Assign_Type_20.X
                  Y: =Text_Title_20.Y
                Children:
                  - rank_title1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="rank_title"
                        FieldName: ="rank_title"
                        FieldType: ="s"
                        Order: =1
            - Text_Title_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Title:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Birthday_20.Width
                  X: =Text_Assign_Type_20.X
                  Y: =Date_Picker_Arrival_Date_20.Y
            - Date_Picker_Arrival_Date_20:
                Control: DatePicker@0.0.46
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Format: ='DatePickerCanvas.Format'.Short
                  Height: =Text_Input_Change_User_20.Height
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {arrival_date:Self.SelectedDate});

                    UpdateContext({varReadyToSubmit: false})
                  SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).arrival_date
                  Width: =Text_Input_Cell_Num_20.Width
                  X: =Text_Input_Cell_Num_20.X
                  Y: =Text_Arrive_Date_20.Y
            - Text_Arrive_Date_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Arrival Date:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Cell_Num_20.X
                  Y: =Text_Cell_Num_20.Y + Text_Cell_Num_20.Height + Parent.Height/40
            - Dropdown_Assign_Type_20:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_20.Height
                  Items: =colAssign
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {assign_type:Self.Selected.assign_type });

                    UpdateContext({varReadyToSubmit: false})
                  Width: =Date_Picker_Birthday_20.Width
                  X: =Date_Picker_Birthday_20.X
                  Y: =Text_Assign_Type_20.Y
                Children:
                  - assign_type1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="assign_type"
                        FieldName: ="assign_type"
                        FieldType: ="s"
                        Order: =1
            - Text_Assign_Type_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Assignment:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Birthday_20.Width
                  X: =Text_Birthday_20.X
                  Y: =Text_Input_Cell_Num_20.Y
            - Text_Input_Cell_Num_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).cell_num
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =10
                  OnChange: |-
                    =If(Len(Self.Text) = 10 && IsMatch(Self.Text,"[0-9]+"),
                        Patch(colPerson, Index(colPerson,1), {cell_num:Self.Text}),
                        Reset(Self);
                        Notify("PLEASE ENTER A 10-DIGIT PHONE NUMBER WITHOUT SPECIAL CHARACTERS",NotificationType.Warning));

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Tooltip: ="Only numbers; no special characters; must be 10 digits"
                  Width: =Dropdown_Service_20.Width
                  X: =Dropdown_Service_20.X
                  Y: =Text_Cell_Num_20.Y
            - Text_Cell_Num_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Cell Phone:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Service_20.X
                  Y: =Text_Service_20.Y + Text_Service_20.Height + Parent.Height/40
            - Date_Picker_Birthday_20:
                Control: DatePicker@0.0.46
                Properties:
                  BorderRadius: =10
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Format: ='DatePickerCanvas.Format'.Short
                  Height: =Text_Input_Change_User_20.Height
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {birthday:Self.SelectedDate});

                    UpdateContext({varReadyToSubmit: false})
                  SelectedDate: =LookUp(colPerson, usma_pers_id = varPerson.usma_pers_id).birthday
                  Width: =Text_Input_Perm_Email_20.X + Text_Input_Perm_Email_20.Width - Self.X
                  X: =Text_Birthday_20.X + Text_Birthday_20.Width
                  Y: =Text_Birthday_20.Y
            - Text_Birthday_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Birthday:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/12
                  X: =Dropdown_Service_20.X + Dropdown_Service_20.Width + Parent.Width/40
                  Y: =Dropdown_Service_20.Y
            - Dropdown_Service_20:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colPerson, usma_pers_id = varPerson.usma_pers_id)
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_20.Height
                  Items: =colServices
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {service:Self.Selected.service});

                    UpdateContext({varReadyToSubmit: false})
                  Width: =Text_Input_Perm_Email_20.Width/3
                  X: =Text_Input_Perm_Email_20.X
                  Y: =Text_Service_20.Y
                Children:
                  - service1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="service"
                        FieldName: ="service"
                        FieldType: ="s"
                        Order: =1
            - Text_Service_20:
                Control: Text@0.0.51
                Properties:
                  BorderColor: =RGBA(240, 98, 15, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Service:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Perm_Email_20.X
                  Y: =Text_Perm_Email_20.Y + Text_Perm_Email_20.Height + Parent.Height/40
            - Text_Input_Perm_Email_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPerson,1).perm_email
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {perm_email:Upper(Self.Text)});

                    UpdateContext({varReadyToSubmit: false})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Text_Input_Middle_Name_20.Width*2.5
                  X: =Text_Input_wp_Email_22.X
                  Y: =Text_Perm_Email_20.Y
            - Text_Perm_Email_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Perm. Email:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_wp_Email_22.X
                  Y: =Text_wp_Email_22.Y + Text_wp_Email_22.Height + Parent.Height/40
            - Text_Input_wp_Email_22:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =varPerson.wp_email
                  DisplayMode: =DisplayMode.Disabled
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Text_Input_Middle_Name_20.Width*2.5
                  X: =Dropdown_Sex_20.X
                  Y: =Text_wp_Email_22.Y
            - Text_wp_Email_22:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="USMA Email:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Sex_20.X
                  Y: =Text_Sex_20.Y + Text_Sex_20.Height + Parent.Height/40
            - Image_Person_20:
                Control: Image@2.2.3
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Height: =Text_Input_wp_Email_22.Y - Self.Y - Parent.Height/40
                  Image: |-
                    =IfError(
                        With(
                            { photo: Office365Users.UserPhotoV2(varPerson.wp_email) },
                            If(IsBlank(photo), SampleImage, photo)
                        ),
                        SampleImage
                    )
                  ImagePosition: =ImagePosition.Fill
                  RadiusBottomLeft: =50
                  RadiusBottomRight: =50
                  RadiusTopLeft: =50
                  RadiusTopRight: =50
                  Width: =Text_Input_wp_Email_22.X + Text_Input_wp_Email_22.Width - Self.X
                  X: =Text_Input_Pers_ID_20.X + Text_Input_Pers_ID_20.Width + Parent.Width/40
                  Y: =Text_Pers_ID_20.Y
            - Dropdown_Sex_20:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =If(
                        Index(colPerson,1).sex = "F", 
                        Filter(colSexes, sex = "FEMALE"), 
                        If(
                            Index(colPerson,1).sex = "M", 
                            Filter(colSexes, sex = "MALE"),
                            Filter(colSexes, sex = "OTHER")))
                  DisplayMode: |-
                    =If(
                        varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "S1" || 
                        varUser.usma_pers_id = varPerson.usma_pers_id ||
                        Upper(User().Email) = varPerson.wp_email, 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_20.Height
                  Items: =colSexes
                  OnChange: |-
                    =Patch(colPerson, Index(colPerson,1), {sex: Self.Selected.sex});

                    UpdateContext({varReadyToSubmit: false})
                  Width: =Text_Input_Last_Name_22.Width
                  X: =Text_Input_Last_Name_22.X
                  Y: =Text_Sex_20.Y
                Children:
                  - sex1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="sex"
                        FieldName: ="sex"
                        FieldType: ="s"
                        Order: =1
            - Text_Sex_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Sex:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Middle_Name_20.X
                  Y: =Text_Last_Name_22.Y + Text_Last_Name_22.Height + Parent.Height/40
            - Text_Input_Last_Name_22:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =varPerson.last_name
                  DisplayMode: =DisplayMode.Disabled
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Text_Input_Middle_Name_20.Width
                  X: =Text_Input_Middle_Name_20.X
                  Y: =Text_Last_Name_22.Y
            - Text_Last_Name_22:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Last Name:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Middle_Name_20.Width
                  X: =Text_Middle_Name_20.X
                  Y: =Text_Middle_Name_20.Y + Text_Middle_Name_20.Height + Parent.Height/40
            - Text_Input_Middle_Name_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =varPerson.middle_name
                  DisplayMode: =DisplayMode.Disabled
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Text_Input_Pers_ID_20.Width
                  X: =Text_Input_First_Name_22.X
                  Y: =Text_Middle_Name_20.Y
            - Text_Middle_Name_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Middle Name:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/10
                  X: =Text_First_Name_22.X
                  Y: =Text_First_Name_22.Y + Text_First_Name_22.Height + Parent.Height/40
            - Text_Input_First_Name_22:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =varPerson.first_name
                  DisplayMode: =DisplayMode.Disabled
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Text_Input_Pers_ID_20.Width
                  X: =Text_Input_Pers_ID_20.X
                  Y: =Text_First_Name_22.Y
            - Text_First_Name_22:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="First Name:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/10
                  X: =Text_Pers_ID_20.X
                  Y: =Text_Pers_ID_20.Y + Text_Pers_ID_20.Height + Parent.Height/40
            - Text_Input_Pers_ID_20:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =varPerson.usma_pers_id
                  DisplayMode: =DisplayMode.Disabled
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_20.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width/8
                  X: =Text_Pers_ID_20.X + Text_Pers_ID_20.Width
                  Y: =Text_Pers_ID_20.Y
            - Text_Pers_ID_20:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_20.Height
                  Size: =18
                  Text: ="Pers ID:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/10
                  X: =Parent.Width/50
                  Y: =Parent.Height/40
            - Rectangle_Disable_20:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: =Spinner_20.Visible
                  Width: =Parent.Width
            - Spinner_20:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Personnel_Details_Header_20:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Personnel_Details_20:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Personnel Details"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_20:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_20:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Projects_Overview_30

Screens:
  Screen_Projects_Overview_30:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Projects_Overview_30:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Projects_Header_30.Height
            Width: =Parent.Width
            Y: =Container_Projects_Header_30.Height
          Children:
            - Button_Edit_Project_30:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_30.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=Set(varProjectID, Gallery_Projects_30.Selected.project_id);\r\n\r\nClearCollect(colProject, \r\n    {project_id: varProjectID,\r\n    project_title: LookUp(current_projects_view, project_id = varProjectID).project_title,\r\n    project_description: LookUp(current_projects_view, project_id = varProjectID).project_desc,\r\n    project_ay: LookUp(lookup_class_offerings, offering_id = LookUp(project_cadet, project_id = varProjectID).offering_id).ay,\r\n    project_semester: LookUp(lookup_class_offerings, offering_id = LookUp(project_cadet, project_id = varProjectID).offering_id).semester,\r\n    center_id: LookUp(center_sponsors, project_id = varProjectID).center_id,\r\n    center_sponsor_id: LookUp(center_sponsors, project_id = varProjectID).center_sponsor_id}, \r\n    {project_id: varProjectID,\r\n    project_title: LookUp(current_projects_view, project_id = varProjectID).project_title,\r\n    project_description: LookUp(current_projects_view, project_id = varProjectID).project_desc,\r\n    project_ay: LookUp(lookup_class_offerings, offering_id = LookUp(project_cadet, project_id = varProjectID).offering_id).ay,\r\n    project_semester: LookUp(lookup_class_offerings, offering_id = LookUp(project_cadet, project_id = varProjectID).offering_id).semester,\r\n    center_id: LookUp(center_sponsors, project_id = varProjectID).center_id,\r\n    center_sponsor_id: LookUp(center_sponsors, project_id = varProjectID).center_sponsor_id});\r\n\r\nClearCollect(colCenters, {center_id: Blank(), center_abbrev: Blank(), center_name: Blank(), center_type: Blank()});\r\nCollect(colCenters, ShowColumns(lookup_center, center_id, center_abbrev, center_name, center_type));\r\n\r\nClearCollect(colProjectCadets, \r\n    Table(project_cadet_view_procedure.dboprojectcadetviewprocedure({project_id:varProjectID}).ResultSets.Table1)); \r\n    \r\nClearCollect(colProjectFaculty,\r\n    Table(project_fac_view_procedure.dboprojectfacviewprocedure({project_id:varProjectID}).ResultSets.Table1));\r\n\r\nClearCollect(colLookupTags, \r\n    ShowColumns(lookup_topic_methods, topic_method_id, topic_method));\r\n\r\nClearCollect(colProjectTags, \r\n    ShowColumns(Filter(project_tags_view, project_id = varProjectID), topic_method_id, topic_method, tag_id));\r\n\r\nClearCollect(colLookupPriority,\r\n    ShowColumns(lookup_priority, priority_id, priority_name, priority_num, proponent_name, ay));\r\n\r\nClearCollect(colProjectPriorities, \r\n    ShowColumns(Filter(project_priority_view, project_id = varProjectID), project_priority_id, priority_id, priority_name, priority_num, proponent_name, ay));\r\n\r\nClearCollect(colPubTypes, ShowColumns(lookup_pub_types, pub_type_id, pub_type));\r\n\r\nClearCollect(colPubVenues, ShowColumns(lookup_pub_venues, venue_id, venue_abbrev, venue_name));\r\n\r\nClearCollect(colProjectPublications,\r\n    ShowColumns(Filter(current_cadet_pubs_view, project_id = varProjectID), cadet_pub_id, cdt_last_name, venue_id, venue_abbrev, venue_name, pub_type_id, pub_type, project_id, project_cadet_id, pub_title, signed_up, pub_date, pub_link, updated_on));\r\n\r\nClearCollect(colLookupProjectAwards, \r\n    {award_name: Blank()}, \r\n    {award_name: \"HOLLIS AWARD\"}, \r\n    {award_name: \"CLARK AWARD\"}, \r\n    {award_name: \"WISE CHALLENGE\"}, \r\n    {award_name: \"DEAN'S INTER-DEPARTMENTAL PROJECT AWARD\"});\r\n\r\nClearCollect(colProjectAwards, \r\n    ShowColumns(Filter(project_awards, project_id = varProjectID), project_award_id, project_id, project_cadet_id, award_name, signed_up, won, updated_on));\r\n\r\nClearCollect(colProjectCollaborators,\r\n    ShowColumns(Filter(project_collab_org_view, project_id = varProjectID), project_collaborator_id, collab_id, collab_email, last_name, first_name, collab_name, org_id, org_name, org_and_parent, org_abbrev, org_type, org_city, org_state, org_country, parent_org_id));\r\n\r\nClearCollect(colLookupCollaborators, lookup_collab_view);\r\n\r\nClearCollect(colLookupOrgs, lookup_org_view);\r\n\r\nClearCollect(colProjectPictures, \r\n    Filter(project_pictures, project_id = varProjectID));\r\n\r\nNavigate(Screen_Project_Details_40);\r\n"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Edit Project"
                  Visible: =If(IsBlank(varReturnScreen), true, false)
                  Width: =Parent.Width/11
                  X: =Gallery_Projects_30.X + Gallery_Projects_30.Width - Self.Width
                  Y: =Text_Input_Cadet_Search_30.Y
            - Button_Add_Project_30:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_30.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=If(IsBlank(varReturnScreen),\r\n    Set(varProjectID, Blank());\r\n\r\n    ClearCollect(colProject, \r\n        {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()}, \r\n        {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()});\r\n        \r\n    ClearCollect(colCenters, {center_id: Blank(), center_abbrev: Blank(), center_name: Blank(), center_type: Blank()});\r\n    Collect(colCenters, ShowColumns(lookup_center, center_id, center_abbrev, center_name, center_type));\r\n    \r\n    ClearCollect(colProjectStatus, {status: Blank()}, {status: \"ACTIVE\"}, {status: \"COMPLETE\"}, {status: \"DROPPED\"});\r\n\r\n    ClearCollect(colResearchClasses, {class_num: Blank()});\r\n\r\n    Collect(colResearchClasses, ShowColumns(current_research_classes_view, offering_id, ay, semester, class_num));\r\n\r\n    ClearCollect(colRoles, {role_id: 1, role: \"ADVISOR\"}, {role_id: 2, role: \"CO-ADVISOR\"});\r\n\r\n    ClearCollect(colLookupTags, \r\n        ShowColumns(lookup_topic_methods, topic_method_id, topic_method));\r\n\r\n    ClearCollect(colLookupPriority,\r\n        ShowColumns(lookup_priority, priority_id, priority_name, priority_num, proponent_name, ay));\r\n\r\n    ClearCollect(colPubTypes, ShowColumns(lookup_pub_types, pub_type_id, pub_type));\r\n\r\n    ClearCollect(colPubVenues, ShowColumns(lookup_pub_venues, venue_id, venue_abbrev, venue_name));\r\n\r\n    ClearCollect(colLookupProjectAwards, \r\n    {award_name: Blank()}, \r\n    {award_name: \"HOLLIS AWARD\"}, \r\n    {award_name: \"CLARK AWARD\"}, \r\n    {award_name: \"WISE CHALLENGE\"}, \r\n    {award_name: \"DEAN'S INTER-DEPARTMENTAL PROJECT AWARD\"});\r\n\r\n    ClearCollect(colLookupCollaborators, lookup_collab_view);\r\n\r\n    ClearCollect(colLookupOrgs, lookup_org_view);\r\n\r\n    Navigate(Screen_Project_Details_40),\r\n\r\n    UpdateContext({varResetCheckBoxes: true});\r\n    UpdateContext({varResetCheckBoxes: false});\r\n    Navigate(varReturnScreen);\r\n    Reset(Gallery_Projects_30);\r\n    Set(varReturnScreen, Blank()))\r\n\r\n\r\n\r\n\r\n/*\r\n    ForAll(colTempProjectTravel As project, \r\n        Collect(colProjectTravel, project));\r\n\r\n    ForAll(colRemoveProjectTravel As project, \r\n        If(IsBlank(varTraveler.travel_id), \r\n            Remove(colProjectTravel, LookUp(Filter(colProjectTravel, usma_pers_id = varTraveler.usma_pers_id), project_id = project.project_id)), \r\n            Remove(colProjectTravel, LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = project.project_id))));\r\n        \r\n    UpdateContext({varResetCheckBoxes: true});\r\n    UpdateContext({varResetCheckBoxes: false});\r\n        \r\n    Clear(colRemoveProjectTravel);\r\n    Clear(colTempProjectTravel);\r\n\r\n    Reset(Gallery_Projects_30);\r\n            \r\n    Navigate(varReturnScreen);\r\n        \r\n    Set(varReturnScreen, Blank()));\r\n\r\n*/"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: |-
                    =If(IsBlank(varReturnScreen),
                        "Add Project", "Done")
                  Width: =Parent.Width/11
                  X: =Button_Edit_Project_30.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Cadet_Search_30.Y
            - Button_Home_30:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_30.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=Clear(colProjectStatus);\r\n\r\nClear(colResearchClasses);\r\n\r\nClear(colRoles);\r\n\r\nIf(\r\n    Not(IsBlank(varReturnScreen)),\r\n    UpdateContext({varResetCheckBoxes: true});\r\n    UpdateContext({varResetCheckBoxes: false});\r\n    Navigate(varReturnScreen);\r\n    Set(varReturnScreen, Blank()),\r\n    \r\n    Navigate(Screen_Welcome_User_00))\r\n    \r\n    "
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Home"
                  Visible: |-
                    =If(
                        IsBlank(varReturnScreen), true, false)
                  Width: =Parent.Width/11
                  X: =Button_Add_Project_30.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Cadet_Search_30.Y
            - Text_Input_Course_Search_30:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_30.Height
                  HintText: ="Search Course"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Cadet_Search_30);
                    Reset(Text_Input_Advisor_Search_30);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Projects_30.Width/7
                  X: =Text_Input_Advisor_Search_30.X + Text_Input_Advisor_Search_30.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Course_Search_30:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Cadet_Search_30.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Course_Search_30);

                    Reset(Gallery_Projects_30)
                  Width: =Self.Height
                  X: =Text_Input_Course_Search_30.X + Text_Input_Course_Search_30.Width - Self.Width
                  Y: =Text_Input_Cadet_Search_30.Y + Text_Input_Cadet_Search_30.Height/8
            - Text_Input_Advisor_Search_30:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_30.Height
                  HintText: ="Search Advisor Last Name"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Cadet_Search_30);
                    Reset(Text_Input_Course_Search_30);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Projects_30.Width/7
                  X: =Text_Input_Cadet_Search_30.X + Text_Input_Cadet_Search_30.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Advisor_Search_30:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Cadet_Search_30.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Advisor_Search_30);

                    Reset(Gallery_Projects_30)
                  Width: =Self.Height
                  X: =Text_Input_Advisor_Search_30.X + Text_Input_Advisor_Search_30.Width - Self.Width
                  Y: =Text_Input_Cadet_Search_30.Y + Text_Input_Cadet_Search_30.Height/8
            - Text_Input_Cadet_Search_30:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_30.Height
                  HintText: ="Search CDT Last Name"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Advisor_Search_30);
                    Reset(Text_Input_Course_Search_30);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Projects_30.Width/7
                  X: =Gallery_Projects_30.X
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Cadet_Search_30:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Cadet_Search_30.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Cadet_Search_30);

                    Reset(Gallery_Projects_30)
                  Width: =Self.Height
                  X: =Text_Input_Cadet_Search_30.X + Text_Input_Cadet_Search_30.Width - Self.Width
                  Y: =Text_Input_Cadet_Search_30.Y + Text_Input_Cadet_Search_30.Height/8
            - Gallery_Projects_30:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =1
                  Height: =Text_Input_Cadet_Search_30.Y - Text_Project_Title_30.Y - Text_Project_Title_30.Height - Parent.Height/40
                  Items: |-
                    =If(
                        Not(IsBlank(Text_Input_Cadet_Search_30.Text)),
                        Filter(
                            Filter(
                                Sort(Sort(current_projects_view, cdt_last_name, SortOrder.Ascending), ay, SortOrder.Descending), 
                                role = "ADVISOR"), 
                            StartsWith(cdt_last_name, Text_Input_Cadet_Search_30.Text)),
                            If(
                                Not(IsBlank(Text_Input_Advisor_Search_30.Text)),
                                Filter(
                                    Filter(
                                        Sort(Sort(current_projects_view, cdt_last_name, SortOrder.Ascending), ay, SortOrder.Descending), 
                                        role = "ADVISOR"),
                                        StartsWith(fac_last_name, Text_Input_Advisor_Search_30.Text)),
                                            If(
                                                Not(IsBlank(Text_Input_Course_Search_30.Text)),
                                                Filter(
                                                    Filter(
                                                        Sort(Sort(current_projects_view, cdt_last_name, SortOrder.Ascending), ay, SortOrder.Descending), 
                                                        role = "ADVISOR"),
                                                        Text_Input_Course_Search_30.Text in class_num),
                                                        Filter(Sort(Sort(current_projects_view, cdt_last_name, SortOrder.Ascending), ay, SortOrder.Descending), 
                                                            role = "ADVISOR"))))
                  Selectable: |-
                    =If(varReturnScreen = Screen_Trip_Details_60, 
                        false, true)
                  TemplateFill: "=If(\n    varReturnScreen = Screen_Trip_Details_60, \n    If(\n        ThisItem.project_id in Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num, travel_cost_id = varTraveler.travel_id).project_id, \n        RGBA(177, 179, 179, 1),\n        RGBA(0, 0, 0, 0)),\n\n    If(\n        varReturnScreen = Screen_Purchase_Details_80, \n        If(\n            ThisItem.project_id in colProjectPurchases.project_id, \n            RGBA(177, 179, 179, 1),\n            RGBA(0, 0, 0, 0)),\n        \n        If(\n            ThisItem.IsSelected, \n            RGBA(177, 179, 179, 1), \n            RGBA(0, 0, 0, 0))))"
                  TemplateSize: =Text_Input_Change_User_30.Height*2
                  Width: =Parent.Width*19/20
                  X: =(Parent.Width - Self.Width)/2
                  Y: =Text_Project_Title_30.Y + Text_Project_Title_30.Height
                Children:
                  - Text_Status_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.project_status
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Course_30.Width
                        X: =Text_Status_30.X - Gallery_Projects_30.X
                  - Text_AYT_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =Concatenate(ThisItem.ay, "-", ThisItem.semester)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Course_30.Width
                        X: =Text_AYT_30.X - Gallery_Projects_30.X
                  - Text_Course_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.class_num
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Course_30.Width
                        X: =Text_Course_30.X - Gallery_Projects_30.X
                  - Text_Advisor_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =Concatenate(ThisItem.fac_last_name, ", ", ThisItem.fac_first_name)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Advisor_30.Width
                        X: =Text_Advisor_30.X - Gallery_Projects_30.X
                  - Text_Cadet_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =Concatenate(ThisItem.cdt_last_name, ", ", ThisItem.cdt_first_name)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Cadet_30.Width
                        X: =Text_Cadet_30.X - Gallery_Projects_30.X
                  - Text_Project_Title_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: |
                          =ThisItem.project_title
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Project_Title_30.Width
                        Wrap: =false
                        X: =Text_Project_Title_30.X - Gallery_Projects_30.X
                  - Text_Project_ID_31:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        PaddingLeft: =10
                        Size: =18
                        Text: |
                          =ThisItem.project_id
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Project_ID_30.Width
                        Wrap: =false
                  - Checkbox_Projects_30:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxSize: =Parent.TemplateHeight*.5
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Default: "=If(\n    varReturnScreen = Screen_Trip_Details_60,\n    If(\n        IsBlank(varTraveler.travel_id), \n            If(\n                ThisItem.project_id in Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num).project_id, \n                true, false), \n            If(\n                ThisItem.project_id in Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id).project_id, \n                true, false)),\n            \n    If(\n        ThisItem.project_id in colProjectPurchases.project_id, \n        true, false))"
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: "=If(\n    varReturnScreen = Screen_Trip_Details_60, \n    \n    Collect(colProjectTravel,\n        {project_travel_id: Blank(), \n        project_id: ThisItem.project_id,\n        travel_cost_id: varTraveler.travel_id,\n        usma_pers_id: varTraveler.usma_pers_id,\n        last_name: varTraveler.traveler_last_name,\n        new_traveler_num: varTraveler.new_traveler_num,\n        new_project_travel_num: Max(colProjectTravel, new_project_travel_num) + 1}), \n    If(\n        varReturnScreen = Screen_Purchase_Details_80,   \n        Collect(colProjectPurchases,\n            {project_purchase_id: Blank(), \n            project_id: ThisItem.project_id,\n            purchase_cost_id: varPurchaseID,\n            new_project_purchase_num: Max(colProjectPurchases, new_project_purchase_num) + 1})));\n\n/*\nIf(\n    varReturnScreen = Screen_Trip_Details_60, \n    \n    Collect(colTempProjectTravel,\n        {project_travel_id: Blank(), \n        project_id: ThisItem.project_id,\n        travel_cost_id: varTraveler.travel_id,\n        usma_pers_id: varTraveler.usma_pers_id,\n        last_name: varTraveler.traveler_last_name,\n        new_traveler_num: varTraveler.new_traveler_num,\n        new_project_travel_num: Max(colTempProjectTravel, new_project_travel_num) + 1}), \n        \n    Collect(colTempProjectPurchase,\n        {project_purchase_id: Blank(), \n        project_id: ThisItem.project_id,\n        purchase_cost_id: varPurchaseID,\n        new_project_purchase_num: Max(colTempProjectPurchase, new_project_purchase_num) + 1}));\n\n*/"
                        OnSelect: =Select(Parent)
                        OnUncheck: "=If(\r\n    varReturnScreen = Screen_Trip_Details_60, \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    If(\r\n        Not(IsBlank(varTraveler.travel_id)), //EXISTING TRAVELER\r\n        If(\r\n            Not(IsBlank(LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id).project_travel_id)), //CHECK IF EXISTING TRAVELER ALREADY HAS THIS PROJECT IN THEIR TRAVEL\r\n\r\n            Collect(colRemoveProjectTravel, \r\n                LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)));\r\n\r\n        Remove(colProjectTravel,\r\n            LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)), \r\n\r\n        //NEW TRAVELER\r\n        Remove(colProjectTravel,\r\n            LookUp(Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id))), \r\n\r\n    If(\r\n        varReturnScreen = Screen_Purchase_Details_80, \r\n\r\n        If(\r\n            Not(IsBlank(LookUp(Filter(colProjectPurchases, purchase_cost_id = varPurchaseID), project_id = ThisItem.project_id).project_purchase_id)), //CHECK IF EXISTING PURCHASE ALREADY HAS THIS PROJECT\r\n            \r\n            Collect(colRemoveProjectPurchases, \r\n                    LookUp(Filter(colProjectPurchases, purchase_cost_id = varPurchaseID), project_id = ThisItem.project_id)));\r\n\r\n            Remove(colProjectPurchases,\r\n                LookUp(Filter(colProjectPurchases, purchase_cost_id = varPurchaseID), project_id = ThisItem.project_id))))\r\n\r\n\r\n\r\n\r\n\r\n\r\n/*\r\nIf(\r\n    Not(IsBlank(varTraveler.travel_id)), //EXISTING TRAVELER\r\n    If(\r\n        Not(IsBlank(LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id).project_travel_id)), //CHECK IF ALREADY ASSIGNED\r\n            \r\n        If(\r\n            IsBlank(LookUp(Filter(colRemoveProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)), //CHECK IF NOT ALREADY IN REMOVE COLLECTION\r\n            Collect(colRemoveProjectTravel, \r\n                LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)));\r\n        If(\r\n            Not(IsBlank(LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id))), \r\n            Remove(colProjectTravel, LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)));\r\n        If(\r\n            Not(IsBlank(LookUp(Filter(colTempProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id))), \r\n            Remove(colTempProjectTravel, LookUp(Filter(colTempProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id))), \r\n\r\n        If(\r\n            Not(IsBlank(LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id))), \r\n            Remove(colProjectTravel, LookUp(Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)));\r\n        If(\r\n            Not(IsBlank(LookUp(Filter(colTempProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id))), \r\n            Remove(colTempProjectTravel, LookUp(Filter(colTempProjectTravel, travel_cost_id = varTraveler.travel_id), project_id = ThisItem.project_id)))), \r\n    \r\n    If(\r\n        IsBlank(LookUp(Filter(colRemoveProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id)),\r\n        Collect(colRemoveProjectTravel, \r\n            LookUp(Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id)));\r\n    If(\r\n        Not(IsBlank(LookUp(Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id))), \r\n        Remove(colProjectTravel, LookUp(Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id)));\r\n        \r\n    If(\r\n        Not(IsBlank(LookUp(Filter(colTempProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id))), \r\n        Remove(colTempProjectTravel, LookUp(Filter(colTempProjectTravel, new_traveler_num = varTraveler.new_traveler_num), project_id = ThisItem.project_id))))\r\n\r\n*/"
                        Reset: =varResetCheckBoxes
                        Text: =
                        Visible: |-
                          =If(
                              varReturnScreen = Screen_Trip_Details_60 || 
                              varReturnScreen = Screen_Purchase_Details_80, 
                              true, false)
                        Width: =Self.Height
                        X: =Text_Project_ID_31.Width - Self.Width
                  - Separator_Gallery_Projects_30:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Text_Status_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="Status"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width/15
                  X: =Text_AYT_30.X + Text_AYT_30.Width + 10
                  Y: =Text_Project_Title_30.Y
            - Text_AYT_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="AY-T"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width/15
                  X: =Text_Course_30.X + Text_Course_30.Width + 10
                  Y: =Text_Project_Title_30.Y
            - Text_Course_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="Course"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width/15
                  X: =Text_Advisor_30.X + Text_Advisor_30.Width + 10
                  Y: =Text_Project_Title_30.Y
            - Text_Advisor_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="Primary Advisor"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width/6
                  X: =Text_Cadet_30.X + Text_Cadet_30.Width + 10
                  Y: =Text_Project_Title_30.Y
            - Text_Cadet_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="Cadet"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width/6
                  X: =Text_Project_Title_30.X + Text_Project_Title_30.Width + 10
                  Y: =Text_Project_Title_30.Y
            - Text_Project_Title_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="Project Title"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width*76/195 - 60
                  X: =Gallery_Projects_30.X + Text_Project_ID_30.Width + 10
                  Y: =Parent.Height/40
            - Text_Project_ID_30:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_30.Height
                  Size: =18
                  Text: ="Project ID"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Projects_30.Width/13
                  X: =Gallery_Projects_30.X
                  Y: =Parent.Height/40
      - Container_Projects_Header_30:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Projects_Header_30:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Projects"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_30:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_30:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Project_Details_40

Screens:
  Screen_Project_Details_40:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Projects_Details_40:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Header_Projects_Details_40.Height
            Width: =Parent.Width
            Y: =Container_Header_Projects_Details_40.Height
          Children:
            - Text_Input_Project_ID_40:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colProject,1).project_id
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width/15
                  X: =Parent.Width - Self.Width
                  Y: =Parent.Height - Self.Height
            - Text_Project_ID_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =24
                  Text: ="Project ID"
                  Width: =Parent.Width/12
                  X: =Text_Input_Project_ID_40.X - Self.Width
                  Y: =Text_Input_Project_ID_40.Y
            - Button_Submit_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit  && 
                        (CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                        varPermissions = "Master" ||
                        varPermissions = "Research"), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=UpdateContext({varShowSpinner:true});\r\n\r\n// REMOVE ANY DELETED AWARDS\r\nForAll(colRemoveProjectAwards As award, \r\n    Remove(project_awards, LookUp(project_awards, project_award_id = award.project_award_id)));\r\n\r\n// REMOVE ANY DELETED PUBLICATIONS\r\nForAll(colRemoveProjectPublications As pub, \r\n    Remove(publications, LookUp(publications, cadet_pub_id = pub.cadet_pub_id)));\r\n\r\n// REMOVE ANY DELETED CADETS\r\nForAll(colRemoveProjectCadets As cadet, \r\n    Remove(project_cadet, LookUp(project_cadet, project_cadet_id = cadet.project_cadet_id)));\r\n\r\n// REMOVE ANY DELETED PRIORITIES\r\nForAll(colRemoveProjectPriorities As priority, \r\n    Remove(priorities, LookUp(priorities, project_priority_id = priority.project_priority_id)));\r\n\r\n// REMOVE ANY DELETED TAGS\r\nForAll(colRemoveProjectTags As tag, \r\n    Remove(project_tags, LookUp(project_tags, tag_id = tag.tag_id)));\r\n\r\n// REMOVE ANY DELETED FACULTY\r\nForAll(colRemoveProjectFaculty As fac, \r\n    Remove(project_fac, LookUp(project_fac, project_fac_id = fac.project_fac_id)));\r\n\r\n// REMOVE ANY DELETED COLLABORATORS\r\nForAll(colRemoveProjectCollaborators As collab, \r\n    Remove(project_collaborators, LookUp(project_collaborators, project_collaborator_id = collab.project_collaborator_id)));\r\n\r\n// UPDATE PROJECTS TABLE\r\nIf(\r\n    IsBlank(Index(colProject,1).project_id), \r\n    // CREATE NEW PROJECT IN PROJECTS TABLE\r\n    Set(varProjectID, \r\n        Patch(projects, Defaults(projects), \r\n            {project_title: Index(colProject,1).project_title, \r\n            project_desc: Index(colProject,1).project_description}).project_id); \r\n        \r\n        // UPDATE PROJECT_CADET TABLE WITH NEW CADETS FOR NEW PROJECT\r\n        ForAll(\r\n            colProjectCadets As cadet, \r\n            With({\r\n                new_project_cadet_id:\r\n            Patch(project_cadet, Defaults(project_cadet), \r\n                {project_id: varProjectID, \r\n                usma_pers_id: cadet.usma_pers_id, \r\n                offering_id: cadet.offering_id, \r\n                project_status: cadet.project_status}).project_cadet_id}, \r\n            \r\n            // UPDATE ASPIRATIONAL PUBLICATIONS FOR NEW CADETS FOR NEW PROJECT\r\n            ForAll(Filter(colProjectPublications, new_cadet_num = cadet.new_cadet_num) As pub, \r\n                Patch(publications, Defaults(publications), \r\n                    {venue_id: pub.venue_id, \r\n                    pub_type_id: pub.pub_type_id, \r\n                    project_cadet_id: new_project_cadet_id, \r\n                    pub_title: pub.pub_title, \r\n                    signed_up: pub.signed_up, \r\n                    pub_date: pub.pub_date, \r\n                    pub_link: pub.pub_link, \r\n                    updated_on: Today()})); \r\n\r\n            // UPDATE PROJECT AWARDS FOR NEW CADETS FOR NEW PROJECT\r\n            ForAll(Filter(colProjectAwards, new_cadet_num = cadet.new_cadet_num) As award, \r\n                Patch(project_awards, Defaults(project_awards), \r\n                    {project_id: varProjectID,\r\n                    project_cadet_id: new_project_cadet_id, \r\n                    award_name: award.award_name, \r\n                    signed_up: award.signed_up, \r\n                    won: award.won, \r\n                    updated_on: Today()}))));\r\n\r\n    // UPDATE PROJECT PRIORITIES FOR NEW PROJECT\r\n    If(\r\n        CountRows(colProjectPriorities) > 0, \r\n        ForAll(colProjectPriorities As priority, \r\n            Patch(priorities, Defaults(priorities), \r\n                {priority_id: priority.priority_id, \r\n                project_id: varProjectID}))); \r\n\r\n    // UPDATE PROJECT TAGS FOR NEW PROJECT\r\n    If(\r\n        CountRows(colProjectTags) > 0, \r\n        ForAll(colProjectTags As tag, \r\n            Patch(project_tags, Defaults(project_tags), \r\n                {project_id: varProjectID, \r\n                topic_method_id: tag.topic_method_id}))); \r\n\r\n    // UPDATE PROJECT FACULTY FOR NEW PROJECT\r\n    ForAll(colProjectFaculty As fac, \r\n        Patch(project_fac, Defaults(project_fac), \r\n            {project_id: varProjectID, \r\n            tour_id: fac.tour_id, \r\n            role: fac.role, \r\n            updated_on: Today()})); \r\n    \r\n    // UPDATE CENTER SPONSORS FOR NEW PROJECT\r\n    If(\r\n        Not(IsBlank(Index(colProject,1).center_id)),\r\n        Patch(center_sponsors, Defaults(center_sponsors), \r\n            {project_id: varProjectID, \r\n            center_id: Index(colProject,1).center_id})); \r\n    \r\n    // UPDATE PROJECT COLLABORATORS FOR NEW PROJECT\r\n    If(\r\n        CountRows(colProjectCollaborators) > 0,\r\n        ForAll(colProjectCollaborators As collab, \r\n            Patch(project_collaborators, Defaults(project_collaborators), \r\n                {project_id: varProjectID, \r\n                spon_collab_id: collab.collab_id}))),\r\n\r\n    // PATCH CHANGES TO EXISTING PROJECTS INTO PROJECTS TABLE\r\n    If(\r\n        Index(colProject,1).project_title <> Index(colProject,2).project_title ||\r\n        Index(colProject,1).project_description <> Index(colProject,2).project_description, \r\n        Patch(projects, LookUp(projects, project_id = Index(colProject,1).project_id), \r\n            {project_title: Index(colProject,1).project_title, \r\n            project_desc: Index(colProject,1).project_description, \r\n            updated_on: Today()}));\r\n\r\n    // PATCH CADET CHANGES FOR EXISTING PROJECTS TO PROJECT_CADET AND CAPTURE NEW PROJECT_CADET_ID\r\n    If(\r\n        varCadetChange,\r\n        ForAll(colProjectCadets As cadet, \r\n            If(\r\n                IsBlank(cadet.project_cadet_id), \r\n                With({new_project_cadet_id:    \r\n                    Patch(project_cadet, Defaults(project_cadet), \r\n                        {project_id: Index(colProject,1).project_id, \r\n                        usma_pers_id: cadet.usma_pers_id, \r\n                        offering_id: cadet.offering_id, \r\n                        project_status: cadet.project_status, \r\n                        updated_on: Today()}).project_cadet_id}, \r\n                    \r\n                    // PATCH NEW ASPIRATIONAL PUBLICATIONS FOR NEW CADETS FOR EXISTING PROJECTS\r\n                    ForAll(Filter(colProjectPublications, new_cadet_num = cadet.new_cadet_num) As pub, \r\n                        Patch(publications, Defaults(publications), \r\n                            {venue_id: pub.venue_id, \r\n                            pub_type_id: pub.pub_type_id, \r\n                            project_cadet_id: new_project_cadet_id, \r\n                            pub_title: pub.pub_title, \r\n                            signed_up: pub.signed_up, \r\n                            pub_date: pub.pub_date, \r\n                            pub_link: pub.pub_link, \r\n                            updated_on: Today()}));\r\n\r\n                    // PATCH IN NEW PROJECT AWARDS FOR NEW CADETS FOR EXISTING PROJECTS\r\n                    ForAll(Filter(colProjectAwards, new_cadet_num = cadet.new_cadet_num) As award, \r\n                        Patch(project_awards, Defaults(project_awards), \r\n                            {project_id: Index(colProject,1).project_id,\r\n                            project_cadet_id: new_project_cadet_id, \r\n                            award_name: award.award_name, \r\n                            signed_up: award.signed_up, \r\n                            won: award.won, \r\n                            updated_on: Today()}))), \r\n\r\n                // PATCH UPDATES TO EXISTING CADETS FOR EXISTING PROJECTS\r\n                Patch(project_cadet, LookUp(project_cadet, project_cadet_id = cadet.project_cadet_id), \r\n                    {offering_id: cadet.offering_id, \r\n                    project_status: cadet.project_status, \r\n                    updated_on: Today()}))));\r\n    \r\n    // PATCH CHANGES TO PUBLICATIONS FOR EXISTING CADETS FOR EXISTING PROJECTS\r\n    If(\r\n        varPubChange,\r\n        ForAll(Filter(colProjectPublications, Not(IsBlank(project_cadet_id))) As pub, \r\n            If(\r\n                IsBlank(pub.cadet_pub_id), \r\n                // PATCH NEW PUBLICATIONS FOR EXISTING CADETS FOR EXISTING PROJECTS\r\n                Patch(publications, Defaults(publications), \r\n                    {venue_id: pub.venue_id, \r\n                    pub_type_id: pub.pub_type_id, \r\n                    project_cadet_id: pub.project_cadet_id, \r\n                    pub_title: pub.pub_title, \r\n                    signed_up: pub.signed_up, \r\n                    pub_date: pub.pub_date, \r\n                    pub_link: pub.pub_link, \r\n                    updated_on: Today()}), \r\n\r\n                // PATCH UPDATES TO EXISTING PUBLICATIONS FOR EXISTING CADETS FOR EXISTING PROJECTS\r\n                Patch(publications, LookUp(publications, cadet_pub_id = pub.cadet_pub_id), \r\n                    {venue_id: pub.venue_id, \r\n                    pub_type_id: pub.pub_type_id, \r\n                    project_cadet_id: pub.project_cadet_id, \r\n                    pub_title: pub.pub_title, \r\n                    signed_up: pub.signed_up, \r\n                    pub_date: pub.pub_date, \r\n                    pub_link: pub.pub_link, \r\n                    updated_on: Today()})))); \r\n\r\n    // PATCH CHANGES TO AWARDS FOR EXISTING CADETS FOR EXISTING PROJECTS\r\n    If(\r\n        varAwardChange, \r\n        ForAll(Filter(colProjectAwards, Not(IsBlank(project_cadet_id))) As award, \r\n            If(\r\n                IsBlank(award.project_award_id), \r\n                // PATCH IN NEW AWARDS FOR EXISTING CADETS FOR EXISTING PROJECTS\r\n                Patch(project_awards, Defaults(project_awards), \r\n                    {project_id: Index(colProject,1).project_id,\r\n                    project_cadet_id: award.project_cadet_id, \r\n                    award_name: award.award_name, \r\n                    signed_up: award.signed_up, \r\n                    won: award.won, \r\n                    updated_on: Today()}), \r\n\r\n                // PATCH UPDATES TO EXISTING AWARDS FOR EXISTING CADETS FOR EXISTING PROJECTS\r\n                Patch(project_awards, LookUp(project_awards, project_award_id = award.project_award_id), \r\n                    {project_cadet_id: award.project_cadet_id, \r\n                    award_name: award.award_name, \r\n                    signed_up: award.signed_up, \r\n                    won: award.won, \r\n                    updated_on: Today()}))));\r\n\r\n    // PATCH CHANGES TO PRIORITIES FOR EXISTING PROJECTS\r\n    If(\r\n        varPriorityChange, \r\n        ForAll(colProjectPriorities As priority, \r\n            If(\r\n                IsBlank(priority.project_priority_id), \r\n                // PATCH IN NEW PRIORITIES FOR EXISTING PROJECTS\r\n                Patch(priorities, Defaults(priorities), \r\n                    {priority_id: priority.priority_id, \r\n                    project_id: Index(colProject,1).project_id}), \r\n\r\n                // PATCH IN UPDATES TO EXISTING PRIORITIES\r\n                Patch(priorities, LookUp(priorities, project_priority_id = priority.project_priority_id), \r\n                    {priority_id: priority.priority_id}))));\r\n\r\n    If(\r\n        varTagChange, \r\n        ForAll(colProjectTags As tag, \r\n            If(\r\n                IsBlank(tag.tag_id), \r\n                // PATCH IN NEW TAGS FOR EXISTING PROJECTS\r\n                Patch(project_tags, Defaults(project_tags), \r\n                    {project_id: Index(colProject,1).project_id, \r\n                    topic_method_id: tag.topic_method_id}), \r\n                \r\n                // PATCH IN UPDATES TO EXISTING TAGS FOR EXISTING PROJECTS\r\n                Patch(project_tags, LookUp(project_tags, tag_id = tag.tag_id), \r\n                    {topic_method_id: tag.topic_method_id}))));\r\n\r\n    // PATCH CHANGES TO FACULTY FOR EXISTING PROJECTS\r\n    If(\r\n        varFacChange, \r\n        ForAll(colProjectFaculty As fac, \r\n            If(\r\n                IsBlank(fac.project_fac_id), \r\n                // PATCH IN NEW FACULTY FOR EXISTING PROJECTS\r\n                Patch(project_fac, Defaults(project_fac), \r\n                    {project_id: Index(colProject,1).project_id, \r\n                    tour_id: fac.tour_id, \r\n                    role: fac.role, \r\n                    updated_on: Today()}), \r\n\r\n                // PATCH IN CHANGES TO EXISTING FACUTLY FOR EXISTING PROJECTS\r\n                Patch(project_fac, LookUp(project_fac, project_fac_id = fac.project_fac_id), \r\n                    {role: fac.role, \r\n                    updated_on: Today()}))));\r\n\r\n    // PATCH CHANGES TO CENTER SPONSOR FOR EXISTING PROJECTS\r\n    If(\r\n        Index(colProject,1).center_id <> Index(colProject,2).center_id,\r\n        If(\r\n            IsBlank(Index(colProject,2).center_id),\r\n            // PATCH IN NEW CENTER SPONSOR FOR EXISTING PROJECTS\r\n            Patch(center_sponsors, Defaults(center_sponsors), \r\n                {center_id: Index(colProject,1).center_id, \r\n                project_id: Index(colProject,1).project_id}),\r\n\r\n            If(\r\n                IsBlank(Index(colProject,1).center_id), \r\n                // REMOVE CENTER SPONSOR FOR EXISTING PROJECTS\r\n                Remove(center_sponsors, LookUp(center_sponsors, center_sponsor_id = Index(colProject,2).center_sponsor_id)), \r\n\r\n                // PATCH IN CHANGES TO EXISTING CENTER SPONSOR FOR EXISTING PROJECTS\r\n                Patch(center_sponsors, LookUp(center_sponsors, center_sponsor_id = Index(colProject,1).center_sponsor_id), \r\n                    {center_id: Index(colProject,1).center_id}))));\r\n\r\n    // PATCH CHANGES TO COLLABORATORS FOR EXISTING PROJECTS\r\n    If(\r\n        varCollabChange,\r\n        ForAll(colProjectCollaborators As collab, \r\n            If(\r\n                IsBlank(collab.project_collaborator_id), \r\n                // PATCH IN NEW PROJECT COLLABORATORS FOR EXISTING PROJECTS\r\n                Patch(project_collaborators, Defaults(project_collaborators), \r\n                    {spon_collab_id: collab.collab_id, \r\n                    project_id: Index(colProject,1).project_id}), \r\n\r\n                // PATCH IN CHANGES TO EXISTING COLLABORATORS FOR EXISTING PROJECTS\r\n                Patch(project_collaborators, LookUp(project_collaborators, project_collaborator_id = collab.project_collaborator_id), \r\n                    {spon_collab_id: collab.collab_id})))));\r\n\r\nRefresh(current_projects_view);\r\nRefresh(center_sponsors); \r\nRefresh(project_tags_view); \r\nRefresh(project_priority_view); \r\nRefresh(current_cadet_pubs_view); \r\nRefresh(project_awards); \r\nRefresh(project_collab_org_view); \r\nRefresh(lookup_collab_view); \r\nRefresh(lookup_org_view);\r\n\r\nReset(Gallery_Projects_30);\r\n\r\nSet(varProjectID, Blank());\r\nSet(varReturnScreen, Blank());\r\n\r\nClearCollect(colProject, \r\n    {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()},\r\n    {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()});\r\nClear(colCenters);\r\nClear(colProjectCadets); \r\nClear(colProjectFaculty);\r\nClear(colLookupTags);\r\nClear(colProjectTags);\r\nClear(colLookupPriority);\r\nClear(colProjectPriorities);\r\nClear(colPubTypes);\r\nClear(colPubVenues);\r\nClear(colProjectPublications);\r\nClear(colLookupProjectAwards);\r\nClear(colProjectAwards);\r\nClear(colProjectCollaborators);\r\nClear(colLookupCollaborators);\r\nClear(colLookupOrgs);\r\nClear(colRemoveProjectAwards);\r\nClear(colRemoveProjectCadets); \r\nClear(colRemoveProjectCollaborators); \r\nClear(colRemoveProjectFaculty); \r\nClear(colRemoveProjectPriorities); \r\nClear(colRemoveProjectPublications); \r\nClear(colRemoveProjectTags);\r\nClear(colProjectPictures);\r\n\r\nUpdateContext({varAddAward:Blank()});\r\nUpdateContext({varAddPictures:Blank()});\r\nUpdateContext({varAddPriorities:Blank()});\r\nUpdateContext({varAwardChange:Blank()});\r\nUpdateContext({varCadetChange:Blank()});\r\nUpdateContext({varCollabChange:Blank()});\r\nUpdateContext({varCollabMissing:Blank()});\r\nUpdateContext({varFacChange:Blank()});\r\nUpdateContext({varMissingParent:Blank()});\r\nUpdateContext({varNewCadet:Blank()});\r\nUpdateContext({varNewOrg:Blank()});\r\nUpdateContext({varOrgReset:Blank()});\r\nUpdateContext({varPriorityChange:Blank()});\r\nUpdateContext({varPubChange:Blank()});\r\nUpdateContext({varReadyToSubmit:Blank()});\r\nUpdateContext({varTagChange:Blank()});\r\nUpdateContext({varShowSpinner:false});\r\n\r\n\r\nNavigate(Screen_Projects_Overview_30);\r\n"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Save"
                  Width: =Parent.Width/11
                  X: =Button_Check_40.X + Button_Check_40.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Check_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        Not(varReadyToSubmit) && 
                        (CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                        varPermissions = "Master" ||
                        varPermissions = "Research"), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(
                        Not(IsBlank(Index(colProject,1).project_title)) &&
                        Not(IsBlank(Index(colProject,1).project_description)) &&
                        Not(IsBlank(Index(colProject,1).project_ay)) &&
                        Not(IsBlank(Index(colProject,1).project_semester)) &&
                        CountIf(colProjectCadets, Not(IsBlank(usma_pers_id)), Not(IsBlank(class_num)), Not(IsBlank(project_status))) > 0 &&
                        CountIf(colProjectFaculty, Not(IsBlank(tour_id)), Not(IsBlank(role))) > 0 &&
                        CountIf(colProjectTags, Not(IsBlank(topic_method_id))) > 0,
                        If(
                            CountIf(colProjectCadets, IsBlank(class_num) Or IsBlank(project_status)) = 0 && 
                            CountRows(colProjectCadets) = CountRows(Distinct(colProjectCadets, usma_pers_id)),
                            If(
                                CountIf(colProjectFaculty, IsBlank(role)) = 0 &&
                                CountIf(colProjectFaculty, role = "ADVISOR") = 1 && 
                                CountRows(colProjectFaculty) = CountRows(Distinct(colProjectFaculty, tour_id)), 
                                If(
                                    CountIf(colProjectCollaborators, IsBlank(collab_id)) = 0 && 
                                    CountRows(colProjectCollaborators) = CountRows(Distinct(colProjectCollaborators, collab_id)), 
                                    If(
                                        CountIf(colProjectPriorities, IsBlank(priority_id)) = 0 &&
                                        CountRows(colProjectPriorities) = CountRows(Distinct(colProjectPriorities, priority_id)), 
                                        If(
                                            CountIf(colProjectTags, IsBlank(topic_method_id)) = 0 && 
                                            CountRows(colProjectTags) = CountRows(Distinct(colProjectTags, topic_method_id)),
                                            If(
                                                CountRows(Filter(colProjectPublications, Not(IsBlank(new_cadet_num)))) = 0 ||
                                                CountRows(Filter(colProjectPublications, Not(IsBlank(project_cadet_id)))) = 0, 
                                                UpdateContext({varReadyToSubmit:true});
                                                Notify("CLICK SAVE TO SUBMIT CHANGES", NotificationType.Success),
                                                UpdateContext({varReadyToSubmit:false});
                                                Notify("PLEASE ENSURE ALL PUBLICATIONS HAVE A CADET ASSIGNED", NotificationType.Error)),
                                            UpdateContext({varReadyToSubmit:false});
                                            Notify("PLEASE REMOVE ANY BLANK OR DUPLICATE TAGS", NotificationType.Error)),
                                        UpdateContext({varReadyToSubmit:false});
                                        Notify("PLEASE REMOVE ANY BLANK OR DUPLICATE PRIORITIES", NotificationType.Error)),
                                    UpdateContext({varReadyToSubmit:false});
                                    Notify("PLEASE REMOVE ANY BLANK OR DUPLICATE COLLABORATORS", NotificationType.Error)), 
                                UpdateContext({varReadyToSubmit:false});
                                Notify("PLEASE ENSURE ALL ADVISORS ARE ASSIGNED A ROLE; THERE IS ONLY ONE PRIMARY ADVISOR; THERE ARE NO DUPLICATE ADVISORS", NotificationType.Error)),
                            UpdateContext({varReadyToSubmit:false});
                            Notify("PLEASE ENSURE ALL CADETS ARE ASSIGNED A CLASS AND A STATUS AND THERE ARE NO DUPLICATE CADETS", NotificationType.Error)),
                        UpdateContext({varReadyToSubmit:false});
                        Notify("PLEASE ENSURE THIS PROJECT HAS: A TITLE; A DESCRIPTION; AN AY; A SEMESTER; AT LEAST ONE CADET; AT LEAST ONE ADVISOR; AT LEAST ONE TAG", NotificationType.Error));
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Check"
                  Width: =Parent.Width/11
                  X: =Button_Return_40.X + Button_Return_40.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Return_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Refresh(current_projects_view);

                    Reset(Gallery_Projects_30);

                    Set(varProjectID, Blank());
                    Set(varReturnScreen, Blank());

                    ClearCollect(colProject, 
                        {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()},
                        {project_id: Blank(), project_title: Blank(), project_description: Blank(), project_ay: Blank(), project_semester: Blank(), center_id: Blank(), center_sponsor_id: Blank(), updated_on: Blank()});
                    Clear(colCenters);
                    Clear(colProjectCadets); 
                    Clear(colProjectFaculty);
                    Clear(colLookupTags);
                    Clear(colProjectTags);
                    Clear(colLookupPriority);
                    Clear(colProjectPriorities);
                    Clear(colPubTypes);
                    Clear(colPubVenues);
                    Clear(colProjectPublications);
                    Clear(colLookupProjectAwards);
                    Clear(colProjectAwards);
                    Clear(colProjectCollaborators);
                    Clear(colLookupCollaborators);
                    Clear(colLookupOrgs);
                    Clear(colRemoveProjectAwards);
                    Clear(colRemoveProjectCadets); 
                    Clear(colRemoveProjectCollaborators); 
                    Clear(colRemoveProjectFaculty); 
                    Clear(colRemoveProjectPriorities); 
                    Clear(colRemoveProjectPublications); 
                    Clear(colRemoveProjectTags);
                    Clear(colProjectPictures);

                    UpdateContext({varAddAward:Blank()});
                    UpdateContext({varAddPictures:Blank()});
                    UpdateContext({varAddPriorities:Blank()});
                    UpdateContext({varAwardChange:Blank()});
                    UpdateContext({varCadetChange:Blank()});
                    UpdateContext({varCollabChange:Blank()});
                    UpdateContext({varCollabMissing:Blank()});
                    UpdateContext({varFacChange:Blank()});
                    UpdateContext({varMissingParent:Blank()});
                    UpdateContext({varNewCadet:Blank()});
                    UpdateContext({varNewOrg:Blank()});
                    UpdateContext({varOrgReset:Blank()});
                    UpdateContext({varPriorityChange:Blank()});
                    UpdateContext({varPubChange:Blank()});
                    UpdateContext({varReadyToSubmit:Blank()});
                    UpdateContext({varTagChange:Blank()});
                    UpdateContext({varShowSpinner:false});


                    Navigate(Screen_Projects_Overview_30);
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Return"
                  Width: =Parent.Width/11
                  X: =40
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Refresh_Collaborators_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Refresh(lookup_collab_view);

                    ClearCollect(colLookupCollaborators, lookup_collab_view);

                    Reset(Gallery_Collaborators_40);
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Refresh Collaborators"
                  Visible: =Button_New_Collaborator_40.Visible
                  Width: =Parent.Width/7
                  X: =Button_New_Collaborator_40.X + Button_New_Collaborator_40.Width + Parent.Width/40
                  Y: =Gallery_Collaborators_40.Y + Gallery_Collaborators_40.Height + Parent.Height/40
            - Button_New_Collaborator_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varCollabMissing:CountRows(colLookupCollaborators)+1});

                    UpdateContext({varReadyToSubmit:false});
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Collaborator not listed?"
                  Visible: |-
                    =If(
                        CountRows(colProjectCollaborators) > 0, true, false)
                  Width: =Parent.Width/7
                  X: =Gallery_Collaborators_40.X
                  Y: =Gallery_Collaborators_40.Y + Gallery_Collaborators_40.Height + Parent.Height/40
            - Button_Add_Awards_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varAddAward: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Awards"
                  Visible: |-
                    =If(
                        CountRows(colProjectCadets) > 0, 
                        true, false)
                  Width: =Parent.Width/12
                  X: =Button_Add_Pictures_40.X + Button_Add_Pictures_40.Width + Parent.Width/50
                  Y: =Button_Add_Priorities_40.Y
            - Button_Add_Pictures_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        Not(IsBlank(Index(colProject,1).project_id)), 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varAddPictures: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Pictures"
                  Tooltip: ="You must save and come back to project before adding pictures"
                  Width: =Parent.Width/8
                  X: =Button_Add_Priorities_40.X + Button_Add_Priorities_40.Width + Parent.Width/50
                  Y: =Button_Add_Priorities_40.Y
            - Button_Add_Priorities_40:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varAddPriorities: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Priorities"
                  Visible: |-
                    =If(
                        CountRows(colProjectCadets) > 0, 
                        true, false)
                  Width: =Parent.Width/8
                  X: |-
                    =Button_Return_40.X
                    //Button_Cancel_40.X + Button_Cancel_40.Width + Parent.Width/50
                  Y: =Button_Return_40.Y - Self.Height - Parent.Height/40
            - Gallery_Collaborators_40:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =1
                  Height: =Text_Faculty_40.Height*2.25
                  Items: =colProjectCollaborators
                  TemplateSize: =Text_Input_Change_User_40.Height
                  Width: =Text_Faculty_40.Width
                  X: =Text_Collaborators_40.X
                  Y: =Text_Collab_Name_40.Y + Text_Collab_Name_40.Height
                Children:
                  - Icon_Remove_Collaborator_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =If(
                              Not(IsBlank(ThisItem.project_collaborator_id)), 
                              Collect(colRemoveProjectCollaborators, ThisItem));

                          Remove(colProjectCollaborators, ThisItem);

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varCollabChange:true});
                        Visible: =If(IsBlank(ThisItem.project_collaborator_id),true, false)
                        Width: =Self.Height
                        X: =Icon_Add_Collaborator_40.X - Gallery_Collaborators_40.X
                  - Text_Input_Collaborator_Org_And_Parent_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.org_and_parent
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Tooltip: =Self.Text
                        Width: =Text_Collab_Org_40.Width
                        X: =Text_Collab_Org_40.X - Gallery_Collaborators_40.X
                  - Text_Input_Collaborator_Email_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.collab_email
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Tooltip: =Self.Text
                        Width: =Text_Collab_Email_40.Width
                        X: =Text_Collab_Email_40.X - Gallery_Collaborators_40.X
                  - Dropdown_Collaborator_Name_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colProjectCollaborators, collab_id = ThisItem.collab_id)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =Sort(colLookupCollaborators, last_name, SortOrder.Ascending)
                        OnChange: |
                          =Patch(colProjectCollaborators, ThisItem, 
                              {collab_id: Self.Selected.collab_id, 
                              collab_email: Self.Selected.collab_email, 
                              last_name: Self.Selected.last_name, 
                              first_name: Self.Selected.first_name, 
                              collab_name: Self.Selected.collab_name,
                              org_id: Self.Selected.org_id, 
                              org_and_parent: LookUp(colLookupOrgs, org_id = Self.Selected.org_id).org_and_parent});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varCollabChange:true});
                        Width: =Text_Collab_Name_40.Width
                        X: =Text_Collab_Name_40.X - Text_Collab_Name_40.X
                      Children:
                        - collab_email1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="collab_email"
                              FieldName: ="collab_email"
                              FieldType: ="s"
                              Order: =2
                        - collab_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="collab_id"
                              FieldName: ="collab_id"
                              FieldType: ="n"
                              Order: =3
                        - collab_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="collab_name"
                              FieldName: ="collab_name"
                              FieldType: ="s"
                              Order: =1
                        - first_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="first_name"
                              FieldName: ="first_name"
                              FieldType: ="s"
                              Order: =5
                        - last_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="last_name"
                              FieldName: ="last_name"
                              FieldType: ="s"
                              Order: =6
                        - org_name2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_name"
                              FieldName: ="org_name"
                              FieldType: ="s"
                              Order: =6
                        - org_id2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_id"
                              FieldName: ="org_id"
                              FieldType: ="n"
                              Order: =7
                  - Separator_Gallery_Collaborators_40:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Collaborator_40:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Height: =Text_Input_Change_User_40.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Collect(colProjectCollaborators, 
                        {new_collab_num: Max(colProjectCollaborators, new_collab_num)+1, 
                        project_id: Index(colProject,1).project_id, 
                        project_collaborator_id: Blank(),
                        collab_id: Blank(), 
                        collab_email: Blank(), 
                        last_name: Blank(), 
                        first_name: Blank(), 
                        collab_name: Blank(),
                        org_id: Blank(), 
                        org_name: Blank(),
                        parent_org_id: Blank(), 
                        parent_org_name: Blank(), 
                        org_and_parent: Blank(),
                        org_abbrev: Blank(), 
                        org_type: Blank(), 
                        org_city: Blank(), 
                        org_state: Blank(), 
                        org_country: Blank()});

                    UpdateContext({varReadyToSubmit:false});

                    UpdateContext({varCollabChange:true});
                  Width: =Self.Height
                  X: =(Gallery_Collaborators_40.X + Gallery_Collaborators_40.Width - Text_Collab_Org_40.X - Text_Collab_Org_40.Width - Self.Width)/2 + Text_Collab_Org_40.X + Text_Collab_Org_40.Width
                  Y: =Text_Collab_Org_40.Y
            - Text_Collab_Org_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Org"
                  Width: =Text_Faculty_40.Width/3
                  X: =Text_Collab_Email_40.X + Text_Collab_Email_40.Width + 10
                  Y: =Text_Collab_Name_40.Y
            - Text_Collab_Email_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Email"
                  Width: =Text_Faculty_40.Width/3
                  X: =Text_Collab_Name_40.X + Text_Collab_Name_40.Width + 10
                  Y: =Text_Collab_Name_40.Y
            - Text_Collab_Name_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Name"
                  Width: =Text_Collaborators_40.Width/4
                  X: =Text_Collaborators_40.X
                  Y: =Text_Collaborators_40.Y + Text_Collaborators_40.Height
            - Text_Collaborators_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Collaborators"
                  Width: =Text_Faculty_40.Width
                  X: =Text_Cadets_40.X + Text_Cadets_40.Width - Self.Width
                  Y: =Text_Faculty_40.Y
            - Gallery_Faculty_40:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =1
                  Height: =Text_Faculty_40.Height*2.25
                  Items: =colProjectFaculty
                  TemplateSize: =Text_Input_Change_User_40.Height
                  Width: =Text_Faculty_40.Width
                  X: =Gallery_Cadets_40.X
                  Y: =Text_Faculty_Tour_40.Y + Text_Faculty_Tour_40.Height
                Children:
                  - Icon_Remove_Faculty_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =If(
                              Not(IsBlank(ThisItem.project_fac_id)), 
                              Collect(colRemoveProjectFaculty, ThisItem));

                          Remove(colProjectFaculty, ThisItem);

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varFacChange:true});
                        Visible: =If(IsBlank(ThisItem.project_fac_id),true, false)
                        Width: =Self.Height
                        X: =Icon_Add_Faculty_40.X - Parent.X
                  - Dropdown_Faculty_Role_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colRoles, role = ThisItem.role)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =colRoles
                        OnChange: |-
                          =Patch(colProjectFaculty, ThisItem,{role:Self.Selected.role});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varFacChange:true});
                        Width: =Text_Faculty_Role_40.Width
                        X: =Text_Faculty_Role_40.X - Gallery_Faculty_40.X
                      Children:
                        - role1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="role"
                              FieldName: ="role"
                              FieldType: ="s"
                              Order: =1
                  - Text_Input_Faculty_First_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.fac_first_name
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Faculty_First_Name_40.Width
                        X: =Text_Faculty_First_Name_40.X - Gallery_Faculty_40.X
                  - Text_Input_Faculty_Last_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.fac_last_name
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Faculty_Last_Name_40.Width
                        X: =Text_Faculty_Last_Name_40.X - Gallery_Faculty_40.X
                  - Text_Input_Faculty_Tour_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.tour_id
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Faculty_Tour_40.Width
                  - Separator_Gallery_Faculty_40:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Faculty_40:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Height: =Text_Input_Change_User_40.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Set(varReturnScreen, App.ActiveScreen);

                    Navigate(Screen_Personnel_Overview_10);

                    UpdateContext({varReadyToSubmit:false});

                    UpdateContext({varFacChange:true});
                  Width: =Self.Height
                  X: =(Gallery_Faculty_40.X + Gallery_Faculty_40.Width - Text_Faculty_Role_40.X - Text_Faculty_Role_40.Width - Self.Width)/2 + Text_Faculty_Role_40.X + Text_Faculty_Role_40.Width
                  Y: =Text_Faculty_Role_40.Y
            - Text_Faculty_Role_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Role"
                  Width: =Text_Faculty_40.Width*3/8 - 40 - Icon_Add_Faculty_40.Width
                  X: =Text_Faculty_First_Name_40.X + Text_Faculty_First_Name_40.Width + 10
                  Y: =Text_Faculty_Tour_40.Y
            - Text_Faculty_First_Name_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="First Name"
                  Width: =Text_Faculty_40.Width/4
                  X: =Text_Faculty_Last_Name_40.X + Text_Faculty_Last_Name_40.Width + 10
                  Y: =Text_Faculty_Tour_40.Y
            - Text_Faculty_Last_Name_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Last Name"
                  Width: =Text_Faculty_40.Width/4
                  X: =Text_Faculty_Tour_40.X + Text_Faculty_Tour_40.Width + 10
                  Y: =Text_Faculty_Tour_40.Y
            - Text_Faculty_Tour_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Tour ID"
                  Width: =Gallery_Faculty_40.Width/8
                  X: =Text_Faculty_40.X
                  Y: =Text_Faculty_40.Y + Text_Faculty_40.Height
            - Text_Faculty_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Faculty"
                  Width: =Parent.Width/2 - Parent.Width*3/80
                  X: =Text_Cadets_40.X
                  Y: |-
                    =Gallery_Pubs_40.Y + Gallery_Pubs_40.Height + Parent.Height/40
                    //Gallery_Cadets_40.Y + Gallery_Cadets_40.Height + Parent.Height/40
            - Gallery_Pubs_40:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =1
                  Height: =Text_Pubs_40.Height*2.25
                  Items: =colProjectPublications
                  TemplateSize: =Text_Input_Change_User_40.Height
                  Width: =Text_Pubs_40.Width
                  X: =Gallery_Cadets_40.X
                  Y: |-
                    =Text_Pub_Cadet_40.Y + Text_Pub_Cadet_40.Height

                    //Gallery_Cadets_40.Y + Gallery_Cadets_40.Height + Parent.Height/40
                Children:
                  - Icon_Remove_Pub_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =If(
                              Not(IsBlank(ThisItem.cadet_pub_id)), 
                              Collect(colRemoveProjectPublications, ThisItem));

                          Remove(colProjectPublications, ThisItem);

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        Visible: =true //If(IsBlank(ThisItem.project_fac_id),true, false)
                        Width: =Self.Height
                        X: =Icon_Add_Pub_40.X - Gallery_Pubs_40.X
                  - Date_Picker_Updated_On_41:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderRadius: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Parent.TemplateHeight
                        OnChange: =
                        SelectedDate: =ThisItem.updated_on
                        Width: =Text_Updated_On_40.Width
                        X: =Text_Updated_On_40.X - Gallery_Pubs_40.X
                  - Text_Input_Pub_Link_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.pub_link
                        DisplayMode: |-
                          =If(
                              Icon_Add_Pub_40.Visible, 
                              If(
                                  CountRows(colProjectFaculty)>0, 
                                  If(
                                      CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                      varPermissions = "Master" ||
                                      varPermissions = "Research", 
                                      DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit), 
                              DisplayMode.Disabled)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        Mode: =TextMode.MultiLine
                        OnChange: |-
                          =Patch(colProjectPublications, ThisItem,
                              {pub_link: Upper(Self.Text), 
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        OnSelect: =Select(Parent)
                        Width: =Text_Pub_Link_40.Width
                        X: =Text_Pub_Link_40.X - Gallery_Pubs_40.X
                  - Date_Picker_Pub_Date_40:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderRadius: =10
                        DisplayMode: |-
                          =If(
                              Icon_Add_Pub_40.Visible, 
                              If(
                                  CountRows(colProjectFaculty)>0, 
                                  If(
                                      CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                      varPermissions = "Master" ||
                                      varPermissions = "Research", 
                                      DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit), 
                              DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Parent.TemplateHeight
                        OnChange: |-
                          =Patch(colProjectPublications, ThisItem,
                              {pub_date: Self.SelectedDate, 
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        SelectedDate: =ThisItem.pub_date
                        Width: =Text_Pub_Date_40.Width
                        X: =Text_Pub_Date_40.X - Gallery_Pubs_40.X
                  - Dropdown_Signed_Up_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colYesNo, answer = ThisItem.signed_up)
                        DisplayMode: |-
                          =If(
                              Icon_Add_Pub_40.Visible, 
                              If(
                                  CountRows(colProjectFaculty)>0, 
                                  If(
                                      CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                      varPermissions = "Master" ||
                                      varPermissions = "Research", 
                                      DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit), 
                              DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: |-
                          =Filter(
                              Filter(colYesNo, Not(IsBlank(answer))), answer <> "N/A")
                        OnChange: |-
                          =Patch(colProjectPublications, ThisItem,
                              {signed_up: Self.Selected.answer, 
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        Width: =Text_Signed_Up_40.Width
                        X: =Text_Signed_Up_40.X - Gallery_Pubs_40.X
                      Children:
                        - answer3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="answer"
                              FieldName: ="answer"
                              FieldType: ="s"
                              Order: =1
                  - Text_Input_Pub_Title_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.pub_title
                        DisplayMode: |-
                          =If(
                              Icon_Add_Pub_40.Visible, 
                              If(
                                  CountRows(colProjectFaculty)>0, 
                                  If(
                                      CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                      varPermissions = "Master" ||
                                      varPermissions = "Research", 
                                      DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit), 
                              DisplayMode.Disabled)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        Mode: =TextMode.MultiLine
                        OnChange: |-
                          =Patch(colProjectPublications, ThisItem,
                              {pub_title: Upper(Self.Text), 
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        OnSelect: =Select(Parent)
                        Width: =Text_Pub_Title_40.Width
                        X: =Text_Pub_Title_40.X - Gallery_Pubs_40.X
                  - Dropdown_Pub_Type_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colProjectPublications, venue_id = ThisItem.venue_id)
                        DisplayMode: |-
                          =If(
                              Icon_Add_Pub_40.Visible, 
                              If(
                                  CountRows(colProjectFaculty)>0, 
                                  If(
                                      CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                      varPermissions = "Master" ||
                                      varPermissions = "Research", 
                                      DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit), 
                              DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =colPubTypes
                        OnChange: |-
                          =Patch(colProjectPublications, ThisItem,
                              {pub_type_id: Self.Selected.pub_type_id, 
                              pub_type: Self.Selected.pub_type, 
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        Width: =Text_Pub_Type_40.Width
                        X: =Text_Pub_Type_40.X - Gallery_Pubs_40.X
                      Children:
                        - pub_type1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="pub_type"
                              FieldName: ="pub_type"
                              FieldType: ="s"
                              Order: =1
                        - pub_type_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="pub_type_id"
                              FieldName: ="pub_type_id"
                              FieldType: ="n"
                              Order: =2
                  - Dropdown_Venue_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colProjectPublications, venue_id = ThisItem.venue_id)
                        DisplayMode: |-
                          =If(
                              Icon_Add_Pub_40.Visible, 
                              If(
                                  CountRows(colProjectFaculty)>0, 
                                  If(
                                      CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                      varPermissions = "Master" ||
                                      varPermissions = "Research", 
                                      DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit), 
                              DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =colPubVenues
                        OnChange: |-
                          =Patch(colProjectPublications, ThisItem,
                              {venue_id: Self.Selected.venue_id,
                              venue_abbrev: Self.Selected.venue_abbrev, 
                              venue_name: Self.Selected.venue_name, 
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        Width: =Text_Venue_40.Width
                        X: =Text_Venue_40.X - Gallery_Pubs_40.X
                      Children:
                        - venue_abbrev1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="venue_abbrev"
                              FieldName: ="venue_abbrev"
                              FieldType: ="s"
                              Order: =1
                        - venue_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="venue_id"
                              FieldName: ="venue_id"
                              FieldType: ="n"
                              Order: =2
                  - Dropdown_Pub_Cadet_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colProjectCadets, new_cadet_num = ThisItem.new_cadet_num, project_cadet_id = ThisItem.project_cadet_id)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                                  DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =colProjectCadets
                        OnChange: |
                          =Patch(colProjectPublications, ThisItem,
                              {project_cadet_id: Self.Selected.project_cadet_id, 
                              new_cadet_num: Self.Selected.new_cadet_num,
                              updated_on:Today()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPubChange:true});
                        Width: =Text_Pub_Cadet_40.Width
                        X: =Text_Pub_Cadet_40.X - Gallery_Pubs_40.X
                      Children:
                        - cdt_last_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="cdt_last_name"
                              FieldName: ="cdt_last_name"
                              FieldType: ="s"
                              Order: =1
                        - usma_pers_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="usma_pers_id"
                              FieldName: ="usma_pers_id"
                              FieldType: ="s"
                              Order: =2
                  - Separator_Gallery_Pubs_40:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Pub_40:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: "=If(\n    (CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||\n    varPermissions = \"Master\" ||\n    varPermissions = \"Research\")\n    \n    &&\n    \n    CountRows(colProjectCadets) > 0, \n        DisplayMode.Edit, DisplayMode.Disabled)"
                  Height: =Text_Input_Change_User_40.Height
                  Icon: =Icon.Add
                  OnSelect: "=Collect(colProjectPublications, \r\n    {new_cadet_num: 0, \r\n    venue_id: Blank(), \r\n    venue_abbrev: Blank(), \r\n    venue_name: Blank(),\r\n    pub_type_id: Blank(), \r\n    pub_type: Blank(),\r\n    project_id: varProjectID,\r\n    project_cadet_id: Blank(), \r\n    pub_title: Blank(), \r\n    signed_up: \"NO\",\r\n    pub_date: Blank(), \r\n    pub_link: Blank(),\r\n    updated_on: Blank(),\r\n    new_pub_num: Max(colProjectPublications, new_pub_num) + 1});\r\n    \r\nUpdateContext({varReadyToSubmit:false});\r\n\r\nUpdateContext({varPubChange:true});\r\n"
                  Tooltip: ="YOU MUST SUBMIT THIS PROJECT BEFORE ADDING A PUBLICATION OR CONFERENCE"
                  Width: =Self.Height
                  X: |-
                    =Gallery_Pubs_40.X + Gallery_Pubs_40.Width - Self.Width

                    //(Gallery_Faculty_41.X + Gallery_Faculty_41.Width - Text_Faculty_Role_41.X - Text_Faculty_Role_41.Width - Self.Width)/2 + Text_Faculty_Role_41.X + Text_Faculty_Role_41.Width
                  Y: =Text_Pub_Cadet_40.Y
            - Text_Updated_On_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Updated"
                  Width: =Gallery_Pubs_40.Width/14
                  X: =Icon_Add_Pub_40.X - Self.Width - 10
                  Y: =Text_Pubs_40.Y + Text_Pubs_40.Height
            - Text_Pub_Link_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Pub Link"
                  Width: =Text_Updated_On_40.X - Self.X - 10
                  X: =Text_Pub_Date_40.X + Text_Pub_Date_40.Width + 10
                  Y: =Text_Pubs_40.Y + Text_Pubs_40.Height
            - Text_Pub_Date_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Pub Date"
                  Width: =Gallery_Pubs_40.Width/14
                  X: =Text_Signed_Up_40.X + Text_Signed_Up_40.Width + 10
                  Y: =Text_Pubs_40.Y + Text_Pubs_40.Height
            - Text_Signed_Up_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Signed Up"
                  Width: =Gallery_Pubs_40.Width/14
                  X: =Text_Pub_Title_40.X + Text_Pub_Title_40.Width + 10
                  Y: =Text_Pubs_40.Y + Text_Pubs_40.Height
            - Text_Pub_Title_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Title"
                  Width: =Text_Pubs_40.Width/4
                  X: =Text_Pub_Type_40.X + Text_Pub_Type_40.Width + 10
                  Y: =Text_Pub_Cadet_40.Y
            - Text_Pub_Type_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Pub Type"
                  Width: =Text_Pubs_40.Width/6
                  X: =Text_Venue_40.X + Text_Venue_40.Width + 10
                  Y: =Text_Pub_Cadet_40.Y
            - Text_Venue_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Venue"
                  Width: =Text_Pubs_40.Width/12
                  X: =Text_Pub_Cadet_40.X + Text_Pub_Cadet_40.Width + 10
                  Y: =Text_Pub_Cadet_40.Y
            - Text_Pub_Cadet_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Name"
                  Width: =Gallery_Pubs_40.Width/12
                  X: =Text_Pubs_40.X
                  Y: =Text_Pubs_40.Y + Text_Pubs_40.Height
            - Text_Pubs_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Aspirational Publications and Presentations"
                  Width: =Text_Cadets_40.Width
                  X: =Text_Cadets_40.X
                  Y: |-
                    =//Gallery_Collaborators_40.Y + Gallery_Collaborators_40.Height + Parent.Height/40
                    Gallery_Cadets_40.Y + Gallery_Cadets_40.Height + Parent.Height/40
            - Gallery_Cadets_40:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =1
                  Height: =Text_Cadets_40.Height*2.5
                  Items: =colProjectCadets
                  TemplateSize: =Text_Input_Change_User_40.Height
                  Width: =Text_Cadets_40.Width
                  X: =Text_Cadets_40.X
                  Y: =Text_C_Num_40.Y + Text_C_Num_40.Height
                Children:
                  - Icon_Remove_Cadet_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =If(
                              Not(IsBlank(ThisItem.project_cadet_id)), 
                              Collect(colRemoveProjectCadets, ThisItem));

                          Remove(colProjectCadets, ThisItem);

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varCadetChange:true});
                        Visible: =If(IsBlank(ThisItem.project_cadet_id),true, false)
                        Width: =Self.Height
                        X: =Icon_Add_Cadet_40.X - Parent.X
                  - Dropdown_Project_Status_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: |-
                          =//If(
                          //    ThisItem.project_cadet_id = Blank(),
                          //    Filter(colProjectStatus, status = Blank()),
                          //    Filter(colProjectStatus, status = Index(colProjectCadets,1).project_status))

                          Filter(colProjectStatus, status = ThisItem.project_status)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =colProjectStatus
                        OnChange: |-
                          =Patch(colProjectCadets, ThisItem, {project_status:Self.Selected.status});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varCadetChange:true});
                        Width: =Text_Status_40.Width
                        X: =Text_Status_40.X - Gallery_Faculty_40.X
                      Children:
                        - status1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="status"
                              FieldName: ="status"
                              FieldType: ="s"
                              Order: =1
                  - Dropdown_Course_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colResearchClasses, offering_id = ThisItem.offering_id)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =Filter(colResearchClasses, ay = Index(colProject,1).project_ay && semester = Index(colProject,1).project_semester)
                        OnChange: |-
                          =Patch(colProjectCadets, ThisItem, 
                                  {offering_id:Self.Selected.offering_id, 
                                  class_num: LookUp(current_research_classes_view, offering_id = Self.Selected.offering_id).class_num});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varCadetChange:true});
                        Width: =Text_Course_40.Width
                        X: =Text_Course_40.X - Gallery_Faculty_40.X
                      Children:
                        - class_num1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="class_num"
                              FieldName: ="class_num"
                              FieldType: ="s"
                              Order: =1
                  - Text_Input_Major_41:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.major_2
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Tooltip: =LookUp(lookup_major, major_code = ThisItem.major_2).major_name
                        Width: =Text_Major_41.Width
                        X: =Text_Major_41.X - Gallery_Cadets_40.X
                  - Text_Input_Major_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.major_1
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Tooltip: =LookUp(lookup_major, major_code = ThisItem.major_1).major_name
                        Width: =Text_Major_40.Width
                        X: =Text_Major_40.X - Gallery_Cadets_40.X
                  - Text_Input_Class_Year_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.grad_year
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Class_Year_40.Width
                        X: =Text_Class_Year_40.X - Gallery_Cadets_40.X
                  - Text_Input_Cadet_First_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.cdt_first_name
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Cadet_First_Name_40.Width
                        X: =Text_Cadet_First_Name_40.X - Gallery_Cadets_40.X
                  - Text_Input_Cadet_Last_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: |
                          =ThisItem.cdt_last_name
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Cadet_Last_Name_40.Width
                        X: =Text_Cadet_Last_Name_40.X - Gallery_Cadets_40.X
                  - Text_Input_Cadet_wp_Email_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: |
                          =ThisItem.cdt_wp_email
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Cadet_wp_Email_40.Width
                        X: =Text_Cadet_wp_Email_40.X - Gallery_Faculty_40.X
                  - Text_Input_C_Num_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.usma_pers_id
                        DisplayMode: =DisplayMode.View
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_C_Num_40.Width
                        X: =Text_C_Num_40.X - Gallery_Faculty_40.X
                  - Separator_Gallery_Cadets_40:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Cadet_40:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Height: =Text_Input_Change_User_40.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =UpdateContext({varNewCadet:true});

                    UpdateContext({varReadyToSubmit:false});

                    UpdateContext({varCadetChange:true});
                  Width: =Self.Height
                  X: =(Gallery_Cadets_40.X + Gallery_Cadets_40.Width - Text_Status_40.X - Text_Status_40.Width - Self.Width)/2 + Text_Status_40.X + Text_Status_40.Width
                  Y: =Text_Cadet_wp_Email_40.Y
            - Text_Status_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Status"
                  Width: =Text_Cadets_40.Width/10
                  X: =Text_Course_40.X + Text_Course_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Course_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Course"
                  Width: =Text_Cadets_40.Width/15
                  X: =Text_Major_41.X + Text_Major_41.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Major_41:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Major"
                  Width: =Text_Cadets_40.Width/15
                  X: =Text_Major_40.X + Text_Major_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Major_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Major"
                  Width: =Text_Cadets_40.Width/15
                  X: =Text_Class_Year_40.X + Text_Class_Year_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Class_Year_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Class"
                  Width: =Text_Cadets_40.Width/15
                  X: =Text_Cadet_First_Name_40.X + Text_Cadet_First_Name_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Cadet_First_Name_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="First Name"
                  Width: =Text_Cadets_40.Width/10
                  X: =Text_Cadet_Last_Name_40.X + Text_Cadet_Last_Name_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Cadet_Last_Name_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Last Name"
                  Width: =Text_Cadets_40.Width/10
                  X: =Text_Cadet_wp_Email_40.X + Text_Cadet_wp_Email_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Cadet_wp_Email_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="WP Email"
                  Width: =Text_Cadets_40.Width/4
                  X: =Text_C_Num_40.X + Text_C_Num_40.Width + 10
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_C_Num_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="C Num"
                  Width: =Text_Cadets_40.Width/12
                  X: =Text_Cadets_40.X
                  Y: =Text_Cadets_40.Y + Text_Cadets_40.Height
            - Text_Cadets_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Cadets"
                  Width: =Parent.Width - Self.X*2
                  X: =Text_Project_Description_40.X
                  Y: =Text_Project_Description_40.Y + Text_Project_Description_40.Height// + Parent.Height/50
            - Gallery_Tags_40:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =1
                  Height: =Text_Center_Sponsor_40.Y + Text_Center_Sponsor_40.Height - Self.Y
                  Items: =colProjectTags
                  TemplateSize: =Text_Input_Change_User_40.Height
                  Width: =Text_Tags_40.Width
                  X: =Text_Tags_40.X
                  Y: =Text_Tags_40.Y + Text_Tags_40.Height
                Children:
                  - Icon_Remove_Tag_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =If(
                              Not(IsBlank(ThisItem.tag_id)), 
                              Collect(colRemoveProjectTags, ThisItem));

                          Remove(colProjectTags, ThisItem);

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varTagChange:true});
                        Visible: =If(IsBlank(ThisItem.tag_id),true, false)
                        Width: =Self.Height
                        X: =Icon_Add_Tag_40.X - Parent.X
                  - Dropdown_Tag_Name_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colLookupTags, topic_method_id = ThisItem.topic_method_id)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =colLookupTags
                        OnChange: |
                          =Patch(colProjectTags, ThisItem, {topic_method_id:Self.Selected.topic_method_id});

                          UpdateContext({varTagChange:true});
                        Width: =Icon_Remove_Tag_40.X
                        X: =Text_Tags_40.X - Gallery_Tags_40.X
                      Children:
                        - topic_method1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="topic_method"
                              FieldName: ="topic_method"
                              FieldType: ="s"
                              Order: =1
                        - topic_method_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="topic_method_id"
                              FieldName: ="topic_method_id"
                              FieldType: ="n"
                              Order: =2
                  - Separator_Gallery_Tags_40:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Text_Tags_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Tags"
                  Width: =Text_Collaborators_40.Width/2
                  X: =Text_Collaborators_40.X + Text_Collaborators_40.Width - Self.Width
                  Y: =Text_Input_AY_40.Y
            - Icon_Add_Tag_40:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Height: =Text_Input_Change_User_40.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Collect(colProjectTags, 
                        {new_tag_num: Max(colProjectTags, new_tag_num)+1, 
                        tag_id: Blank(), 
                        topic_method: Blank(), 
                        topic_method_id: Blank()});

                    UpdateContext({varReadyToSubmit:false});

                    UpdateContext({varTagChange:true});
                  Width: =Self.Height
                  X: =Gallery_Tags_40.X + Gallery_Tags_40.Width - Self.Width - 10
                  Y: =Text_Tags_40.Y
            - Dropdown_Center_Sponsor_40:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colCenters, center_id = Index(colProject,1).center_id)
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_40.Height
                  Items: =colCenters
                  OnChange: |-
                    =Patch(colProject, Index(colProject,1), {center_id: Self.Selected.center_id});
                    UpdateContext({varReadyToSubmit:false});
                  Width: =Text_Input_Semester_40.Width
                  X: =Text_Input_Semester_40.X
                  Y: =Text_Center_Sponsor_40.Y
                Children:
                  - center_abbrev1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="center_abbrev"
                        FieldName: ="center_abbrev"
                        FieldType: ="s"
                        Order: =1
                  - center_id1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="center_id"
                        FieldName: ="center_id"
                        FieldType: ="n"
                        Order: =2
            - Text_Center_Sponsor_40:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Center Sponsor:"
                  Width: =Text_AY_40.Width
                  X: =Text_AY_40.X
                  Y: |-
                    =Text_Project_Description_40.Y + Text_Project_Description_40.Height - Self.Height
                    //Text_Semester_40.Y + Text_Semester_40.Height + Parent.Height/50
            - Text_Input_Semester_40:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colProject,1).project_semester
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =If(
                        Len(Value(Self.Text)) = 1 &&
                        Value(Self.Text) > 0 &&
                        Value(Self.Text) < 10,
                        Patch(colProject, Index(colProject,1), {project_semester: Value(Self.Text)});
                        ForAll(
                            colProjectCadets As cadet, 
                            If(IsBlank(cadet.project_cadet_id), 
                                Patch(colProjectCadets, LookUp(colProjectCadets, new_cadet_num = cadet.new_cadet_num), 
                                    {class_num: Blank(), 
                                    offering_id: Blank()}), 
                                Patch(colProjectCadets, LookUp(colProjectCadets, project_cadet_id = cadet.project_cadet_id), 
                                    {class_num: Blank(), 
                                    offering_id: Blank()}))),
                        Reset(Self);
                        Reset(Gallery_Cadets_40);
                        Notify("PLEASE ENTER A SEMESTER GREATER THAN 0 OR LESS THAN 10", NotificationType.Error));

                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =4
                  Width: =Text_Input_AY_40.Width
                  X: =Text_Input_AY_40.X
                  Y: =Text_Semester_40.Y
            - Text_Semester_40:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Semester:"
                  Width: =Text_AY_40.Width
                  X: =Text_AY_40.X
                  Y: =(Text_Center_Sponsor_40.Y - (Text_AY_40.Y + Text_AY_40.Height) - Self.Height)/2 + Text_AY_40.Height + Text_AY_40.Y
            - Text_Input_AY_40:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colProject,1).project_ay
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: "=If(\n    Len(Value(Self.Text)) = 4 &&\n    Year(Now()) - Value(Self.Text) <= 1,\n    Patch(colProject, Index(colProject,1), \n        {project_ay: Value(Self.Text)});\n    ForAll(\n        colProjectCadets As cadet, \n        If(IsBlank(cadet.project_cadet_id), \n            Patch(colProjectCadets, LookUp(colProjectCadets, new_cadet_num = cadet.new_cadet_num), \n                {class_num: Blank(), \n                offering_id: Blank()}), \n            Patch(colProjectCadets, LookUp(colProjectCadets, project_cadet_id = cadet.project_cadet_id), \n                {class_num: Blank(), \n                offering_id: Blank()}))), \n    Reset(Self);\n\n    Reset(Gallery_Cadets_40);\n    \n    Notify(\"PLEASE ENTER A 4 DIGIT YEAR NO FURTHER BACK THAN 1 YEAR FROM TODAY\", NotificationType.Error));\n\nUpdateContext({varReadyToSubmit:false});"
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =3
                  Width: =Parent.Width/15
                  X: =Text_Tags_40.X - Self.Width - Parent.Width/50
                  Y: =Text_AY_40.Y
            - Text_AY_40:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="AY:"
                  Width: =Parent.Width/10
                  X: =Text_Input_AY_40.X - Self.Width
                  Y: =Text_Input_Project_Title_40.Y
            - Text_Input_Project_Description_40:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colProject,1).project_description
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Project_Description_40.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =500
                  Mode: =TextMode.MultiLine
                  OnChange: |-
                    =Patch(colProject, Index(colProject,1), {project_description: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =2
                  Width: =Text_Input_Project_Title_40.Width
                  X: =Text_Input_Project_Title_40.X
                  Y: =Text_Project_Description_40.Y
            - Text_Project_Description_40:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height*2
                  Size: =23
                  Text: ="Project Description:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Project_Title_40.Width
                  X: =Text_Project_Title_40.X
                  Y: =Text_Project_Title_40.Y + Text_Project_Title_40.Height + Parent.Height/50
            - Text_Input_Project_Title_40:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colProject,1).project_title
                  DisplayMode: |-
                    =If(
                        CountRows(colProjectFaculty)>0, 
                        If(
                            CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                            varPermissions = "Master" ||
                            varPermissions = "Research", 
                            DisplayMode.Edit, DisplayMode.Disabled),
                        DisplayMode.Edit)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_40.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =500
                  Mode: =TextMode.MultiLine
                  OnChange: |-
                    =Patch(colProject, Index(colProject,1), {project_title: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Text_AY_40.X - Self.X - Parent.Width/50
                  X: =Text_Project_Title_40.X + Text_Project_Title_40.Width
                  Y: =Text_Project_Title_40.Y
            - Text_Project_Title_40:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_40.Height
                  Size: =23
                  Text: ="Project Title"
                  Width: =Parent.Width/12
                  X: =Parent.Width/40
                  Y: =Parent.Height/50
            - Rectangle_Disable_40:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Spinner_40.Visible ||
                        Container_Add_Pictures_40.Visible ||
                        Container_New_Cadet_40.Visible ||
                        Container_New_Org_40.Visible ||
                        Container_New_Collab_40.Visible ||
                        Container_Add_Pictures_40.Visible ||
                        Container_Add_Priorities_40.Visible ||
                        Container_Add_Awards_40.Visible,
                        true, false)
                  Width: =Parent.Width
            - Container_Add_Awards_40:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varAddAward
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Awards_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              CountRows(colProjectAwards) > 0 ,
                              If(
                                  CountRows(Filter(colProjectAwards, IsBlank(project_cadet_id), IsBlank(new_cadet_num))) > 0 ||

                                  CountRows(Filter(colProjectAwards, IsBlank(award_name))) > 0, 

                                  Notify("PLEASE ENSURE YOU HAVE SELECTED A CADET AND AWARD FOR EVERY ENTRY", NotificationType.Error), 

                                  UpdateContext({varAwardChange: true});
                                  UpdateContext({varAddAward:false})), 
                                  UpdateContext({varAddAward:false}))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save Changes"
                        Width: =Self.Height*3.5
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Gallery_Awards_40:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Parent.Height/2
                        Items: =colProjectAwards
                        OnSelect: =
                        TemplateSize: =Text_Input_Change_User_40.Height
                        Width: =Text_Awards_40.Width
                        X: =Text_Awards_40.X
                        Y: =Text_Award_Cadet_40.Y + Text_Award_Cadet_40.Height
                      Children:
                        - Icon_Remove_Awards_40:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.project_award_id)),  
                                    Collect(colRemoveProjectAwards, ThisItem));

                                Remove(colProjectAwards, ThisItem);

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAwardChange:true});
                              Width: =Self.Height
                              X: =Icon_Add_Awards_40.X - Gallery_Awards_40.X
                        - Date_Picker_Award_Updated_40:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderRadius: =10
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: |-
                                =Patch(colProjectAwards, ThisItem, 
                                    {updated_on: Self.SelectedDate});

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAwardChange:true});
                              SelectedDate: =ThisItem.updated_on
                              Width: =Text_Award_Updated_40.Width
                              X: =Text_Award_Updated_40.X - Gallery_Awards_40.X
                              Y: =0.6499999999999986
                        - Dropdown_Award_Won_40:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colYesNo, answer = ThisItem.won)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Filter(colYesNo, answer <> "N/A")
                              OnChange: |-
                                =Patch(colProjectAwards, ThisItem, 
                                    {won: Self.Selected.answer, 
                                    updated_on: Today()});

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAwardChange:true});
                              Width: =Text_Award_Won_40.Width
                              X: =Text_Award_Won_40.X - Gallery_Awards_40.X
                            Children:
                              - answer5:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="answer"
                                    FieldName: ="answer"
                                    FieldType: ="s"
                                    Order: =1
                        - Dropdown_Award_Signed_Up_40:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colYesNo, answer = ThisItem.signed_up)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Filter(colYesNo, Not(IsBlank(answer)), answer <> "N/A")
                              OnChange: |-
                                =Patch(colProjectAwards, ThisItem, 
                                    {signed_up: Self.Selected.answer, 
                                    updated_on: Today()});

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAwardChange:true});
                              Width: =Text_Award_Signed_Up_40.Width
                              X: =Text_Award_Signed_Up_40.X - Gallery_Awards_40.X
                            Children:
                              - answer4:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="answer"
                                    FieldName: ="answer"
                                    FieldType: ="s"
                                    Order: =1
                        - Dropdown_Award_Name_40:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colProjectAwards, award_name = ThisItem.award_name)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =colLookupProjectAwards
                              OnChange: |-
                                =Patch(colProjectAwards, ThisItem, 
                                    {award_name: Self.Selected.award_name, 
                                    updated_on: Today()});

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAwardChange:true});
                              Width: =Text_Award_Name_40.Width
                              X: =Text_Award_Name_40.X - Gallery_Awards_40.X
                            Children:
                              - award_name3:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="award_name"
                                    FieldName: ="award_name"
                                    FieldType: ="s"
                                    Order: =1
                        - Dropdown_Award_Cadet_40:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colProjectCadets, project_cadet_id = ThisItem.project_cadet_id, new_cadet_num = ThisItem.new_cadet_num)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =colProjectCadets
                              OnChange: |-
                                =Patch(colProjectAwards, ThisItem, 
                                    {project_cadet_id: Self.Selected.project_cadet_id, 
                                    new_cadet_num: Self.Selected.new_cadet_num,
                                    updated_on: Today()});

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAwardChange:true});
                              Width: =Text_Award_Cadet_40.Width
                              X: =Text_Award_Cadet_40.X - Gallery_Awards_40.X
                            Children:
                              - cdt_last_name3:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="cdt_last_name"
                                    FieldName: ="cdt_last_name"
                                    FieldType: ="s"
                                    Order: =1
                              - project_cadet_id1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="project_cadet_id"
                                    FieldName: ="project_cadet_id"
                                    FieldType: ="n"
                                    Order: =3
                              - new_cadet_num1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="new_cadet_num"
                                    FieldName: ="new_cadet_num"
                                    FieldType: ="n"
                                    Order: =4
                              - usma_pers_id2:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="usma_pers_id"
                                    FieldName: ="usma_pers_id"
                                    FieldType: ="s"
                                    Order: =4
                        - Separator_Gallery_Awards_40:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Awards_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colProjectAwards,
                              {project_award_id: Blank(),
                              project_id: varProjectID,
                              project_cadet_id: Blank(),
                              new_cadet_num: 0,
                              award_name: Blank(), 
                              signed_up: Blank(),
                              won: Blank(),
                              updated_on: Blank(),
                              new_award_num: Max(colProjectAwards, new_award_num)+1});

                          UpdateContext({varAwardChange:true});

                          UpdateContext({varReadyToSubmit:false});
                        Width: =Self.Height
                        X: =Gallery_Awards_40.Width + Gallery_Awards_40.X - Self.Width - 10
                        Y: =Text_Award_Signed_Up_40.Y
                  - Text_Award_Updated_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Updated"
                        Width: =Icon_Add_Awards_40.X - Self.X - 10
                        X: =Text_Award_Won_40.X + Text_Award_Won_40.Width + 10
                        Y: =Text_Awards_40.Y + Text_Awards_40.Height
                  - Text_Award_Won_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Won"
                        Width: =Parent.Width/10
                        X: =Text_Award_Signed_Up_40.X + Text_Award_Signed_Up_40.Width + 10
                        Y: =Text_Awards_40.Y + Text_Awards_40.Height
                  - Text_Award_Signed_Up_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Signed Up"
                        Width: =Text_Awards_40.Width/6
                        X: =Text_Award_Name_40.X + Text_Award_Name_40.Width + 10
                        Y: =Text_Awards_40.Y + Text_Awards_40.Height
                  - Text_Award_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Award"
                        Width: =Text_Awards_40.Width/6
                        X: =Text_Award_Cadet_40.X + Text_Award_Cadet_40.Width + 10
                        Y: =Text_Awards_40.Y + Text_Awards_40.Height
                  - Text_Award_Cadet_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Last Name"
                        Width: =Text_Awards_40.Width/5
                        X: =Text_Awards_40.X
                        Y: =Text_Awards_40.Y + Text_Awards_40.Height
                  - Text_Awards_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Project Awards"
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
            - Container_Add_Pictures_40:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.Bold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =varAddPictures
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Attachment_Control_Pictures_40:
                      Control: Attachments@2.3.0
                      Properties:
                        AddAttachmentText: ="Attach JPG files"
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Fill: =Color.White
                        Font: =Font.'Open Sans'
                        Height: =Button_Cancel_Add_Pictures_40.Y
                        HoverFill: =RGBA(186, 202, 226, 1)
                        ItemColor: =RGBA(255, 255, 255, 1)
                        ItemFill: =RGBA(56, 96, 178, 1)
                        ItemHoverFill: =RGBA(186, 202, 226, 1)
                        NoAttachmentsText: ="Drag and drop up to 6 JPG pictures at a time"
                        OnAddFile: "=UpdateContext({varAddPictures: false});\n\nUpdateContext({varShowSpinner: true});\n\nForAll(\n    Attachment_Control_Pictures_40.Attachments As FILE, \n    If(\n        Not(IsNumeric(Find(\"jpg\", Lower(FILE.Name), Len(FILE.Name)-3))), \n        Reset(Self);\n        Notify(\"PLEASE ONLY UPLOAD .JPG FILES\",NotificationType.Error)));\n    \nForAll(\n    Attachment_Control_Pictures_40.Attachments As FILE,\n    Patch(project_pictures, Defaults(project_pictures),\n    {project_id: Index(colProject,1).project_id, \n    picture_link: 'Math-ProjectsUploadPictures'.Run(\n        {contentBytes:FILE.Value, name:FILE.Name},\n        Index(colProject,1).project_id, \n        Index(colProject,1).project_ay).link}));\n\nReset(Self);\n\nRefresh(project_pictures);\n\nClearCollect(colProjectPictures, \n    Filter(project_pictures, project_id = Index(colProject,1).project_id));\n\nReset(Gallery_Pictures_40);\n\nUpdateContext({varShowSpinner: false})"
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 18, 107, 1)
                        Width: =Parent.Width/2
                  - Button_Cancel_Add_Pictures_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_40.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(Self.Fill, -20%)
                        OnSelect: |-
                          =UpdateContext({varAddPictures: false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Container_Projects_Details_40.Width/11
                        X: =Attachment_Control_Pictures_40.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Gallery_Pictures_40:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Height: =Parent.Height - Parent.Height/20
                        Items: =colProjectPictures
                        TemplateSize: =Parent.Width/2
                        Visible: =varAddPictures
                        Width: =Parent.Width/2 - Parent.Width/20
                        X: =Parent.Width - Self.Width - Parent.Width/40
                        Y: =Parent.Height/40
                      Children:
                        - Subtitle_Image_Link_40:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =Self.Size * 1.8
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0
                              PaddingLeft: =0
                              PaddingRight: =0
                              PaddingTop: =0
                              Size: =12
                              Text: =ThisItem.picture_link
                              VerticalAlign: =VerticalAlign.Top
                              Width: =Image_Project_40.Width
                              X: =Image_Project_40.X
                              Y: =Image_Project_40.Y + Image_Project_40.Height + Parent.Height/30
                        - Image_Project_40:
                            Control: Image@2.2.3
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Height: =Parent.Height - Subtitle_Image_Link_40.Height - Self.Y - Parent.Height/15
                              Image: =ThisItem.picture_link
                              ImagePosition: =ImagePosition.Fill
                              OnSelect: =Select(Parent)
                              RadiusBottomLeft: =8
                              RadiusBottomRight: =8
                              RadiusTopLeft: =8
                              RadiusTopRight: =8
                              Width: =Parent.TemplateWidth
                              X: =Parent.TemplateWidth/2 - Self.Width/2
            - Container_Add_Priorities_40:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varAddPriorities
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Priorities_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              CountRows(colProjectPriorities) <> CountRows(Distinct(colProjectPriorities, priority_id)), 
                              Notify("PLEASE REMOVE DUPLICATE PRIORITIES", NotificationType.Error), 

                              RemoveIf(colProjectPriorities, IsBlank(priority_id));

                              UpdateContext({varAddPriorities:false});
                              UpdateContext({varPriorityChange:false}))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save Changes"
                        Width: =Self.Height*3.5
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Gallery_Priorities_40:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Parent.Height/2
                        Items: =colProjectPriorities
                        OnSelect: =
                        TemplateSize: =Text_Input_Change_User_40.Height
                        Width: =Text_Priorities_40.Width
                        X: =Text_Priorities_40.X
                        Y: =Text_Priority_Name_40.Y + Text_Priority_Name_40.Height
                      Children:
                        - Icon_Remove_Priorities_40:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.project_priority_id)),
                                    Collect(colRemoveProjectPriorities, ThisItem)); 

                                Remove(colProjectPriorities, ThisItem);

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varPriorityChange:true});
                              Visible: =If(IsBlank(ThisItem.project_priority_id),true, false)
                              Width: =Self.Height
                              X: =Icon_Add_Priorities_40.X - Gallery_Priorities_40.X
                        - Text_Input_Priority_AY_40:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              Default: =ThisItem.ay
                              DisplayMode: =DisplayMode.View
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =Select(Parent)
                              Width: =Text_Priority_AY_40.Width
                              X: =Text_Priority_AY_40.X - Gallery_Priorities_40.X
                        - Text_Input_Priority_Num_40:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =RGBA(0, 18, 107, 1)
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              Default: =ThisItem.priority_num
                              DisplayMode: =DisplayMode.View
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =Select(Parent)
                              Width: =Text_Priority_Num_40.Width
                              X: =Text_Priority_Num_40.X - Gallery_Priorities_40.X
                        - Text_Input_Proponent_Name_40:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              Default: =ThisItem.proponent_name
                              DisplayMode: =DisplayMode.View
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =Select(Parent)
                              Width: =Text_Proponent_Name_40.Width
                              X: =Text_Proponent_Name_40.X - Gallery_Priorities_40.X
                        - Dropdown_Priority_Name_40:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colLookupPriority, priority_name = ThisItem.priority_name)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Filter(colLookupPriority, ay = ThisItem.ay)
                              OnChange: |-
                                =Patch(colProjectPriorities, ThisItem, 
                                    {priority_name: Self.Selected.priority_name, 
                                    priority_id: Self.Selected.priority_id, 
                                    priority_num: Self.Selected.priority_num, 
                                    proponent_name: Self.Selected.proponent_name});

                                Reset(Text_Input_Proponent_Name_40);
                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varPriorityChange:true});

                                UpdateContext({varAwardChange:true});
                              Width: =Text_Priority_Name_40.Width
                              X: =Text_Priority_Name_40.X - Gallery_Priorities_40.X
                            Children:
                              - priority_name1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="priority_name"
                                    FieldName: ="priority_name"
                                    FieldType: ="s"
                                    Order: =1
                              - priority_num1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="priority_num"
                                    FieldName: ="priority_num"
                                    FieldType: ="n"
                                    Order: =3
                              - proponent_name1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="proponent_name"
                                    FieldName: ="proponent_name"
                                    FieldType: ="s"
                                    Order: =4
                              - priority_id1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="priority_id"
                                    FieldName: ="priority_id"
                                    FieldType: ="n"
                                    Order: =2
                        - Separator_Gallery_Priorities_40:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Priorities_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colProjectPriorities, 
                              {new_priority_num: Max(colProjectPriorities, new_priority_num)+1, 
                              ay: Index(colProject,1).project_ay, 
                              priority_id: Blank(), 
                              priority_name: Blank(), 
                              priority_num: Blank(), 
                              project_priority_id: Blank(), 
                              proponent_name: Blank()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varPriorityChange:true});
                        Width: =Self.Height
                        X: =Gallery_Priorities_40.Width + Gallery_Priorities_40.X - Self.Width - 10
                        Y: =Text_Priority_Num_40.Y
                  - Text_Priority_AY_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="FY/AY"
                        Width: =Icon_Add_Priorities_40.X - Self.X
                        X: =Text_Priority_Num_40.X + Text_Priority_Num_40.Width + 10
                        Y: =Text_Priority_Num_40.Y
                  - Text_Priority_Num_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Priority Num"
                        Width: =Text_Priorities_40.Width/6
                        X: =Text_Proponent_Name_40.X + Text_Proponent_Name_40.Width + 10
                        Y: =Text_Priorities_40.Y + Text_Priorities_40.Height
                  - Text_Proponent_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Proponent"
                        Width: =Text_Priorities_40.Width/5
                        X: =Text_Priority_Name_40.X + Text_Priority_Name_40.Width + 10
                        Y: =Text_Priorities_40.Y + Text_Priorities_40.Height
                  - Text_Priority_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Priority Name"
                        Width: =Text_Priorities_40.Width/3
                        X: =Text_Priorities_40.X
                        Y: =Text_Priorities_40.Y + Text_Priorities_40.Height
                  - Text_Priorities_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_40.Height
                        Size: =23
                        Text: ="Project Priorities"
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
            - Container_New_Collab_40:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.25
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =If(varCollabMissing = Blank(), false, true)
                  Width: =Parent.Width/1.25
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Confirm_Add_Org_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(varReadyToSubmit, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |
                          =UpdateContext({varShowSpinner:true});

                          Patch(lookup_sponsors_collaborators, Defaults(lookup_sponsors_collaborators), 
                              {spon_collab_last_name: Upper(Text_Input_New_Collaborator_Last_Name_40.Text),
                              spon_collab_first_name: Upper(Text_Input_New_Collaborator_First_Name_40.Text), 
                              spon_collab_email: Upper(Text_Input_New_Collaborator_Email_40.Text), 
                              org_id: Dropdown_New_Collaborator_Org_Name_40.Selected.org_id});

                          ClearCollect(colLookupCollaborators, lookup_sponsors_collaborators);

                          Reset(Text_Input_New_Collaborator_Last_Name_40);
                          Reset(Text_Input_New_Collaborator_First_Name_40);
                          Reset(Text_Input_New_Collaborator_Email_40);
                          Reset(Dropdown_New_Collaborator_Org_Name_40);
                          Reset(Gallery_Collaborators_40);
                          UpdateContext({varCollabMissing:Blank()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varShowSpinner:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Add Collaborator"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Check_Org_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(Not(varReadyToSubmit), 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              Not(IsBlank(Text_Input_New_Collaborator_Last_Name_40.Text)) &&
                              Not(IsBlank(Text_Input_New_Collaborator_Last_Name_40.Text)) &&
                              Not(IsBlank(Text_Input_New_Collaborator_Email_40.Text)) &&
                              Not(IsBlank(Dropdown_New_Collaborator_Org_Name_40.Selected.org_id)), 
                              UpdateContext({varReadyToSubmit:true});
                              Notify("CLICK ADD COLLABORATOR TO SUBMIT CHANGES",NotificationType.Success), 
                              UpdateContext({varReadyToSubmit:false});
                              Notify("PLEASE ENSURE ALL FIELDS OUTLINED IN RED ARE FILLED OUT", NotificationType.Error));
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Check"
                        Width: =Self.Height*3
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Org_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Text_Input_New_Collaborator_Last_Name_40);
                          Reset(Text_Input_New_Collaborator_First_Name_40);
                          Reset(Text_Input_New_Collaborator_Email_40);
                          Reset(Dropdown_New_Collaborator_Org_Name_40);

                          UpdateContext({varCollabMissing:Blank()});

                          UpdateContext({varReadyToSubmit:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Refresh_Orgs_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowSpinner:true});

                          ClearCollect(colLookupOrgs, lookup_org_view);

                          Reset(Dropdown_New_Collaborator_Org_Name_40);

                          UpdateContext({varShowSpinner:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Refresh Orgs"
                        Width: =Button_New_Org_40.Width
                        X: =Text_Input_New_Collaborator_Parent_Org_40.X + Text_Input_New_Collaborator_Parent_Org_40.Width - Self.Width
                        Y: =Text_New_Collaborator_Parent_Org_40.Y + Text_New_Collaborator_Parent_Org_40.Height + Parent.Height/40
                  - Button_New_Org_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varNewOrg: true});

                          ClearCollect(colStates, {state:Blank()}, {state:"AK"}, {state:"AL"}, {state:"AR"}, {state:"AS"}, {state:"AZ"}, {state:"CA"}, {state:"CO"}, {state:"CT"}, {state:"DC"}, {state:"DE"}, {state:"FL"}, {state:"GA"}, {state:"GU"}, {state:"HI"}, {state:"IA"}, {state:"ID"}, {state:"IL"}, {state:"IN"}, {state:"KS"}, {state:"KY"}, {state:"LA"}, {state:"MA"}, {state:"MD"}, {state:"ME"}, {state:"MI"}, {state:"MN"}, {state:"MO"}, {state:"MP"}, {state:"MS"}, {state:"MT"}, {state:"NC"}, {state:"ND"}, {state:"NE"}, {state:"NH"}, {state:"NJ"}, {state:"NM"}, {state:"NV"}, {state:"NY"}, {state:"OH"}, {state:"OK"}, {state:"OR"}, {state:"PA"}, {state:"PR"}, {state:"RI"}, {state:"SC"}, {state:"SD"}, {state:"TN"}, {state:"TT"}, {state:"TX"}, {state:"UT"}, {state:"VA"}, {state:"VI"}, {state:"VT"}, {state:"WA"}, {state:"WI"}, {state:"WV"}, {state:"WY"});

                          UpdateContext({varReadyToSubmit:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Org not listed?"
                        Width: =(Text_New_Collaborator_Org_Name_40.Width + Dropdown_New_Collaborator_Org_Name_40.Width)/2 - Parent.Width/60
                        X: =Text_New_Collaborator_Parent_Org_40.X
                        Y: =Text_New_Collaborator_Parent_Org_40.Y + Text_New_Collaborator_Parent_Org_40.Height + Parent.Height/40
                  - Text_Input_New_Collaborator_Parent_Org_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(colLookupOrgs, org_id = Dropdown_New_Collaborator_Org_Name_40.Selected.org_id).parent_org_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Collect(colProjectCollaborators, 
                              {first_name: Upper(Self.Text)})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Dropdown_New_Collaborator_Org_Name_40.Width
                        X: =Dropdown_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Parent_Org_40.Y
                  - Text_New_Collaborator_Parent_Org_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="Parent Org:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Location_40.Y + Text_New_Collaborator_Org_Location_40.Height + Parent.Height/40
                  - Text_Input_New_Collaborator_Org_Location_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =Concatenate(
                              LookUp(colLookupOrgs, org_id = Dropdown_New_Collaborator_Org_Name_40.Selected.org_id).org_city,
                              ", ",
                              LookUp(colLookupOrgs, org_id = Dropdown_New_Collaborator_Org_Name_40.Selected.org_id).org_state,
                              ", ",
                              LookUp(colLookupOrgs, org_id = Dropdown_New_Collaborator_Org_Name_40.Selected.org_id).org_country)
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Collect(colProjectCollaborators, 
                              {first_name: Upper(Self.Text)})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Dropdown_New_Collaborator_Org_Name_40.Width
                        X: =Dropdown_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Location_40.Y
                  - Text_New_Collaborator_Org_Location_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="Org Location:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Type_40.Y + Text_New_Collaborator_Org_Type_40.Height + Parent.Height/40
                  - Text_Input_New_Collaborator_Org_Type_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(colLookupOrgs, org_id = Dropdown_New_Collaborator_Org_Name_40.Selected.org_id).org_type
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Collect(colProjectCollaborators, 
                              {first_name: Upper(Self.Text)})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Dropdown_New_Collaborator_Org_Name_40.Width
                        X: =Dropdown_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Type_40.Y
                  - Text_New_Collaborator_Org_Type_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="Org Type:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Abbrev_40.Y + Text_New_Collaborator_Org_Abbrev_40.Height + Parent.Height/40
                  - Text_Input_New_Collaborator_Org_Abbrev_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(colLookupOrgs, org_id = Dropdown_New_Collaborator_Org_Name_40.Selected.org_id).org_abbrev
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Collect(colProjectCollaborators, 
                              {first_name: Upper(Self.Text)})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Dropdown_New_Collaborator_Org_Name_40.Width
                        X: =Dropdown_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Abbrev_40.Y
                  - Text_New_Collaborator_Org_Abbrev_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="Abbreviation:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_Org_Name_40.X
                        Y: =Text_New_Collaborator_Org_Name_40.Y + Text_New_Collaborator_Org_Name_40.Height + Parent.Height/40
                  - Dropdown_New_Collaborator_Org_Name_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colCenters, center_id = Index(colProject,1).center_id)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Items: =Sort(colLookupOrgs, org_name, SortOrder.Ascending)
                        OnChange: =UpdateContext({varReadyToSubmit:false});
                        Width: =Text_New_Collaborator_Org_Info_40.Width + Text_New_Collaborator_Org_Info_40.X - Self.X - Parent.Width/40
                        X: =Text_New_Collaborator_Org_Name_40.X + Text_New_Collaborator_Org_Name_40.Width
                        Y: =Text_New_Collaborator_Org_Name_40.Y
                      Children:
                        - org_abbrev1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_abbrev"
                              FieldName: ="org_abbrev"
                              FieldType: ="s"
                              Order: =4
                        - org_city1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_city"
                              FieldName: ="org_city"
                              FieldType: ="s"
                              Order: =5
                        - org_country1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_country"
                              FieldName: ="org_country"
                              FieldType: ="s"
                              Order: =6
                        - org_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_id"
                              FieldName: ="org_id"
                              FieldType: ="n"
                              Order: =7
                        - org_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_name"
                              FieldName: ="org_name"
                              FieldType: ="s"
                              Order: =3
                        - org_state1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_state"
                              FieldName: ="org_state"
                              FieldType: ="s"
                              Order: =8
                        - org_type1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_type"
                              FieldName: ="org_type"
                              FieldType: ="s"
                              Order: =9
                        - parent_org_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="parent_org_name"
                              FieldName: ="parent_org_name"
                              FieldType: ="s"
                              Order: =2
                        - org_and_parent1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_and_parent"
                              FieldName: ="org_and_parent"
                              FieldType: ="s"
                              Order: =1
                  - Text_New_Collaborator_Org_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="Organization:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_Input_New_Collaborator_Last_Name_40.X + Text_Input_New_Collaborator_Last_Name_40.Width + Parent.Width/40
                        Y: =Text_Input_New_Collaborator_Last_Name_40.Y
                  - Text_New_Collaborator_Org_Info_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Organization Info"
                        Width: =Parent.Width/2
                        X: =Parent.Width/2
                        Y: =Parent.Height/40
                  - Text_Input_New_Collaborator_Email_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =UpdateContext({varReadyToSubmit:false});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Text_Input_New_Collaborator_Last_Name_40.Width
                        X: =Text_Input_New_Collaborator_Last_Name_40.X
                        Y: =Text_New_Collaborator_Email_40.Y
                  - Text_New_Collaborator_Email_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="Email:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_Last_Name_40.X
                        Y: =Text_New_Collaborator_First_Name_40.Y + Text_New_Collaborator_First_Name_40.Height + Parent.Height/40
                  - Text_Input_New_Collaborator_First_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =UpdateContext({varReadyToSubmit:false});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_First_Name_40.X + Text_New_Collaborator_First_Name_40.Width
                        Y: =Text_New_Collaborator_First_Name_40.Y
                  - Text_New_Collaborator_First_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        Size: =24
                        Text: ="First Name:"
                        Width: =Text_New_Collaborator_Last_Name_40.Width
                        X: =Text_New_Collaborator_Last_Name_40.X
                        Y: =Text_New_Collaborator_Last_Name_40.Y + Text_New_Collaborator_Last_Name_40.Height + Parent.Height/40
                  - Text_Input_New_Collaborator_Last_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Collaborator_Last_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =UpdateContext({varReadyToSubmit:false});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_New_Collaborator_Info_40.Width - Self.X - Parent.Width/40
                        X: =Text_New_Collaborator_Last_Name_40.X + Text_New_Collaborator_Last_Name_40.Width
                        Y: =Text_New_Collaborator_Last_Name_40.Y
                  - Text_New_Collaborator_Last_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Last Name"
                        Width: =Text_New_Collaborator_Info_40.Width/3
                        X: =Parent.Width/40
                        Y: =Text_New_Collaborator_Info_40.Y + Text_New_Collaborator_Info_40.Height + Parent.Height/20
                  - Text_New_Collaborator_Info_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Collaborator Info"
                        Width: =Parent.Width/2
                        Y: =Parent.Height/40
            - Container_New_Org_40:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: |-
                    =If(varNewOrg <> Blank(),
                        true, false)
                  Width: =Parent.Width/1.5
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Confirm_Add_Org_41:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: =If(varReadyToSubmit, DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowSpinner:true});

                          Patch(lookup_orgs, Defaults(lookup_orgs), 
                              {org_name: Upper(Text_Input_New_Org_Name_40.Text), 
                              org_abbrev: Upper(Text_Input_New_Org_Abbrev_40.Text), 
                              org_type: Dropdown_New_Org_Type_40.Selected.Value, 
                              org_city: Upper(Text_Input_New_Org_City_40.Text), 
                              org_state: If(
                                  Radio_New_Org_Country_40.Selected.answer = "YES", 
                                  Dropdown_New_Org_State_40.Selected.state, 
                                  Upper(Text_Input_New_Org_State_40.Text)), 
                              org_country: If(
                                  Radio_New_Org_Country_40.Selected.answer = "YES",
                                  "USA",
                                  Upper(Text_Input_New_Org_Country_40.Text)),
                              parent_org_id:
                                  If(varMissingParent,
                                      Blank(),
                                      Dropdown_New_Org_Parent_Org_40.Selected.org_id)});

                          UpdateContext({varNewOrg:Blank()});
                          UpdateContext({varMissingParent:false});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varOrgReset:true});
                          UpdateContext({varOrgReset:false});
                          Reset(Dropdown_New_Org_Type_40);
                          Reset(Dropdown_New_Org_State_40);
                          Reset(Dropdown_New_Org_Parent_Org_40);

                          ClearCollect(colLookupOrgs, lookup_org_view);

                          Reset(Dropdown_New_Collaborator_Org_Name_40);

                          UpdateContext({varShowSpinner:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Add Organization"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Check_Add_Org_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(Not(varReadyToSubmit), 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              Not(IsBlank(Text_Input_New_Org_Name_40.Text)) && 
                              Not(IsBlank(Text_Input_New_Org_Abbrev_40.Text)) &&
                              Not(IsBlank(Dropdown_New_Org_Type_40.Selected.Value)) &&
                              Not(IsBlank(Radio_New_Org_Country_40.Selected.answer)) &&
                              If(Radio_New_Org_Country_40.Selected.answer = "NO",
                                  If(
                                      Not(IsBlank(Text_Input_New_Org_Country_40.Text)) &&
                                      Not(IsBlank(Text_Input_New_Org_State_40.Text)), 
                                      true, false), 
                                  If(
                                      Not(IsBlank(Dropdown_New_Org_State_40.Selected.state)), 
                                      true, false)) &&
                              Not(IsBlank(Text_Input_New_Org_City_40.Text)) &&
                              If(
                                  varMissingParent,
                                  true,
                                  If(
                                      Not(IsBlank(Dropdown_New_Org_Parent_Org_40.Selected)),
                                      true, false)),
                              UpdateContext({varReadyToSubmit:true});
                              Notify("CLICK ADD ORGANIZATION TO SUBMIT CHANGES",NotificationType.Success),
                              UpdateContext({varReadyToSubmit:false});
                              Notify("PLEASE ENSURE ALL FIELDS OUTLINED IN RED ARE FILLED OUT", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Check"
                        Width: =Self.Height*3
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Org_41:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |
                          =UpdateContext({varNewOrg:Blank()});
                          UpdateContext({varMissingParent:false});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varOrgReset:true});
                          UpdateContext({varOrgReset:false});
                          Reset(Dropdown_New_Org_Type_40);
                          Reset(Dropdown_New_Org_State_40);
                          Reset(Dropdown_New_Org_Parent_Org_40);
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Missing_Parent_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              varMissingParent, 
                              UpdateContext({varMissingParent: false}),
                              UpdateContext({varMissingParent: true}));

                          Reset(Dropdown_New_Org_Parent_Org_40);
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: |-
                          =If(
                              varMissingParent, 
                              "Parent Listed", 
                              "Parent Missing")
                        Visible: =varNewOrg
                        Width: =Text_Input_Parent_Org_Search_40.Width
                        X: =Text_Input_Parent_Org_Search_40.X
                        Y: =Text_Input_Parent_Org_Search_40.Y + Text_Input_Parent_Org_Search_40.Height + Parent.Height/40
                  - Dropdown_New_Org_Parent_Org_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_New_Org_Name_40.Height
                        Items: |-
                          =If( 
                              Not(IsBlank(Text_Input_Parent_Org_Search_40.Text)),
                              Sort(Filter(colLookupOrgs, Text_Input_Parent_Org_Search_40.Text in org_and_parent), org_name, SortOrder.Ascending),
                              Sort(colLookupOrgs, org_name, SortOrder.Ascending))
                        OnChange: =UpdateContext({varReadyToSubmit:false});
                        Visible: =Not(varMissingParent)
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_New_Org_City_40.X
                        Y: =Text_New_Org_Parent_Org_40.Y
                      Children:
                        - org_and_parent2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_and_parent"
                              FieldName: ="org_and_parent"
                              FieldType: ="s"
                              Order: =1
                        - org_name3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_name"
                              FieldName: ="org_name"
                              FieldType: ="s"
                              Order: =2
                        - org_id3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_id"
                              FieldName: ="org_id"
                              FieldType: ="n"
                              Order: =3
                  - Text_Input_Parent_Org_Search_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =0
                        Default: =""
                        Fill: =RGBA(177, 179, 179, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Info_40.Height
                        HintText: ="Search Orgs"
                        HoverBorderColor: =
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Reset(Text_Input_Advisor_Search_30);
                          Reset(Text_Input_Course_Search_30);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varOrgReset
                        Visible: =Not(varMissingParent)
                        Width: =Text_Input_New_Org_City_40.Width
                        X: =Text_Input_New_Org_State_40.X
                        Y: =Text_New_Org_Parent_Org_40.Y
                  - Icon_Cancel_Parent_Org_Search_40:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(156, 156, 156, 1)
                        Height: =Text_Input_Parent_Org_Search_40.Height*3/4
                        Icon: =Icon.Cancel
                        OnSelect: =Reset(Text_Input_Parent_Org_Search_40);
                        Visible: =Not(varMissingParent)
                        Width: =Self.Height
                        X: =Text_Input_Parent_Org_Search_40.X + Text_Input_Parent_Org_Search_40.Width - Self.Width
                        Y: =Text_Input_Parent_Org_Search_40.Y + Text_Input_Parent_Org_Search_40.Height/8
                  - Text_New_Org_Parent_Org_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Parent Org:"
                        Visible: =Not(varMissingParent)
                        Width: =Text_New_Org_Name_40.Width
                        X: =Text_New_Org_State_40.X
                        Y: =Text_New_Org_State_40.Y + Text_New_Org_State_40.Height + Parent.Height/40
                  - Text_Input_New_Org_City_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |
                          =UpdateContext({varReadyToSubmit:false});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varOrgReset
                        Width: =Text_Input_New_Org_Abbrev_40.Width
                        X: |-
                          =//Text_New_Org_Abbrev_40.X + Text_New_Org_Abbrev_40.Width
                          Text_Input_New_Org_Country_40.X
                        Y: =Text_New_Org_City_40.Y
                  - Text_New_Org_City_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Org City:"
                        Width: =Text_New_Org_Name_40.Width
                        X: |-
                          =//Text_New_Org_Name_40.X
                          Text_New_Org_Country_41.X
                        Y: =Text_New_Org_Country_40.Y + Text_New_Org_Country_40.Height + Parent.Height/40
                  - Text_Input_New_Org_State_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =UpdateContext({varReadyToSubmit:false});

                          Reset(Dropdown_New_Org_State_40);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varOrgReset
                        Visible: |-
                          =If(Radio_New_Org_Country_40.Selected.answer = "YES",
                              false, true)
                        Width: =Dropdown_New_Org_State_40.Width
                        X: =Dropdown_New_Org_State_40.X
                        Y: =Text_New_Org_State_40.Y
                  - Dropdown_New_Org_State_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_New_Org_Name_40.Height
                        Items: =colStates
                        OnChange: |-
                          =UpdateContext({varReadyToSubmit:false});

                          Reset(Text_Input_New_Org_State_40);
                        Visible: |-
                          =If(Radio_New_Org_Country_40.Selected.answer = "YES",
                              true, false)
                        Width: =Text_Input_New_Org_Abbrev_40.Width
                        X: |-
                          =//Text_Input_New_Org_Country_40.X
                          Text_New_Org_Abbrev_40.X + Text_New_Org_Abbrev_40.Width
                        Y: =Text_New_Org_State_40.Y
                      Children:
                        - state2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="state"
                              FieldName: ="state"
                              FieldType: ="s"
                              Order: =1
                  - Text_New_Org_State_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Org State Abbrev:"
                        Width: =Text_New_Org_Name_40.Width
                        X: |-
                          =//Text_New_Org_Country_41.X
                          Text_New_Org_Name_40.X
                        Y: =Text_New_Org_City_40.Y
                  - Text_Input_New_Org_Country_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =UpdateContext({varReadyToSubmit:false});
                          Reset(Dropdown_New_Org_State_40);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varOrgReset
                        Visible: |-
                          =If(Radio_New_Org_Country_40.Selected.answer = "YES",
                              false, true)
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_New_Org_Country_41.X + Text_New_Org_Country_41.Width
                        Y: =Text_New_Org_Country_41.Y
                  - Text_New_Org_Country_41:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Org Country:"
                        Visible: |-
                          =If(Radio_New_Org_Country_40.Selected.answer = "YES",
                              false, true)
                        Width: =Text_New_Org_Type_40.Width
                        X: =Radio_New_Org_Country_40.X + Radio_New_Org_Country_40.Width + Parent.Width/40
                        Y: =Text_New_Org_Type_40.Y + Text_New_Org_Type_40.Height + Parent.Height/40
                  - Radio_New_Org_Country_40:
                      Control: Radio@0.0.25
                      Properties:
                        DefaultSelectedItems: =Filter(colYesNo, answer = "YES")
                        Height: =Text_New_Org_Name_40.Height
                        Items: =Filter(colYesNo, answer <> "N/A", answer <> Blank())
                        Layout: ='RadioGroupCanvas.Layout'.Horizontal
                        OnChange: |-
                          =UpdateContext({varReadyToSubmit:false});
                          Reset(Text_Input_New_Org_Country_40);
                          Reset(Text_Input_New_Org_State_40);
                          Reset(Dropdown_New_Org_State_40);
                        Width: =Text_Input_New_Org_Abbrev_40.Width
                        X: =Text_Input_New_Org_Abbrev_40.X
                        Y: =Text_New_Org_Country_40.Y
                      Children:
                        - answer6:
                            Control: RadioDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="answer"
                              FieldName: ="answer"
                              FieldType: ="s"
                              Order: =1
                  - Text_New_Org_Country_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Org in US?"
                        Width: =Text_New_Org_Name_40.Width
                        X: =Text_New_Org_Name_40.X
                        Y: =Text_New_Org_Type_40.Y + Text_New_Org_Type_40.Height + Parent.Height/40
                  - Dropdown_New_Org_Type_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colCenters, center_id = Index(colProject,1).center_id)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_New_Org_Name_40.Height
                        Items: =Distinct(colLookupOrgs, org_type)
                        OnChange: |
                          =UpdateContext({varReadyToSubmit:false});
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_New_Org_Type_40.X + Text_New_Org_Type_40.Width
                        Y: =Text_New_Org_Type_40.Y
                      Children:
                        - Value1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="Value"
                              FieldName: ="Value"
                              FieldType: ="s"
                              Order: =1
                  - Text_New_Org_Type_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Org Type:"
                        Width: =Text_New_Org_Name_40.Width
                        X: =Text_Input_New_Org_Abbrev_40.X + Text_Input_New_Org_Abbrev_40.Width + Parent.Width/40
                        Y: =Text_New_Org_Abbrev_40.Y
                  - Text_Input_New_Org_Abbrev_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |
                          =UpdateContext({varReadyToSubmit:false});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varOrgReset
                        Width: =Text_Input_New_Org_Name_40.Width/3
                        X: =Text_New_Org_Abbrev_40.X + Text_New_Org_Abbrev_40.Width
                        Y: =Text_New_Org_Abbrev_40.Y
                  - Text_New_Org_Abbrev_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Org_Name_40.Height
                        Size: =24
                        Text: ="Org Abbreviation:"
                        Width: =Text_New_Org_Name_40.Width
                        X: =Text_New_Org_Name_40.X
                        Y: =Text_New_Org_Name_40.Y + Text_New_Org_Name_40.Height + Parent.Height/40
                  - Text_Input_New_Org_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Org_Name_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =UpdateContext({varReadyToSubmit:false});
                          Reset(Dropdown_New_Org_Parent_Org_40);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varOrgReset
                        Width: =Text_New_Org_Info_40.Width - Self.X - Parent.Width/40
                        X: =Text_New_Org_Name_40.X + Text_New_Org_Name_40.Width
                        Y: =Text_New_Org_Name_40.Y
                  - Text_New_Org_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Org Name:"
                        Width: =Text_New_Org_Info_40.Width/5
                        X: =Parent.Width/40
                        Y: =Text_New_Org_Info_40.Y + Text_New_Org_Info_40.Height + Parent.Height/20
                  - Text_New_Org_Info_40:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Add a New Organization"
                        Width: =Parent.Width
                        Y: =Parent.Height/40
            - Container_New_Cadet_40:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: |-
                    =If(varNewCadet = true, true, false)
                    //false
                  Width: =Parent.Width/2
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Confirm_Add_Cadet_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              Not(IsBlank(Value(Text_Input_New_Cadet_Class_Year_40.Text))),
                              Collect(colProjectCadets,  
                                  {cdt_first_name: Text_Input_New_Cadet_First_Name_40.Text,
                                  cdt_last_name: Text_Input_New_Cadet_Last_Name_40.Text, 
                                  usma_pers_id: Text_Input_New_Cadet_C_Num_40.Text,
                                  grad_year: Value(Text_Input_New_Cadet_Class_Year_40.Text),
                                  major_1: Text_Input_New_Cadet_Major_40.Text,
                                  major_2: Text_Input_New_Cadet_Major_2_40.Text,
                                  cdt_wp_email: Upper(Dropdown_wp_Email_40.Selected.UserPrincipalName), 
                                  new_cadet_num: Max(colProjectCadets, new_cadet_num)+1});

                              Reset(Text_Input_New_Cadet_Last_Name_Search_40);
                              Reset(Dropdown_wp_Email_40);

                              UpdateContext({varNewCadet:false}),
                              Notify("PLEASE ENSURE YOU SELECT A CADET", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Add Cadet to Project"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Cadet_40:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Text_Input_New_Cadet_Last_Name_Search_40);
                          Reset(Dropdown_wp_Email_40);

                          UpdateContext({varNewCadet:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Image_Cadet_40:
                      Control: Image@2.2.3
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Height: =Text_New_Cadet_Major_41.Y - Text_New_Cadet_Major_41.Height
                        Image: |-
                          =If(
                          !IsBlank(Dropdown_wp_Email_40.Selected.UserPrincipalName),
                          Office365Users.UserPhoto(Dropdown_wp_Email_40.Selected.UserPrincipalName)
                          )
                        ImagePosition: =ImagePosition.Fill
                        RadiusBottomLeft: =50
                        RadiusBottomRight: =50
                        RadiusTopLeft: =50
                        RadiusTopRight: =50
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Dropdown_wp_Email_40.X
                        Y: =Text_New_Cadet_Last_Name_40.Y
                  - Text_Input_New_Cadet_Major_2_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_wp_Email_40.Selected.UserPrincipalName).major_code_2
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Tooltip: =LookUp(lookup_major, major_code = Self.Text).major_name
                        Width: =Text_Input_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Major_41.Y
                  - Text_New_Cadet_Major_41:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Size: =24
                        Text: ="Major 2:"
                        Width: =Text_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Major_40.Y + Text_New_Cadet_Major_40.Height + Parent.Height/40
                  - Text_Input_New_Cadet_Major_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_wp_Email_40.Selected.UserPrincipalName).major_code_1
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Tooltip: =LookUp(lookup_major, major_code = Self.Text).major_name
                        Width: =Text_Input_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Major_40.Y
                  - Text_New_Cadet_Major_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Size: =24
                        Text: ="Major 1:"
                        Width: =Text_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Class_Year_40.Y + Text_New_Cadet_Class_Year_40.Height + Parent.Height/40
                  - Text_Input_New_Cadet_Class_Year_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_wp_Email_40.Selected.UserPrincipalName).grad_year
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Class_Year_40.Y
                  - Text_New_Cadet_Class_Year_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Size: =24
                        Text: ="Class:"
                        Width: =Text_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_C_Num_40.Y + Text_New_Cadet_C_Num_40.Height + Parent.Height/40
                  - Text_Input_New_Cadet_C_Num_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_wp_Email_40.Selected.UserPrincipalName).usma_pers_id
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_C_Num_40.Y
                  - Text_New_Cadet_C_Num_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Size: =24
                        Text: ="C Number:"
                        Width: =Text_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_First_Name_40.Y + Text_New_Cadet_First_Name_40.Height + Parent.Height/40
                  - Text_Input_New_Cadet_First_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_wp_Email_40.Selected.UserPrincipalName).first_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_First_Name_40.Y
                  - Text_New_Cadet_First_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Size: =24
                        Text: ="First Name:"
                        Width: =Text_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Last_Name_40.Y + Text_New_Cadet_Last_Name_40.Height + Parent.Height/40
                  - Text_Input_New_Cadet_Last_Name_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_wp_Email_40.Selected.UserPrincipalName).last_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Last_Name_40.Y
                  - Text_New_Cadet_Last_Name_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Size: =24
                        Text: ="Last Name:"
                        Width: =Text_New_Cadet_Last_Name_Search_40.Width
                        X: =Text_New_Cadet_Last_Name_Search_40.X
                        Y: =Text_New_Cadet_Last_Name_Search_40.Y + Text_New_Cadet_Last_Name_Search_40.Height + Parent.Height/20
                  - Dropdown_wp_Email_40:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        Items: =Office365Users.SearchUserV2({searchTerm:Text_Input_New_Cadet_Last_Name_Search_40.Text}).value
                        OnChange: =
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_Input_New_Cadet_Last_Name_Search_40.X + Text_Input_New_Cadet_Last_Name_Search_40.Width + Parent.Width/15
                        Y: =Text_Input_New_Cadet_Last_Name_Search_40.Y
                      Children:
                        - UserPrincipalName4:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="UserPrincipalName"
                              FieldName: ="UserPrincipalName"
                              FieldType: ="s"
                              Order: =1
                  - Text_Input_New_Cadet_Last_Name_Search_40:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Last_Name_Search_40.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/2 - Self.X - Parent.Width/20
                        X: =Text_New_Cadet_Last_Name_Search_40.X + Text_New_Cadet_Last_Name_Search_40.Width
                        Y: =Text_New_Cadet_Last_Name_Search_40.Y
                  - Text_New_Cadet_Last_Name_Search_40:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Search Cadet"
                        Width: =Parent.Width/4
                        X: =Parent.Width/40
                        Y: =Parent.Height/40
            - Spinner_40:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Header_Projects_Details_40:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Projects_Details_40:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Project Details"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_40:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_40:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Trips_Overview_50

Screens:
  Screen_Trips_Overview_50:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Trips_Overview_50:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Trips_Header_50.Height
            Width: =Parent.Width
            Y: =Container_Trips_Header_50.Height
          Children:
            - Button_Home_50:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_50.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: =Navigate(Screen_Welcome_User_00)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Home"
                  Width: =Parent.Width/11
                  X: =Button_Add_Trip_50.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Event_Search_50.Y
            - Button_Add_Trip_50:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_50.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Set(varTrip, 
                        {trip_id: Blank(), 
                        trip_event: Blank(), 
                        trip_start: Blank()});

                    ClearCollect(colTrip,
                        {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: "USA", destination: Blank(), gik_approved: "N/A", gik_submitted: "N/A", dean_submitted: "N/A", dean_approved: "N/A"}, {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: "USA", destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});

                    ClearCollect(colTripTypes, 
                        {trip_type: Blank()});
                    Collect(colTripTypes, lookup_trip_type);

                    ClearCollect(colSections, 
                        view_current_sections_procedure.dboviewcurrentsectionsprocedure({travel_start_date:Today()}).ResultSets.Table1);

                    Navigate(Screen_Trip_Details_60);
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Add Trip"
                  Width: =Parent.Width/11
                  X: =Button_Join_Trip_50.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Event_Search_50.Y
            - Button_Join_Trip_50:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_50.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=Set(varTrip, \r\n    {trip_id: Gallery_Trips_50.Selected.trip_id, \r\n    trip_event: Gallery_Trips_50.Selected.trip_event, \r\n    trip_start: Gallery_Trips_50.Selected.trip_start});\r\n    \r\nClearCollect(colTrip, \r\n    With({\r\n    tripRecord: \r\n        ShowColumns(\r\n            Filter(current_trips_view, trip_id = varTrip.trip_id), trip_id, trip_type, trip_event, trip_start, trip_end, trip_oic, oic_last_name, oic_first_name, oic_name, purpose, trip_summary, destination_city, destination_state, destination_country, destination, gik_approved, gik_submitted, dean_approved, dean_submitted, xo_approved_on, p6_approved_on)}, \r\n        Table(tripRecord, \r\n            tripRecord)));\r\n\r\nClearCollect(colTravelers, \r\n    Filter(ShowColumns(current_travel_view, travel_id, trip_id, cntrl_num, usma_pers_id, traveler_last_name, traveler_first_name, traveler_name, pers_type, traveler_email, budget_id, budget_name, loa, split_loa, budget_assigned_by, meal_cost, lodging_cost, rental_cost, pov_cost, airfare_cost, other_cost, cost_desc, travel_cost_committed, travel_cost_disbursed, travel_cost_status, travel_start, travel_end, voucher_submitted_on, voucher_approved_on, travel_doc_num, missing_class, trip_event, trip_start, pd_tour, pd_approved_on, cd_tour, cd_approved_on, xo_tour, xo_approved_on, p6_tour, p6_approved_on), trip_id = varTrip.trip_id));\r\n\r\nClearCollect(colTripTypes, \r\n    {trip_type: Blank()});\r\nCollect(colTripTypes, lookup_trip_type);\r\n\r\nClearCollect(colSections, \r\n    view_current_sections_procedure.dboviewcurrentsectionsprocedure({travel_start_date:varTrip.trip_start}).ResultSets.Table1);\r\n        \r\nClearCollect(colClassesMissed,\r\n    Filter(ShowColumns(missed_classes_travel_view, missed_class_id, section_id, missed_date, trip_id, travel_cost_id, covering_fac_tour, class_num, apd, apd_name, approved_on, instructor_tour, apd_tour), trip_id = varTrip.trip_id));\r\n\r\nClearCollect(colTravelNotes, \r\n    Filter(ShowColumns(travel_notes_view, travel_note_id, trip_id, travel_cost_id, notes, tour_id, name, updated_on), trip_id = varTrip.trip_id));\r\n\r\nClearCollect(colProjectTravel, \r\n    ShowColumns(project_travel, project_travel_id, travel_cost_id, project_id));\r\n\r\nClearCollect(colAddLocs, \r\n    Filter(ShowColumns(add_locs_view, add_loc_id, travel_cost_id, trip_id, traveler_last_name, traveler_first_name, traveler_name, leg_start, leg_end, destination_city, destination_state, destination_country), trip_id = varTrip.trip_id));\r\n\r\nNavigate(Screen_Trip_Details_60);"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Edit/Join Trip"
                  Width: =Parent.Width/11
                  X: =Gallery_Trips_50.X + Gallery_Trips_50.Width - Self.Width
                  Y: =Text_Input_Event_Search_50.Y
            - Text_Input_OIC_Search_50:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_50.Height
                  HintText: ="Search OIC"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Event_Search_50);
                    Reset(Text_Input_Destination_Search_50);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Trips_50.Width/8
                  X: =Text_Input_Destination_Search_50.X + Text_Input_Destination_Search_50.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_OIC_Search_50:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Event_Search_50.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_OIC_Search_50);

                    Reset(Gallery_Trips_50)
                  Width: =Self.Height
                  X: =Text_Input_OIC_Search_50.X + Text_Input_OIC_Search_50.Width - Self.Width
                  Y: =Text_Input_Event_Search_50.Y + Text_Input_Event_Search_50.Height/8
            - Text_Input_Destination_Search_50:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_50.Height
                  HintText: ="Search Destination"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Event_Search_50);
                    Reset(Text_Input_OIC_Search_50);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Trips_50.Width/8
                  X: =Text_Input_Event_Search_50.X + Text_Input_Event_Search_50.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Destination_Search_50:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Event_Search_50.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Destination_Search_50);

                    Reset(Gallery_Trips_50)
                  Width: =Self.Height
                  X: =Text_Input_Destination_Search_50.X + Text_Input_Destination_Search_50.Width - Self.Width
                  Y: =Text_Input_Event_Search_50.Y + Text_Input_Event_Search_50.Height/8
            - Text_Input_Event_Search_50:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_50.Height
                  HintText: ="Search Event"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Destination_Search_50);
                    Reset(Text_Input_OIC_Search_50);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Trips_50.Width/8
                  X: =Text_Input_ID_Search_50.X + Text_Input_ID_Search_50.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Event_Search_50:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Event_Search_50.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Event_Search_50);

                    Reset(Gallery_Trips_50)
                  Width: =Self.Height
                  X: =Text_Input_Event_Search_50.X + Text_Input_Event_Search_50.Width - Self.Width
                  Y: =Text_Input_Event_Search_50.Y + Text_Input_Event_Search_50.Height/8
            - Text_Input_ID_Search_50:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_50.Height
                  HintText: ="Search Trip ID"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Destination_Search_50);
                    Reset(Text_Input_OIC_Search_50);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Trips_50.Width/8
                  X: =Gallery_Trips_50.X
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_ID_Search_50:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Event_Search_50.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_ID_Search_50);

                    Reset(Gallery_Trips_50)
                  Width: =Self.Height
                  X: =Text_Input_ID_Search_50.X + Text_Input_ID_Search_50.Width - Self.Width
                  Y: =Text_Input_Event_Search_50.Y + Text_Input_Event_Search_50.Height/8
            - Text_PAX_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="PAX"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/20
                  X: =Icon_Show_Approvals_50.X - Gallery_Trips_50.X
                  Y: =Text_Event_Name_50.Y
            - Text_Cost_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="Cost"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/19
                  X: =Text_PAX_50.X - Self.Width - 10
                  Y: =Text_Event_Name_50.Y
            - Text_OIC_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="OIC"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Cost_50.X - Self.X - 10
                  X: =Text_Trip_End_50.X + Text_Trip_End_50.Width + 10
                  Y: =Text_Event_Name_50.Y
            - Text_Trip_End_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="Trip End"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Trips_50.Width/15
                  X: =Text_Trip_Start_50.X + Text_Trip_Start_50.Width + 10
                  Y: =Text_Event_Name_50.Y
            - Text_Trip_Start_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="Trip Start"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Trips_50.Width/15
                  X: =Text_Destination_50.X + Text_Destination_50.Width + 10
                  Y: =Text_Event_Name_50.Y
            - Text_Destination_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="Primary Destination"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Trips_50.Width/6
                  X: =Text_Event_Name_50.X + Text_Event_Name_50.Width + 10
                  Y: =Text_Event_Name_50.Y
            - Text_Event_Name_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="Event Type and Name"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Trips_50.Width*56/195 - 60
                  X: =Gallery_Trips_50.X + Text_Trip_ID_50.Width + 10
                  Y: =Parent.Height/40
            - Text_Trip_ID_50:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_50.Height
                  Size: =18
                  Text: ="Trip ID"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Trips_50.Width/15
                  X: =Gallery_Trips_50.X
                  Y: =Parent.Height/40
            - Gallery_Trips_50:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =1
                  Height: =Text_Input_Event_Search_50.Y - Text_Event_Name_50.Y - Text_Event_Name_50.Height - Parent.Height/40
                  Items: "=If(\r\n    Not(IsBlank(Text_Input_ID_Search_50.Text)), \r\n    Sort(\r\n        Filter(current_trips_view, Value(Text_Input_ID_Search_50.Text) = trip_id, trip_status = \"ACTIVE\"),\r\n        trip_start, SortOrder.Descending),\r\n\r\n    If(\r\n        Not(IsBlank(Text_Input_Event_Search_50.Text)),\r\n        Sort(\r\n            Filter(current_trips_view, Text_Input_Event_Search_50.Text in trip_event, trip_status = \"ACTIVE\"),\r\n            trip_start, SortOrder.Descending),\r\n        If(\r\n            Not(IsBlank(Text_Input_Destination_Search_50.Text)),\r\n            Sort(\r\n                Filter(current_trips_view, Text_Input_Destination_Search_50.Text in destination, trip_status = \"ACTIVE\"), \r\n                trip_start, SortOrder.Descending), \r\n                \r\n            If(\r\n                Not(IsBlank(Text_Input_OIC_Search_50.Text)),\r\n                Sort(\r\n                        Filter(current_trips_view, Text_Input_OIC_Search_50.Text in oic_name, trip_status = \"ACTIVE\"), \r\n                        trip_start, SortOrder.Descending),\r\n                    Sort(Filter(current_trips_view, trip_status = \"ACTIVE\"), trip_start, SortOrder.Descending)))))"
                  TemplateFill: |
                    =If(
                        IsBlank(ThisItem.p6_approved_on) || IsBlank(ThisItem.xo_approved_on),
                        If(
                            ThisItem.IsSelected, 
                            RGBA(255, 121, 69,1), 
                            ColorFade(RGBA(255, 121, 69,1), .6)), 
                        If(
                            ThisItem.p6_approved_on = Date(1900, 1, 1) || ThisItem.xo_approved_on = Date(1900, 1, 1), 
                            If(
                                ThisItem.IsSelected,
                                Color.Yellow, 
                                ColorFade(Color.Yellow, .6)),

                            If(
                                ThisItem.IsSelected, 
                                Color.LightGreen, 
                                ColorFade(Color.LightGreen, .6))))
                  TemplateSize: =Text_Input_Change_User_50.Height*2
                  Width: =Parent.Width*19/20
                  X: =(Parent.Width - Self.Width)/2
                  Y: =Text_Event_Name_50.Y + Text_Event_Name_50.Height
                Children:
                  - Icon_Show_Approvals_50:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        Height: =Parent.TemplateHeight*.75
                        Icon: =Icon.DetailList
                        OnSelect: "=Select(Parent);\r\n\r\nClearCollect(colTravelers, \r\n    Filter(ShowColumns(current_travel_view, travel_id, trip_id, cntrl_num, usma_pers_id, traveler_last_name, traveler_first_name, traveler_name, pers_type, traveler_email, budget_id, budget_name, loa, split_loa, budget_assigned_by, meal_cost, lodging_cost, rental_cost, pov_cost, airfare_cost, other_cost, cost_desc, travel_cost_committed, travel_cost_disbursed, travel_cost_status, travel_start, travel_end, voucher_submitted_on, voucher_approved_on, travel_doc_num, missing_class, trip_event, trip_start, pd_tour, pd_approved_on, cd_tour, cd_approved_on, xo_tour, xo_approved_on, p6_tour, p6_approved_on), trip_id = Gallery_Trips_50.Selected.trip_id));\r\n\r\n\r\nUpdateContext({varShowApprovals:true}); "
                        Tooltip: ="Show Approvals"
                        X: =Parent.TemplateWidth - Self.Width*9/8
                        Y: =Parent.TemplateHeight/8
                  - Text_OIC_53:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =Sum(ThisItem.num_cadets, ThisItem.num_fac, ThisItem.num_guests)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_PAX_50.Width
                        X: =Text_PAX_50.X - Gallery_Trips_50.X
                  - Text_OIC_51:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.oic_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_OIC_50.Width
                        X: =Text_OIC_50.X - Gallery_Trips_50.X
                  - Text_Trip_End_51:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.trip_end
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Trip_End_50.Width
                        X: =Text_Trip_End_50.X - Gallery_Trips_50.X
                  - Text_Trip_Start_51:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.trip_start
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Trip_Start_50.Width
                        X: =Text_Trip_Start_50.X - Gallery_Trips_50.X
                  - Text_Destination_51:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.destination
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Destination_50.Width
                        X: =Text_Destination_50.X - Gallery_Trips_50.X
                  - Text_Event_Name_51:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: |
                          =Concatenate(ThisItem.trip_type, " - ", ThisItem.trip_event)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Event_Name_50.Width
                        Wrap: =false
                        X: =Text_Event_Name_50.X - Gallery_Trips_50.X
                  - Text_Trip_ID_51:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        PaddingLeft: =10
                        Size: =18
                        Text: =ThisItem.trip_id
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Trip_ID_50.Width
                        Wrap: =false
                  - Separator_Gallery_Trips_50:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                  - Text_OIC_52:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =Concatenate("$", Abs(ThisItem.cost))
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Cost_50.Width
                        X: =Text_Cost_50.X - Gallery_Trips_50.X
            - Rectangle_Disable_50:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Container_Approvals_50.Visible,
                        true, false)
                  Width: =Parent.Width
            - Container_Approvals_50:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowApprovals
                  Width: =Parent.Width/1.5
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Close_Approvals_50:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Approvals_50.Height*1.2
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Clear(colTravelers);

                          UpdateContext({varShowApprovals:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Close"
                        Width: =Self.Height*3
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Gallery_Approvals_50:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Button_Close_Approvals_50.Y - Self.Y - Parent.Height/20
                        Items: =Sort(colTravelers, traveler_last_name, SortOrder.Ascending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateFill: |-
                          =If(
                              IsBlank(ThisItem.p6_approved_on) || ThisItem.p6_approved_on = Date(1900, 1, 1),
                              If(
                                  IsBlank(ThisItem.xo_approved_on),  
                                  RGBA(255, 121, 69,1), 
                                  Color.Yellow), 
                              Color.LightGreen)
                        TemplateSize: =Text_Approvals_50.Height
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Text_Name_50.Y + Text_Name_50.Height
                      Children:
                        - Text_Input_P5_P6:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.p6_approved_on = Date(1900, 1, 1), 
                                    Blank(), 
                                    ThisItem.p6_approved_on)
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_XO_Approve_50.Width
                              X: =Text_P5_P6_Approve_50.X - Gallery_Approvals_50.X
                        - Text_Input_XO_50:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.xo_approved_on = Date(1900, 1, 1), 
                                    Blank(), 
                                    ThisItem.xo_approved_on)
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_XO_Approve_50.Width
                              X: =Text_XO_Approve_50.X - Gallery_Approvals_50.X
                        - Text_Input_Budget_50:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.cd_approved_on
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Budget_50.Width
                              X: =Text_Budget_50.X - Gallery_Approvals_50.X
                        - Text_Input_APD_50:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.pd_approved_on
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_APD_50.Width
                              X: =Text_APD_50.X - Gallery_Approvals_50.X
                        - Text_Input_Name_50:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.traveler_name
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Name_50.Width
                              X: =Text_Name_50.X - Gallery_Approvals_50.X
                        - Separator_Gallery_Approvals_50:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Text_P5_P6_Approve_50:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_50.Height
                        Size: =23
                        Text: ="P5/P6 Approved"
                        Width: =Text_APD_50.Width
                        X: =Text_XO_Approve_50.X + Text_XO_Approve_50.Width + 10
                        Y: =Text_Name_50.Y
                  - Text_XO_Approve_50:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_50.Height
                        Size: =23
                        Text: ="XO Approved"
                        Width: =Text_APD_50.Width
                        X: =Text_Budget_50.X + Text_Budget_50.Width + 10
                        Y: =Text_Name_50.Y
                  - Text_Budget_50:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_50.Height
                        Size: =23
                        Text: ="Budget Approved"
                        Width: =Text_APD_50.Width
                        X: =Text_APD_50.X + Text_APD_50.Width + 10
                        Y: =Text_Name_50.Y
                  - Text_APD_50:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_50.Height
                        Size: =23
                        Text: ="APD Approved"
                        Width: =((Text_Approvals_50.Width*3/4) - 40 - Gallery_Approvals_50.X - Parent.Width/40)/4
                        X: =Text_Name_50.X + Text_Name_50.Width + 10
                        Y: =Text_Name_50.Y
                  - Text_Name_50:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_50.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Text_Approvals_50.Width/4
                        X: =Parent.Width/40
                        Y: =Text_Approvals_50.Y + Text_Approvals_50.Height + Parent.Height/40
                  - Text_Approvals_50:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/12
                        Size: =24
                        Text: ="Approvals"
                        Width: =Parent.Width
      - Container_Trips_Header_50:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Trips_Header_50:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Trips"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_50:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_50:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Trip_Details_60

Screens:
  Screen_Trip_Details_60:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Trip_Details_60:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Header_Trip_Details_60.Height
            Width: =Parent.Width
            Y: =Container_Header_Trip_Details_60.Height
          Children:
            - Text_Input_Trip_ID_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colTrip,1).trip_id
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width/15
                  X: =Parent.Width - Self.Width
                  Y: =Parent.Height - Self.Height
            - Text_Trip_ID_60:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Trip ID"
                  Width: =Parent.Width/12
                  X: =Text_Input_Trip_ID_60.X - Self.Width
                  Y: =Text_Input_Trip_ID_60.Y
            - Button_Cancel_Trip_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\r\n    Not(IsBlank(Index(colTrip,2).trip_id)) &&\r\n    \r\n    (varUser.tour_id = Index(colTrip,1).trip_oic || \r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\"),\r\n    \r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varShowCancel: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Cancel Trip"
                  Width: =Parent.Width/11
                  X: =Button_Generate_Memo_60.X + Button_Generate_Memo_60.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/50
            - Button_Generate_Memo_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\n    (varUser.tour_id = Index(colTrip,1).trip_oic || \n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\")\n    \n    &&\n    \n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = CountRows(colTravelers)\n    \n    &&\n    \n    CountRows(Filter(colTravelers, p6_approved_on <> Date(1900, 1, 1))) = CountRows(colTravelers)\n    \n    &&\n    \n    CountRows(colTravelers) > 0,\n    DisplayMode.Edit, DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: "=UpdateContext({varShowSpinner:true});\r\n\r\n'Math-TravelGenerateMemo'.Run(\r\n\r\n    Concat(Distinct(colTravelers, cd_tour),\r\n        LookUp(colFaculty, tour_id = Value).rank_title & \" \" & \r\n        LookUp(colFaculty, tour_id = Value).first_name & \" \" &\r\n        LookUp(colFaculty, tour_id = Value).last_name & \", \" &\r\n        LookUp(colFaculty, tour_id = Value).center_abbrev & \r\n        \" DIRECTOR, Department of Mathematical Sciences, United States Military Academy, West Point, NY 10996 <<approved in app>>\" & Char(10)), \r\n\r\n    Concatenate(\r\n        LookUp(colFaculty, dept_pos = \"XO\").rank_title & \" \" &\r\n        LookUp(colFaculty, dept_pos = \"XO\").first_name & \" \" &\r\n        LookUp(colFaculty, dept_pos = \"XO\").last_name & \r\n        \", EXECUTIVE OFFICER, Department of Mathematical Sciences, United States Military Academy, West Point, NY  10996\" & Char(10)),  \r\n\r\n    Concatenate(\r\n        LookUp(colFaculty, dept_pos = \"P6\").rank_title & \" \" &\r\n        LookUp(colFaculty, dept_pos = \"P6\").first_name & \" \" &\r\n        LookUp(colFaculty, dept_pos = \"P6\").last_name & \r\n        \", HEAD, Department of Mathematical Sciences, United States Military Academy, West Point, NY  10996\" & Char(10)), \r\n\r\n    Concatenate(\r\n        Index(colTrip,1).trip_event & \", \" &\r\n        Index(colTrip,1).destination & \": \"&\r\n        Index(colTrip,1).trip_start & \" - \" &\r\n        Index(colTrip,1).trip_end), \r\n\r\n    Index(colTrip,1).purpose, \r\n\r\n    Index(colTrip,1).trip_summary, \r\n\r\n    Concat(colTravelers, \r\n        traveler_first_name & \" \" &\r\n        traveler_last_name & \": $\" &\r\n        Abs(travel_cost_committed) & \" from \" &\r\n        budget_name & \" - FY\" & \r\n        If(\r\n            Month(Today()) > 9, \r\n            Year(Today()) - 1999, \r\n            Year(Today()) - 2000) \r\n        \r\n        & loa & Char(13) &\r\n\r\n        Concat(\r\n            Filter(colAddLocs, travel_cost_id = travel_id), \r\n            leg_start & \r\n            \" - \" &\r\n            leg_end &\r\n            \": \" & \r\n            destination_city & \r\n            \", \" &\r\n            destination_state & \r\n            \", \" & \r\n            destination_country & Char(13))),\r\n\r\n    Concatenate(\"$\" & Abs(Sum(colTravelers, lodging_cost))),\r\n\r\n    Concatenate(\"$\" & Abs(Sum(colTravelers, airfare_cost))), \r\n\r\n    Concatenate(\"$\" & Abs(Sum(colTravelers, pov_cost))), \r\n\r\n    Concatenate(\"$\" & Abs(Sum(colTravelers, rental_cost))), \r\n\r\n    Concatenate(\"$\" & Abs(Sum(colTravelers, meal_cost))), \r\n\r\n    Concatenate(\"$\" & Abs(Sum(colTravelers, other_cost))), \r\n\r\n    LookUp(colFaculty, tour_id = Index(colTrip,1).trip_oic).wp_email, \r\n\r\n    Concatenate(\r\n        \"<<signed in app>>\" & Char(13) &\r\n        LookUp(colFaculty, tour_id = Index(colTrip,1).trip_oic).first_name & \" \" &\r\n        LookUp(colFaculty, tour_id = Index(colTrip,1).trip_oic).last_name & Char(13) &\r\n        LookUp(colFaculty, tour_id = Index(colTrip,1).trip_oic).rank_title), \r\n\r\n    Concatenate(\r\n        \"<<signed in app>>\" & Char(13) &\r\n        LookUp(colFaculty, dept_pos = \"XO\").first_name & \" \" &\r\n        LookUp(colFaculty, dept_pos = \"XO\").last_name & Char(13) &\r\n        \"EXECUTIVE OFFICER\" & Char(13) &\r\n        \"Department of Mathematical Sciences\"),\r\n\r\n    If(\r\n        First(colTravelers).p6_tour = LookUp(colFaculty, dept_pos = \"P6\").tour_id,\r\n        Concatenate(\r\n            \"<<signed in app>>\" & Char(13) &\r\n            LookUp(colFaculty, dept_pos = \"P6\").first_name & \" \" &\r\n            LookUp(colFaculty, dept_pos = \"P6\").last_name & Char(13) &\r\n            LookUp(colFaculty, dept_pos = \"P6\").rank_title & \", US ARMY\" & Char(13) &\r\n            \"Professor and Head, Department of Mathematical Sciences\"),\r\n        Concatenate(\r\n            \"<<signed in app>>\" & Char(13) &\r\n            LookUp(colFaculty, dept_pos = \"P5\").first_name & \" \" &\r\n            LookUp(colFaculty, dept_pos = \"P5\").last_name & Char(13) &\r\n            LookUp(colFaculty, dept_pos = \"P5\").rank_title & \", US ARMY\" & Char(13) &\r\n            \"Deputy Head, Department of Mathematical Sciences\")), \r\n\r\n    Concat(colPermissionAdmin,\r\n        wp_email & \"; \"), \r\n    \r\n    Concatenate(\r\n        LookUp(colFaculty, dept_pos = \"P6\").wp_email & \"; \" &\r\n        LookUp(colFaculty, dept_pos = \"P5\").wp_email), \r\n    \r\n    Concatenate(\"Trip_\" & Index(colTrip,1).trip_id & \"Memo\"),\r\n\r\n    Concatenate(\r\n        \"$\" & Sum(colTravelers, Abs(travel_cost_committed))), \r\n    \r\n    Index(colTrip,1).trip_id);\r\n    \r\nUpdateContext({varShowSpinner:false});\r\n\r\nNotify(\"FILE SUCCESSFULLY GENERATED, PLEASE ALLOW A MOMENT TO RECEIVE IT IN YOUR EMAIL\", NotificationType.Success)"
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Text: ="Generate Memo"
                  Visible: |-
                    =If(
                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) &&
                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers),
                        true, false)
                  Width: =Button_Submit_60.Width
                  X: =Button_Add_Files_60.X + Button_Add_Files_60.Width + Parent.Width/50
                  Y: =Button_Submit_60.Y
            - Button_Add_Files_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varUser.tour_id = Index(colTrip,1).trip_oic || 
                        varPermissions = "Master" || 
                        varPermissions = "Admin" || 
                        varPermissions = "Research" ||
                        varUser.dept_pos = "XO" || varUser.dept_pos = "P5" || varUser.dept_pos = "P6", 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: |-
                    =UpdateContext({varAddFiles: true})
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: ="Add Files"
                  Tooltip: =
                  Visible: |-
                    =If(
                        Self.Text = "Routing Complete" || Self.Text = "", 
                        false, true)
                  Width: =Button_Submit_60.Width
                  X: =Button_Route_Approval_60.X + Button_Route_Approval_60.Width + Parent.Width/50
                  Y: =Button_Submit_60.Y
            - Button_Route_Approval_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\r\n    (Not(varTravelerChange) && Not(varTravelNoteChange) && Not(varMissingClassChange) && Not(varProjectTravelChange))\r\n\r\n    &&\r\n    \r\n    (varUser.tour_id = Index(colTrip,1).trip_oic || \r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\")\r\n\r\n    ||\r\n\r\n    ((varUser.dept_pos = \"XO\" || varUser.dept_pos = \"P5\" || varUser.dept_pos = \"P6\")\r\n\r\n    &&\r\n\r\n    Self.Text = \"View Approvals\")\r\n        \r\n    &&\r\n    \r\n    (Index(colTrip,1).dean_submitted <> \"NO\" && Self.Text <> \"Route Request\")\r\n\r\n    &&\r\n\r\n    (Index(colTrip,1).gik_submitted <> \"NO\" && Self.Text <> \"Route Request\"),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: "=If(\r\n    Self.Text = \"Request Coverage/Funds\" &&\r\n    CountRows(Filter(colClassesMissed, Not(IsBlank(covering_fac_tour)), IsBlank(approved_on))) > 0,\r\n    UpdateContext({varShowSpinner:true});\r\n    With( \r\n        {colAPDs: Distinct(\r\n            Filter(colClassesMissed, Not(IsBlank(covering_fac_tour)), IsBlank(approved_on)), apd)},\r\n                ForAll(colAPDs, \r\n                    'Math-TravelApproveClassesV2'.Run(\r\n                        Index(colTrip,1).trip_id, \r\n                        Value, \r\n                        Index(colTrip,1).trip_start, \r\n                        Index(colTrip,1).trip_end, \r\n                        Index(colTrip,1).trip_event, \r\n                        Index(colTrip,1).destination))));\r\n\r\nUpdateContext({varShowSpinner:true});\r\nForAll(colTravelers As traveler,\r\n    If(\r\n        Self.Text = \"Request Coverage/Funds\" &&\r\n        IsBlank(LookUp(colClassesMissed, travel_cost_id = traveler.travel_id)) &&\r\n        varTraveler.pers_type = \"FACULTY\" &&\r\n        Not(IsBlank(LookUp(colSections, tour_id = LookUp(colFaculty, usma_pers_id = traveler.usma_pers_id).tour_id))), \r\n        'Math-TravelApproveClasses2_V2'.Run( \r\n            Index(colTrip,1).trip_id, \r\n            LookUp(colFaculty, program_pos_id = LookUp(colSections, tour_id = LookUp(colFaculty, usma_pers_id = traveler.usma_pers_id).tour_id).apd).tour_id, \r\n            Index(colTrip,1).trip_start, \r\n            Index(colTrip,1).trip_end, \r\n            Index(colTrip,1).trip_event, \r\n            Index(colTrip,1).destination, \r\n            traveler.travel_id, \r\n            LookUp(colFaculty, program_pos_id = LookUp(colSections, tour_id = LookUp(colFaculty, usma_pers_id = traveler.usma_pers_id).tour_id).apd).wp_email, \r\n            traveler.traveler_email, \r\n            traveler.missing_class, \r\n            traveler.traveler_name)));\r\n\r\nForAll(colTravelers As traveler, \r\n    If(\r\n        Self.Text = \"Request Coverage/Funds\" &&\r\n        (IsBlank(LookUp(colSections, tour_id = LookUp(colFaculty, usma_pers_id = traveler.usma_pers_id).tour_id)) ||\r\n        IsBlank(LookUp(colFaculty, usma_pers_id = traveler.usma_pers_id))),\r\n        Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n            {pd_approved_on: Today(), \r\n            pd_tour: LookUp(current_fac_view, wp_email = First(colPermissionMaster).wp_email).tour_id})));\r\n\r\nIf(\r\n    Self.Text = \"Request Coverage/Funds\" &&\r\n    CountRows(Filter(colTravelers, IsBlank(cd_approved_on))) > 0,\r\n    UpdateContext({varShowSpinner:true});\r\n    'Math-TravelRequestFundsV2'.Run(\r\n        Index(colTrip,1).trip_id,\r\n        Index(colTrip,1).trip_type));\r\n\r\nIf(\r\n    Self.Text = \"Route Request\",\r\n    UpdateContext({varShowSpinner:true});\r\n    ForAll(colTravelers As traveler,\r\n        Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n            {xo_approved_on: Date(1900, 1, 1), \r\n            p6_approved_on: Date(1900, 1, 1)}));\r\n    'Math-TravelRouteApproval1_V3'.Run(\r\n        Index(colTrip,1).trip_id, \r\n        \"1900-01-01\", \r\n        \"1900-01-01\", \r\n        Concat(colPermissionAdmin, wp_email, \"; \"))); \r\n    \r\nIf(\r\n    Self.Text = \"View Approvals\", \r\n    UpdateContext({varShowApprovals: true}));\r\n\r\nIf(\r\n    Self.Text <> \"View Approvals\",\r\n    ClearCollect(colTrip,\r\n    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()},\r\n    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});\r\n    Clear(colTravelers);\r\n    Clear(colProjectTravel);\r\n    Clear(colClassesMissed);\r\n    Clear(colTravelNotes);\r\n    Clear(colProjectPriorities);\r\n    Clear(colProjectAwards);\r\n    Clear(colProjectFaculty);\r\n    Clear(colProjectCadets);\r\n    Clear(colProjectPublications);\r\n    Clear(colRemoveClassesMissed);\r\n    Clear(colRemoveProjectAwards);\r\n    Clear(colRemoveProjectPriorities);\r\n    Clear(colRemoveProjectPublications);\r\n    Clear(colRemoveProjectTravel);\r\n    Clear(colRemoveTravelers);\r\n    Clear(colRemoveTravelNotes);\r\n    Clear(colSections);\r\n    Clear(colTripTypes);\r\n    Clear(colAddLocs);\r\n    Clear(colRemoveAddLocs);\r\n\r\n    Set(varTraveler, Blank());\r\n    Set(varAddFacTraveler, Blank());\r\n    Set(varTrip, Blank());\r\n\r\n    UpdateContext({varDeanApproval: Blank()});\r\n    UpdateContext({varMissingClassChange: Blank()});\r\n    UpdateContext({varShowCancel:false});\r\n    UpdateContext({varNewCadet: Blank()});\r\n    UpdateContext({varNewGuest: Blank()});\r\n    UpdateContext({varPersQuestion: Blank()});\r\n    UpdateContext({varProjectTravelChange: Blank()});\r\n    UpdateContext({varResetCosts: Blank()});\r\n    UpdateContext({varShowClass: Blank()});\r\n    UpdateContext({varShowCostDetails: Blank()});\r\n    UpdateContext({varTravelNoteChange: Blank()});\r\n    UpdateContext({varReadyToSubmit:Blank()});\r\n    UpdateContext({varTravelerChange:false});\r\n\r\n    Refresh(current_travel_view);\r\n    Refresh(current_trips_view);\r\n    Reset(Gallery_Trips_50);\r\n    \r\n    UpdateContext({varShowSpinner:false});\r\n\r\n    If(\r\n        Not(IsBlank(varReturnScreen)),\r\n        Navigate(varReturnScreen),\r\n        Navigate(Screen_Trips_Overview_50)););\r\n\r\n    UpdateContext({varShowSpinner:false})"
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: |-
                    =If(
                        // CHECK IF ALL REQUIRED TRIP INFORMATION IS NOT BLANK - GIK/DEAN APPROVAL NOT NEEDED TO REQUEST FUNDS
                        Not(IsBlank(Index(colTrip,1).trip_id)) &&
                        Not(IsBlank(Index(colTrip,1).trip_type)) &&
                        Not(IsBlank(Index(colTrip,1).trip_event)) &&
                        Not(IsBlank(Index(colTrip,1).trip_start)) &&
                        Not(IsBlank(Index(colTrip,1).trip_end)) &&
                        Not(IsBlank(Index(colTrip,1).trip_oic)) &&
                        Not(IsBlank(Index(colTrip,1).purpose)) &&
                        Not(IsBlank(Index(colTrip,1).trip_summary)) &&
                        Not(IsBlank(Index(colTrip,1).destination_city)) &&
                        Not(IsBlank(Index(colTrip,1).destination_state)) &&
                        Not(IsBlank(Index(colTrip,1).destination_country)) &&

                        CountRows(Filter(colTravelers, IsBlank(usma_pers_id), pers_type <> "GUEST")) = 0 &&
                        CountRows(Filter(colTravelers, IsBlank(traveler_last_name), IsBlank(traveler_first_name), IsBlank(traveler_email))) = 0 &&
                        CountRows(Filter(colTravelers, IsBlank(trip_id))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(meal_cost))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(lodging_cost))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(rental_cost))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(pov_cost))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(airfare_cost))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(other_cost))) = 0 &&
                        CountRows(Filter(colTravelers, IsBlank(travel_cost_committed))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(travel_cost_disbursed))) = 0 &&
                        CountRows(Filter(colTravelers, IsBlank(travel_cost_status))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(travel_start))) = 0 &&  
                        CountRows(Filter(colTravelers, IsBlank(travel_end))) = 0 &&
                        CountRows(Filter(colTravelers, IsBlank(missing_class))) = 0 &&
                        CountRows(Filter(colClassesMissed, IsBlank(covering_fac_tour))) = 0,

                        If(
                            CountRows(Filter(colClassesMissed, Not(IsBlank(approved_on)))) <> CountRows(colClassesMissed) || 
                            CountRows(Filter(colTravelers, pers_type = "FACULTY", Not(IsBlank(pd_approved_on)))) <> CountRows(Filter(colTravelers, pers_type = "FACULTY")) || 
                            CountRows(Filter(colTravelers, Not(IsBlank(cd_approved_on)))) <> CountRows(colTravelers),
                            "Request Coverage/Funds", 
                                If(
                                    CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 && 
                                    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0,
                                    "Route Request",
                                    "View Approvals")), "")
                  Tooltip: ="GIK and submitted to Dean cannot be 'NO' before final route"
                  Visible: |-
                    =If(
                        Self.Text = "" || CountRows(colTravelers) = 0, 
                        false, true)
                  Width: =Button_Submit_60.Width
                  X: =Button_Submit_60.X + Button_Submit_60.Width + Parent.Width/50
                  Y: =Button_Submit_60.Y
            - Button_XO_P5_61:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers) && \r\n    varUser.dept_pos = \"XO\") \r\n    \r\n    || \r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = CountRows(colTravelers) && \r\n    (varUser.dept_pos = \"P5\" || varUser.dept_pos = \"P6\")), \r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=If(\r\n    varUser.dept_pos = \"XO\",   \r\n        ForAll(colTravelers As traveler, \r\n        Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n            {xo_tour: Blank(), \r\n            xo_approved_on: Blank(), \r\n            p6_tour: Blank(), \r\n            p6_approved_on: Blank()}); \r\n            \r\n        Patch(colTravelers, LookUp(colTravelers, travel_id = traveler.travel_id), \r\n            {xo_tour: Blank(), \r\n            xo_approved_on: Blank(), \r\n            p6_tour: Blank(), \r\n            p6_approved_on: Blank()})),\r\n\r\n    If(\r\n        varUser.dept_pos = \"P6\" || varUser.dept_pos = \"P5\", \r\n        ForAll(colTravelers As traveler, \r\n        Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n            {xo_tour: Blank(), \r\n            xo_approved_on: Blank(), \r\n            p6_tour: Blank(), \r\n            p6_approved_on: Blank()}); \r\n                    \r\n        Patch(colTravelers, LookUp(colTravelers, travel_id = traveler.travel_id), \r\n            {xo_tour: Blank(), \r\n            xo_approved_on: Blank(), \r\n            p6_tour: Blank(), \r\n            p6_approved_on: Blank()}))));\r\n\r\nClearCollect(colTrip,\r\n    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()},\r\n    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});\r\nClear(colTravelers);\r\nClear(colProjectTravel);\r\nClear(colClassesMissed);\r\nClear(colTravelNotes);\r\nClear(colProjectPriorities);\r\nClear(colProjectAwards);\r\nClear(colProjectFaculty);\r\nClear(colProjectCadets);\r\nClear(colProjectPublications);\r\nClear(colRemoveClassesMissed);\r\nClear(colRemoveProjectAwards);\r\nClear(colRemoveProjectPriorities);\r\nClear(colRemoveProjectPublications);\r\nClear(colRemoveProjectTravel);\r\nClear(colRemoveTravelers);\r\nClear(colRemoveTravelNotes);\r\nClear(colSections);\r\nClear(colTripTypes);\r\nClear(colAddLocs);\r\nClear(colRemoveAddLocs);\r\n\r\nSet(varTraveler, Blank());\r\nSet(varReturnScreen, Blank());\r\nSet(varAddFacTraveler, Blank());\r\nSet(varTrip, Blank());\r\n\r\nUpdateContext({varDeanApproval: Blank()});\r\nUpdateContext({varMissingClassChange: Blank()});\r\n\r\nUpdateContext({varNewCadet: Blank()});\r\nUpdateContext({varNewGuest: Blank()});\r\nUpdateContext({varPersQuestion: Blank()});\r\nUpdateContext({varProjectTravelChange: Blank()});\r\nUpdateContext({varResetCosts: Blank()});\r\nUpdateContext({varShowClass: Blank()});\r\nUpdateContext({varShowCostDetails: Blank()});\r\nUpdateContext({varTravelNoteChange: Blank()});\r\nUpdateContext({varReadyToSubmit:false});\r\nUpdateContext({varTravelerChange:false});\r\n\r\nRefresh(current_travel_view);\r\nRefresh(current_trips_view);\r\nReset(Gallery_Trips_50);\r\n    \r\nUpdateContext({varShowSpinner:false});\r\n\r\nNavigate(Screen_Trips_Overview_50);\r\n\r\nUpdateContext({varShowSpinner:false})"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Reject"
                  Visible: =Button_XO_P5_60.Visible
                  Width: =Parent.Width/11
                  X: =Button_Submit_60.X + Button_Submit_60.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/50
            - Button_Submit_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\r\n    varReadyToSubmit, DisplayMode.Edit, DisplayMode.Disabled)\r\n\r\n/*\r\nIf(\r\n    (varReadyToSubmit && \r\n    CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 &&\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0), \r\n    DisplayMode.Edit,\r\n\r\n    If(\r\n        (CountRows(colTravelers) = CountRows(Filter(colTravelers, xo_approved_on = Date(1900, 1, 1))) &&\r\n        varUser.dept_pos = \"XO\")\r\n            \r\n        ||\r\n\r\n        (CountRows(colTravelers) = CountRows(Filter(colTravelers, p6_approved_on = Date(1900, 1, 1))) &&\r\n        (varUser.dept_pos = \"P6\" || varUser.dept_pos = \"P5\")), \r\n        DisplayMode.Edit, DisplayMode.Disabled))\r\n\r\n        */"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=UpdateContext({varShowSpinner:true});\r\nIf(\r\n    Self.Text = \"Save\", \r\n\r\n    // REMOVE ANY DELETED ADDITIONAL LOCATIONS\r\n    If(CountRows(colRemoveAddLocs)>0, \r\n        ForAll(colRemoveAddLocs As remove_loc, \r\n            Remove(add_locs, LookUp(add_locs, add_loc_id = remove_loc.add_loc_id))));\r\n\r\n    // REMOVE ANY DELETED MISSED CLASSES\r\n    If(CountRows(colRemoveClassesMissed)>0, \r\n        ForAll(colRemoveClassesMissed As remove_class, \r\n            Remove(classes_missed_travel, LookUp(classes_missed_travel, missed_class_id = remove_class.missed_class_id))));\r\n\r\n    // REMOVE ANY DELETED TRAVEL NOTES\r\n    If(CountRows(colRemoveTravelNotes)>0, \r\n        ForAll(colRemoveTravelNotes As remove_note, \r\n            Remove(travel_notes, LookUp(travel_notes, travel_note_id = remove_note.travel_note_id))));\r\n\r\n    // REMOVE ANY DELETED Traveler\r\n    If(CountRows(colRemoveTravelers)>0, \r\n        ForAll(colRemoveTravelers As remove_traveler, \r\n            Remove(travel_costs, LookUp(travel_costs, travel_cost_id = remove_traveler.travel_id))));\r\n\r\n    // REMOVE ANY DELETED PROJECT TRAVEL\r\n    If(CountRows(colRemoveProjectTravel)>0, \r\n        ForAll(colRemoveProjectTravel As project, \r\n            Remove(project_travel, LookUp(project_travel, project_travel_id = project.project_travel_id))));\r\n\r\n\r\n    // UPDATE TRIPS TABLE\r\n    If(\r\n        IsBlank(Index(colTrip,1).trip_id), // IF COMPLETELY NEW TRIP\r\n            Set(varTrip,\r\n                // PATCH IN NEW TRIPS TO TRIPS TABLE ANG GET TRIP ID\r\n                {trip_id:\r\n                    Patch(lookup_trips, Defaults(lookup_trips),\r\n                        {trip_type: Index(colTrip,1).trip_type,\r\n                        trip_event: Index(colTrip,1).trip_event,\r\n                        gik_submitted: Index(colTrip,1).gik_submitted,\r\n                        gik_approved: Index(colTrip,1).gik_approved,\r\n                        dean_submitted: Index(colTrip,1).dean_submitted,\r\n                        dean_approved: Index(colTrip,1).dean_approved,\r\n                        trip_start: Index(colTrip,1).trip_start,\r\n                        trip_end: Index(colTrip,1).trip_end,\r\n                        trip_oic: Index(colTrip,1).trip_oic,\r\n                        purpose: Index(colTrip,1).purpose,\r\n                        trip_summary: Index(colTrip,1).trip_summary,\r\n                        destination_city: Index(colTrip,1).destination_city,\r\n                        destination_state: Index(colTrip,1).destination_state,\r\n                        destination_country: Index(colTrip,1).destination_country, \r\n                        updated_on:Today()}).trip_id}), \r\n        If(\r\n            // CHECK FOR CHANGES TO EXISTING TRIP\r\n            Index(colTrip,1).trip_type <> Index(colTrip,2).trip_type ||\r\n            Index(colTrip,1).trip_event <> Index(colTrip,2).trip_event ||\r\n            Index(colTrip,1).gik_submitted <> Index(colTrip,2).gik_submitted ||\r\n            Index(colTrip,1).gik_approved <> Index(colTrip,2).gik_approved ||\r\n            Index(colTrip,1).dean_submitted <> Index(colTrip,2).dean_submitted ||\r\n            Index(colTrip,1).dean_approved <> Index(colTrip,2).dean_approved ||\r\n            Index(colTrip,1).trip_start <> Index(colTrip,2).trip_start ||\r\n            Index(colTrip,1).trip_end <> Index(colTrip,2).trip_end ||\r\n            Index(colTrip,1).trip_oic <> Index(colTrip,2).trip_oic ||\r\n            Index(colTrip,1).purpose <> Index(colTrip,2).purpose ||\r\n            Index(colTrip,1).trip_summary <> Index(colTrip,2).trip_summary ||\r\n            Index(colTrip,1).destination_city <> Index(colTrip,2).destination_city ||\r\n            Index(colTrip,1).destination_state <> Index(colTrip,2).destination_state ||\r\n            Index(colTrip,1).destination_country <> Index(colTrip,2).destination_country, \r\n            // PATCH IN UPDATES TO EXISTING TRIPS\r\n            Patch(lookup_trips, LookUp(lookup_trips, trip_id = Index(colTrip,1).trip_id), \r\n                {trip_type: Index(colTrip,1).trip_type,\r\n                trip_event: Index(colTrip,1).trip_event,\r\n                gik_submitted: Index(colTrip,1).gik_submitted,\r\n                gik_approved: Index(colTrip,1).gik_approved,\r\n                dean_submitted: Index(colTrip,1).dean_submitted,\r\n                dean_approved: Index(colTrip,1).dean_approved,\r\n                trip_start: Index(colTrip,1).trip_start,\r\n                trip_end: Index(colTrip,1).trip_end,\r\n                trip_oic: Index(colTrip,1).trip_oic,\r\n                purpose: Index(colTrip,1).purpose,\r\n                trip_summary: Index(colTrip,1).trip_summary,\r\n                destination_city: Index(colTrip,1).destination_city,\r\n                destination_state: Index(colTrip,1).destination_state,\r\n                destination_country: Index(colTrip,1).destination_country, \r\n                updated_on: Today()})));\r\n\r\n    // UPDATE TRAVEL COSTS TABLE\r\n    ForAll(colTravelers As traveler, \r\n        If(IsBlank(traveler.travel_id), // IF NEW Traveler  \r\n            // PATCH IN NEW Travelers\r\n            With({new_travel_cost_id: \r\n                Patch(travel_costs, Defaults(travel_costs), \r\n                    {cntrl_num: traveler.cntrl_num, \r\n                    usma_pers_id: traveler.usma_pers_id,\r\n                    pers_type: traveler.pers_type,\r\n                    last_name: If(\r\n                        traveler.pers_type = \"GUEST\",\r\n                        traveler.traveler_last_name,\r\n                        Blank()), \r\n                    first_name: If(\r\n                        traveler.pers_type = \"GUEST\",\r\n                        traveler.traveler_first_name,\r\n                        Blank()), \r\n                    email: If(\r\n                        traveler.pers_type = \"GUEST\",\r\n                        traveler.traveler_email,\r\n                        Blank()), \r\n                    trip_id: varTrip.trip_id, \r\n                    budget_id: traveler.budget_id, \r\n                    split_loa: traveler.split_loa,\r\n                    budget_assigned_by: traveler.budget_assigned_by, \r\n                    meal_cost: If(IsBlank(traveler.meal_cost), 0, -Abs(traveler.meal_cost)),\r\n                    lodging_cost: If(IsBlank(traveler.lodging_cost), 0, -Abs(traveler.lodging_cost)), \r\n                    rental_cost: If(IsBlank(traveler.rental_cost), 0, -Abs(traveler.rental_cost)), \r\n                    pov_cost: If(IsBlank(traveler.pov_cost), 0, -Abs(traveler.pov_cost)), \r\n                    airfare_cost: If(IsBlank(traveler.airfare_cost), 0, -Abs(traveler.airfare_cost)), \r\n                    other_cost: If(IsBlank(traveler.other_cost), 0, -Abs(traveler.other_cost)),\r\n                    cost_desc: traveler.cost_desc,\r\n                    travel_cost_committed: If(IsBlank(traveler.travel_cost_committed), 0, -Abs(traveler.travel_cost_committed)), \r\n                    travel_cost_disbursed: If(IsBlank(traveler.travel_cost_disbursed), 0, -Abs(traveler.travel_cost_disbursed)),\r\n                    travel_cost_status: traveler.travel_cost_status, \r\n                    travel_start: traveler.travel_start,\r\n                    travel_end: traveler.travel_end,\r\n                    voucher_submitted_on: traveler.voucher_submitted_on, \r\n                    voucher_approved_on: traveler.voucher_approved_on,\r\n                    travel_doc_num: traveler.travel_doc_num, \r\n                    missing_class: traveler.missing_class,\r\n                    pd_approved_on: traveler.pd_approved_on,\r\n                    pd_tour: traveler.pd_tour, \r\n                    cd_approved_on: traveler.cd_approved_on, \r\n                    cd_tour: traveler.cd_tour,\r\n                    xo_approved_on: traveler.xo_approved_on, \r\n                    xo_tour: traveler.xo_tour,\r\n                    updated_on: Today(),\r\n                    p6_approved_on: traveler.p6_approved_on, \r\n                    p6_tour: traveler.p6_tour}).travel_cost_id},\r\n\r\n                // PATCH IN NEW ADDITIONAL LOCATIONS FOR NEW Travelers\r\n                ForAll(Filter(colAddLocs, new_traveler_num = traveler.new_traveler_num) As add_loc, \r\n                    Patch(add_locs, Defaults(add_locs), \r\n                        {travel_cost_id: new_travel_cost_id, \r\n                        leg_start: add_loc.leg_start, \r\n                        leg_end: add_loc.leg_end, \r\n                        destination_country: add_loc.destination_country, \r\n                        destination_state: add_loc.destination_state, \r\n                        destination_city: add_loc.destination_city}));\r\n\r\n                // PATCH IN NEW MISSING CLASSES FOR NEW Travelers\r\n                ForAll(Filter(colClassesMissed, usma_pers_id = traveler.usma_pers_id, IsBlank(missed_class_id), IsBlank(travel_cost_id)) As class, \r\n                    Patch(classes_missed_travel, Defaults(classes_missed_travel), \r\n                        {travel_cost_id: new_travel_cost_id, \r\n                        trip_id: varTrip.trip_id, \r\n                        section_id: class.section_id, \r\n                        missed_date: class.missed_date, \r\n                        covering_fac: class.covering_fac_tour, \r\n                        approved_on: class.approved_on})); \r\n\r\n                // CHECK FOR AND APPLY OVERALL PD APPROVAL - THIS IS ONLY POSSIBLE IF A PD IS TRAVELING AND APPROVING HIS/HER OWN MISSED CLASS COVERAGE PLAN\r\n                If(\r\n                    CountRows(Filter(colClassesMissed, travel_cost_id = new_travel_cost_id, Not(IsBlank(approved_on)))) = CountRows(Filter(colClassesMissed, travel_cost_id = new_travel_cost_id))\r\n                    &&\r\n                    CountRows(Filter(colClassesMissed, travel_cost_id = new_travel_cost_id)) > 0\r\n                    &&\r\n                    IsBlank(traveler.pd_approved_on), \r\n                    aggregate_pd_approval_procedure.dboaggregatepdapprovalprocedure(\r\n                        {apd_tour_id: varUser.tour_id, \r\n                        instructor_tour: varUser.tour_id,\r\n                        program_pos_id: varUser.apd, \r\n                        travel_cost_id: new_travel_cost_id}));\r\n\r\n                // PATCH IN NEW TRAVEL NOTES FOR NEW Travelers\r\n                ForAll(Filter(colTravelNotes, usma_pers_id = varTraveler.usma_pers_id, IsBlank(travel_note_id), IsBlank(travel_cost_id), new_traveler_num = traveler.new_traveler_num) As note, \r\n                    Patch(travel_notes, Defaults(travel_notes), \r\n                        {travel_cost_id: new_travel_cost_id, \r\n                        notes: note.notes, \r\n                        tour_id: note.tour_id, \r\n                        updated_on: Today()});\r\n                    Remove(colTravelNotes, note));\r\n\r\n                // PATCH IN NEW PROJECT TRAVEL FOR NEW TravelerS\r\n                ForAll(Filter(colProjectTravel, usma_pers_id = traveler.usma_pers_id, IsBlank(project_travel_id), IsBlank(travel_cost_id), new_traveler_num = traveler.new_traveler_num) As project, \r\n                    Patch(project_travel, Defaults(project_travel), \r\n                        {project_id: project.project_id, \r\n                        travel_cost_id: new_travel_cost_id});\r\n                    Remove(colProjectTravel, project)));\r\n                    \r\n            Remove(colTravelers, traveler), \r\n\r\n            // PATCH IN UPDATES TO EXISTING Travelers TO TRAVEL COSTS\r\n            If(varTravelerChange, \r\n                Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n                    {cntrl_num: traveler.cntrl_num, \r\n                    usma_pers_id: traveler.usma_pers_id,\r\n                    pers_type: traveler.pers_type,\r\n                    last_name: If(\r\n                        traveler.pers_type = \"GUEST\",\r\n                        traveler.traveler_last_name,\r\n                        Blank()), \r\n                    first_name: If(\r\n                        traveler.pers_type = \"GUEST\",\r\n                        traveler.traveler_first_name,\r\n                        Blank()), \r\n                    email: If(\r\n                        traveler.pers_type = \"GUEST\",\r\n                        traveler.traveler_email,\r\n                        Blank()), \r\n                    trip_id: varTrip.trip_id, \r\n                    budget_id: traveler.budget_id, \r\n                    split_loa: traveler.split_loa,\r\n                    budget_assigned_by: traveler.budget_assigned_by, \r\n                    meal_cost: If(IsBlank(traveler.meal_cost), 0, -Abs(traveler.meal_cost)),\r\n                    lodging_cost: If(IsBlank(traveler.lodging_cost), 0, -Abs(traveler.lodging_cost)), \r\n                    rental_cost: If(IsBlank(traveler.rental_cost), 0, -Abs(traveler.rental_cost)), \r\n                    pov_cost: If(IsBlank(traveler.pov_cost), 0, -Abs(traveler.pov_cost)), \r\n                    airfare_cost: If(IsBlank(traveler.airfare_cost), 0, -Abs(traveler.airfare_cost)), \r\n                    other_cost: If(IsBlank(traveler.other_cost), 0, -Abs(traveler.other_cost)),\r\n                    cost_desc: traveler.cost_desc,\r\n                    travel_cost_committed: If(IsBlank(traveler.travel_cost_committed), 0, -Abs(traveler.travel_cost_committed)), \r\n                    travel_cost_disbursed: If(IsBlank(traveler.travel_cost_disbursed), 0, -Abs(traveler.travel_cost_disbursed)),\r\n                    travel_cost_status: traveler.travel_cost_status, \r\n                    travel_start: traveler.travel_start,\r\n                    travel_end: traveler.travel_end,\r\n                    voucher_submitted_on: traveler.voucher_submitted_on, \r\n                    voucher_approved_on: traveler.voucher_approved_on,\r\n                    travel_doc_num: traveler.travel_doc_num, \r\n                    missing_class: traveler.missing_class,\r\n                    pd_approved_on: traveler.pd_approved_on,\r\n                    pd_tour: traveler.pd_tour, \r\n                    cd_approved_on: traveler.cd_approved_on, \r\n                    cd_tour: traveler.cd_tour,\r\n                    xo_approved_on: traveler.xo_approved_on, \r\n                    xo_tour: traveler.xo_tour,\r\n                    updated_on: Today(),\r\n                    p6_approved_on: traveler.p6_approved_on, \r\n                    p6_tour: traveler.p6_tour}));\r\n\r\n            // PATCH IN ADDITIONAL LOCATIONS FOR EXISTING Travelers\r\n            If(varAddLocChange, \r\n                ForAll(Filter(colAddLocs, travel_cost_id = traveler.travel_id) As add_loc, \r\n                    If(IsBlank(add_loc.add_loc_id), \r\n                    //PATCH IN NEW ADDITIONAL LOCATIONS\r\n                    Patch(add_locs, Defaults(add_locs), \r\n                        {travel_cost_id: traveler.travel_id, \r\n                        leg_start: add_loc.leg_start, \r\n                        leg_end: add_loc.leg_end, \r\n                        destination_country: add_loc.destination_country, \r\n                        destination_state: add_loc.destination_state, \r\n                        destination_city: add_loc.destination_city}), \r\n                    Patch(add_locs, LookUp(add_locs, add_loc_id = add_loc.add_loc_id), \r\n                        {leg_start: add_loc.leg_start, \r\n                        leg_end: add_loc.leg_end, \r\n                        destination_country: add_loc.destination_country, \r\n                        destination_state: add_loc.destination_state, \r\n                        destination_city: add_loc.destination_city}))));\r\n                        \r\n            // PATCH IN MISSING CLASSES FOR EXISTING Travelers\r\n            If(varMissingClassChange, \r\n                ForAll(Filter(colClassesMissed, travel_cost_id = traveler.travel_id) As class, \r\n                    If(IsBlank(class.missed_class_id), \r\n                        // PATCH IN NEW MISSED CLASSES\r\n                        Patch(classes_missed_travel, Defaults(classes_missed_travel), \r\n                            {travel_cost_id: class.travel_cost_id, \r\n                            trip_id: class.trip_id, \r\n                            section_id: class.section_id, \r\n                            missed_date: class.missed_date, \r\n                            covering_fac: class.covering_fac_tour, \r\n                            approved_on: class.approved_on}),\r\n\r\n                        // PATCH UPDATES TO EXISTING MISSED CLASSES FOR EXISTING Travelers \r\n                        Patch(classes_missed_travel, LookUp(classes_missed_travel, missed_class_id = class.missed_class_id), \r\n                            {travel_cost_id: class.travel_cost_id, \r\n                            trip_id: class.trip_id, \r\n                            section_id: class.section_id, \r\n                            missed_date: class.missed_date, \r\n                            covering_fac: class.covering_fac_tour, \r\n                            approved_on: class.approved_on})));\r\n\r\n                    // APPLY PD APPROVAL TO TRAVELER IF ALL MISSING CLASSES HAVE BEEN APPROVED\r\n                    If(\r\n                        CountRows(Filter(colClassesMissed, travel_cost_id = traveler.travel_id)) = CountRows(Filter(colClassesMissed, travel_cost_id = traveler.travel_id, Not(IsBlank(approved_on))))\r\n                        &&\r\n                        CountRows(Filter(colClassesMissed, travel_cost_id = traveler.travel_id)) > 0,\r\n                        aggregate_pd_approval_procedure.dboaggregatepdapprovalprocedure({ \r\n                            apd_tour_id: LookUp(Filter(colClassesMissed, travel_cost_id = traveler.travel_id), approved_on = Max(Filter(colClassesMissed, travel_cost_id = traveler.travel_id), approved_on)).apd_tour , \r\n                            instructor_tour: LookUp(colFaculty, wp_email = traveler.traveler_email).tour_id, \r\n                            program_pos_id: LookUp(Filter(colClassesMissed, travel_cost_id = traveler.travel_id), approved_on = Max(Filter(colClassesMissed, travel_cost_id = traveler.travel_id), approved_on)).apd,\r\n                            travel_cost_id: traveler.travel_id})));\r\n\r\n            // PATCH IN TRAVEL NOTES FOR EXISTING Travelers\r\n            If(varTravelNoteChange, \r\n                ForAll(Filter(colTravelNotes, travel_cost_id = traveler.travel_id) As note, \r\n                    If(IsBlank(note.travel_note_id), \r\n                        // PATCH IN NEW NOTES FOR EXISTING Travelers\r\n                        Patch(travel_notes, Defaults(travel_notes), \r\n                            {travel_cost_id: note.travel_cost_id, \r\n                            notes: note.notes, \r\n                            tour_id: note.tour_id, \r\n                            updated_on: Today()});\r\n                        Remove(colTravelNotes, note), \r\n                        // PATCH IN CHANGES TO NOTES FOR EXISTING Travelers\r\n                        Patch(travel_notes, LookUp(travel_notes, travel_note_id = note.travel_note_id), \r\n                            {notes: note.notes, \r\n                            tour_id: note.tour_id, \r\n                            updated_on: Today()});\r\n                        Remove(colTravelNotes, note))));\r\n\r\n            // PATCH IN PROJECT TRAVEL FOR EXISTING Travelers\r\n            If(varProjectTravelChange, \r\n                ForAll(Filter(colProjectTravel, travel_cost_id = traveler.travel_id) As project, \r\n                    If(IsBlank(project.project_travel_id), \r\n                        // PATCH IN NEW PROJECT TRAVEL FOR EXISTING Travelers\r\n                        Patch(project_travel, Defaults(project_travel),\r\n                            {project_id: project.project_id, \r\n                            travel_cost_id: project.travel_cost_id});\r\n                        Remove(colProjectTravel, project), \r\n                        // PATCH IN CHANGES TO PROJECT TRAVEL FOR EXISTING Travelers\r\n                        Patch(project_travel, LookUp(project_travel, project_travel_id = project.project_travel_id), \r\n                            {project_id: project.project_id});\r\n                        Remove(colProjectTravel, project)))))),\r\n\r\n    If(\r\n        varUser.dept_pos = \"XO\",  \r\n        ForAll(colTravelers As traveler, \r\n            Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n                {xo_tour: varUser.tour_id, \r\n                xo_approved_on: Today()})),\r\n\r\n        If(\r\n            varUser.dept_pos = \"P6\" || varUser.dept_pos = \"P5\",  \r\n            ForAll(colTravelers As traveler, \r\n                Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n                    {p6_tour: varUser.tour_id, \r\n                    p6_approved_on: Today()})))));\r\n\r\n\r\nClearCollect(colTrip,\r\n    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()},\r\n    {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});\r\n\r\nClear(colTravelers);\r\nClear(colProjectTravel);\r\nClear(colClassesMissed);\r\nClear(colTravelNotes);\r\nClear(colProjectPriorities);\r\nClear(colProjectAwards);\r\nClear(colProjectFaculty);\r\nClear(colProjectCadets);\r\nClear(colProjectPublications);\r\nClear(colRemoveClassesMissed);\r\nClear(colRemoveProjectAwards);\r\nClear(colRemoveProjectPriorities);\r\nClear(colRemoveProjectPublications);\r\nClear(colRemoveProjectTravel);\r\nClear(colRemoveTravelers);\r\nClear(colRemoveTravelNotes);\r\nClear(colSections);\r\nClear(colTripTypes);\r\nClear(colAddLocs);\r\nClear(colRemoveAddLocs);\r\n\r\nSet(varTraveler, Blank());\r\nSet(varAddFacTraveler, Blank());\r\nSet(varTrip, Blank());\r\n\r\nUpdateContext({varDeanApproval: Blank()});\r\nUpdateContext({varMissingClassChange: Blank()});\r\nUpdateContext({varShowCancel:false});\r\nUpdateContext({varNewCadet: Blank()});\r\nUpdateContext({varNewGuest: Blank()});\r\nUpdateContext({varPersQuestion: Blank()});\r\nUpdateContext({varProjectTravelChange: Blank()});\r\nUpdateContext({varResetCosts: Blank()});\r\nUpdateContext({varShowClass: Blank()});\r\nUpdateContext({varShowCostDetails: Blank()});\r\nUpdateContext({varTravelNoteChange: Blank()});\r\nUpdateContext({varReadyToSubmit:Blank()});\r\nUpdateContext({varTravelerChange:false});\r\n\r\nRefresh(missed_classes_travel_view); \r\nRefresh(current_fac_view); \r\nRefresh(travel_notes_view); \r\nRefresh(project_travel); \r\nRefresh(add_locs_view);\r\nRefresh(current_travel_view);\r\nRefresh(current_trips_view);\r\n\r\nReset(Gallery_Trips_50);\r\n \r\nUpdateContext({varShowSpinner:false});\r\n\r\nIf(\r\n    Not(IsBlank(varReturnScreen)),\r\n\r\n    ClearCollect(colTotalCosts, \r\n        ShowColumns(total_costs_view, budget_id, budget_name, fee_costs, gift_costs, print_costs, supply_costs, salary_costs, travel_costs, total_costs));\r\n\r\n    ClearCollect(colBudgetLedger,\r\n        ShowColumns(budget_ledger_view, category, cntrl_num, trip_id, ID, budget_name, budget_id, budget_type, name, email, purpose, doc_num, projected_cost, committed_cost, disbursed_cost, status, trip_start));\r\n\r\n    Collect(colBudgetLedger, \r\n        {category: Blank(), cntrl_num: Blank(), trip_id: Blank(), ID: Blank(), budget_name: Blank(), budget_id: Blank(), budget_type: Blank(), name: Blank(), email: Blank(), purpose: Blank(), doc_num: Blank(), projected_cost: Blank(), committed_cost: Blank(), disbursed_cost: Blank(), status: Blank(), new_budget_num: Blank(), trip_start: Blank()});\r\n\r\n    Navigate(varReturnScreen),\r\n    Navigate(Screen_Trips_Overview_50));\r\n\r\n    "
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Save"
                  Visible: "=If(\r\n    (varUser.dept_pos = \"XO\" || varUser.dept_pos = \"P5\" || varUser.dept_pos = \"P6\") &&\r\n    \r\n    CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers) &&\r\n\r\n    CountRows(colTravelers) > 0 &&\r\n\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = CountRows(colTravelers), false, true)"
                  Width: =Parent.Width/11
                  X: =Button_Check_60.X + Button_Check_60.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/50
            - Button_XO_P5_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\r\n    (CountRows(Filter(colTravelers, xo_approved_on = Date(1900, 1, 1))) = CountRows(colTravelers) && \r\n    varUser.dept_pos = \"XO\") \r\n    \r\n    || \r\n\r\n    (CountRows(Filter(colTravelers, p6_approved_on = Date(1900, 1, 1))) = CountRows(colTravelers) && \r\n    (varUser.dept_pos = \"P5\" || varUser.dept_pos = \"P6\")), \r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=If(\r\n    varUser.dept_pos = \"XO\",  \r\n    ForAll(colTravelers As traveler, \r\n        Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n            {xo_tour: varUser.tour_id, \r\n            xo_approved_on: Today()}); \r\n            \r\n        Patch(colTravelers, LookUp(colTravelers, travel_id = traveler.travel_id), \r\n            {xo_tour: varUser.tour_id, \r\n            xo_approved_on: Today()})),\r\n\r\n    If(\r\n        varUser.dept_pos = \"P6\" || varUser.dept_pos = \"P5\",  \r\n        ForAll(colTravelers As traveler, \r\n        Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), \r\n            {p6_tour: varUser.tour_id, \r\n            p6_approved_on: Today()}); \r\n                    \r\n        Patch(colTravelers, LookUp(colTravelers, travel_id = traveler.travel_id), \r\n            {p6_tour: varUser.tour_id, \r\n            p6_approved_on: Today()}))))"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Approve"
                  Visible: =Not(Button_Submit_60.Visible)
                  Width: =Parent.Width/11
                  X: =Button_Check_60.X + Button_Check_60.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/50
            - Button_Check_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: =If(varReadyToSubmit = false || Not(Button_Submit_60.Visible), DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(
                        // CHECK MINIMUM REQUIREMENTS TO CREATE A TRIP
                        Not(IsBlank(Index(colTrip,1).trip_type)) &&
                        Not(IsBlank(Index(colTrip,1).trip_oic)) &&
                        Not(IsBlank(Index(colTrip,1).trip_event)) &&
                        Not(IsBlank(Index(colTrip,1).trip_start)) &&
                        Not(IsBlank(Index(colTrip,1).trip_end)) &&
                        Not(IsBlank(Index(colTrip,1).destination_city)) &&
                        Not(IsBlank(Index(colTrip,1).destination_state)) &&
                        Not(IsBlank(Index(colTrip,1).destination_country)), 
                        If(
                            // CHECK MINIMUM REQUIREMENTS TO CREATE A Traveler
                            CountRows(Filter(colTravelers, IsBlank(travel_cost_status))) = 0 && 
                            CountRows(colTravelers) > 0,
                            If(
                                // CHECK MINIMUM REQUIREMENTS TO MAKE A NOTE
                                CountRows(Filter(colTravelNotes, IsBlank(notes))) = 0,
                                UpdateContext({varReadyToSubmit:true});
                                Notify("CLICK SAVE TO SUBMIT CHANGES", NotificationType.Success),
                                Notify("PLEASE REMOVE ANY BLANK NOTES", NotificationType.Error)),
                            Notify("PLEASE ENSURE THERE IS AT LEAST ONE TRAVELER GOING ON THIS TRIP", NotificationType.Error)),
                        Notify("PLEASE ENSURE ALL FIELDS OUTLINED IN RED ARE COMPLETE: TRIP TYPE, TRIP OIC, EVENT NAME, TRIP START, TRIP END, DESTINATION CITY, STATE, COUNTRY", NotificationType.Error));
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Check"
                  Width: =Parent.Width/11
                  X: =Button_Return_60.X + Button_Return_60.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/50
            - Button_Return_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Refresh(current_trips_view);

                    Clear(colTravelers);
                    Clear(colProjectTravel);
                    Clear(colClassesMissed);
                    Clear(colTravelNotes);
                    Clear(colProjectPriorities);
                    Clear(colProjectAwards);
                    Clear(colProjectFaculty);
                    Clear(colProjectCadets);
                    Clear(colProjectPublications);
                    Clear(colRemoveClassesMissed);
                    Clear(colRemoveProjectAwards);
                    Clear(colRemoveProjectPriorities);
                    Clear(colRemoveProjectPublications);
                    Clear(colRemoveProjectTravel);
                    Clear(colRemoveTravelers);
                    Clear(colRemoveTravelNotes);
                    Clear(colSections);
                    Clear(colTripTypes);
                    Clear(colAddLocs);
                    Clear(colRemoveAddLocs);


                    Set(varTraveler, Blank());
                    Set(varAddFacTraveler, Blank());
                    Set(varTrip, Blank());

                    UpdateContext({varDeanApproval: Blank()});
                    UpdateContext({varMissingClassChange: Blank()});
                    UpdateContext({varShowCancel:false});
                    UpdateContext({varNewCadet: Blank()});
                    UpdateContext({varNewGuest: Blank()});
                    UpdateContext({varPersQuestion: Blank()});
                    UpdateContext({varProjectTravelChange: Blank()});
                    UpdateContext({varResetCosts: Blank()});
                    UpdateContext({varShowClass: Blank()});
                    UpdateContext({varShowCostDetails: Blank()});
                    UpdateContext({varTravelNoteChange: Blank()});
                    UpdateContext({varReadyToSubmit:Blank()});
                    UpdateContext({varTravelerChange:false});

                    Reset(Gallery_Trips_50);

                    ClearCollect(colTrip,
                        {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()},
                        {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});

                    If(
                        Not(IsBlank(varReturnScreen)),

                        ClearCollect(colTotalCosts, 
                        ShowColumns(total_costs_view, budget_id, budget_name, fee_costs, gift_costs, print_costs, supply_costs, salary_costs, travel_costs, total_costs));

                        ClearCollect(colBudgetLedger,
                            ShowColumns(budget_ledger_view, category, cntrl_num, trip_id, ID, budget_name, budget_id, budget_type, name, email, purpose, doc_num, projected_cost, committed_cost, disbursed_cost, status, trip_start));

                        Collect(colBudgetLedger, 
                            {category: Blank(), cntrl_num: Blank(), trip_id: Blank(), ID: Blank(), budget_name: Blank(), budget_id: Blank(), budget_type: Blank(), name: Blank(), email: Blank(), purpose: Blank(), doc_num: Blank(), projected_cost: Blank(), committed_cost: Blank(), disbursed_cost: Blank(), status: Blank(), new_budget_num: Blank(), trip_start: Blank()});

                        Navigate(varReturnScreen),
                        Navigate(Screen_Trips_Overview_50));
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Return"
                  Width: =Parent.Width/11
                  X: =Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/50
            - Container_Traveler_Details_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  DropShadow: =DropShadow.None
                  Height: =Button_Cancel_Trip_60.Y - Self.Y
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =If(IsBlank(varTraveler), false, true)
                  Width: =Container_Travelers_60.Width
                  X: =Container_Travelers_60.X + Container_Travelers_60.Width + Parent.Width/50
                  Y: =Container_Travelers_60.Y - Parent.Height/25
                Children:
                  - Button_Voucher_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varTravelerChange: true});
                          UpdateContext({varDisburse: true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Voucher"
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Button_Split_LOA_60.Width
                        X: =Button_Split_LOA_60.X + Button_Split_LOA_60.Width + Parent.Width/80
                        Y: |-
                          =Parent.Height - Self.Height - 10
                          //Text_Budget_61.Y
                  - Button_Split_LOA_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Collect(colTravelers,
                              {travel_id: Blank(),
                              cntrl_num: Blank(), 
                              usma_pers_id: varTraveler.usma_pers_id, 
                              traveler_last_name: varTraveler.traveler_last_name, 
                              traveler_first_name: varTraveler.traveler_first_name,
                              traveler_name: varTraveler.traveler_name, 
                              pers_type: varTraveler.pers_type,
                              traveler_email: varTraveler.traveler_email,
                              budget_id: Blank(), 
                              budget_name: Blank(),
                              split_loa: "YES",
                              budget_assigned_by: Blank(), 
                              meal_cost: Blank(), 
                              lodging_cost: Blank(), 
                              rental_cost: Blank(), 
                              pov_cost: Blank(), 
                              airfare_cost: Blank(), 
                              other_cost: Blank(), 
                              cost_desc: Blank(),
                              travel_cost_committed: Blank(), 
                              travel_cost_disbursed: Blank(),
                              travel_cost_status: "PROJECTED", 
                              travel_start: varTraveler.travel_start,
                              travel_end: varTraveler.travel_end,
                              travel_doc_num: Blank(), 
                              missing_class: "N/A", 
                              trip_event: varTraveler.trip_event, 
                              trip_start: varTraveler.trip_start,
                              cd_approved_on: Blank(),
                              cd_tour: Blank(), 
                              pd_approved_on: Today(), 
                              pd_tour: LookUp(colFaculty, wp_email = First(permissions_master).wp_email).tour_id, 
                              xo_approved_on: Blank(), 
                              xo_tour: Blank(), 
                              p6_approved_on: Blank(), 
                              p6_tour: Blank()});

                          Set(varTraveler, Last(colTravelers));
                          UpdateContext({varTravelerChange: true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Split LOA"
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =(Parent.Width - Self.X)/2 - Parent.Width/80
                        X: =Text_Cost_Status_60.X
                        Y: |-
                          =Parent.Height - Self.Height - 10
                          //Text_Budget_61.Y
                  - Text_Input_Budget_Assigned_By_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(colFaculty, tour_id = LookUp(Filter(colTravelers, traveler_name = varTraveler.traveler_name), travel_id = varTraveler.travel_id).budget_assigned_by).name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Parent.Width/2 - Self.X - Parent.Width/80
                        X: =Text_Input_Pers_Type_60.X
                        Y: |-
                          =Button_Split_LOA_60.Y
                          //Text_Budget_61.Y
                  - Text_Budget_Assigned_By_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Assigned By:"
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_Travel_Start_61.X
                        Y: |-
                          =Button_Split_LOA_60.Y
                          //Text_Budget_60.Y + Text_Budget_60.Height + Parent.Height/30
                  - Dropdown_Cost_Status_60:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colCostStatus, cost_status = varTraveler.travel_cost_status)
                        DisplayMode: |-
                          =If(varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_60.Height
                        Items: =colCostStatus
                        OnChange: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {travel_cost_status: Self.Selected.cost_status}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {travel_cost_status: Self.Selected.cost_status}));
                          Set(varTraveler, Patch(varTraveler, 
                              {travel_cost_status: Self.Selected.cost_status}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Date_Picker_Travel_End_61.Width
                        X: =Text_Input_Doc_Num_60.X
                        Y: =Text_Budget_60.Y
                      Children:
                        - cost_status1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="cost_status"
                              FieldName: ="cost_status"
                              FieldType: ="s"
                              Order: =1
                  - Text_Cost_Status_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Cost Status:"
                        VerticalAlign: =VerticalAlign.Middle
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_Travel_End_61.X
                        Y: =Dropdown_Budget_60.Y
                  - Dropdown_Budget_60:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: |-
                          =If(IsBlank(varTraveler.budget_id), 
                              Filter(colBudgets, budget_id = Blank()), 
                              Filter(colBudgets, budget_id = 
                              varTraveler.budget_id))
                        DisplayMode: |-
                          =If(varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",
                              If(
                                  IsBlank(varTraveler.cd_approved_on), 
                                  DisplayMode.Edit, DisplayMode.Disabled), 
                              DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_60.Height
                        Items: =colBudgets
                        OnChange: |-
                          =If(Self.Selected.budget_type = "ARMY" && Index(colTrip,1).trip_type = "CONFERENCE",
                              Patch(colTrip, Index(colTrip,1), 
                                  {dean_submitted: "NO", 
                                  dean_approved: "NO"}));

                          If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {budget_id: Self.Selected.budget_id,
                                  budget_name: Self.Selected.budget_name, 
                                  budget_assigned_by: varUser.tour_id, 
                                  loa: Self.Selected.loa}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {budget_id: Self.Selected.budget_id,
                                  budget_name: Self.Selected.budget_name, 
                                  budget_assigned_by: varUser.tour_id, 
                                  loa: Self.Selected.loa}));
                          Set(varTraveler, Patch(varTraveler, 
                              {budget_id: Self.Selected.budget_id,
                              budget_name: Self.Selected.budget_name, 
                              budget_assigned_by: varUser.tour_id, 
                              loa: Self.Selected.loa}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});

                          Reset(Text_Input_Budget_Assigned_By_60);
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Date_Picker_Travel_End_61.Width
                        X: =Text_Input_CNTRL_Num_60.X
                        Y: =Text_Budget_60.Y
                      Children:
                        - budget_name1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_name"
                              FieldName: ="budget_name"
                              FieldType: ="s"
                              Order: =1
                        - budget_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_id"
                              FieldName: ="budget_id"
                              FieldType: ="n"
                              Order: =2
                        - budget_type1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_type"
                              FieldName: ="budget_type"
                              FieldType: ="s"
                              Order: =4
                        - loa1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="loa"
                              FieldName: ="loa"
                              FieldType: ="s"
                              Order: =3
                  - Text_Budget_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Budget:"
                        VerticalAlign: =VerticalAlign.Middle
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_Travel_Start_61.X
                        Y: |-
                          =Button_Split_LOA_60.Y - Self.Height - Parent.Height/30
                          //Text_CNTRL_Num_60.Y + Text_CNTRL_Num_60.Height + Parent.Height/30
                  - Button_Approve_Budget_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |
                          =If(
                              varUser.tour_id = LookUp(colBudgets, budget_id = varTraveler.budget_id).director_tour || 
                              varUser.tour_id = LookUp(colFaculty, pos_title = "DIRECTOR" && center_abbrev = "RESEARCH").tour_id ||
                              varUser.tour_id = LookUp(colFaculty, pos_title = "DIRECTOR" && center_abbrev = "CDAS").tour_id ||
                              varUser.tour_id = LookUp(colFaculty, pos_title = "DIRECTOR" && center_abbrev = "MSC").tour_id, 

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(Self.Text = \"Approve\",\r\n    If(IsBlank(varTraveler.travel_id), \r\n        Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),\r\n            {cd_tour: varUser.tour_id, \r\n            cd_approved_on: Today()}),\r\n        Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n            {cd_tour: varUser.tour_id, \r\n            cd_approved_on: Today()}));\r\n    Set(varTraveler, \r\n        Patch(varTraveler, \r\n        {cd_tour: varUser.tour_id, \r\n        cd_approved_on: Today()})),\r\n\r\n    If(IsBlank(varTraveler.travel_id), \r\n        Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),\r\n            {cd_tour: Blank(), \r\n            cd_approved_on: Blank()}),\r\n        Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n            {cd_tour: Blank(), \r\n            cd_approved_on: Blank()}));\r\n    Set(varTraveler, \r\n        Patch(varTraveler, \r\n        {cd_tour: Blank(), \r\n        cd_approved_on: Blank()})));   \r\n                \r\nUpdateContext({varReadyToSubmit:false});\r\nUpdateContext({varTravelerChange:true});"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on),
                              "Approve", "Disapprove")
                        Visible: =If(IsBlank(varTraveler.budget_id), false, true)
                        Width: =Text_Budget_60.Width - 10
                        X: =Text_Budget_60.X
                        Y: =Text_Budget_60.Y
                  - Text_Input_Doc_Num_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =If(IsBlank(varTraveler.travel_doc_num), Blank(), 
                              varTraveler.travel_doc_num)
                        DisplayMode: |-
                          =If(varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {travel_doc_num: Upper(Self.Text)}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {travel_doc_num: Upper(Self.Text)}));
                          Set(varTraveler, Patch(varTraveler, 
                              {travel_doc_num: Upper(Self.Text)}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Date_Picker_Travel_Start_61.Width
                        X: =Date_Picker_Travel_End_61.X
                        Y: =Text_CNTRL_Num_60.Y
                  - Text_Doc_Num_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: |-
                          ="Travel Doc #:"
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_Travel_End_61.X
                        Y: =Text_CNTRL_Num_60.Y
                  - Text_Input_CNTRL_Num_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =If(IsBlank(varTraveler.cntrl_num), Blank(), 
                              varTraveler.cntrl_num)
                        DisplayMode: |-
                          =If(varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HintText: =
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {cntrl_num: Upper(Self.Text)}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {cntrl_num: Upper(Self.Text)}));
                          Set(varTraveler, Patch(varTraveler, 
                              {cntrl_num: Upper(Self.Text)}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Tooltip: =
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Date_Picker_Travel_Start_61.Width
                        X: =Date_Picker_Travel_Start_61.X
                        Y: =Text_CNTRL_Num_60.Y
                  - Text_CNTRL_Num_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="CNTRL Num:"
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_Travel_Start_61.X
                        Y: |-
                          =Text_Budget_60.Y - Self.Height - Parent.Height/30
                          //Text_Faculty_63.Y + Text_Faculty_63.Height + Parent.Height/30
                  - Text_Administrator_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="To be filled out by Administrator"
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Parent.Width
                        Y: |-
                          =Text_CNTRL_Num_60.Y - Self.Height - Parent.Height/30
                          //Text_Travel_Start_68.Y + Text_Travel_Start_68.Height + Parent.Height/20
                  - Text_DTS_LOA_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadius: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0.04)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: |-
                          =Concatenate("DTS LOA: ", 
                              If(LookUp(colBudgets, budget_id = Dropdown_Budget_60.Selected.budget_id).budget_type = "GIFT",
                                  "MATHGIFT1",
                                  If(LookUp(colBudgets, budget_id = Dropdown_Budget_60.Selected.budget_id).budget_name = "CROSS-ORG",
                                      "See Administrator",
                                      "MATH1")))
                        Visible: =If(IsBlank(varTraveler.travel_id), false, true)
                        Width: =Parent.Width - Self.X
                        X: =Text_Pers_Type_60.X
                        Y: =Button_Project_Travel_60.Y + Button_Project_Travel_60.Height + Parent.Height/15
                  - Gallery_Project_Travel_60:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Text_Pers_Type_60.Height*1.5
                        Items: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Filter(colProjectTravel, new_traveler_num = varTraveler.new_traveler_num),
                              Filter(colProjectTravel, travel_cost_id = varTraveler.travel_id))
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        TemplateSize: =Text_Input_Change_User_60.Height
                        Width: =Parent.Width - Self.X - Button_Project_Travel_60.X
                        X: =Button_Project_Travel_60.X + Button_Project_Travel_60.Width + Parent.Width/30
                        Y: =Button_Project_Travel_60.Y
                      Children:
                        - Text_Input_Project_Title_61:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =LookUp(current_projects_view, project_id = ThisItem.project_id).project_title
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.TemplateWidth
                              X: =Text_Traveler_Last_Name_60.X
                        - Separator_Gallery_Project_Travel_60:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Button_Project_Travel_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.wp_email = varTraveler.traveler_email ||
                              varUser.tour_id = Index(colTrip,1).trip_oic,

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Set(varReturnScreen, App.ActiveScreen);
                          Navigate(Screen_Projects_Overview_30);
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varProjectTravelChange: true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Project-Related Travel?"
                        Width: =Parent.Width/2 - Self.X - Parent.Width/60
                        X: =Text_Pers_Type_60.X
                        Y: =Button_Travel_Cost_60.Y + Button_Travel_Cost_60.Height + Parent.Height/30
                  - Button_More_Locations_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.dept_pos = \"P6\" || \r\n    varUser.dept_pos = \"P5\" || \r\n    varUser.dept_pos = \"XO\" || \r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n    \r\n    Not(IsBlank(varTraveler.travel_start))\r\n    \r\n    &&\r\n    \r\n    Not(IsBlank(varTraveler.travel_end)), \r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowAddLocs:true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="More Locations"
                        Visible: |-
                          =If(
                              varTraveler.split_loa = "NO" &&
                              Not(IsBlank(LookUp(current_fac_view, wp_email = varTraveler.traveler_email))) &&
                              LookUp(current_fac_view, wp_email = varTraveler.traveler_email).acad_rank <> "NOT APPLICABLE",
                              true, false)
                        Width: =Button_Voucher_60.Width
                        X: =Button_Voucher_60.X
                        Y: =Button_Travel_Cost_60.Y
                  - Button_Missing_Class_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.dept_pos = \"P6\" || \r\n    varUser.dept_pos = \"P5\" || \r\n    varUser.dept_pos = \"XO\" ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic || \r\n    varUser.tour_id = Index(colTrip,2).trip_oic || \r\n\r\n    If(\r\n        IsBlank(varTraveler.travel_id), \r\n        If(\r\n            CountRows(Filter(colClassesMissed, new_traveler_num = varTraveler.new_traveler_num, usma_pers_id = varTraveler.usma_pers_id, apd = varUser.apd)) > 0,\r\n            true, \r\n            If(\r\n                CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                true,\r\n                false)),\r\n        If(\r\n            CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id, apd = varUser.apd)) > 0, \r\n            true, \r\n            If(\r\n                CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                true,\r\n                false))))\r\n        \r\n    &&\r\n    \r\n    Not(IsBlank(varTraveler.travel_start))\r\n    \r\n    &&\r\n    \r\n    Not(IsBlank(varTraveler.travel_end)), \r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowClass:true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Missing Class"
                        Visible: |-
                          =If(
                              varTraveler.split_loa = "NO" &&
                              Not(IsBlank(LookUp(current_fac_view, wp_email = varTraveler.traveler_email))) &&
                              LookUp(current_fac_view, wp_email = varTraveler.traveler_email).acad_rank <> "NOT APPLICABLE",
                              true, false)
                        Width: =Button_Split_LOA_60.Width
                        X: =Text_Travel_End_61.X
                        Y: =Button_Travel_Cost_60.Y
                  - Text_Input_Travel_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.travel_cost_committed)
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =/*If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                          */
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Date_Picker_Travel_Start_61.Width
                        X: =Date_Picker_Travel_Start_61.X
                        Y: =Button_Travel_Cost_60.Y
                  - Button_Travel_Cost_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic ||
                              varUser.dept_pos = "P6" || 
                              varUser.dept_pos = "P5" || 
                              varUser.dept_pos = "XO"),

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowCostDetails: true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Travel Cost"
                        Width: =Text_Pers_Type_60.Width - 10
                        X: =Text_Pers_Type_60.X
                        Y: =Text_Travel_Start_61.Y + Text_Travel_Start_61.Height + Parent.Height/30
                  - Date_Picker_Travel_End_61:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        EndDate: =Index(colTrip,1).trip_end
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_60.Height
                        OnChange: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {travel_end: Self.SelectedDate}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {travel_end: Self.SelectedDate}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {travel_end:Self.SelectedDate}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        SelectedDate: =varTraveler.travel_end
                        StartDate: =Index(colTrip,1).trip_start
                        Width: =Date_Picker_Travel_Start_61.Width
                        X: =Text_Input_travel_cost_id_60.X
                        Y: =Text_Travel_End_61.Y
                  - Text_Travel_End_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Travel End:"
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_travel_cost_id_60.X
                        Y: =Text_Travel_Start_61.Y
                  - Date_Picker_Travel_Start_61:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        EndDate: =Index(colTrip,1).trip_end
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_60.Height
                        OnChange: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {travel_start: Self.SelectedDate}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {travel_start: Self.SelectedDate}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {travel_start:Self.SelectedDate}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        SelectedDate: =varTraveler.travel_start
                        StartDate: =Index(colTrip,1).trip_start
                        Width: =Parent.Width/2 - Self.X - Parent.Width/80
                        X: =Text_Travel_Start_61.X + Text_Travel_Start_61.Width
                        Y: =Text_Travel_Start_61.Y
                  - Text_Travel_Start_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Travel Start:"
                        Width: =Text_Pers_Type_60.Width
                        X: =Text_Pers_Type_60.X
                        Y: =Text_Pers_Type_60.Y + Text_Pers_Type_60.Height + Parent.Height/30
                  - Text_Input_travel_cost_id_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.travel_id
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_Pers_Type_60.Width
                        X: =Text_travel_cost_id_60.X + Text_travel_cost_id_60.Width
                        Y: =Text_travel_cost_id_60.Y
                  - Text_travel_cost_id_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Travel ID"
                        Width: =Parent.Width/5
                        X: =Text_Input_Pers_Type_60.X + Text_Input_Pers_Type_60.Width + Parent.Width/40
                        Y: =Text_Pers_Type_60.Y
                  - Text_Input_Pers_Type_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.pers_type
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/2 - Self.X - Parent.Width/80
                        X: =Text_Pers_Type_60.X + Text_Pers_Type_60.Width
                        Y: =Text_Pers_Type_60.Y
                  - Text_Pers_Type_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Pers. Type"
                        Width: =Parent.Width/5
                        X: =Parent.Width/40
                        Y: =Text_Traveler_Info_60.Y + Text_Traveler_Info_60.Height + Parent.Height/50
                  - Text_Traveler_Info_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: =Concatenate(varTraveler.traveler_first_name, " ", varTraveler.traveler_last_name, " Travel Info")
                        Width: =Parent.Width
            - Container_Traveler_Notes_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  DropShadow: =DropShadow.None
                  Fill: =Color.White
                  Height: =Parent.Height/5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =If(IsBlank(varTraveler), false, true)
                  Width: =Parent.Width/2 - Parent.Width*3/100
                  X: =Parent.Width/50
                  Y: =Container_Travelers_60.Y + Container_Travelers_60.Height + Parent.Height/50
                Children:
                  - Gallery_Traveler_Notes_60:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Parent.Height - Self.Y - Parent.Height/50
                        Items: =Sort(Filter(colTravelNotes, travel_cost_id = varTraveler.travel_id, new_traveler_num = varTraveler.new_traveler_num), updated_on, SortOrder.Descending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateSize: =Text_Input_Change_User_60.Height
                        Width: =Parent.Width
                        Y: =Text_Note_60.Y + Text_Note_60.Height
                      Children:
                        - Icon_Remove_Note_60:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: |-
                                =If(
                                    varUser.tour_id = ThisItem.tour_id ||
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colTrip,1).trip_oic, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(IsBlank(ThisItem.travel_note_id), 
                                    Remove(colTravelNotes, ThisItem),
                                    Collect(colRemoveTravelNotes, ThisItem);
                                    Remove(colTravelNotes, ThisItem));

                                UpdateContext({varReadyToSubmit:false});
                                UpdateContext({varTravelNoteChange: true});
                              Width: =Self.Height
                              X: =Parent.TemplateWidth - Self.Width - 10
                        - Text_Input_Note_Date_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.updated_on
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_Date_60.Width
                              X: =Text_Note_Date_60.X
                        - Text_Input_Note_Creator_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.name
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_Creator_60.Width
                              X: =Text_Note_Creator_60.X
                        - Text_Input_Note_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.notes
                              DisplayMode: |-
                                =If(
                                    varUser.tour_id = ThisItem.tour_id ||
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colTrip,1).trip_oic, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: |-
                                =Patch(colTravelNotes, ThisItem, 
                                    {notes: Upper(Self.Text), 
                                    tour_id: varUser.tour_id, 
                                    name: varUser.name, 
                                    updated_on: Today()});

                                UpdateContext({varTravelNoteChange: true});
                                UpdateContext({varReadyToSubmit: false});
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_60.Width
                              X: =Text_Note_60.X
                        - Separator_Gallery_Traveler_Notes_60:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Note_60:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Text_Input_Change_User_60.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colTravelNotes,
                              {travel_note_id: Blank(), 
                              travel_cost_id: varTraveler.travel_id,  
                              notes: Blank(),
                              usma_pers_id: varTraveler.usma_pers_id, 
                              tour_id: varUser.tour_id,
                              name: varUser.name, 
                              updated_on: Blank(),
                              new_note_num: Max(colTravelNotes, new_note_num) + 1, 
                              new_traveler_num: varTraveler.new_traveler_num});

                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelNoteChange: true});
                        Width: =Self.Height
                        X: =Gallery_Traveler_Notes_60.Width - Self.Width - 10
                        Y: =Text_Note_Creator_60.Y
                  - Text_Note_Date_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Updated On"
                        Width: =Parent.Width/6
                        X: =Icon_Add_Note_60.X - Self.Width - 10
                        Y: =Text_Traveler_Notes_60.Y + Text_Traveler_Notes_60.Height
                  - Text_Note_Creator_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Created By"
                        Width: =Parent.Width/4
                        X: =Text_Note_Date_60.X - Self.Width - 10
                        Y: =Text_Traveler_Notes_60.Y + Text_Traveler_Notes_60.Height
                  - Text_Note_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Notes"
                        Width: =Text_Note_Creator_60.X - 10
                        X: =Text_Traveler_Notes_60.X
                        Y: =Text_Traveler_Notes_60.Y + Text_Traveler_Notes_60.Height
                  - Text_Traveler_Notes_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =24
                        Text: ="Notes"
                        Width: =Parent.Width
            - Container_Travelers_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  DropShadow: =DropShadow.None
                  Fill: =Color.White
                  Height: =Parent.Height/3
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Parent.Width/2 - Parent.Width*3/100
                  X: =Parent.Width/50
                  Y: =Text_GIK_Submitted_60.Y + Text_GIK_Submitted_60.Height + Parent.Height/50
                Children:
                  - Gallery_Travelers_60:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Parent.Height - Self.Y - Parent.Height/50
                        Items: =Sort(colTravelers, traveler_last_name, SortOrder.Ascending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        TemplateFill: =If(ThisItem.travel_id = varTraveler.travel_id && ThisItem.new_traveler_num = varTraveler.new_traveler_num, RGBA(177, 179, 179, 1), RGBA(0, 0, 0, 0))
                        TemplateSize: =Text_Input_Change_User_60.Height
                        Width: =Parent.Width
                        Y: =Text_Traveler_Last_Name_60.Y + Text_Traveler_Last_Name_60.Height
                      Children:
                        - Icon_Remove_Traveler_60:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: |-
                                =If(
                                    IsBlank(ThisItem.travel_id), 
                                    If(
                                        CountRows(Filter(colClassesMissed, usma_pers_id = ThisItem.usma_pers_id, new_traveler_num = ThisItem.new_traveler_num))> 0 ||
                                        CountRows(Filter(colProjectTravel, usma_pers_id = ThisItem.usma_pers_id, new_traveler_num = ThisItem.new_traveler_num))> 0 ||
                                        CountRows(Filter(colTravelNotes, usma_pers_id = ThisItem.usma_pers_id, new_traveler_num = ThisItem.new_traveler_num))> 0 ||
                                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) <> 0 ||
                                        CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) <> 0,
                                        DisplayMode.Disabled, DisplayMode.Edit), 

                                    If(
                                        CountRows(Filter(colClassesMissed, travel_cost_id = ThisItem.travel_id))> 0 ||
                                        CountRows(Filter(colProjectTravel, travel_cost_id = ThisItem.travel_id))> 0 ||
                                        CountRows(Filter(colTravelNotes, travel_cost_id = ThisItem.travel_id))> 0 ||
                                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) <> 0 ||
                                        CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) <> 0,
                                        DisplayMode.Disabled, DisplayMode.Edit))
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |
                                =If(IsBlank(ThisItem.cntrl_num), 
                                    If(IsBlank(ThisItem.travel_id),

                                        Remove(colTravelers, ThisItem);
                                        UpdateContext({varTravelerChange: true});
                                        Set(varTraveler, Blank()), 

                                        Collect(colRemoveTravelers, ThisItem);
                                        Remove(colTravelers, ThisItem);
                                        UpdateContext({varTravelerChange: true}));
                                        Set(varTraveler, Blank()), 

                                    Notify("YOU CANNOT REMOVE A Traveler WITH A CONTROL NUMBER. REQUEST ADMIN STAFF TO 'CANCEL' THIS TRAVEL", NotificationType.Error));

                                UpdateContext({varReadyToSubmit:false});
                              Tooltip: ="REMOVE ALL NOTES, MISSING CLASSES, AND PROJECT TRAVEL TO REMOVE THIS TRAVELER"
                              Visible: =If(IsBlank(ThisItem.cntrl_num), true, false)
                              Width: =Self.Height
                              X: =Icon_Add_Traveler_60.X
                        - Text_Input_Travel_End_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.travel_end
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Travel_End_60.Width
                              X: =Text_Travel_End_60.X
                        - Text_Input_Travel_Start_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.travel_start
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Travel_Start_60.Width
                              X: =Text_Travel_Start_60.X
                        - Text_Input_Traveler_Email_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.traveler_email
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Traveler_Email_60.Width
                              X: =Text_Traveler_Email_60.X
                        - Text_Input_Traveler_Last_Name_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.traveler_last_name
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Traveler_Last_Name_60.Width
                              X: =Text_Traveler_Last_Name_60.X
                        - Button_Gallery_Travelers_60:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =Self.Fill
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =RGBA(0, 0, 0, 0.04)
                              OnSelect: |-
                                =Select(Parent);
                                Set(varTraveler, ThisItem);
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Text: =
                              Width: =Icon_Remove_Traveler_60.X
                        - Separator_Gallery_Travelers_60:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Traveler_60:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Height: =Text_Input_Change_User_60.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =UpdateContext({varPersQuestion: true});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varTravelerChange:true});
                        Width: =Self.Height
                        X: =(Gallery_Travelers_60.X + Gallery_Travelers_60.Width - Text_Travel_End_60.X - Text_Travel_End_60.Width - Self.Width)/2 + Text_Travel_End_60.X + Text_Travel_End_60.Width
                        Y: =Text_Traveler_Email_60.Y
                  - Text_Travel_End_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="End"
                        Width: =Text_Travel_Start_60.Width
                        X: =Text_Travel_Start_60.X + Text_Travel_Start_60.Width + 10
                        Y: =Text_Travelers_60.Y + Text_Travelers_60.Height
                  - Text_Travel_Start_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Start"
                        Width: =Text_Travelers_60.Width*6/30 - 20 - Icon_Add_Traveler_60.Width/2
                        X: =Text_Traveler_Email_60.X + Text_Traveler_Email_60.Width + 10
                        Y: =Text_Travelers_60.Y + Text_Travelers_60.Height
                  - Text_Traveler_Email_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Email"
                        Width: =Text_Travelers_60.Width/2.75
                        X: =Text_Traveler_Last_Name_60.X + Text_Traveler_Last_Name_60.Width + 10
                        Y: =Text_Travelers_60.Y + Text_Travelers_60.Height
                  - Text_Traveler_Last_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Last Name"
                        Width: =Text_Travelers_60.Width/5
                        X: =Text_Travelers_60.X
                        Y: =Text_Travelers_60.Y + Text_Travelers_60.Height
                  - Text_Travelers_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Travelers"
                        Width: =Parent.Width
            - Dropdown_Dean_Approved_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =If(IsBlank(Index(colTrip,1).dean_approved), Filter(colYesNo, answer = "N/A"),
                        Filter(colYesNo, answer = Index(colTrip,1).dean_approved))
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =16
                  Height: =Text_Input_Change_User_60.Height
                  Items: |-
                    =If(
                        CountRows(
                            Filter(
                                colBudgets, budget_type = "ARMY" &&
                                budget_id in ShowColumns(Filter(colTravelers, Not(IsBlank(budget_id))), budget_id))) > 0,
                        Filter(colYesNo, answer <> "N/A" && Not(IsBlank(answer))),
                        colYesNo)
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {dean_approved: Self.Selected.answer});
                    UpdateContext({varReadyToSubmit:false});
                  Visible: =If(Dropdown_Dean_Submitted_60.Selected.answer = "YES", true, false)
                  Width: =Dropdown_Dean_Submitted_60.Width
                  X: =Text_Input_Trip_Justification_60.X + Text_Input_Trip_Justification_60.Width - Self.Width
                  Y: =Text_GIK_Submitted_60.Y
                Children:
                  - answer2_5:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="answer"
                        FieldName: ="answer"
                        FieldType: ="s"
                        Order: =1
            - Text_Dean_Approved_60:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =18
                  Text: ="Approved?"
                  VerticalAlign: =VerticalAlign.Middle
                  Visible: =If(Dropdown_Dean_Submitted_60.Selected.answer = "YES", true, false)
                  Width: =Text_Trip_Event_60.Width*.8
                  X: =Dropdown_Dean_Approved_60.X -Self.Width
                  Y: =Text_GIK_Submitted_60.Y
            - Dropdown_Dean_Submitted_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =If(IsBlank(Index(colTrip,1).dean_submitted), Filter(colYesNo, answer = "N/A"),
                        Filter(colYesNo, answer = Index(colTrip,1).dean_submitted))
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =16
                  Height: =Text_Input_Change_User_60.Height
                  Items: |-
                    =If(
                        CountRows(
                            Filter(
                                colBudgets, budget_type = "ARMY",
                                budget_id in ShowColumns(Filter(colTravelers, Not(IsBlank(budget_id))), budget_id))) > 0,
                        Filter(colYesNo, answer <> "N/A" && Not(IsBlank(answer))),
                        colYesNo)
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {dean_submitted: Self.Selected.answer});
                    UpdateContext({varReadyToSubmit:false});

                    If(
                        Self.Selected.answer = "NO", 
                        UpdateContext({varShowDean: true}));
                  Visible: =Text_Dean_Submitted_60.Visible
                  Width: =Parent.Width/20
                  X: =Text_Dean_Submitted_60.X + Text_Dean_Submitted_60.Width
                  Y: =Text_GIK_Submitted_60.Y
                Children:
                  - answer2_4:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="answer"
                        FieldName: ="answer"
                        FieldType: ="s"
                        Order: =1
            - Text_Dean_Submitted_60:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =18
                  Text: ="Dean Submitted?"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Trip_Event_60.Width*1.25
                  X: =Text_Input_Trip_Justification_60.X
                  Y: =Text_GIK_Submitted_60.Y
            - Image_Whats_This_61:
                Control: Image@2.2.3
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Height: =Text_Input_Change_User_60.Height
                  Image: =WhatsThisIcon
                  OnSelect: |-
                    =UpdateContext({varShowDean: true});
                  Width: =Self.Height
                  X: =Dropdown_Dean_Submitted_60.X - Self.Width
                  Y: =Text_GIK_Submitted_60.Y
            - Dropdown_GIK_Approved_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =If(IsBlank(Index(colTrip,1).gik_approved), Filter(colYesNo, answer = "N/A"),
                        Filter(colYesNo, answer = Index(colTrip,1).gik_approved))
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_60.Height
                  Items: =colYesNo
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {gik_approved: Self.Selected.answer});
                    UpdateContext({varReadyToSubmit:false});
                  Visible: =If(Dropdown_GIK_Submitted_60.Selected.answer = "YES", true, false)
                  Width: =Dropdown_GIK_Submitted_60.Width
                  X: =Text_Input_Trip_Purpose_60.X + Text_Input_Trip_Purpose_60.Width - Self.Width
                  Y: =Text_GIK_Submitted_60.Y
                Children:
                  - answer2_3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="answer"
                        FieldName: ="answer"
                        FieldType: ="s"
                        Order: =1
            - Text_GIK_Approved_60:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =18
                  Text: ="Approved?"
                  VerticalAlign: =VerticalAlign.Middle
                  Visible: =If(Dropdown_GIK_Submitted_60.Selected.answer = "YES", true, false)
                  Width: =Text_Trip_Event_60.Width*.8
                  X: =Dropdown_GIK_Approved_60.X -Self.Width
                  Y: =Text_Input_Trip_Purpose_60.Y + Text_Input_Trip_Purpose_60.Height + Parent.Height/50
            - Dropdown_GIK_Submitted_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =If(IsBlank(Index(colTrip,1).gik_submitted), Filter(colYesNo, answer = "N/A"),
                        Filter(colYesNo, answer = Index(colTrip,1).gik_submitted))
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_60.Height
                  Items: =colYesNo
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {gik_submitted: Self.Selected.answer});
                    UpdateContext({varReadyToSubmit:false});

                    If(
                        Self.Selected.answer = "NO", 
                        UpdateContext({varShowGIK: true}));
                  Visible: =Text_GIK_Submitted_60.Visible
                  Width: =Parent.Width/20
                  X: =Text_GIK_Submitted_60.X + Text_GIK_Submitted_60.Width
                  Y: =Text_GIK_Submitted_60.Y
                Children:
                  - answer2_2:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="answer"
                        FieldName: ="answer"
                        FieldType: ="s"
                        Order: =1
            - Text_GIK_Submitted_60:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =18
                  Text: ="GIK Submitted?"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Trip_Event_60.Width*1.25
                  X: =Text_Trip_Event_60.X
                  Y: =Text_Input_Trip_Purpose_60.Y + Text_Input_Trip_Purpose_60.Height + Parent.Height/50
            - Image_Whats_This_60:
                Control: Image@2.2.3
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Height: =Text_Input_Change_User_60.Height
                  Image: =WhatsThisIcon
                  OnSelect: |-
                    =UpdateContext({varShowGIK: true});
                  Width: =Self.Height
                  X: =Dropdown_GIK_Submitted_60.X - Self.Width
                  Y: =Text_GIK_Submitted_60.Y
            - Text_Input_Destination_City_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).destination_city
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), 
                        {destination_city: Upper(Self.Text), 
                        destination: Concatenate(Upper(Self.Text), ", ", Index(colTrip,1).destination_state, ", ", Index(colTrip,1).destination_country)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Dropdown_Trip_Type_60.Width
                  X: =Text_Destination_City_60.X + Text_Destination_City_60.Width
                  Y: =Text_Destination_City_60.Y
            - Text_Destination_City_60:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="City:"
                  Width: =Parent.Width/15
                  X: =Text_Country_60.X
                  Y: =Button_Assign_OIC_60.Y
            - Text_Input_Trip_OIC_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).oic_name
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =//Patch(colProject, Index(colProject,1), {project_title: Upper(Self.Text)});
                    //UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Dropdown_Trip_Type_60.Width
                  X: =Button_Assign_OIC_60.X + Button_Assign_OIC_60.Width + Parent.Width/80
                  Y: =Button_Assign_OIC_60.Y
            - Button_Assign_OIC_60:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Set(varReturnScreen, App.ActiveScreen);

                    Refresh(current_fac_view);

                    Navigate(Screen_Personnel_Overview_10);

                    UpdateContext({varReadyToSubmit:false});
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="OIC"
                  Width: =Text_Trip_Start_60.Width - Parent.Width/80
                  X: =Text_Trip_Start_60.X
                  Y: |-
                    =Text_Trip_Type_60.Y + Text_Trip_Type_60.Height + Parent.Height/50

                    //Text_Input_Trip_Justification_60.Y + Text_Input_Trip_Justification_60.Height - Self.Height
            - Dropdown_State_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colStates, state = Index(colTrip,1).destination_state)
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_60.Height
                  Items: =colStates
                  OnChange: |-
                    =Reset(Text_Input_Destination_City_60);
                    Patch(colTrip, Index(colTrip,1), 
                        {destination_state: Self.Selected.state, 
                        destination_city: Blank(), 
                        destination: Blank()});
                    UpdateContext({varReadyToSubmit:false});
                  Visible: =If(Index(colTrip,1).destination_country = "USA", true, false)
                  Width: =Date_Picker_Trip_Start_60.Width
                  X: =Text_Country_60.X + Text_Country_60.Width
                  Y: =Text_Destination_State_60.Y
                Children:
                  - state3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="state"
                        FieldName: ="state"
                        FieldType: ="s"
                        Order: =1
            - Text_Input_Destination_State_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).destination_state
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Reset(Text_Input_Destination_City_60);
                    Patch(colTrip, Index(colTrip,1), 
                        {destination_state: Upper(Self.Text), 
                        destination_city: Blank()});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Visible: =If(Dropdown_Country_60.Selected.answer = "YES", false, true)
                  Width: =Dropdown_Trip_Type_60.Width
                  X: =Text_Destination_City_60.X + Text_Destination_City_60.Width
                  Y: =Text_Destination_State_60.Y
            - Text_Destination_State_60:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="State:"
                  Width: =Parent.Width/15
                  X: =Text_Country_60.X
                  Y: =Text_Trip_Type_60.Y
            - Dropdown_Trip_Type_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colTripTypes, trip_type = Index(colTrip,1).trip_type)
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_60.Height
                  Items: =colTripTypes
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {trip_type: Self.Selected.trip_type});
                    UpdateContext({varReadyToSubmit:false});
                  Width: =Date_Picker_Trip_Start_60.Width
                  X: =Text_Trip_Type_60.X + Text_Trip_Type_60.Width
                  Y: =Text_Trip_Type_60.Y
                Children:
                  - trip_type1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="trip_type"
                        FieldName: ="trip_type"
                        FieldType: ="s"
                        Order: =1
            - Text_Trip_Type_60:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Type:"
                  Width: =Text_Trip_Start_60.Width
                  X: =Text_Trip_Start_60.X
                  Y: =Text_Trip_End_60.Y + Text_Trip_End_60.Height + Parent.Height/50
            - Text_Input_Destination_Country_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).destination_country
                  DisplayMode: "=If(Dropdown_Country_60.Selected.answer = \"YES\", DisplayMode.Disabled, \r\n    If(IsBlank(Index(colTrip,2).trip_oic), \r\n        DisplayMode.Edit, \r\n        If(\r\n            (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n            varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n            \r\n            &&\r\n\r\n            (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0), \r\n            \r\n            DisplayMode.Edit, \r\n            DisplayMode.Disabled)))"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {destination_country: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Dropdown_Trip_Type_60.Width
                  X: =Text_Destination_City_60.X + Text_Destination_City_60.Width
                  Y: =Text_Destination_Country_60.Y
            - Text_Destination_Country_60:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Country:"
                  Width: =Parent.Width/15
                  X: =Text_Country_60.X
                  Y: =Text_Trip_End_60.Y
            - Date_Picker_Trip_End_60:
                Control: DatePicker@0.0.46
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Format: ='DatePickerCanvas.Format'.Short
                  Height: =Text_Input_Change_User_60.Height
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {trip_end: Self.SelectedDate});
                    UpdateContext({varReadyToSubmit:false});
                  SelectedDate: =Index(colTrip,1).trip_end
                  StartDate: =Index(colTrip,1).trip_start
                  Width: =Parent.Width/12
                  X: =Text_Trip_End_60.X + Text_Trip_End_60.Width
                  Y: =Text_Trip_End_60.Y
            - Text_Trip_End_60:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="End:"
                  Width: =Parent.Width/15
                  X: =Text_Trip_Start_60.X
                  Y: =Text_Trip_Start_60.Y + Text_Trip_Start_60.Height + Parent.Height/50
            - Dropdown_Country_60:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =Filter(
                        colYesNo, answer = 
                        If(
                            Index(colTrip,1).destination_country = "USA", "YES", "NO"))
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_60.Height
                  Items: =Filter(colYesNo, answer <> "N/A")
                  OnChange: |-
                    =
                    If(Self.Selected.answer = "YES", 
                        Patch(colTrip, Index(colTrip,1), 
                            {destination_country: "USA",
                            destination_state: Blank(), 
                            destination_city: Blank(), 
                            destination: Blank()}), 
                        Patch(colTrip, Index(colTrip,1), 
                            {destination_country: Blank(), 
                            destination_state: Blank(), 
                            destination_city: Blank(), 
                            destination: Blank()}));

                    Reset(Text_Input_Destination_Country_60);
                    Reset(Text_Input_Destination_State_60);
                    Reset(Dropdown_State_60);
                    Reset(Text_Input_Destination_City_60);

                    UpdateContext({varReadyToSubmit:false});
                  Width: =Date_Picker_Trip_Start_60.Width
                  X: =Text_Country_60.X + Text_Country_60.Width
                  Y: =Text_Country_60.Y
                Children:
                  - answer2:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="answer"
                        FieldName: ="answer"
                        FieldType: ="s"
                        Order: =1
            - Text_Country_60:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="In US?"
                  Width: =Parent.Width/15
                  X: =Date_Picker_Trip_Start_60.X + Date_Picker_Trip_Start_60.Width + Parent.Width/50
                  Y: =Text_Trip_Start_60.Y
            - Date_Picker_Trip_Start_60:
                Control: DatePicker@0.0.46
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  EndDate: =Index(colTrip,1).trip_end
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Format: ='DatePickerCanvas.Format'.Short
                  Height: =Text_Input_Change_User_60.Height
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {trip_start: Self.SelectedDate});
                    UpdateContext({varReadyToSubmit:false});
                  SelectedDate: =Index(colTrip,1).trip_start
                  Width: =Parent.Width/12
                  X: =Text_Trip_Start_60.X + Text_Trip_Start_60.Width
                  Y: =Text_Trip_Start_60.Y
            - Text_Trip_Start_60:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Start:"
                  Width: =Parent.Width/15
                  X: =Text_Input_Trip_Event_60.X + Text_Input_Trip_Event_60.Width + Parent.Width/50
                  Y: =Text_Trip_Event_60.Y
            - Text_Input_Trip_Justification_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).trip_summary
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height*3.5
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =1000
                  Mode: =TextMode.MultiLine
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {trip_summary: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =2
                  Width: =Text_Trip_Purpose_60.Width
                  X: =Text_Trip_Summary_60.X
                  Y: =Text_Trip_Purpose_60.Y + Text_Trip_Purpose_60.Height
            - Text_Trip_Summary_60:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Trip Summary"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =(Text_Input_Trip_Event_60.X + Text_Input_Trip_Event_60.Width - Text_Trip_Event_60.X)/2 - Parent.Width/100
                  X: =Text_Trip_Purpose_60.X + Text_Trip_Purpose_60.Width + Parent.Width/50
                  Y: =Text_Trip_Purpose_60.Y
            - Text_Input_Trip_Purpose_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).purpose
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height*3.5
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =1000
                  Mode: =TextMode.MultiLine
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {purpose: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =2
                  Width: =Text_Trip_Purpose_60.Width
                  X: =Text_Trip_Event_60.X
                  Y: =Text_Trip_Purpose_60.Y + Text_Trip_Purpose_60.Height
            - Text_Trip_Purpose_60:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Trip Purpose"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =(Text_Input_Trip_Event_60.X + Text_Input_Trip_Event_60.Width - Text_Trip_Event_60.X)/2 - Parent.Width/100
                  X: =Text_Trip_Event_60.X
                  Y: =Text_Trip_Event_60.Y + Text_Trip_Event_60.Height
            - Text_Input_Trip_Event_60:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colTrip,1).trip_event
                  DisplayMode: "=If(IsBlank(Index(colTrip,2).trip_oic), \r\n    DisplayMode.Edit, \r\n    If(\r\n        (varUser.tour_id = Index(colTrip,2).trip_oic ||\r\n        varPermissions = \"Master\" || varPermissions = \"Admin\" || varPermissions = \"Research\")\r\n        \r\n        &&\r\n\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n        DisplayMode.Edit, \r\n        DisplayMode.Disabled))\r\n"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_60.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colTrip, Index(colTrip,1), {trip_event: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Parent.Width/2
                  X: =Text_Trip_Event_60.X + Text_Trip_Event_60.Width
                  Y: =Text_Trip_Event_60.Y
            - Text_Trip_Event_60:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_60.Height
                  Size: =23
                  Text: ="Event"
                  Width: =Parent.Width/12
                  X: =Parent.Width/40
                  Y: =Parent.Height/50
            - Rectangle_Disable_60:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Spinner_60.Visible ||
                        Container_New_Cadet_Traveler_60.Visible ||
                        Container_Traveler_Pers_Type_60.Visible ||
                        Container_Missed_Classes_60.Visible ||
                        Container_Cost_Details_60.Visible ||
                        Container_Add_Files_60.Visible ||
                        varShowDean ||
                        varShowGIK ||
                        Container_Disburse_60.Visible ||
                        Container_Approvals_60.Visible ||
                        Container_Add_Locs_60.Visible ||
                        Container_Cancel_Trip_60.Visible,
                        true, false)
                  Width: =Parent.Width
            - Container_Cost_Details_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Container_Traveler_Details_60.Height
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowCostDetails
                  Width: =Container_Travelers_60.Width
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Cost_Details_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(    
                              Not(IsBlank(Text_Input_Meal_Cost_60.Text)) &&
                              Not(IsBlank(Text_Input_Lodging_Cost_60.Text)) &&
                              Not(IsBlank(Text_Input_Rental_Cost_60.Text)) &&
                              Not(IsBlank(Text_Input_POV_Cost_60.Text)) &&
                              Not(IsBlank(Text_Input_Airfare_Cost_60.Text)) &&

                              If(
                                  Text_Cost_Desc_60.Visible,
                                  If(
                                      IsBlank(Text_Input_Cost_Desc_60.Text), 
                                      false, true),
                                  true), 

                              If(Not(IsBlank(Gallery_Travelers_60.Selected.travel_id)),
                                  Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                      {meal_cost: Round(Abs(Value(Text_Input_Meal_Cost_60.Text)),2), 
                                      lodging_cost: Round(Abs(Value(Text_Input_Lodging_Cost_60.Text)),2), 
                                      rental_cost: Round(Abs(Value(Text_Input_Rental_Cost_60.Text)),2), 
                                      pov_cost: Round(Abs(Value(Text_Input_POV_Cost_60.Text)),2), 
                                      airfare_cost: Round(Abs(Value(Text_Input_Airfare_Cost_60.Text)),2), 
                                      other_cost: Round(Abs(Value(Text_Input_Other_Cost_60.Text)),2),
                                      cost_desc: If(Text_Cost_Desc_60.Visible, Upper(Text_Input_Cost_Desc_60.Text), Blank()),
                                      travel_cost_committed: Round(Abs(Value(Text_Input_Total_Cost_60.Text)),2)});
                                  Set(varTraveler, Patch(varTraveler,
                                      {meal_cost: Round(Abs(Value(Text_Input_Meal_Cost_60.Text)),2), 
                                      lodging_cost: Round(Abs(Value(Text_Input_Lodging_Cost_60.Text)),2), 
                                      rental_cost: Round(Abs(Value(Text_Input_Rental_Cost_60.Text)),2), 
                                      pov_cost: Round(Abs(Value(Text_Input_POV_Cost_60.Text)),2), 
                                      airfare_cost: Round(Abs(Value(Text_Input_Airfare_Cost_60.Text)),2), 
                                      other_cost: Round(Abs(Value(Text_Input_Other_Cost_60.Text)),2),
                                      cost_desc: If(Text_Cost_Desc_60.Visible, Upper(Text_Input_Cost_Desc_60.Text), Blank()),
                                      travel_cost_committed: Round(Abs(Value(Text_Input_Total_Cost_60.Text)),2)})),
                                  Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                      {meal_cost: Round(Abs(Value(Text_Input_Meal_Cost_60.Text)),2), 
                                      lodging_cost: Round(Abs(Value(Text_Input_Lodging_Cost_60.Text)),2), 
                                      rental_cost: Round(Abs(Value(Text_Input_Rental_Cost_60.Text)),2), 
                                      pov_cost: Round(Abs(Value(Text_Input_POV_Cost_60.Text)),2), 
                                      airfare_cost: Round(Abs(Value(Text_Input_Airfare_Cost_60.Text)),2), 
                                      other_cost: Round(Abs(Value(Text_Input_Other_Cost_60.Text)),2),
                                      cost_desc: If(Text_Cost_Desc_60.Visible, Upper(Text_Input_Cost_Desc_60.Text), Blank()),
                                      travel_cost_committed: Round(Abs(Value(Text_Input_Total_Cost_60.Text)),2)});
                                  Set(varTraveler, Patch(varTraveler,
                                      {meal_cost: Round(Abs(Value(Text_Input_Meal_Cost_60.Text)),2), 
                                      lodging_cost: Round(Abs(Value(Text_Input_Lodging_Cost_60.Text)),2), 
                                      rental_cost: Round(Abs(Value(Text_Input_Rental_Cost_60.Text)),2), 
                                      pov_cost: Round(Abs(Value(Text_Input_POV_Cost_60.Text)),2), 
                                      airfare_cost: Round(Abs(Value(Text_Input_Airfare_Cost_60.Text)),2), 
                                      other_cost: Round(Abs(Value(Text_Input_Other_Cost_60.Text)),2),
                                      cost_desc: If(Text_Cost_Desc_60.Visible, Upper(Text_Input_Cost_Desc_60.Text), Blank()),
                                      travel_cost_committed: Round(Abs(Value(Text_Input_Total_Cost_60.Text)),2)})));
                                  Reset(Text_Input_Travel_Cost_60);
                                  UpdateContext({varResetCosts:true});
                                  UpdateContext({varResetCosts:false});
                                  UpdateContext({varShowCostDetails:false});
                                  UpdateContext({varReadyToSubmit:false});
                                  UpdateContext({varTravelerChange:true}),
                              Notify("PLEASE ENSURE EVERY COST HAS AN AMOUNT. IF A CATEGORY HAS NO COST, PLEASE ENTER ZERO. IF THERE IS AN 'OTHER' COST, YOU MUST PROVIDE A DESCRIPTION.", NotificationType.Error));
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save Changes"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Cost_Details_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varResetCosts:true});
                          UpdateContext({varResetCosts:false});
                          UpdateContext({varShowCostDetails:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Input_Total_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Sum(Abs(Value(Text_Input_Meal_Cost_60.Text)), Abs(Value(Text_Input_Lodging_Cost_60.Text)), Abs(Value(Text_Input_Rental_Cost_60.Text)), Abs(Value(Text_Input_POV_Cost_60.Text)), Abs(Value(Text_Input_Airfare_Cost_60.Text)), Abs(Value(Text_Input_Other_Cost_60.Text)))
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =/*If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                          */
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Total_Cost_60.X + Text_Total_Cost_60.Width
                        Y: =Text_Total_Cost_60.Y
                  - Text_Total_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="Total Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Parent.Width/2 - Self.Width
                        Y: =Text_Cost_Desc_60.Y + Text_Cost_Desc_60.Height + Parent.Height/30
                  - Text_Input_Cost_Desc_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.cost_desc
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic ||
                              varUser.tour_id = Index(colTrip,2).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Visible: =Text_Cost_Desc_60.Visible
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_Cost_Desc_60.X + Text_Cost_Desc_60.Width
                        Y: =Text_Cost_Desc_60.Y
                  - Text_Cost_Desc_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="'Other' Description:"
                        Visible: |-
                          =If(
                              IsBlank(Text_Input_Other_Cost_60.Text) || Abs(Value(Text_Input_Other_Cost_60.Text)) = 0, 
                              false, true)
                        Width: =Text_Traveler_Name_60.Width * 1.25
                        X: =Text_Rental_Cost_60.X
                        Y: =Text_Other_Cost_60.Y + Text_Other_Cost_60.Height + Parent.Height/30
                  - Text_Input_Other_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.other_cost)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Input_travel_cost_id_61.X
                        Y: =Text_Other_Cost_60.Y
                  - Text_Other_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="Other Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Text_travel_cost_id_61.X
                        Y: =Text_Airfare_Cost_60.Y + Text_Airfare_Cost_60.Height + Parent.Height/30
                  - Text_Input_Rental_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.rental_cost)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =/*If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                          */
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Meal_Cost_60.X + Text_Meal_Cost_60.Width
                        Y: =Text_Rental_Cost_60.Y
                  - Text_Rental_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="Rental Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Text_Traveler_Name_60.X
                        Y: =Text_Lodging_Cost_60.Y + Text_Lodging_Cost_60.Height + Parent.Height/30
                  - Text_Input_Airfare_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.airfare_cost)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =/*If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                          */
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Input_travel_cost_id_61.X
                        Y: =Text_Airfare_Cost_60.Y
                  - Text_Airfare_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="Airfare Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Text_travel_cost_id_61.X
                        Y: =Text_POV_Cost_60.Y + Text_POV_Cost_60.Height + Parent.Height/30
                  - Text_Input_Lodging_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.lodging_cost)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =/*If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                          */
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Meal_Cost_60.X + Text_Meal_Cost_60.Width
                        Y: =Text_Lodging_Cost_60.Y
                  - Text_Lodging_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="Lodging Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Text_Traveler_Name_60.X
                        Y: =Text_Meal_Cost_60.Y + Text_Meal_Cost_60.Height + Parent.Height/30
                  - Text_Input_POV_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.pov_cost)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =/*If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                          */
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Input_travel_cost_id_61.X
                        Y: =Text_POV_Cost_60.Y
                  - Text_POV_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="POV Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Text_travel_cost_id_61.X
                        Y: =Text_Meal_Cost_60.Y
                  - Text_Input_Meal_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.meal_cost)
                        DisplayMode: |-
                          =If(
                              IsBlank(varTraveler.cd_approved_on) &&
                              (varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetCosts
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_Meal_Cost_60.X + Text_Meal_Cost_60.Width
                        Y: =Text_Meal_Cost_60.Y
                  - Text_Meal_Cost_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_60.Height
                        Size: =23
                        Text: ="Meal Cost:"
                        Width: =Text_Traveler_Name_60.Width
                        X: =Text_Traveler_Name_60.X
                        Y: =Text_Traveler_Name_60.Y + Text_Traveler_Name_60.Height + Parent.Height/10
                  - Text_Input_travel_cost_id_61:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.travel_id
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_Traveler_Name_60.Width
                        X: =Text_travel_cost_id_61.X + Text_travel_cost_id_61.Width
                        Y: =Text_travel_cost_id_61.Y
                  - Text_travel_cost_id_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =23
                        Text: ="Travel ID"
                        Width: =Parent.Width/5
                        X: =Text_Input_Traveler_Name_60.X + Text_Input_Traveler_Name_60.Width + Parent.Width/40
                        Y: =Text_Traveler_Name_60.Y
                  - Text_Input_Traveler_Name_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.traveler_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/2 - Self.X - Parent.Width/80
                        X: =Text_Traveler_Name_60.X + Text_Traveler_Name_60.Width
                        Y: =Text_Traveler_Name_60.Y
                  - Text_Traveler_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =23
                        Text: ="Traveler"
                        Width: =Parent.Width/5
                        X: =Parent.Width/40
                        Y: =Text_Cost_Breakdown_60.Y + Text_Cost_Breakdown_60.Height + Parent.Height/50
                  - Text_Cost_Breakdown_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/12
                        Size: =24
                        Text: ="Travel Cost Breakdown"
                        Width: =Parent.Width
            - Container_Missed_Classes_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowClass
                  Width: =Parent.Width/1.5
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Classes_Missed_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: "=If(varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.wp_email = varTraveler.traveler_email ||\r\n    varUser.dept_pos = \"P6\" || \r\n    varUser.dept_pos = \"P5\" || \r\n    varUser.dept_pos = \"XO\" ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n    \r\n    If(\r\n        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n        true, false), \r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Classes_Missed_60.Height*1.25
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\r\n    varTraveler.missing_class = \"NO\" ||\r\n    varTraveler.missing_class = \"REARRANGED SCHEDULE\" ||\r\n    varTraveler.missing_class = \"N/A\", \r\n    \r\n    If(\r\n        IsBlank(varTraveler.travel_id), \r\n\r\n        ForAll(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num) As class,\r\n            Remove(colClassesMissed, class));\r\n        \r\n        UpdateContext({varMissingClassChange: true});\r\n        UpdateContext({varShowClass:false}),\r\n\r\n        ForAll(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id) As class,\r\n            If(IsBlank(class.missed_class_id), \r\n                Remove(colClassesMissed, class), \r\n                Collect(colRemoveClassesMissed, class);\r\n                Remove(colClassesMissed, class)));\r\n        \r\n        UpdateContext({varMissingClassChange: true});\r\n        UpdateContext({varShowClass:false})), \r\n    \r\n    If(\r\n        CountRows(Filter(colClassesMissed, IsBlank(section_id))) = 0 &&\r\n        CountRows(Filter(colClassesMissed, IsBlank(missed_date))) = 0, \r\n\r\n        If(\r\n            IsBlank(varTraveler.travel_id),\r\n            If(\r\n                CountRows(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num)) > 0 &&\r\n                CountRows(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num, IsBlank(approved_on))) = 0, \r\n                Patch(colTravelers, LookUp(Filter(colTravelers, usma_pers_id = varTraveler.usma_pers_id), new_traveler_num = varTraveler.new_traveler_num),\r\n                    {pd_approved_on: Today()});\r\n                Set(varTraveler, \r\n                    Patch(varTraveler, {pd_approved_on: Blank()})); \r\n                UpdateContext({varMissingClassChange: true});\r\n                UpdateContext({varShowClass:false}),\r\n                \r\n                Patch(colTravelers, LookUp(Filter(colTravelers, usma_pers_id = varTraveler.usma_pers_id), new_traveler_num = varTraveler.new_traveler_num),\r\n                    {pd_approved_on: Blank()});\r\n                Set(varTraveler, \r\n                    Patch(varTraveler, {pd_approved_on: Blank()}));\r\n                UpdateContext({varMissingClassChange: true});\r\n                UpdateContext({varShowClass:false})),\r\n\r\n            If(\r\n                CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id)) > 0 &&\r\n                CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id, IsBlank(approved_on))) = 0, \r\n                Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n                    {pd_approved_on: Today()});\r\n                Set(varTraveler, \r\n                    Patch(varTraveler, {pd_approved_on: Blank()}));\r\n                    \r\n                UpdateContext({varMissingClassChange: true});\r\n                UpdateContext({varShowClass:false}),\r\n                \r\n                Patch(colTravelers, LookUp(Filter(colTravelers, usma_pers_id = varTraveler.usma_pers_id), new_traveler_num = varTraveler.new_traveler_num),\r\n                    {pd_approved_on: Blank()});\r\n                Set(varTraveler, \r\n                    Patch(varTraveler, {pd_approved_on: Blank()}));\r\n                UpdateContext({varMissingClassChange: true});\r\n                UpdateContext({varShowClass:false}))), \r\n\r\n        Notify(\"PLEASE ENSURE YOU HAVE SELECTED A DATE AND HOUR THAT YOU ARE MISSING CLASS\", NotificationType.Error)))"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Self.Height*3.5
                        X: |-
                          =If(
                              Checkbox_Not_Missing_Class_60.Value ||
                              Checkbox_Rearranged_Schedule_60.Value ||
                              Checkbox_Class_NA_60.Value,
                              Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width, 
                              Parent.Width/ 2 - Self.Width/2)
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Missing_Class_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              CountRows(
                                  Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Button_Save_Classes_Missed_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\r\n    IsBlank(varTraveler.pd_approved_on),\r\n    \r\n        If(IsBlank(varTraveler.travel_id), \r\n            Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),\r\n                {pd_approved_on: Today(), \r\n                pd_tour: varUser.tour_id}),\r\n            Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n                {pd_approved_on: Today(), \r\n                pd_tour: varUser.tour_id}));\r\n        Set(varTraveler, Patch(varTraveler, \r\n                {pd_approved_on: Today(), \r\n                pd_tour: varUser.tour_id})),\r\n        If(IsBlank(varTraveler.travel_id), \r\n            Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),\r\n                {pd_approved_on: Blank(), \r\n                pd_tour: Blank()}),\r\n            Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n                {pd_approved_on: Blank(), \r\n                pd_tour: Blank()}));\r\n        Set(varTraveler, Patch(varTraveler, \r\n                {pd_approved_on: Blank(), \r\n                pd_tour: Blank()})));\r\nUpdateContext({varReadyToSubmit:false});\r\nUpdateContext({varTravelerChange:true});"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: |-
                          =If(
                              IsBlank(varTraveler.pd_approved_on),
                              "Approve", "Disapprove")
                        Tooltip: ="Only your APD can approve your missed class plan"
                        Visible: |-
                          =If(
                              Checkbox_Not_Missing_Class_60.Value ||
                              Checkbox_Rearranged_Schedule_60.Value ||
                              Checkbox_Class_NA_60.Value, true, false)
                        Width: =Dropdown_Cost_Status_60.Width
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Button_Save_Classes_Missed_60.Y
                  - Checkbox_Class_NA_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Default: |-
                          =If(
                              varTraveler.missing_class = "N/A", true, false)
                        DisplayMode: "=If(\r\n    Not(IsBlank(varTraveler.pd_approved_on)), \r\n    DisplayMode.Disabled,\r\n\r\n    If(\r\n        IsBlank(varTraveler.travel_id), \r\n            If(\r\n                CountRows(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled),\r\n\r\n            If(\r\n                CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled)))"
                        Font: =Font.'Open Sans'
                        Height: =Text_Classes_Missed_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: "N/A"}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: "N/A"}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: "N/A"}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        OnUncheck: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: Blank()}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: Blank()}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: Blank()}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        Size: =10
                        Text: ="Not Applicable"
                        Tooltip: ="Select this option if you don't teach for the Math Department or your travel is outside a semester you teach"
                        Width: =Button_Save_Classes_Missed_60.Width
                        X: =Checkbox_Rearranged_Schedule_60.X + Checkbox_Rearranged_Schedule_60.Width + Parent.Width/40
                        Y: =Gallery_Classes_Missed_60.Y + Gallery_Classes_Missed_60.Height + Parent.Height/50
                  - Checkbox_Rearranged_Schedule_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Default: |-
                          =If(
                              varTraveler.missing_class = "REARRANGED SCHEDULE", true, false)
                        DisplayMode: "=If(\r\n    Not(IsBlank(varTraveler.pd_approved_on)), \r\n    DisplayMode.Disabled,\r\n\r\n    If(\r\n        IsBlank(varTraveler.travel_id), \r\n            If(\r\n                CountRows(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled),\r\n\r\n            If(\r\n                CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled)))"
                        Font: =Font.'Open Sans'
                        Height: =Text_Classes_Missed_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: "REARRANGED SCHEDULE"}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: "REARRANGED SCHEDULE"}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: "REARRANGED SCHEDULE"}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        OnUncheck: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: Blank()}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: Blank()}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: Blank()}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        Size: =10
                        Text: ="Rearranged Schedule"
                        Tooltip: ="Select this option if you rearranged your schedule to allow for this travel"
                        Width: =Button_Save_Classes_Missed_60.Width
                        X: =Gallery_Classes_Missed_60.Width/2 + Gallery_Classes_Missed_60.X - Self.Width/2
                        Y: =Gallery_Classes_Missed_60.Y + Gallery_Classes_Missed_60.Height + Parent.Height/50
                  - Checkbox_Not_Missing_Class_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Default: |-
                          =If(
                              varTraveler.missing_class = "NO", true, false)
                        DisplayMode: "=If(\r\n    Not(IsBlank(varTraveler.pd_approved_on)), \r\n    DisplayMode.Disabled,\r\n\r\n    If(\r\n        IsBlank(varTraveler.travel_id), \r\n            If(\r\n                CountRows(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled),\r\n\r\n            If(\r\n                CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled)))"
                        Font: =Font.'Open Sans'
                        Height: =Text_Classes_Missed_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: "NO"}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: "NO"}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: "NO"}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        OnUncheck: |-
                          =If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: Blank()}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: Blank()}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: Blank()}));
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange:true});
                        Size: =10
                        Text: ="Not Missing Class"
                        Tooltip: ="Select this option if your teaching drops align with your travel"
                        Width: =Button_Save_Classes_Missed_60.Width
                        X: =Checkbox_Rearranged_Schedule_60.X - Self.Width - Parent.Width/40
                        Y: =Gallery_Classes_Missed_60.Y + Gallery_Classes_Missed_60.Height + Parent.Height/50
                  - Gallery_Classes_Missed_60:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Parent.Height/2.5
                        Items: |-
                          =If(
                              IsBlank(varTraveler.travel_id), 
                              Filter(colClassesMissed, new_traveler_num = varTraveler.new_traveler_num, usma_pers_id = varTraveler.usma_pers_id),
                              Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id))
                        OnSelect: =
                        TemplateSize: =Text_Classes_Missed_60.Height
                        Visible: |-
                          =If(
                              Checkbox_Not_Missing_Class_60.Value ||
                              Checkbox_Rearranged_Schedule_60.Value ||
                              Checkbox_Class_NA_60.Value,
                              false, true)
                        Width: =Text_Classes_Missed_60.Width
                        X: =Text_Classes_Missed_60.X
                        Y: =Text_Class_Date_60.Y + Text_Class_Date_60.Height
                      Children:
                        - Icon_Remove_Classes_Missed_60:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\r\n    IsBlank(ThisItem.approved_on),\r\n\r\n    If(varPermissions = \"Master\" ||\r\n        varPermissions = \"Admin\" ||\r\n        varPermissions = \"Research\" ||\r\n        varUser.wp_email = varTraveler.traveler_email ||\r\n        varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n        varUser.apd = ThisItem.apd ||\r\n        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n        DisplayMode.Edit, DisplayMode.Disabled), \r\n    \r\n    DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(Not(IsBlank(ThisItem.missed_class_id)), 
                                    Collect(colRemoveClassesMissed, ThisItem));

                                Remove(colClassesMissed, ThisItem);

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varMissingClassChange:true});
                              Width: =Self.Height
                              X: =Icon_Add_Classes_Missed_60.X - Gallery_Classes_Missed_60.X
                        - Date_Picker_Class_PD_Approved_60:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderRadius: =10
                              DisplayMode: =DisplayMode.Disabled
                              EndDate: =Date_Picker_Travel_End_61.SelectedDate
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: |-
                                =Patch(colClassesMissed, ThisItem, {missed_date:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =ThisItem.approved_on
                              StartDate: =Date_Picker_Travel_Start_61.SelectedDate
                              Width: =Text_Class_PD_Approved_60.X + Text_Class_PD_Approved_60.Width - Self.X - Gallery_Classes_Missed_60.X
                              X: =Checkbox_Class_PD_Approved_60.X + Checkbox_Class_PD_Approved_60.Width
                        - Checkbox_Class_PD_Approved_60:
                            Control: Classic/CheckBox@2.1.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                              CheckmarkFill: =RGBA(0, 0, 0, 1)
                              Default: =Not(IsBlank(ThisItem.approved_on))
                              DisplayMode: "=If(\r\n    IsBlank(ThisItem.apd) ||\r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers) ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = CountRows(colTravelers)), \r\n    DisplayMode.Disabled, \r\n    \r\n    If(\r\n        varUser.apd = ThisItem.apd,\r\n        DisplayMode.Edit, DisplayMode.Disabled))"
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverColor: =RGBA(0, 18, 107, 1)
                              OnCheck: |
                                =Patch(colClassesMissed, ThisItem, 
                                    {approved_on: Today()});

                                Self.Value = true;

                                UpdateContext({varReadyToSubmit:false})
                              OnSelect: =Select(Parent)
                              OnUncheck: |-
                                =Self.Value = false;

                                Patch(colClassesMissed, ThisItem, 
                                    {approved_on: Blank()});

                                Reset(Date_Picker_Class_PD_Approved_60);

                                If(
                                    IsBlank(varTraveler.travel_id), 
                                        Patch(colTravelers, LookUp(Filter(colTravelers, usma_pers_id = varTraveler.usma_pers_id), new_traveler_num = varTraveler.new_traveler_num), 
                                            {pd_approved_on: Blank()}),
                                        Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id), 
                                            {pd_approved_on: Blank()}));
                                Set(varTraveler, Patch(varTraveler, {pd_approved_on: Blank()})); 

                                UpdateContext({varReadyToSubmit:false})
                              Text: =
                              Width: =Self.Height
                              X: =Text_Class_PD_Approved_60.X - Gallery_Classes_Missed_60.X
                        - Dropdown_Covering_Fac_60:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colFaculty, tour_id = ThisItem.covering_fac_tour)
                              DisplayMode: "=If(\r\n    IsBlank(ThisItem.approved_on),\r\n\r\n    If(varPermissions = \"Master\" ||\r\n        varPermissions = \"Admin\" ||\r\n        varPermissions = \"Research\" ||\r\n        varUser.wp_email = varTraveler.traveler_email ||\r\n        varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n        varUser.apd = ThisItem.apd ||\r\n        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n        DisplayMode.Edit, DisplayMode.Disabled), \r\n    \r\n    DisplayMode.Disabled)"
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Sort(colFaculty, name, SortOrder.Ascending)
                              OnChange: |-
                                =Patch(colClassesMissed, ThisItem, {covering_fac_tour: Self.Selected.tour_id});
                                //UpdateContext({varReadyToSubmit:false});
                              Width: =Text_Covering_Fac_60.Width
                              X: =Text_Covering_Fac_60.X - Gallery_Classes_Missed_60.X
                            Children:
                              - name1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="name"
                                    FieldName: ="name"
                                    FieldType: ="s"
                                    Order: =1
                              - tour_id1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="tour_id"
                                    FieldName: ="tour_id"
                                    FieldType: ="n"
                                    Order: =3
                              - last_name2:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="last_name"
                                    FieldName: ="last_name"
                                    FieldType: ="s"
                                    Order: =2
                        - Text_Input_Class_Num_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.class_num
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =Set(varTraveler, ThisItem);
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Class_Num_60.Width
                              X: =Text_Class_Num_60.X - Gallery_Classes_Missed_60.X
                        - Dropdown_Class_Hour_60:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colSections, section_id = ThisItem.section_id)
                              DisplayMode: "=If(\r\n    IsBlank(ThisItem.approved_on),\r\n\r\n    If(varPermissions = \"Master\" ||\r\n        varPermissions = \"Admin\" ||\r\n        varPermissions = \"Research\" ||\r\n        varUser.wp_email = varTraveler.traveler_email ||\r\n        varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n        varUser.apd = ThisItem.apd ||\r\n        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n        DisplayMode.Edit, DisplayMode.Disabled), \r\n    \r\n    DisplayMode.Disabled)"
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id)
                              OnChange: |-
                                =Patch(colClassesMissed, ThisItem, 
                                    {class_num: Self.Selected.class_num, 
                                    section_id: Self.Selected.section_id, 
                                    apd: Self.Selected.apd});
                                UpdateContext({varReadyToSubmit:false});
                              Width: =Text_Class_Hour_60.Width
                              X: =Text_Class_Hour_60.X - Gallery_Classes_Missed_60.X
                            Children:
                              - section_num1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="section_num"
                                    FieldName: ="section_num"
                                    FieldType: ="n"
                                    Order: =5
                              - section_id1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="section_id"
                                    FieldName: ="section_id"
                                    FieldType: ="n"
                                    Order: =4
                              - offering_id1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="offering_id"
                                    FieldName: ="offering_id"
                                    FieldType: ="n"
                                    Order: =3
                              - class_num2:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="class_num"
                                    FieldName: ="class_num"
                                    FieldType: ="s"
                                    Order: =2
                              - class_hour1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="class_hour"
                                    FieldName: ="class_hour"
                                    FieldType: ="s"
                                    Order: =1
                              - apd1:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="apd"
                                    FieldName: ="apd"
                                    FieldType: ="n"
                                    Order: =6
                        - Date_Picker_Class_Missed_60:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderRadius: =10
                              DisplayMode: "=If(\r\n    IsBlank(ThisItem.approved_on),\r\n\r\n    If(varPermissions = \"Master\" ||\r\n        varPermissions = \"Admin\" ||\r\n        varPermissions = \"Research\" ||\r\n        varUser.wp_email = varTraveler.traveler_email ||\r\n        varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n        varUser.apd = ThisItem.apd ||\r\n        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n        DisplayMode.Edit, DisplayMode.Disabled), \r\n    \r\n    DisplayMode.Disabled)"
                              EndDate: =Date_Picker_Travel_End_61.SelectedDate
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: |-
                                =Patch(colClassesMissed, ThisItem, {missed_date:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =ThisItem.missed_date
                              StartDate: =Date_Picker_Travel_Start_61.SelectedDate
                              Width: =Text_Class_Date_60.Width
                              X: =Text_Class_Date_60.X - Gallery_Classes_Missed_60.X
                              Y: =2.0775000000000006
                        - Separator_Gallery_Classes_Missed_60:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Classes_Missed_60:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    Not(IsBlank(varTraveler.pd_approved_on)), \r\n    DisplayMode.Disabled,\r\n\r\n    If(\r\n        IsBlank(varTraveler.travel_id), \r\n            If(\r\n                CountRows(Filter(colClassesMissed, usma_pers_id = varTraveler.usma_pers_id, new_traveler_num = varTraveler.new_traveler_num, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled),\r\n\r\n            If(\r\n                CountRows(Filter(colClassesMissed, travel_cost_id = varTraveler.travel_id, Not(IsBlank(approved_on)))) = 0, \r\n                \r\n                If(varPermissions = \"Master\" ||\r\n                    varPermissions = \"Admin\" ||\r\n                    varPermissions = \"Research\" ||\r\n                    varUser.wp_email = varTraveler.traveler_email ||\r\n                    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n                    \r\n                    If(\r\n                        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n                        true, false), \r\n\r\n                    DisplayMode.Edit, DisplayMode.Disabled),\r\n                DisplayMode.Disabled)))"
                        Height: =Text_Class_Num_60.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colClassesMissed,
                              {missed_class_id: Blank(),
                              travel_cost_id: varTraveler.travel_id,
                              trip_id: Index(colTrip,1).trip_id,
                              section_id: Blank(), 
                              class_num: Blank(),
                              missed_date: Blank(),
                              covering_fac_tour: Blank(),
                              apd: Blank(), 
                              apd_name: Blank(), 
                              approved_on: Blank(),
                              new_missed_class: Max(colClassesMissed, new_missed_class) + 1,
                              usma_pers_id: varTraveler.usma_pers_id,
                              new_traveler_num: varTraveler.new_traveler_num});

                          If(IsBlank(varTraveler.travel_id), 
                              Patch(colTravelers, LookUp(colTravelers, new_traveler_num = varTraveler.new_traveler_num),
                                  {missing_class: "YES"}),
                              Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),
                                  {missing_class: "YES"}));
                          Set(varTraveler, Patch(varTraveler, 
                                  {missing_class: "YES"}));

                          UpdateContext({varMissingClassChange:true});

                          UpdateContext({varReadyToSubmit:false});
                        Width: =Self.Height
                        X: =(Gallery_Classes_Missed_60.X + Gallery_Classes_Missed_60.Width - Text_Class_PD_Approved_60.X - Text_Class_PD_Approved_60.Width - Self.Width)/2 + Text_Class_PD_Approved_60.X + Text_Class_PD_Approved_60.Width
                        Y: =Text_Class_Num_60.Y
                  - Text_Class_PD_Approved_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Classes_Missed_60.Height
                        Size: =24
                        Text: ="Approved"
                        Width: =Parent.Width/6
                        X: =Text_Covering_Fac_60.X + Text_Covering_Fac_60.Width + 10
                        Y: =Text_Classes_Missed_60.Y + Text_Classes_Missed_60.Height
                  - Text_Covering_Fac_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Classes_Missed_60.Height
                        Size: =24
                        Text: ="Covering"
                        Width: =Parent.Width/4
                        X: =Text_Class_Num_60.X + Text_Class_Num_60.Width + 10
                        Y: =Text_Classes_Missed_60.Y + Text_Classes_Missed_60.Height
                  - Text_Class_Num_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Classes_Missed_60.Height
                        Size: =24
                        Text: ="Course"
                        Width: =Text_Classes_Missed_60.Width/8
                        X: =Text_Class_Hour_60.X + Text_Class_Hour_60.Width + 10
                        Y: =Text_Classes_Missed_60.Y + Text_Classes_Missed_60.Height
                  - Text_Class_Hour_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Classes_Missed_60.Height
                        Size: =24
                        Text: ="Hour"
                        Width: =Text_Classes_Missed_60.Width/8
                        X: =Text_Class_Date_60.X + Text_Class_Date_60.Width + 10
                        Y: =Text_Classes_Missed_60.Y + Text_Classes_Missed_60.Height
                  - Text_Class_Date_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Classes_Missed_60.Height
                        Size: =24
                        Text: ="Date"
                        Width: =Text_Classes_Missed_60.Width/6
                        X: =Text_Classes_Missed_60.X
                        Y: =Text_Classes_Missed_60.Y + Text_Classes_Missed_60.Height
                  - Text_Classes_Missed_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/10
                        Size: =24
                        Text: ="Classes Missed"
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
            - Container_Traveler_Pers_Type_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varPersQuestion
                  Width: =Parent.Width/2
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Add_Cadet_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Add_Traveler_Pers_Type_60.Height/2
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |
                          =UpdateContext({varPersQuestion:false});

                          UpdateContext({varNewCadet: true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cadet"
                        Width: =Self.Height*3
                        X: =Button_Add_Faculty_60.X + Button_Add_Faculty_60.Width + (Parent.Width - Self.Width*4)/5
                        Y: =Button_Add_Faculty_60.Y
                  - Button_Add_Faculty_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Add_Traveler_Pers_Type_60.Height/2
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varPersQuestion:false});

                          Set(varReturnScreen, App.ActiveScreen);
                          Set(varAddFacTraveler, true);
                          Navigate(Screen_Personnel_Overview_10);
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varTravelerChange: true})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Faculty"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*4)/5
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Traveler_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Add_Traveler_Pers_Type_60.Height/2
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varPersQuestion:false});

                          UpdateContext({varTravelerChange: false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =Parent.Width - Self.Width - (Parent.Width - Self.Width*4)/5
                        Y: =Button_Add_Faculty_60.Y
                  - Text_Add_Traveler_Pers_Type_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/4
                        Size: =32
                        Text: |-
                          ="Who would you like to add to this trip: 
                          Faculty, Cadet, or Guest?"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/3
                  - Button_Add_Cadet_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Add_Traveler_Pers_Type_60.Height/2
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |
                          =UpdateContext({varPersQuestion:false});

                          UpdateContext({varNewGuest: true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Guest"
                        Width: =Self.Height*3
                        X: =Button_Add_Cadet_60.X + Button_Add_Cadet_60.Width + (Parent.Width - Self.Width*4)/5
                        Y: =Button_Add_Faculty_60.Y
            - Container_New_Cadet_Traveler_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: |-
                    =If(varNewCadet = true, true, false)
                    //false
                  Width: =Parent.Width/2
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Confirm_Add_Cadet_Traveler_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(IsBlank(Text_Input_New_Cadet_Traveler_C_Num_60.Text), 
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Set(varTraveler, 
                              {new_traveler_num: CountRows(colTravelers)+1, 
                              usma_pers_id:Text_Input_New_Cadet_Traveler_C_Num_60.Text, 
                              pers_type: "CADET",
                              traveler_first_name: Text_Input_New_Cadet_Traveler_First_Name_60.Text,
                              traveler_last_name: Text_Input_New_Cadet_Traveler_Last_Name_60.Text, 
                              traveler_name: Concatenate(Text_Input_New_Cadet_Traveler_Last_Name_60.Text, ", ", Text_Input_New_Cadet_Traveler_First_Name_60.Text),
                              traveler_email: Upper(Dropdown_New_Cadet_Traveler_Email_60.Selected.Mail), 
                              split_loa: "NO",
                              travel_cost_status: "PROJECTED",
                              missing_class: "N/A"});

                          Collect(colTravelers,  
                              {new_traveler_num: CountRows(colTravelers)+1, 
                              usma_pers_id:Text_Input_New_Cadet_Traveler_C_Num_60.Text, 
                              pers_type: "CADET",
                              traveler_first_name: Text_Input_New_Cadet_Traveler_First_Name_60.Text,
                              traveler_last_name: Text_Input_New_Cadet_Traveler_Last_Name_60.Text, 
                              traveler_name: Concatenate(Text_Input_New_Cadet_Traveler_Last_Name_60.Text, ", ", Text_Input_New_Cadet_Traveler_First_Name_60.Text),
                              traveler_email: Upper(Dropdown_New_Cadet_Traveler_Email_60.Selected.Mail),
                              split_loa: "NO",
                              travel_cost_status: "PROJECTED",
                              missing_class: "N/A"}); 

                          Reset(Text_Input_New_Cadet_Traveler_Search_60);
                          Reset(Dropdown_New_Cadet_Traveler_Email_60);
                          UpdateContext({varTravelerChange: true});
                          UpdateContext({varNewCadet:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Add Cadet to Trip"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Cadet_Traveler_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Text_Input_New_Cadet_Traveler_Search_60);
                          Reset(Dropdown_New_Cadet_Traveler_Email_60);

                          UpdateContext({varNewCadet:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Image_Cadet_Traveler_60:
                      Control: Image@2.2.3
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Height: =Text_New_Cadet_Traveler_Major_61.Y - Text_New_Cadet_Traveler_Major_61.Height
                        Image: |-
                          =If(
                          !IsBlank(Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName),
                          Office365Users.UserPhoto(Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName)
                          )
                        ImagePosition: =ImagePosition.Fill
                        RadiusBottomLeft: =50
                        RadiusBottomRight: =50
                        RadiusTopLeft: =50
                        RadiusTopRight: =50
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Dropdown_New_Cadet_Traveler_Email_60.X
                        Y: =Text_New_Cadet_Traveler_Last_Name_60.Y
                  - Text_Input_New_Cadet_Traveler_Major_61:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName).major_code_2
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Tooltip: =LookUp(lookup_major, major_code = Self.Text).major_name
                        Width: =Text_Input_New_Cadet_Traveler_Search_60.Width
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Major_61.Y
                  - Text_New_Cadet_Traveler_Major_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Size: =24
                        Text: ="Major 2:"
                        Width: =Text_New_Cadet_Traveler_Search_60.Width
                        X: =Text_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Major_60.Y + Text_New_Cadet_Traveler_Major_60.Height + Parent.Height/50
                  - Text_Input_New_Cadet_Traveler_Major_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName).major_code_1
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Tooltip: =LookUp(lookup_major, major_code = Self.Text).major_name
                        Width: =Text_Input_New_Cadet_Traveler_Search_60.Width
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Major_60.Y
                  - Text_New_Cadet_Traveler_Major_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Size: =24
                        Text: ="Major 1:"
                        Width: =Text_New_Cadet_Traveler_Search_60.Width
                        X: =Text_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Class_60.Y + Text_New_Cadet_Traveler_Class_60.Height + Parent.Height/50
                  - Text_Input_New_Cadet_Traveler_Class_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName).grad_year
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Traveler_Search_60.Width
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Class_60.Y
                  - Text_New_Cadet_Traveler_Class_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Size: =24
                        Text: ="Class:"
                        Width: =Text_New_Cadet_Traveler_Search_60.Width
                        X: =Text_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_C_Num_60.Y + Text_New_Cadet_Traveler_C_Num_60.Height + Parent.Height/50
                  - Text_Input_New_Cadet_Traveler_C_Num_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName).usma_pers_id
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Traveler_Search_60.Width
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_C_Num_60.Y
                  - Text_New_Cadet_Traveler_C_Num_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Size: =24
                        Text: ="C Number:"
                        Width: =Text_New_Cadet_Traveler_Search_60.Width
                        X: =Text_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_First_Name_60.Y + Text_New_Cadet_Traveler_First_Name_60.Height + Parent.Height/50
                  - Text_Input_New_Cadet_Traveler_First_Name_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName).first_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Traveler_Search_60.Width
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_First_Name_60.Y
                  - Text_New_Cadet_Traveler_First_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Size: =24
                        Text: ="First Name:"
                        Width: =Text_New_Cadet_Traveler_Search_60.Width
                        X: =Text_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Last_Name_60.Y + Text_New_Cadet_Traveler_Last_Name_60.Height + Parent.Height/50
                  - Text_Input_New_Cadet_Traveler_Last_Name_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(current_cadet_view, wp_email = Dropdown_New_Cadet_Traveler_Email_60.Selected.UserPrincipalName).last_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_New_Cadet_Traveler_Search_60.Width
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Last_Name_60.Y
                  - Text_New_Cadet_Traveler_Last_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Size: =24
                        Text: ="Last Name:"
                        Width: =Text_New_Cadet_Traveler_Search_60.Width
                        X: =Text_New_Cadet_Traveler_Search_60.X
                        Y: =Text_New_Cadet_Traveler_Search_60.Y + Text_New_Cadet_Traveler_Search_60.Height + Parent.Height/20
                  - Dropdown_New_Cadet_Traveler_Email_60:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        Items: =Office365Users.SearchUserV2({searchTerm:Text_Input_New_Cadet_Traveler_Search_60.Text}).value
                        OnChange: =
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_Input_New_Cadet_Traveler_Search_60.X + Text_Input_New_Cadet_Traveler_Search_60.Width + Parent.Width/15
                        Y: =Text_Input_New_Cadet_Traveler_Search_60.Y
                      Children:
                        - UserPrincipalName4_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="UserPrincipalName"
                              FieldName: ="UserPrincipalName"
                              FieldType: ="s"
                              Order: =1
                  - Text_Input_New_Cadet_Traveler_Search_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/2 - Self.X - Parent.Width/20
                        X: =Text_New_Cadet_Traveler_Search_60.X + Text_New_Cadet_Traveler_Search_60.Width
                        Y: =Text_New_Cadet_Traveler_Search_60.Y
                  - Text_New_Cadet_Traveler_Search_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/15
                        Size: =24
                        Text: ="Search Last Name"
                        Width: =Parent.Width/4
                        X: =Parent.Width/40
                        Y: =Parent.Height/50
            - Container_New_Guest_Traveler_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/3
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: |-
                    =If(varNewGuest = true, true, false)
                    //false
                  Width: =Parent.Width/2
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Confirm_Add_Cadet_Traveler_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              IsBlank(Text_Input_New_Guest_Traveler_Last_Name_60.Text) || 
                              IsBlank(Text_Input_New_Guest_Traveler_First_Name_60.Text) ||
                              IsBlank(Text_Input_New_Guest_Traveler_Email_60.Text),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Guest_Traveler_Info_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Set(varTraveler, 
                              {new_traveler_num: Max(colTravelers, new_traveler_num) + 1, 
                              usma_pers_id: Blank(), 
                              pers_type: "GUEST",
                              traveler_first_name: Upper(Text_Input_New_Guest_Traveler_First_Name_60.Text),
                              traveler_last_name: Upper(Text_Input_New_Guest_Traveler_Last_Name_60.Text), 
                              traveler_name: Concatenate(Upper(Text_Input_New_Guest_Traveler_Last_Name_60.Text), ", ", Upper(Text_Input_New_Guest_Traveler_First_Name_60.Text)),
                              traveler_email: Upper(Text_Input_New_Guest_Traveler_Email_60.Text),
                              split_loa: "NO",
                              missing_class: "N/A",
                              travel_cost_status: "PROJECTED"});

                          Collect(colTravelers,  
                              {new_traveler_num: Max(colTravelers, new_traveler_num) + 1, 
                              usma_pers_id: Blank(), 
                              pers_type: "GUEST",
                              traveler_first_name: Upper(Text_Input_New_Guest_Traveler_First_Name_60.Text),
                              traveler_last_name: Upper(Text_Input_New_Guest_Traveler_Last_Name_60.Text), 
                              traveler_name: Concatenate(Upper(Text_Input_New_Guest_Traveler_Last_Name_60.Text), ", ", Upper(Text_Input_New_Guest_Traveler_First_Name_60.Text)),
                              traveler_email: Upper(Text_Input_New_Guest_Traveler_Email_60.Text), 
                              split_loa: "NO",
                              missing_class: "N/A",
                              travel_cost_status: "PROJECTED"}); 

                          Reset(Text_Input_New_Guest_Traveler_Email_60);
                          Reset(Text_Input_New_Guest_Traveler_First_Name_60);
                          Reset(Text_Input_New_Guest_Traveler_Last_Name_60);
                          UpdateContext({varTravelerChange: true});
                          UpdateContext({varNewGuest:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Add Guest to Trip"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Cadet_Traveler_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Guest_Traveler_Info_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varNewGuest:false});

                          Reset(Text_Input_New_Guest_Traveler_Email_60);
                          Reset(Text_Input_New_Guest_Traveler_First_Name_60);
                          Reset(Text_Input_New_Guest_Traveler_Last_Name_60);
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Input_New_Guest_Traveler_Email_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Guest_Traveler_Info_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width - Self.X - Parent.Width/20
                        X: =Text_Input_New_Guest_Traveler_Last_Name_60.X
                        Y: =Text_New_Guest_Traveler_Email_60.Y
                  - Text_New_Guest_Traveler_Email_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Guest_Traveler_Info_60.Height
                        Size: =24
                        Text: ="Email:"
                        Width: =Text_New_Guest_Traveler_Last_Name_60.Width
                        X: =Text_New_Guest_Traveler_Last_Name_60.X
                        Y: =Text_New_Guest_Traveler_First_Name_60.Y + Text_New_Guest_Traveler_First_Name_60.Height + Parent.Height/50
                  - Text_Input_New_Guest_Traveler_First_Name_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Guest_Traveler_Info_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/4 - Parent.Width/40
                        X: =Text_New_Guest_Traveler_First_Name_60.X + Text_New_Guest_Traveler_First_Name_60.Width
                        Y: =Text_New_Guest_Traveler_First_Name_60.Y
                  - Text_New_Guest_Traveler_First_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Guest_Traveler_Info_60.Height
                        Size: =24
                        Text: ="First Name:"
                        Width: =Text_New_Guest_Traveler_Last_Name_60.Width
                        X: =Parent.Width/2
                        Y: =Text_New_Guest_Traveler_Last_Name_60.Y
                  - Text_Input_New_Guest_Traveler_Last_Name_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Guest_Traveler_Info_60.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/4 - Parent.Width/40
                        X: =Text_New_Guest_Traveler_Last_Name_60.X + Text_New_Guest_Traveler_Last_Name_60.Width
                        Y: =Text_New_Guest_Traveler_Last_Name_60.Y
                  - Text_New_Guest_Traveler_Last_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Guest_Traveler_Info_60.Height
                        Size: =24
                        Text: ="Last Name:"
                        Width: =Parent.Width/4 - Parent.Width/40
                        X: =Parent.Width/40
                        Y: =Text_New_Guest_Traveler_Info_60.Y + Text_New_Guest_Traveler_Info_60.Height + Parent.Height/20
                  - Text_New_Guest_Traveler_Info_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/7
                        Size: =24
                        Text: ="Guest Traveler Info"
                        Width: =Parent.Width
                        Y: =Parent.Height/50
            - Container_Add_Locs_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowAddLocs
                  Width: =Parent.Width/1.5
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Classes_Missed_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: "=If(varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.wp_email = varTraveler.traveler_email ||\r\n    varUser.dept_pos = \"P6\" || \r\n    varUser.dept_pos = \"P5\" || \r\n    varUser.dept_pos = \"XO\" ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic ||\r\n    \r\n    If(\r\n        CountRows(Filter(colSections, tour_id = LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id).tour_id, apd = varUser.apd)) > 0, \r\n        true, false), \r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Add_Locs_60.Height*1.25
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              CountRows(Filter(colAddLocs, Not(IsBlank(leg_start)), Not(IsBlank(leg_end)), Not(IsBlank(destination_country)), Not(IsBlank(destination_state)), Not(IsBlank(destination_city)))) = CountRows(colAddLocs), 
                              UpdateContext({varShowAddLocs:false}), 
                              Notify("PLEASE ENSURE A LEG START, LEG END, CITY, STATE, AND COUNTRY HAVE BEEN COMPLETED FOR ALL ADDITIONAL LOCATIONS", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Self.Height*3.5
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Gallery_Add_Locs_60:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n\r\n    If(varTraveler.pers_type <> \"FACULTY\",\r\n        If(varUser.tour_id = Index(colTrip,2).trip_oic || varUser.tour_id = Index(colTrip,1).trip_oic, \r\n        true, false)))\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Height: =Parent.Height/2.5
                        Items: |-
                          =If(
                              IsBlank(varTraveler.travel_id), 
                              Filter(colAddLocs, new_traveler_num = varTraveler.new_traveler_num),
                              Filter(colAddLocs, travel_cost_id = varTraveler.travel_id))
                        OnSelect: =
                        Selectable: =false
                        TemplateSize: =Text_Add_Locs_60.Height
                        Width: =Text_Add_Locs_60.Width
                        X: =Text_Add_Locs_60.X
                        Y: =Text_Leg_Start_60.Y + Text_Leg_Start_60.Height
                      Children:
                        - Icon_Remove_Classes_Missed_61:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(Not(IsBlank(ThisItem.add_loc_id)), 
                                    Collect(colRemoveAddLocs, ThisItem));

                                Remove(colAddLocs, ThisItem);

                                UpdateContext({varReadyToSubmit:false});

                                UpdateContext({varAddLocChange:true});
                              Width: =Self.Height
                              X: =Icon_Add_Locs_60.X - Gallery_Add_Locs_60.X
                        - Text_Input_City_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.destination_city
                              DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(colAddLocs, ThisItem, {destination_city:Upper(Self.Text)});

                                UpdateContext({varReadyToSubmit:false})
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_City_61.Width
                              X: =Text_City_61.X - Gallery_Add_Locs_60.X
                        - Dropdown_State_61:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(colStates, state = ThisItem.destination_state)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =colStates
                              OnChange: |-
                                =Patch(colAddLocs, ThisItem, 
                                    {destination_state: Self.Selected.state, 
                                    destination_city: Blank()});
                                UpdateContext({varReadyToSubmit:false});
                              Visible: =If(ThisItem.destination_country = "USA", true, false)
                              Width: =Text_Country_61.Width
                              X: =Text_State_61.X - Gallery_Add_Locs_60.X
                            Children:
                              - state4:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="state"
                                    FieldName: ="state"
                                    FieldType: ="s"
                                    Order: =1
                        - Text_Input_State_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.destination_state
                              DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(colAddLocs, ThisItem, {destination_state:Upper(Self.Text)});

                                UpdateContext({varReadyToSubmit:false})
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Visible: =Not(Dropdown_State_61.Visible)
                              Width: =Text_State_61.Width
                              X: =Text_State_61.X - Gallery_Add_Locs_60.X
                        - Text_Input_Country_61:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.destination_country
                              DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(colAddLocs, ThisItem, 
                                    {destination_country: Upper(Self.Text), 
                                    destination_state: Blank(), 
                                    destination_city: Blank()});

                                UpdateContext({varReadyToSubmit:false})
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_State_61.Width
                              X: =Text_Country_61.X - Gallery_Add_Locs_60.X
                        - Date_Picker_Leg_End_60:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderRadius: =10
                              DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                              EndDate: =Date_Picker_Travel_End_61.SelectedDate
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: |-
                                =Patch(colAddLocs, ThisItem, {leg_end:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =ThisItem.leg_end
                              StartDate: =Date_Picker_Leg_Start_60.SelectedDate
                              Width: =Text_Leg_End_60.Width
                              X: =Text_Leg_End_60.X - Gallery_Add_Locs_60.X
                        - Date_Picker_Leg_Start_60:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderRadius: =10
                              DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                              EndDate: =Date_Picker_Travel_End_61.SelectedDate
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: |-
                                =Patch(colAddLocs, ThisItem, {leg_start:Self.SelectedDate});

                                UpdateContext({varReadyToSubmit: false})
                              SelectedDate: =ThisItem.leg_start
                              StartDate: =Date_Picker_Travel_Start_61.SelectedDate
                              Width: =Text_Leg_Start_60.Width
                              X: =Text_Leg_Start_60.X - Gallery_Add_Locs_60.X
                              Y: =2.0775000000000006
                        - Separator_Gallery_Add_Locs_60:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Locs_60:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\r\n    varUser.tour_id = Index(colTrip,1).trip_oic)\r\n        \r\n    &&\r\n        \r\n    (CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = 0 ||\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = 0),\r\n\r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Height: =Text_State_61.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colAddLocs,
                              {add_loc_id: Blank(),
                              travel_cost_id: varTraveler.travel_id,
                              trip_id: Index(colTrip,1).trip_id,
                              traveler_last_name: varTraveler.traveler_last_name, 
                              traveler_first_name: varTraveler.traveler_first_name,
                              traveler_name: varTraveler.traveler_name,
                              new_traveler_num: varTraveler.new_traveler_num, 
                              new_loc_num: Max(colAddLocs, new_loc_num) + 1,
                              leg_start: Blank(),
                              leg_end: Blank(),
                              destination_city: Blank(),
                              destination_state: Blank(), 
                              destination_country: "USA"});

                          UpdateContext({varAddLocChange:true});

                          UpdateContext({varReadyToSubmit:false});
                        Width: =Self.Height
                        X: =Gallery_Add_Locs_60.X + Gallery_Add_Locs_60.Width - Self.Width
                        Y: =Text_State_61.Y
                  - Text_City_61:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Add_Locs_60.Height
                        Size: =24
                        Text: ="City"
                        Width: =Text_Country_61.Width
                        X: =Text_State_61.X + Text_State_61.Width + 10
                        Y: =Text_Add_Locs_60.Y + Text_Add_Locs_60.Height
                  - Text_State_61:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Add_Locs_60.Height
                        Size: =24
                        Text: ="State"
                        Width: =Text_Country_61.Width
                        X: =Text_Country_61.X + Text_Country_61.Width + 10
                        Y: =Text_Add_Locs_60.Y + Text_Add_Locs_60.Height
                  - Text_Country_61:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Add_Locs_60.Height
                        Size: =24
                        Text: ="Country"
                        Width: =(Text_Add_Locs_60.Width - 60)/4  - Icon_Add_Locs_60.Width/3
                        X: =Text_Leg_End_60.X + Text_Leg_End_60.Width + 10
                        Y: =Text_Add_Locs_60.Y + Text_Add_Locs_60.Height
                  - Text_Leg_End_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Add_Locs_60.Height
                        Size: =24
                        Text: ="Leg End"
                        Width: =Text_Add_Locs_60.Width/8
                        X: =Text_Leg_Start_60.X + Text_Leg_Start_60.Width + 10
                        Y: =Text_Add_Locs_60.Y + Text_Add_Locs_60.Height
                  - Text_Leg_Start_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Add_Locs_60.Height
                        Size: =24
                        Text: ="Leg Start"
                        Width: =Text_Add_Locs_60.Width/8
                        X: =Text_Add_Locs_60.X
                        Y: =Text_Add_Locs_60.Y + Text_Add_Locs_60.Height
                  - Text_Add_Locs_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/10
                        Size: =24
                        Text: ="Additional Locations"
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
            - Container_Add_Files_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.Bold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =varAddFiles
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Attachment_Control_Files_60:
                      Control: Attachments@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Fill: =RGBA(0, 0, 0, 0.04)
                        Font: =Font.'Open Sans'
                        Height: =Parent.Height/4
                        HoverFill: =RGBA(186, 202, 226, 1)
                        ItemColor: =RGBA(255, 255, 255, 1)
                        ItemFill: =RGBA(56, 96, 178, 1)
                        ItemHoverFill: =RGBA(186, 202, 226, 1)
                        MaxAttachments: =1
                        NoAttachmentsText: ="Drag and drop 1 file at a time"
                        OnAddFile: "=If(\n    (Checkbox_Dept_Memo_60.Value ||\n    Checkbox_Dean_Approval_60.Value ||\n    Checkbox_GIK_Approval_60.Value ||\n    Checkbox_Other_60.Value),\n    \n    ForAll(\n    Attachment_Control_Files_60.Attachments As FILE, \n    If(\n        Not(IsNumeric(Find(\"pdf\", Lower(FILE.Name), Len(FILE.Name)-3))), \n        Reset(Self);\n        Notify(\"PLEASE ONLY UPLOAD .PDF FILES\",NotificationType.Error)));\n\n    UpdateContext({varShowSpinner: true});\n\n    'Math-TravelSendFile1_V1'.Run(\n        {contentBytes:First(Attachment_Control_Files_60.Attachments).Value, name:First(Attachment_Control_Files_60.Attachments).Name},  \n        Index(colTrip,1).trip_id, \n        Index(colTrip,1).trip_event, \n        Index(colTrip,1).trip_start, \n        Index(colTrip,1).trip_end, \n        Index(colTrip,1).destination, \n        LookUp(colFaculty, tour_id = Index(colTrip,1).trip_oic).wp_email, \n        If(\n            Checkbox_Dept_Memo_60.Value, \n            \"Memo\", \n            If(\n                Checkbox_Dean_Approval_60.Value, \n                \"Dean_Approval\", \n                If(\n                    Checkbox_GIK_Approval_60.Value,\n                    \"GIK_Approval\", \n                    \"Other\"))),  \n        Concat(colPermissionAdmin, wp_email, \"; \"), \n        If(\n            Month(Index(colTrip,1).trip_start) < 10,\n            Year(Index(colTrip,1).trip_start), \n            Year(Index(colTrip,1).trip_start) + 1));\n\n    Reset(Self);\n    Reset(Checkbox_Dept_Memo_60);\n    Reset(Checkbox_Dean_Approval_60);\n    Reset(Checkbox_GIK_Approval_60);\n    Reset(Checkbox_Other_60);\n\n    UpdateContext({varShowSpinner: false}); \n    \n    Notify(\"File successfully uploaded\", NotificationType.Success), \n\n    Notify(\"You must select the type of document you are uploading\", NotificationType.Error);\n    Reset(Self))"
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 18, 107, 1)
                        Width: =Parent.Width/2
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Checkbox_GIK_Approval_60.Y + Checkbox_GIK_Approval_60.Height + Parent.Height/10
                  - Button_Close_Add_Files_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_File_Type_60.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varAddFiles: false});
                          Reset(Checkbox_Dept_Memo_60);
                          Reset(Checkbox_GIK_Approval_60);
                          Reset(Checkbox_Dean_Approval_60);
                          Reset(Checkbox_Other_60);
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Close"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Checkbox_Other_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Lighter
                        Height: =Text_File_Type_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_Dept_Memo_60);
                          Reset(Checkbox_GIK_Approval_60);
                          Reset(Checkbox_Dean_Approval_60);
                        OnUncheck: =
                        Size: =10
                        Text: ="Other"
                        Width: =Parent.Width/5
                        X: =Checkbox_Dean_Approval_60.X
                        Y: =Checkbox_GIK_Approval_60.Y
                  - Checkbox_GIK_Approval_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_File_Type_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_Dept_Memo_60);
                          Reset(Checkbox_Dean_Approval_60);
                          Reset(Checkbox_Other_60);
                        OnUncheck: =
                        Size: =10
                        Text: ="GIK Approval"
                        Width: =Parent.Width/5
                        X: =Checkbox_Dept_Memo_60.X
                        Y: =Checkbox_Dept_Memo_60.Y + Checkbox_Dept_Memo_60.Height + Parent.Height/50
                  - Checkbox_Dean_Approval_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_File_Type_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_Dept_Memo_60);
                          Reset(Checkbox_GIK_Approval_60);
                          Reset(Checkbox_Other_60);
                        OnUncheck: =
                        Size: =10
                        Text: ="Dean Approval"
                        Width: =Parent.Width/5
                        X: =(Parent.Width - Self.Width*2)/3 + Checkbox_Dept_Memo_60.X + Checkbox_Dept_Memo_60.Width
                        Y: =Text_File_Type_60.Y + Text_File_Type_60.Height + Parent.Height/50
                  - Checkbox_Dept_Memo_60:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_File_Type_60.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_Dean_Approval_60);
                          Reset(Checkbox_GIK_Approval_60);
                          Reset(Checkbox_Other_60);
                        OnUncheck: =
                        Size: =10
                        Text: ="Dept. Memo"
                        Width: =Parent.Width/5
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Text_File_Type_60.Y + Text_File_Type_60.Height + Parent.Height/50
                  - Text_File_Type_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Trip_Event_60.Height
                        Size: =23
                        Text: ="What kind of file would you like to upload?"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/10
            - Container_Whats_This_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.Bold
                  Fill: =Color.LightGray
                  Height: =Parent.Height/3
                  Visible: =varShowGIK || varShowDean
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Button_Close_Whats_This_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Container_Whats_This_60.Height/7
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowGIK: false});
                          UpdateContext({varShowDean: false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Close"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Text_Whats_This_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Button_Close_Whats_This_60.Y - Self.Y
                        Size: =23
                        Text: |-
                          =If(
                              varShowGIK,
                              "If your trip DOES NOT REQUIRE a Gift in Kind (GIK) then select 'N/A'. A Gift In Kind (GIK) is when another organization pays for any part of USMA travel. If this happens, a legal review must be conducted and signed off by the Dean. You cannot route the trip for final approval if 'GIK Submitted' is 'NO'. Talk to the Admin Staff for further assistance.",
                              "If your trip DOES NOT REQUIRE Dean approval then select 'N/A'. Dean approval is required when you are using Army funds for a conference. You cannot route the trip for final approval if 'Dean Submitted' is 'NO'. Talk to the Admin Staff for further assistance")
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Parent.Height/10
            - Container_Disburse_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Container_Traveler_Details_60.Height
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varDisburse
                  Width: =Container_Travelers_60.Width
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Disburse_Details_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n    {voucher_submitted_on: Date_Picker_Voucher_Submitted_60.SelectedDate, \r\n    voucher_approved_on: Date_Picker_Voucher_Approved_60.SelectedDate, \r\n    travel_cost_disbursed: -Abs(Value(Text_Input_Disbursed_Cost_60.Text))});\r\n        \r\nSet(varTraveler, Patch(varTraveler, \r\n    {voucher_submitted_on: Date_Picker_Voucher_Submitted_60.SelectedDate, \r\n    voucher_approved_on: Date_Picker_Voucher_Approved_60.SelectedDate, \r\n    travel_cost_disbursed: -Abs(Value(Text_Input_Disbursed_Cost_60.Text))}));\r\n\r\nUpdateContext({varDisburse:false});\r\nUpdateContext({varReadyToSubmit:false});"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save Changes"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Disburse_Details_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varResetDisbursed:true});
                          UpdateContext({varResetDisbursed:false});
                          UpdateContext({varDisburse:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Input_Disbursed_Cost_60:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.travel_cost_disbursed)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_61.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetDisbursed
                        Width: =Date_Picker_Voucher_Submitted_60.Width
                        X: =Date_Picker_Voucher_Approved_60.X
                        Y: =Text_Amount_Disbursed_60.Y
                  - Text_Amount_Disbursed_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_61.Height
                        Size: =23
                        Text: ="Travel Amount Disbursed:"
                        Width: =Parent.Width/2.5
                        X: =Text_Traveler_Name_61.X
                        Y: =Text_Voucher_Approved_60.Y + Text_Voucher_Approved_60.Height + Parent.Height/20
                  - Date_Picker_Voucher_Approved_60:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Traveler_Name_61.Height
                        OnChange: =
                        SelectedDate: =varTraveler.voucher_approved_on
                        StartDate: =Date_Picker_Voucher_Submitted_60.SelectedDate
                        Width: =Date_Picker_Voucher_Submitted_60.Width
                        X: =Text_Voucher_Submitted_60.X + Text_Voucher_Submitted_60.Width
                        Y: =Text_Voucher_Approved_60.Y
                  - Text_Voucher_Approved_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_61.Height
                        Size: =23
                        Text: ="Voucher Approved On:"
                        Width: =Parent.Width/2.5
                        X: =Text_Traveler_Name_61.X
                        Y: =Text_Voucher_Submitted_60.Y + Text_Voucher_Submitted_60.Height + Parent.Height/20
                  - Date_Picker_Voucher_Submitted_60:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Traveler_Name_61.Height
                        OnChange: =
                        SelectedDate: =varTraveler.voucher_submitted_on
                        Width: =Parent.Width/4
                        X: =Text_Voucher_Submitted_60.X + Text_Voucher_Submitted_60.Width
                        Y: =Text_Voucher_Submitted_60.Y
                  - Text_Voucher_Submitted_60:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_61.Height
                        Size: =23
                        Text: ="Voucher Submitted On:"
                        Width: =Parent.Width/2.5
                        X: =Text_Traveler_Name_61.X
                        Y: =Text_Traveler_Name_61.Y + Text_Traveler_Name_61.Height + Parent.Height/10
                  - Text_Input_travel_cost_id_62:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.travel_id
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_61.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_Traveler_Name_61.Width
                        X: =Text_travel_cost_id_62.X + Text_travel_cost_id_62.Width
                        Y: =Text_travel_cost_id_62.Y
                  - Text_travel_cost_id_62:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Travel ID"
                        Width: =Parent.Width/5
                        X: =Text_Input_Traveler_Name_61.X + Text_Input_Traveler_Name_61.Width + Parent.Width/40
                        Y: =Text_Traveler_Name_61.Y
                  - Text_Input_Traveler_Name_61:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.traveler_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_61.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/2 - Self.X - Parent.Width/80
                        X: =Text_Traveler_Name_61.X + Text_Traveler_Name_61.Width
                        Y: =Text_Traveler_Name_61.Y
                  - Text_Traveler_Name_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Traveler"
                        Width: =Parent.Width/5
                        X: =Parent.Width/40
                        Y: =Text_Disburse_Travel_60.Y + Text_Disburse_Travel_60.Height + Parent.Height/50
                  - Text_Disburse_Travel_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/12
                        Size: =24
                        Text: ="Disburse Travel"
                        Width: =Parent.Width
            - Container_Approvals_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowApprovals
                  Width: =Parent.Width/1.5
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Close_Approvals_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowApprovals:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Gallery_Approvals_60:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Button_Close_Approvals_60.Y - Self.Y - Parent.Height/20
                        Items: =Sort(colTravelers, traveler_last_name, SortOrder.Ascending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateFill: |-
                          =If(
                              IsBlank(ThisItem.p6_approved_on) || ThisItem.p6_approved_on = Date(1900, 1, 1),
                              If(
                                  IsBlank(ThisItem.xo_approved_on),  
                                  RGBA(255, 121, 69,1), 
                                  Color.Yellow), 
                              Color.LightGreen)
                        TemplateSize: =Text_Approvals_60.Height
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Text_Name_60.Y + Text_Name_60.Height
                      Children:
                        - Text_Input_P5_P6_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.p6_approved_on = Date(1900, 1, 1), 
                                    Blank(), 
                                    ThisItem.p6_approved_on)
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_XO_60.Width
                              X: =Text_P5_P6_60.X - Gallery_Approvals_60.X
                        - Text_Input_XO_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.xo_approved_on = Date(1900, 1, 1), 
                                    Blank(), 
                                    ThisItem.xo_approved_on)
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_XO_60.Width
                              X: =Text_XO_60.X - Gallery_Approvals_60.X
                        - Text_Input_Budget_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.cd_approved_on
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Budget_61.Width
                              X: =Text_Budget_61.X - Gallery_Approvals_60.X
                        - Text_Input_APD_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.pd_approved_on
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_APD_60.Width
                              X: =Text_APD_60.X - Gallery_Approvals_60.X
                        - Text_Input_Name_60:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.traveler_name
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Name_60.Width
                              X: =Text_Name_60.X - Gallery_Approvals_60.X
                        - Separator_Gallery_Approvals_60:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Text_P5_P6_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_60.Height
                        Size: =23
                        Text: ="P5/P6 Approval"
                        Width: =Text_APD_60.Width
                        X: =Text_XO_60.X + Text_XO_60.Width + 10
                        Y: =Text_Name_60.Y
                  - Text_XO_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_60.Height
                        Size: =23
                        Text: ="XO Approval"
                        Width: =Text_APD_60.Width
                        X: =Text_Budget_61.X + Text_Budget_61.Width + 10
                        Y: =Text_Name_60.Y
                  - Text_Budget_61:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_60.Height
                        Size: =23
                        Text: ="Budget Approval"
                        Width: =Text_APD_60.Width
                        X: =Text_APD_60.X + Text_APD_60.Width + 10
                        Y: =Text_Name_60.Y
                  - Text_APD_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_60.Height
                        Size: =23
                        Text: ="APD Approval"
                        Width: =((Text_Approvals_60.Width*3/4) - 40 - Gallery_Approvals_60.X - Parent.Width/40)/4
                        X: =Text_Name_60.X + Text_Name_60.Width + 10
                        Y: =Text_Name_60.Y
                  - Text_Name_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Approvals_60.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Text_Approvals_60.Width/4
                        X: =Parent.Width/40
                        Y: =Text_Approvals_60.Y + Text_Approvals_60.Height + Parent.Height/50
                  - Text_Approvals_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/12
                        Size: =24
                        Text: ="Approvals"
                        Width: =Parent.Width
            - Container_Cancel_Trip_60:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/4
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowCancel
                  Width: =Container_Travelers_60.Width
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Keep_Trip_60:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: "=If(\n    (varPermissions = \"Master\" ||\n    varPermissions = \"Admin\" ||\n    varPermissions = \"Research\" ||\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\n\n    If(varTraveler.pers_type <> \"FACULTY\",\n        If(varUser.tour_id = Index(colTrip,2).trip_oic || varUser.tour_id = Index(colTrip,1).trip_oic, \n        true, false)) ||\n        \n        If(\n        IsBlank(LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id)),\n        If(varUser.tour_id = Index(colTrip,2).trip_oic || varUser.tour_id = Index(colTrip,1).trip_oic, \n        true, false))), \n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowCancel:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="No, Keep Trip"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Trip_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Patch(lookup_trips, LookUp(lookup_trips, trip_id = Index(colTrip,1).trip_id), 
                              {trip_status: "CANCELLED", 
                              updated_on: Today()});

                          ForAll(colTravelers As traveler, 
                              Patch(travel_costs, LookUp(travel_costs, travel_cost_id = traveler.travel_id), 
                              {travel_cost_status: "CANCELLED"}));

                          Clear(colTravelers);
                          Clear(colProjectTravel);
                          Clear(colClassesMissed);
                          Clear(colTravelNotes);
                          Clear(colProjectPriorities);
                          Clear(colProjectAwards);
                          Clear(colProjectFaculty);
                          Clear(colProjectCadets);
                          Clear(colProjectPublications);
                          Clear(colRemoveClassesMissed);
                          Clear(colRemoveProjectAwards);
                          Clear(colRemoveProjectPriorities);
                          Clear(colRemoveProjectPublications);
                          Clear(colRemoveProjectTravel);
                          Clear(colRemoveTravelers);
                          Clear(colRemoveTravelNotes);
                          Clear(colSections);
                          Clear(colTripTypes);
                          Clear(colAddLocs);
                          Clear(colRemoveAddLocs);


                          Set(varTraveler, Blank());
                          Set(varAddFacTraveler, Blank());
                          Set(varTrip, Blank());

                          UpdateContext({varDeanApproval: Blank()});
                          UpdateContext({varMissingClassChange: Blank()});
                          UpdateContext({varShowCancel:false});
                          UpdateContext({varNewCadet: Blank()});
                          UpdateContext({varNewGuest: Blank()});
                          UpdateContext({varPersQuestion: Blank()});
                          UpdateContext({varProjectTravelChange: Blank()});
                          UpdateContext({varResetCosts: Blank()});
                          UpdateContext({varShowClass: Blank()});
                          UpdateContext({varShowCostDetails: Blank()});
                          UpdateContext({varTravelNoteChange: Blank()});
                          UpdateContext({varReadyToSubmit:Blank()});
                          UpdateContext({varTravelerChange:false});


                          Refresh(current_trips_view);

                          If(
                              Not(IsBlank(varReturnScreen)),
                              Navigate(varReturnScreen),
                              Navigate(Screen_Trips_Overview_50));

                          ClearCollect(colTrip,
                              {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()},
                              {trip_id: Blank(), trip_type: Blank(), trip_source: Blank(), trip_event: Blank(), trip_start: Blank(), trip_end: Blank(), trip_oic: Blank(), oic_last_name: Blank(), oic_first_name: Blank(), oic_name: Blank(), purpose: Blank(), justification: Blank(), destination_city: Blank(), destination_state: Blank(), destination_country: Blank(), destination: Blank(), gik_approved: Blank(), gik_submitted: Blank()});

                          Reset(Gallery_Trips_50)
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Yes, Cancel Trip"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Cancel_Warning_60:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/2
                        Size: =24
                        Text: |-
                          ="WARNING: You are about to cancel this trip. This cannot be undone. Are you sure you want to cancel?"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Parent.Height/10
            - Spinner_60:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Header_Trip_Details_60:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Trip_Details_60:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Trip Details"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_60:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/50
      - Text_Input_Change_User_60:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/50






// Screen_Purchase_Overview_70

Screens:
  Screen_Purchase_Overview_70:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Purchase_Overview_70:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Purchase_Header_70.Height
            Width: =Parent.Width
            Y: =Container_Purchase_Header_70.Height
          Children:
            - Button_Home_70:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_70.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: =Navigate(Screen_Welcome_User_00)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Home"
                  Width: =Parent.Width/11
                  X: =Button_Add_Purchase_70.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Requestor_Search_70.Y
            - Button_Add_Purchase_70:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_70.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=Set(varPurchaseID, Blank());\n    \nClearCollect(colPurchase, \n    {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: \"SUPPLY\", purchase_type: Blank(), purchase_cost_status: \"PROJECTED\", date_ordered: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: varUser.tour_id, requestor_name: varUser.name, recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()}, \n    {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: \"SUPPLY\", purchase_type: Blank(), purchase_cost_status: \"PROJECTED\", date_ordered: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: varUser.tour_id, requestor_name: varUser.name, recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()});\n\nNavigate(Screen_Purchase_Details_80);"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Add Request"
                  Width: =Parent.Width/11
                  X: =Button_Edit_Purchase_70.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Requestor_Search_70.Y
            - Button_Edit_Purchase_70:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_70.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=Set(varPurchaseID, Gallery_Purchases_70.Selected.purchase_cost_id);\r\n    \r\nClearCollect(colPurchase, \r\n    With({\r\n    purchaseRecord: \r\n        ShowColumns(\r\n            Filter(purchase_cost_view, purchase_cost_id = varPurchaseID), purchase_cost_id, cntrl_num, budget_id, budget_assigned_by, invoice_num, purpose, vendor_name, items_cost, shipping_cost, purchase_cost, purchase_category, purchase_type, purchase_cost_status, date_ordered, certified_fund_date, date_received, gfebs_pr_num, cardholder, cardholder_name, requestor_tour, requestor_name, recipient_tour, recipient_name, updated_on)}, \r\n        Table(purchaseRecord, \r\n            purchaseRecord)));\r\n\r\nClearCollect(colItems, \r\n    ShowColumns(Filter(purchase_items, purchase_cost_id = varPurchaseID), purchase_item_id, purchase_cost_id, item_desc, part_num, quantity, unit_price, total_cost, updated_on));\r\n\r\nClearCollect(colPurchaseNotes, \r\n    ShowColumns(Filter(purchase_notes_view, purchase_cost_id = varPurchaseID), purchase_note_id, purchase_cost_id, notes, tour_id, name, updated_on));\r\n\r\nClearCollect(colProjectPurchases, \r\n    ShowColumns(Filter(project_purchases, purchase_cost_id = varPurchaseID), project_purchase_id, purchase_cost_id, project_id));\r\n\r\nNavigate(Screen_Purchase_Details_80);"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Edit Request"
                  Width: =Parent.Width/11
                  X: =Gallery_Purchases_70.X + Gallery_Purchases_70.Width - Self.Width
                  Y: =Text_Input_Requestor_Search_70.Y
            - Text_Input_GFEBS_Search_70:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_70.Height
                  HintText: ="Search GFEBS PR"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Requestor_Search_70);
                    Reset(Text_Input_Vendor_Search_70);
                    Reset(Text_Input_ID_Search_70);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Purchases_70.Width/8
                  X: =Text_Input_Vendor_Search_70.X + Text_Input_Vendor_Search_70.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_GFEBS_Search_70:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Requestor_Search_70.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_GFEBS_Search_70);

                    Reset(Gallery_Purchases_70)
                  Width: =Self.Height
                  X: =Text_Input_GFEBS_Search_70.X + Text_Input_GFEBS_Search_70.Width - Self.Width
                  Y: =Text_Input_Requestor_Search_70.Y + Text_Input_Requestor_Search_70.Height/8
            - Text_Input_Vendor_Search_70:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_70.Height
                  HintText: ="Search Vendor"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Requestor_Search_70);
                    Reset(Text_Input_ID_Search_70);
                    Reset(Text_Input_GFEBS_Search_70);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Purchases_70.Width/8
                  X: =Text_Input_Requestor_Search_70.X + Text_Input_Requestor_Search_70.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Vendor_Search_70:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Requestor_Search_70.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Vendor_Search_70);

                    Reset(Gallery_Purchases_70)
                  Width: =Self.Height
                  X: =Text_Input_Vendor_Search_70.X + Text_Input_Vendor_Search_70.Width - Self.Width
                  Y: =Text_Input_Requestor_Search_70.Y + Text_Input_Requestor_Search_70.Height/8
            - Text_Input_Requestor_Search_70:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_70.Height
                  HintText: ="Search Requestor"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_ID_Search_70);
                    Reset(Text_Input_Vendor_Search_70);
                    Reset(Text_Input_GFEBS_Search_70);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Purchases_70.Width/8
                  X: =Text_Input_ID_Search_70.X + Text_Input_ID_Search_70.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Requestor_Search_70:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Requestor_Search_70.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Requestor_Search_70);

                    Reset(Gallery_Purchases_70)
                  Width: =Self.Height
                  X: =Text_Input_Requestor_Search_70.X + Text_Input_Requestor_Search_70.Width - Self.Width
                  Y: =Text_Input_Requestor_Search_70.Y + Text_Input_Requestor_Search_70.Height/8
            - Text_Input_ID_Search_70:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_70.Height
                  HintText: ="Search Purchase ID"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Requestor_Search_70);
                    Reset(Text_Input_Vendor_Search_70);
                    Reset(Text_Input_GFEBS_Search_70);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Purchases_70.Width/8
                  X: =Gallery_Purchases_70.X
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_ID_Search_70:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Requestor_Search_70.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_ID_Search_70);

                    Reset(Gallery_Purchases_70)
                  Width: =Self.Height
                  X: =Text_Input_ID_Search_70.X + Text_Input_ID_Search_70.Width - Self.Width
                  Y: =Text_Input_Requestor_Search_70.Y + Text_Input_Requestor_Search_70.Height/8
            - Gallery_Purchases_70:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =1
                  Height: =Text_Input_Requestor_Search_70.Y - Text_Requestor_70.Y - Text_Requestor_70.Height - Parent.Height/40
                  Items: |-
                    =If(
                        Not(IsBlank(Text_Input_ID_Search_70.Text)), 
                        Sort(
                            Filter(purchase_cost_view, Value(Text_Input_ID_Search_70.Text) = purchase_cost_id, purchase_cost_status <> "CANCELLED"),
                            updated_on, SortOrder.Descending),

                        If(
                            Not(IsBlank(Text_Input_Requestor_Search_70.Text)),
                            Sort(
                                Filter(purchase_cost_view, Text_Input_Requestor_Search_70.Text in requestor_name, purchase_cost_status <> "CANCELLED"),
                                updated_on, SortOrder.Descending),
                            If(
                                Not(IsBlank(Text_Input_Vendor_Search_70.Text)),
                                Sort(
                                    Filter(purchase_cost_view, Text_Input_Vendor_Search_70.Text in vendor_name, purchase_cost_status <> "CANCELLED"), 
                                    updated_on, SortOrder.Descending),
                                If(
                                    Not(IsBlank(Text_Input_GFEBS_Search_70.Text)), 
                                    Sort(
                                        Filter(purchase_cost_view, Text_Input_GFEBS_Search_70.Text in gfebs_pr_num, purchase_cost_status <> "CANCELLED"), 
                                        updated_on, SortOrder.Descending), 
                                Sort(Filter(purchase_cost_view, purchase_cost_status <> "CANCELLED"), updated_on, SortOrder.Descending)))))
                  TemplateFill: "=If(\n    ThisItem.purchase_cost_status = \"DISBURSED\", \n    If(\n        ThisItem.IsSelected, \n        Color.LightGreen, \n        ColorFade(Color.LightGreen, .6)), \n    \n    If(\n        ThisItem.purchase_cost_status = \"COMMITTED\", \n        If(\n            ThisItem.IsSelected, \n            Color.Yellow, \n            ColorFade(Color.Yellow, .6)),\n        \n        If(\n            ThisItem.IsSelected, \n            RGBA(255, 121, 69,1), \n            ColorFade(RGBA(255, 121, 69,1), .6))))\n\n\n\n//If(\n//    ThisItem.IsSelected, \n//    RGBA(177, 179, 179, 1), \n//    RGBA(0, 0, 0, 0))\n\n/*\nIf(\n    IsBlank(ThisItem.p6_approved_on) || IsBlank(ThisItem.xo_approved_on),\n    If(\n        ThisItem.IsSelected, \n        RGBA(255, 121, 69,1), \n        ColorFade(RGBA(255, 121, 69,1), .6)), \n    If(\n        ThisItem.p6_approved_on = Date(1900, 1, 1) || ThisItem.xo_approved_on = Date(1900, 1, 1), \n        If(\n            ThisItem.IsSelected,\n            Color.Yellow, \n            ColorFade(Color.Yellow, .6)),\n\n        If(\n            ThisItem.IsSelected, \n            Color.LightGreen, \n            ColorFade(Color.LightGreen, .6))))\n*/\n"
                  TemplateSize: =Text_Input_Change_User_70.Height*2
                  Width: =Parent.Width*19/20
                  X: =(Parent.Width - Self.Width)/2
                  Y: =Text_Requestor_70.Y + Text_Requestor_70.Height
                Children:
                  - Text_Num_Items_71:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.num_items
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Num_Items_70.Width
                        X: =Text_Num_Items_70.X - Gallery_Purchases_70.X
                  - Text_Cost_71:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =Concatenate("$", Abs(ThisItem.purchase_cost))
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Cost_70.Width
                        X: =Text_Cost_70.X - Gallery_Purchases_70.X
                  - Text_PR_Num_71:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.gfebs_pr_num
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_PR_Num_70.Width
                        X: =Text_PR_Num_70.X - Gallery_Purchases_70.X
                  - Text_Vendor_71:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.vendor_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Vendor_70.Width
                        X: =Text_Vendor_70.X - Gallery_Purchases_70.X
                  - Text_Purpose_71:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.purpose
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Purpose_70.Width
                        X: =Text_Purpose_70.X - Gallery_Purchases_70.X
                  - Text_Requestor_71:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: |
                          =ThisItem.requestor_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Requestor_70.Width
                        Wrap: =false
                        X: =Text_Requestor_70.X - Gallery_Purchases_70.X
                  - Text_Purchase_ID_71:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        PaddingLeft: =10
                        Size: =18
                        Text: =ThisItem.purchase_cost_id
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Purchase_ID_70.Width
                        Wrap: =false
                  - Separator_Gallery_Purchases_70:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Text_Num_Items_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="Items"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/20
                  X: =Gallery_Purchases_70.X + Gallery_Purchases_70.Width - Self.Width
                  Y: =Text_Requestor_70.Y
            - Text_Cost_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="Cost"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Parent.Width/19
                  X: =Text_Num_Items_70.X - Self.Width - 10
                  Y: =Text_Requestor_70.Y
            - Text_PR_Num_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="PR Num"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Cost_70.X - Self.X - 10
                  X: =Text_Vendor_70.X + Text_Vendor_70.Width + 10
                  Y: =Text_Requestor_70.Y
            - Text_Vendor_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="Vendor"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Purchases_70.Width/5
                  X: =Text_Purpose_70.X + Text_Purpose_70.Width + 10
                  Y: =Text_Requestor_70.Y
            - Text_Purpose_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="Purpose"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Purchases_70.Width/5
                  X: =Text_Requestor_70.X + Text_Requestor_70.Width + 10
                  Y: =Text_Requestor_70.Y
            - Text_Requestor_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="Requestor"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Purchases_70.Width/5
                  X: =Gallery_Purchases_70.X + Text_Purchase_ID_70.Width + 10
                  Y: =Parent.Height/40
            - Text_Purchase_ID_70:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_70.Height
                  Size: =18
                  Text: ="Purchase ID"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Purchases_70.Width/15
                  X: =Gallery_Purchases_70.X
                  Y: =Parent.Height/40
      - Container_Purchase_Header_70:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Purchase_Header_70:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Purchase Requests"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_70:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_70:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Purchase_Details_80

Screens:
  Screen_Purchase_Details_80:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Purchase_Details_80:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Header_Purchase_Details_80.Height
            Width: =Parent.Width
            Y: =Container_Header_Purchase_Details_80.Height
          Children:
            - Text_Input_Purchase_ID_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: =Index(colPurchase,1).purchase_cost_id
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width/15
                  X: =Parent.Width - Self.Width
                  Y: =Parent.Height - Self.Height
            - Text_Purchase_ID_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Purchase ID"
                  Width: =Parent.Width/12
                  X: =Text_Input_Purchase_ID_80.X - Self.Width
                  Y: =Text_Input_Purchase_ID_80.Y
            - Button_DisburseFunds_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |
                    =If(
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research"), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: =UpdateContext({varDisburse:true})
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Text: ="Disburse Funds"
                  Visible: =false
                  Width: =Button_Return_80.Width
                  X: =Button_Generate_Memo_61.X + Button_Generate_Memo_61.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Cancel_Request_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour) &&
                        Not(IsBlank(Index(colPurchase,1).purchase_cost_id)), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varShowCancel: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Cancel Request"
                  Width: =Button_Return_80.Width
                  X: =Button_Generate_Memo_61.X + Button_Generate_Memo_61.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Generate_Memo_61:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour) &&
                        Not(IsBlank(Index(colPurchase,1).budget_id)), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: =UpdateContext({varGenerateMemo:true})
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Text: ="Generate Form"
                  Visible: |-
                    =If(
                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) &&
                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers),
                        true, false)
                  Width: =Button_Return_80.Width
                  X: =Button_Add_Files_80.X + Button_Add_Files_80.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Add_Files_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\r\n    (varPermissions = \"Master\" ||\r\n    varPermissions = \"Admin\" ||\r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour) \r\n    \r\n    &&\r\n    \r\n    Not(IsBlank(Index(colPurchase,1).purchase_cost_id)), \r\n    DisplayMode.Edit, DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: |-
                    =UpdateContext({varAddFiles: true})
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: ="Add Files"
                  Tooltip: =
                  Visible: |-
                    =If(
                        Self.Text = "Routing Complete" || Self.Text = "", 
                        false, true)
                  Width: =Button_Return_80.Width
                  X: =Button_Route_80.X + Button_Route_80.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Route_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour) && 
                        IsBlank(Index(colPurchase,1).budget_id) &&
                        Not(IsBlank(Index(colPurchase,1).purchase_cost_id)), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: |-
                    =UpdateContext({varShowInvoiceWarning: true})
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: ="Request Funds"
                  Tooltip: =
                  Visible: |-
                    =If(
                        Self.Text = "Routing Complete" || Self.Text = "", 
                        false, true)
                  Width: =Button_Return_80.Width
                  X: =Button_Submit_80.X + Button_Submit_80.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Submit_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit &&
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=UpdateContext({varShowSpinner:true});\r\n// REMOVE ANY DELETED ITEMS\r\nIf(CountRows(colRemoveItems)>0, \r\n    ForAll(colRemoveItems As remove_item, \r\n        Remove(purchase_items, LookUp(purchase_items, purchase_item_id = remove_item.purchase_item_id))));\r\n\r\n// REMOVE ANY DELETED NOTES\r\nIf(CountRows(colRemovePurchaseNotes)>0, \r\n    ForAll(colRemovePurchaseNotes As remove_note, \r\n        Remove(purchase_cost_notes, LookUp(purchase_cost_notes, purchase_note_id = remove_note.purchase_note_id))));\r\n\r\n// REMOVE ANY DELETED PROJECT PURCHASES\r\nIf(CountRows(colRemoveProjectPurchases)>0, \r\n    ForAll(colRemoveProjectPurchases As remove_project, \r\n        Remove(project_purchases, LookUp(project_purchases, project_purchase_id = remove_project.project_purchase_id))));\r\n\r\n\r\n// UPDATE PURCHASE COSTS TABLE\r\nIf(\r\n    IsBlank(Index(colPurchase,1).purchase_cost_id), // IF COMPLETELY NEW PURCHASE\r\n    Set(varPurchaseID,\r\n        // PATCH IN NEW PURCHASE TO PURCHASE_COSTS TABLE AND GET PURCHASE COST ID\r\n            Patch(purchase_costs, Defaults(purchase_costs),\r\n                {cntrl_num: Index(colPurchase,1).cntrl_num,\r\n                budget_id: Index(colPurchase,1).budget_id,\r\n                budget_assigned_by: Index(colPurchase,1).budget_assigned_by,\r\n                invoice_num: Index(colPurchase,1).invoice_num,\r\n                purpose: Index(colPurchase,1).purpose,\r\n                vendor_name: Index(colPurchase,1).vendor_name,\r\n                items_cost: -Abs(Index(colPurchase,1).items_cost),\r\n                shipping_cost: -Abs(Index(colPurchase,1).shipping_cost),\r\n                purchase_cost: -Abs(Index(colPurchase,1).purchase_cost),\r\n                purchase_category: Index(colPurchase,1).purchase_category,\r\n                purchase_type: Index(colPurchase,1).purchase_type,\r\n                purchase_cost_status: Index(colPurchase,1).purchase_cost_status,\r\n                date_ordered: Index(colPurchase,1).date_ordered,\r\n                gfebs_pr_num: Index(colPurchase,1).gfebs_pr_num,\r\n                cardholder: Index(colPurchase,1).cardholder,\r\n                date_received: Index(colPurchase,1).date_received,\r\n                certified_fund_date: Index(colPurchase,1).certified_fund_date, \r\n                requestor_tour: Index(colPurchase,1).requestor_tour,\r\n                recipient_tour: Index(colPurchase,1).recipient_tour,\r\n                updated_on: Today()}).purchase_cost_id);\r\n\r\n    // ADD NEW PURCHASE ITEMS TO NEW PURCHASE COSTS\r\n    ForAll(colItems As item, \r\n        Patch(purchase_items, Defaults(purchase_items), \r\n            {purchase_cost_id: varPurchaseID, \r\n            item_desc: item.item_desc, \r\n            part_num: item.part_num, \r\n            quantity: item.quantity, \r\n            unit_price: -Abs(item.unit_price), \r\n            total_cost: -Abs(item.total_cost), \r\n            updated_on: Today()})); \r\n\r\n    // ADD NEW NOTES TO NEW PURCHASE COSTS\r\n    ForAll(colPurchaseNotes As note, \r\n        Patch(purchase_cost_notes, Defaults(purchase_cost_notes), \r\n            {purchase_cost_id: varPurchaseID, \r\n            notes: note.notes, \r\n            tour_id: note.tour_id, \r\n            updated_on: Today()})); \r\n\r\n    // ADD NEW PROJECT PURCHASES TO NEW PURCHASE COSTS\r\n    ForAll(colProjectPurchases As project, \r\n        Patch(project_purchases, Defaults(project_purchases), \r\n            {purchase_cost_id: varPurchaseID, \r\n            project_id: project.project_id})), \r\n\r\n    // UPDATE EXISTING PURCHASE COSTS\r\n    If(\r\n        varPurchaseChange, \r\n        Patch(purchase_costs, LookUp(purchase_costs, purchase_cost_id = Index(colPurchase,1).purchase_cost_id), \r\n            {cntrl_num: Index(colPurchase,1).cntrl_num,\r\n            budget_id: Index(colPurchase,1).budget_id,\r\n            budget_assigned_by: Index(colPurchase,1).budget_assigned_by,\r\n            invoice_num: Index(colPurchase,1).invoice_num,\r\n            purpose: Index(colPurchase,1).purpose,\r\n            vendor_name: Index(colPurchase,1).vendor_name,\r\n            items_cost: -Abs(Index(colPurchase,1).items_cost),\r\n            shipping_cost: -Abs(Index(colPurchase,1).shipping_cost),\r\n            purchase_cost: -Abs(Index(colPurchase,1).purchase_cost),\r\n            purchase_category: Index(colPurchase,1).purchase_category,\r\n            purchase_type: Index(colPurchase,1).purchase_type,\r\n            purchase_cost_status: Index(colPurchase,1).purchase_cost_status,\r\n            date_ordered: Index(colPurchase,1).date_ordered,\r\n            gfebs_pr_num: Index(colPurchase,1).gfebs_pr_num,\r\n            cardholder: Index(colPurchase,1).cardholder,\r\n            date_received: Index(colPurchase,1).date_received,\r\n            certified_fund_date: Index(colPurchase,1).certified_fund_date, \r\n            requestor_tour: Index(colPurchase,1).requestor_tour,\r\n            recipient_tour: Index(colPurchase,1).recipient_tour,\r\n            updated_on: Today()})); \r\n\r\n    // UPDATE PURCHASE ITEMS FOR EXISTING PURCHASE COSTS\r\n    If(\r\n        varItemChange, \r\n        ForAll(colItems As item, \r\n            If(\r\n                IsBlank(item.purchase_item_id), \r\n                    \r\n                // PATCH IN NEW ITEMS TO EXISTING PURCHASE COST\r\n                Patch(purchase_items, Defaults(purchase_items), \r\n                    {purchase_cost_id: varPurchaseID, \r\n                    item_desc: item.item_desc, \r\n                    part_num: item.part_num, \r\n                    quantity: item.quantity, \r\n                    unit_price: -Abs(item.unit_price), \r\n                    total_cost: -Abs(item.total_cost), \r\n                    updated_on: Today()}), \r\n\r\n                // PATCH IN UPDATES TO EXISTING ITEMS IN EXISTING PURCHASE COST\r\n                Patch(purchase_items, LookUp(purchase_items, purchase_item_id = item.purchase_item_id), \r\n                    {item_desc: item.item_desc, \r\n                    part_num: item.part_num, \r\n                    quantity: item.quantity, \r\n                    unit_price: -Abs(item.unit_price), \r\n                    total_cost: -Abs(item.total_cost), \r\n                    updated_on: Today()}))); \r\n\r\n        // UPDATE TOTAL PURCHASE COST BECAUSE OF CHANGES TO ITEMS\r\n        Patch(purchase_costs, LookUp(purchase_costs, purchase_cost_id = Index(colPurchase,1).purchase_cost_id), \r\n            {items_cost: -Abs(Index(colPurchase,1).items_cost), \r\n            purchase_cost: -Abs(Index(colPurchase,1).purchase_cost)}));\r\n\r\n    // UPDATE PURCHASE NOTES FOR EXISTING PURCHASE COSTS\r\n    If(\r\n        varPurchaseNoteChange, \r\n        ForAll(colPurchaseNotes As note, \r\n            If(\r\n                IsBlank(note.purchase_note_id), \r\n                    \r\n                // PATCH IN NEW NOTES TO EXISTING PURCHASE COST\r\n                Patch(purchase_cost_notes, Defaults(purchase_cost_notes), \r\n                    {purchase_cost_id: varPurchaseID, \r\n                    notes: note.notes, \r\n                    tour_id: note.tour_id, \r\n                    updated_on: Today()}), \r\n\r\n                // PATCH IN UPDATES TO EXISTING NOTES FOR EXISTING PURCHASE COST\r\n                Patch(purchase_cost_notes, LookUp(purchase_cost_notes, purchase_note_id = note.purchase_note_id), \r\n                    {notes: note.notes, \r\n                    tour_id: note.tour_id, \r\n                    updated_on: Today()}))));\r\n\r\n    // UPDATE PROJECT PURCHASES FOR EXISTING PURCHASE COSTS\r\n    If(\r\n        varProjectPurchaseChange, \r\n        ForAll(colProjectPurchases As project, \r\n            If(\r\n                IsBlank(project.project_purchase_id), \r\n\r\n                // PATCH IN NEW PROJECT PURCHASES FOR EXISTING PURCHASE COST\r\n                Patch(project_purchases, Defaults(project_purchases), \r\n                    {purchase_cost_id: varPurchaseID, \r\n                    project_id: project.project_id}), \r\n\r\n                // UPDATE EXISTING PROJECT PURCHASES FOR EXISTING PURCHASE COST\r\n                Patch(project_purchases, LookUp(project_purchases, project_purchase_id = project.project_purchase_id), \r\n                    {project_id: project.project_id})))));\r\n\r\nSet(varPurchaseID, Blank());\r\n\r\nUpdateContext({varPurchaseChange: Blank()});\r\nUpdateContext({varItemChange: Blank()});\r\nUpdateContext({varReadyToSubmit:Blank()});\r\nUpdateContext({varShow10KWarning:Blank()});\r\nUpdateContext({varShowITWarning:Blank()});\r\nUpdateContext({varShowVendorWarning:Blank()});\r\nUpdateContext({varShowInvoiceWarning:Blank()});\r\nUpdateContext({varReadyToSubmit:Blank()});\r\nUpdateContext({varShowCancel:Blank()});\r\nUpdateContext({varGenerateMemo:false});\r\n\r\nClearCollect(colPurchase, \r\n    {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()},\r\n    {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()});\r\n\r\nClear(colItems);\r\nClear(colPurchaseNotes);\r\nClear(colProjectPurchases);\r\nClear(colRemoveItems);\r\nClear(colRemovePurchaseNotes);\r\nClear(colRemoveProjectPurchases);\r\n\r\nRefresh(purchase_cost_view);\r\nRefresh(purchase_items); \r\nRefresh(purchase_notes_view); \r\nRefresh(project_purchases);\r\n\r\nReset(Gallery_Purchases_70);\r\n\r\nUpdateContext({varShowSpinner:false});\r\n\r\nIf(\r\n    Not(IsBlank(varReturnScreen)), \r\n    Navigate(varReturnScreen),\r\n    Navigate(Screen_Purchase_Overview_70))"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Save"
                  Visible: "=If(\r\n    (varUser.dept_pos = \"XO\" || varUser.dept_pos = \"P5\" || varUser.dept_pos = \"P6\") &&\r\n    \r\n    CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers) &&\r\n\r\n    CountRows(colTravelers) > 0 &&\r\n\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = CountRows(colTravelers), false, true)"
                  Width: =Button_Return_80.Width
                  X: =Button_Check_80.X + Button_Check_80.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Check_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        (varReadyToSubmit = false) &&
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=If(\n    // CHECK MINIMUM REQUIREMENTS TO CREATE A REQUEST\n    Not(IsBlank(Index(colPurchase,1).requestor_tour)) &&\n    Not(IsBlank(Index(colPurchase,1).recipient_tour)) &&\n    Not(IsBlank(Index(colPurchase,1).vendor_name)) &&\n    Not(IsBlank(Index(colPurchase,1).purpose)) &&\n    Not(IsBlank(Index(colPurchase,1).purchase_type)) &&\n    Not(IsBlank(Index(colPurchase,1).shipping_cost)) &&\n    Not(IsBlank(Index(colPurchase,1).purchase_cost_status)), \n    \n    If(\n        CountRows(Filter(colItems, IsBlank(item_desc))) = 0 && \n        CountRows(Filter(colItems, IsBlank(unit_price))) = 0 && \n        CountRows(Filter(colItems, IsBlank(quantity))) = 0 && \n        CountRows(colItems) > 0, \n\n        If(\n            CountRows(Filter(colPurchaseNotes, IsBlank(notes))) = 0, \n\n            UpdateContext({varReadyToSubmit:true});\n            Notify(\"CLICK SAVE TO SUBMIT CHANGES\", NotificationType.Success),\n\n            Notify(\"PLEASE DELETE ANY BLANK NOTES\", NotificationType.Error)), \n\n        Notify(\"PLEASE ENSURE YOU HAVE AT LEAST ONE ITEM, WITH A DESCRIPTION, UNIT PRICE, AND QUANTITY FILLED OUT\", NotificationType.Error)), \n            \n    Notify(\"PLEASE ENSURE ALL FIELDS OUTLINED IN RED ARE FILLED OUT\", NotificationType.Error))"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Check"
                  Width: =Button_Return_80.Width
                  X: =Button_Return_80.X + Button_Return_80.Width + Parent.Width/50
                  Y: =Button_Return_80.Y
            - Button_Return_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Set(varPurchaseID, Blank());

                    UpdateContext({varPurchaseChange: Blank()});
                    UpdateContext({varItemChange: Blank()});
                    UpdateContext({varReadyToSubmit:Blank()});
                    UpdateContext({varShow10KWarning:Blank()});
                    UpdateContext({varShowITWarning:Blank()});
                    UpdateContext({varShowVendorWarning:Blank()});
                    UpdateContext({varShowInvoiceWarning:Blank()});
                    UpdateContext({varReadyToSubmit:Blank()});
                    UpdateContext({varShowCancel:Blank()});
                    UpdateContext({varGenerateMemo:false});

                    ClearCollect(colPurchase, 
                        {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()},
                        {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()});

                    Clear(colItems);
                    Clear(colPurchaseNotes);
                    Clear(colProjectPurchases);
                    Clear(colRemoveItems);
                    Clear(colRemovePurchaseNotes);
                    Clear(colRemoveProjectPurchases);

                    Refresh(purchase_cost_view);
                    Refresh(purchase_items); 
                    Refresh(purchase_notes_view); 
                    Refresh(project_purchases);

                    Reset(Gallery_Purchases_70);

                    UpdateContext({varShowSpinner:false});

                    If(
                        Not(IsBlank(varReturnScreen)), 
                        Navigate(varReturnScreen),
                        Navigate(Screen_Purchase_Overview_70))
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Return"
                  Width: =Parent.Width/12
                  X: =Parent.Width/40
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Container_Admin_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  DropShadow: =DropShadow.None
                  Fill: =Color.White
                  Height: =Button_Return_80.Y - Self.Y - Parent.Height/40
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Parent.Width*19/20
                  X: =Parent.Width/50
                  Y: |-
                    =Gallery_Purchase_Notes_80.Y + Gallery_Purchase_Notes_80.Height + Parent.Height/40

                    //Container_Items_80.Y + Container_Items_80.Height + Parent.Height/20
                Children:
                  - Dropdown_Status_80:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colCostStatus,  cost_status= Index(colPurchase,1).purchase_cost_status)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_80.Height
                        Items: =colCostStatus
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), 
                              {purchase_cost_status: Self.Selected.cost_status});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                        Width: =Date_Picker_Cert_Fund_Date_80.Width
                        X: =Dropdown_Budget_80.X
                        Y: =Text_GFEBS_PR_Num_80.Y
                      Children:
                        - cost_status2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="cost_status"
                              FieldName: ="cost_status"
                              FieldType: ="s"
                              Order: =1
                  - Text_Status_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Status"
                        Width: =Text_Budget_80.Width
                        X: =Text_Budget_80.X
                        Y: =Text_GFEBS_PR_Num_80.Y
                  - Text_Budget_81:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =18
                        Text: =Concatenate("Assigned by ", LookUp(colFaculty, tour_id = Index(colPurchase,1).budget_assigned_by).name)
                        VerticalAlign: =VerticalAlign.Middle
                        Visible: =Not(IsBlank(Index(colPurchase,1).budget_assigned_by))
                        Width: =Dropdown_Budget_80.Width + Text_Budget_80.Width
                        X: =Text_Budget_80.X
                        Y: =Text_Budget_80.Y +Text_Budget_80.Height
                  - Dropdown_Budget_80:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colBudgets, budget_id= Index(colPurchase,1).budget_id)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_80.Height
                        Items: =colBudgets
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), 
                              {budget_id: Self.Selected.budget_id, 
                              budget_assigned_by: varUser.tour_id});

                          If(
                              LookUp(colBudgets, budget_id = Self.Selected.budget_id).print_amount > 0 && 
                              Index(colPurchase,1).purchase_type = "PRINTING", 
                              Patch(colPurchase, Index(colPurchase,1), 
                                  {purchase_category: "PRINT"}), 

                              Patch(colPurchase, Index(colPurchase,1), 
                                  {purchase_category: "SUPPLY"}));


                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                        Width: =Date_Picker_Cert_Fund_Date_80.Width
                        X: =Text_Budget_80.X + Text_Budget_80.Width
                        Y: =Text_Budget_80.Y
                      Children:
                        - budget_name2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_name"
                              FieldName: ="budget_name"
                              FieldType: ="s"
                              Order: =1
                        - budget_id2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_id"
                              FieldName: ="budget_id"
                              FieldType: ="n"
                              Order: =2
                        - budget_type2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_type"
                              FieldName: ="budget_type"
                              FieldType: ="s"
                              Order: =3
                        - director_tour1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="director_tour"
                              FieldName: ="director_tour"
                              FieldType: ="n"
                              Order: =4
                        - director_2_tour1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="director_2_tour"
                              FieldName: ="director_2_tour"
                              FieldType: ="n"
                              Order: =5
                  - Text_Budget_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Budget:"
                        Width: =Text_Control_Num_80.Width/2
                        X: =Date_Picker_Date_Ordered_80.X + Date_Picker_Date_Ordered_80.Width + Parent.Width/80
                        Y: =Text_Control_Num_80.Y
                  - Date_Picker_Date_Received_80:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_80.Height
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), {date_received: Self.SelectedDate});
                          UpdateContext({varReadyToSubmit:false});
                        SelectedDate: =Index(colPurchase,1).date_received
                        Width: =Text_Input_Control_Num_80.Width
                        X: =Date_Picker_Date_Ordered_80.X
                        Y: =Text_GFEBS_PR_Num_80.Y
                  - Text_Date_Received_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Date Received:"
                        Width: =Text_Control_Num_80.Width
                        X: =Text_Date_Ordered_80.X
                        Y: =Text_GFEBS_PR_Num_80.Y
                  - Date_Picker_Date_Ordered_80:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_80.Height
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), {date_ordered: Self.SelectedDate});
                          UpdateContext({varReadyToSubmit:false});
                        SelectedDate: =Index(colPurchase,1).date_ordered
                        Width: =Text_Input_Control_Num_80.Width
                        X: =Text_Date_Ordered_80.X + Text_Date_Ordered_80.Width
                        Y: =Text_Date_Ordered_80.Y
                  - Text_Date_Ordered_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Date Ordered:"
                        Width: =Text_Control_Num_80.Width
                        X: =Date_Picker_Cert_Fund_Date_80.X + Date_Picker_Cert_Fund_Date_80.Width + Parent.Width/80
                        Y: =Text_Control_Num_80.Y
                  - Dropdown_Cardholder_80:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colFaculty, tour_id = Index(colPurchase,1).cardholder)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_80.Height
                        Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), 
                              {cardholder: Self.Selected.tour_id,
                              cardholder_name: Self.Selected.name});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                        Width: =Date_Picker_Cert_Fund_Date_80.Width
                        X: =Date_Picker_Cert_Fund_Date_80.X
                        Y: =Text_GFEBS_PR_Num_80.Y
                      Children:
                        - name2_2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="name"
                              FieldName: ="name"
                              FieldType: ="s"
                              Order: =1
                        - last_name3_2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="last_name"
                              FieldName: ="last_name"
                              FieldType: ="s"
                              Order: =2
                        - tour_id2_2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="tour_id"
                              FieldName: ="tour_id"
                              FieldType: ="n"
                              Order: =3
                  - Text_Cardholder_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Cardholder:"
                        Width: =Text_Control_Num_80.Width
                        X: =Text_Cert_Fund_Date_80.X
                        Y: =Text_GFEBS_PR_Num_80.Y
                  - Date_Picker_Cert_Fund_Date_80:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_80.Height
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), {certified_fund_date: Self.SelectedDate});
                          UpdateContext({varReadyToSubmit:false});
                        SelectedDate: =Index(colPurchase,1).certified_fund_date
                        Width: =Text_Input_Control_Num_80.Width
                        X: =Text_Cert_Fund_Date_80.X + Text_Cert_Fund_Date_80.Width
                        Y: =Text_Cert_Fund_Date_80.Y
                  - Text_Cert_Fund_Date_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Certified Fund Date:"
                        Width: =Text_Control_Num_80.Width
                        X: =Text_Input_Control_Num_80.X + Text_Input_Control_Num_80.Width + Parent.Width/80
                        Y: =Text_Control_Num_80.Y
                  - Text_Input_GFEBS_PR_Num_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Index(colPurchase,1).gfebs_pr_num
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HintText: =
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), {gfebs_pr_num: Upper(Self.Text)});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Text_Admin_80.Width/8
                        X: =Text_Control_Num_80.X + Text_Control_Num_80.Width
                        Y: =Text_GFEBS_PR_Num_80.Y
                  - Text_GFEBS_PR_Num_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="GFEBS PR Num:"
                        Width: =Text_Control_Num_80.Width
                        X: =Text_Control_Num_80.X
                        Y: =Text_Control_Num_80.Y + Text_Control_Num_80.Height + Parent.Height/5
                  - Text_Input_Control_Num_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Index(colPurchase,1).cntrl_num
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HintText: =
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: |-
                          =Patch(colPurchase, Index(colPurchase,1), {cntrl_num: Upper(Self.Text)});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Text_Admin_80.Width/8
                        X: =Text_Control_Num_80.X + Text_Control_Num_80.Width
                        Y: =Text_Control_Num_80.Y
                  - Text_Control_Num_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Control Num:"
                        Width: =Text_Admin_80.Width/8
                        Y: =Text_Admin_80.Y + Text_Admin_80.Height + Parent.Height/40
                  - Text_Admin_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="For Admin Personnel Use"
                        Width: =Parent.Width
            - Gallery_Project_Purchases_80:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =2
                  Height: =Text_Requestor_80.Height*1.5
                  Items: =colProjectPurchases
                  OnSelect: |-
                    =//UpdateContext({varTraveler: ThisItem});
                  TemplateSize: =Text_Input_Change_User_80.Height
                  Width: =Parent.Width/4
                  X: =Container_Items_80.X + Container_Items_80.Width - Self.Width
                  Y: =Button_Add_Projects_80.Y
                Children:
                  - Text_Input_Project_Title_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =LookUp(current_projects_view, project_id = ThisItem.project_id).project_title
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        OnSelect: =//UpdateContext({varTraveler:ThisItem});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.TemplateWidth
                  - Separator_Gallery_Project_Purchases_80:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Button_Add_Projects_80:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: |-
                    =Set(varReturnScreen, App.ActiveScreen);
                    Navigate(Screen_Projects_Overview_30);
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varProjectPurchaseChange: true});
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Text: ="Projects"
                  Tooltip: =
                  Visible: |-
                    =If(
                        Self.Text = "Routing Complete" || Self.Text = "", 
                        false, true)
                  Width: =Button_Return_80.Width
                  X: =Gallery_Project_Purchases_80.X - Self.Width - Parent.Width/80
                  Y: =Container_Items_80.Y + Container_Items_80.Height + Parent.Height/40
            - Gallery_Purchase_Notes_80:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 0, 0, 1)
                  BorderThickness: =2
                  Height: =Text_Requestor_80.Height*1.5
                  Items: =Sort(colPurchaseNotes, updated_on, SortOrder.Descending)
                  OnSelect: |-
                    =//UpdateContext({varTraveler: ThisItem});
                  Selectable: =false
                  TemplateSize: =Text_Input_Change_User_80.Height
                  Width: =Icon_Add_Note_80.X + Icon_Add_Note_80.Width - Text_Notes_80.X + 10
                  X: =Text_Notes_80.X
                  Y: =Text_Notes_80.Y + Text_Notes_80.Height
                Children:
                  - Icon_Remove_Note_80:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =If(
                              Not(IsBlank(ThisItem.purchase_note_id)), 
                              Collect(colRemovePurchaseNotes, ThisItem));

                          Remove(colPurchaseNotes, ThisItem);

                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseNoteChange: true});
                        Width: =Self.Height
                        X: =Parent.TemplateWidth - Self.Width - 10
                  - Text_Input_Note_Date_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =ThisItem.updated_on
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        OnSelect: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Note_Date_80.Width
                        X: =Text_Note_Date_80.X - Gallery_Purchase_Notes_80.X
                  - Text_Input_Note_Creator_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =ThisItem.name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        OnSelect: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Note_Creator_80.Width
                        X: =Text_Note_Creator_80.X - Gallery_Purchase_Notes_80.X
                  - Text_Input_Note_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =ThisItem.notes
                        DisplayMode: |-
                          =If(
                              varUser.tour_id = ThisItem.tour_id ||
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.tour_id = Index(colPurchase,1).requestor_tour, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        Mode: =TextMode.MultiLine
                        OnChange: |
                          =Patch(colPurchaseNotes, ThisItem, 
                              {notes: Upper(Self.Text), 
                              tour_id: varUser.tour_id, 
                              name: varUser.name,
                              updated_on: Today()});

                          UpdateContext({varPurchaseNoteChange: true});
                          UpdateContext({varReadyToSubmit: false});
                        OnSelect: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Notes_80.Width
                  - Separator_Gallery_Purchase_Notes_80:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_Note_80:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                  Height: =Text_Input_Change_User_80.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Collect(colPurchaseNotes,
                        {purchase_note_id: Blank(), 
                        purchase_cost_id: varPurchaseID,  
                        notes: Blank(),
                        tour_id: Blank(),
                        name: Blank(), 
                        updated_on: Blank(),
                        new_note_num: Max(colPurchaseNotes, new_note_num) + 1});

                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseNoteChange: true});
                  Width: =Self.Height
                  X: =Text_Note_Date_80.X + Text_Note_Date_80.Width + 10
                  Y: =Text_Note_Creator_80.Y
            - Text_Note_Date_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Updated On"
                  Width: =Parent.Width/10
                  X: =Text_Note_Creator_80.X + Text_Note_Creator_80.Width + 10
                  Y: =Text_Note_Creator_80.Y
            - Text_Note_Creator_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Created By"
                  Width: =Parent.Width/6
                  X: =Text_Notes_80.X + Text_Notes_80.Width + 10
                  Y: =Text_Notes_80.Y
            - Text_Notes_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Notes"
                  Width: =Parent.Width/5
                  X: =Container_Items_80.X
                  Y: =Container_Items_80.Y + Container_Items_80.Height + Parent.Height/50
            - Container_Items_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  DropShadow: =DropShadow.None
                  Fill: =Color.White
                  Height: =Parent.Height/3.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Parent.Width*19/20
                  X: =Parent.Width/50
                  Y: =Text_Vendor_80.Y + Text_Vendor_80.Height + Parent.Height/30
                Children:
                  - Gallery_Items_80:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Parent.Height - Self.Y - Parent.Height/40
                        Items: =colItems
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        TemplateSize: =Text_Input_Change_User_80.Height
                        Width: =Parent.Width
                        Y: =Text_Item_ID_80.Y + Text_Item_ID_80.Height
                      Children:
                        - Icon_Remove_Item_80:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.purchase_item_id)),
                                    Collect(colRemoveItems, ThisItem));

                                Remove(colItems, ThisItem);

                                Patch(colPurchase, Index(colPurchase,1), 
                                    {items_cost: -Abs(Sum(colItems, total_cost)), 
                                    purchase_cost: -Abs(Sum(colItems, total_cost)) + -Abs(Index(colPurchase,1).shipping_cost)});

                                UpdateContext({varItemChange:true});
                                UpdateContext({varReadyToSubmit:false})
                              Tooltip: =
                              Width: =Self.Height
                              X: =Icon_Add_Item_80.X
                        - Text_Input_Extended_Cost_80:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =Abs(ThisItem.total_cost)
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(colItems, ThisItem, {unit_price:-Abs(Value(Self.Text))});

                                UpdateContext({varItemChange:true});

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Extended_Cost_80.Width
                              X: =Text_Extended_Cost_80.X
                        - Text_Input_QTY_80:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.quantity
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: "=Patch(\n    colItems, ThisItem, \n    {quantity:Abs(Value(Self.Text)), \n    total_cost: ThisItem.unit_price * Abs(Value(Self.Text))});\n\nPatch(colPurchase, Index(colPurchase,1), \n    {items_cost: -Abs(Sum(colItems, total_cost)), \n    purchase_cost: -Abs(Sum(colItems, total_cost)) + -Abs(Index(colPurchase,1).shipping_cost)});\n    \nUpdateContext({varItemChange:true});\n\nUpdateContext({varReadyToSubmit: false}); \n\nIf(\n    Abs(Index(colPurchase,1).purchase_cost) > 10000, \n    UpdateContext({varShow10KWarning:true}))"
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_QTY_80.Width
                              X: =Text_QTY_80.X
                        - Text_Input_Unit_Price_80:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =Abs(ThisItem.unit_price)
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(
                                    colItems, ThisItem, 
                                    {unit_price:-Abs(Value(Self.Text)), 
                                    total_cost: -Abs(Value(Self.Text)) * ThisItem.quantity});

                                Patch(colPurchase, Index(colPurchase,1), 
                                    {items_cost: -Abs(Sum(colItems, total_cost)), 
                                    purchase_cost: -Abs(Sum(colItems, total_cost)) + -Abs(Index(colPurchase,1).shipping_cost)});

                                UpdateContext({varItemChange:true});

                                UpdateContext({varReadyToSubmit: false});

                                If(
                                    Abs(Index(colPurchase,1).purchase_cost) > 10000, 
                                    UpdateContext({varShow10KWarning:true}))
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Unit_Price_80.Width
                              X: =Text_Unit_Price_80.X
                        - Text_Input_Part_Num_80:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.part_num
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(colItems, ThisItem, {part_num:Upper(Self.Text)});

                                UpdateContext({varItemChange:true});

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Part_Num_80.Width
                              X: =Text_Part_Num_80.X
                        - Text_Input_Item_Desc_80:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.item_desc
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =Patch(colItems, ThisItem, {item_desc:Upper(Self.Text)});

                                UpdateContext({varItemChange:true});

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Item_Description_80.Width
                              X: =Text_Item_Description_80.X
                        - Text_Input_Item_ID_80:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.purchase_item_id
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Item_ID_80.Width
                              X: =Text_Item_ID_80.X
                        - Separator_Gallery_Items_80:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Item_80:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Height: =Text_Input_Change_User_80.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colItems, 
                              {purchase_cost_id: Index(colPurchase,1).purchase_cost_id, 
                              purchase_item_id: Blank(), 
                              new_item_num: Max(colItems, new_item_num) + 1, 
                              item_desc: Blank(), 
                              part_num: Blank(), 
                              unit_price: Blank(), 
                              quantity: Blank(), 
                              total_cost: Blank()});

                          UpdateContext({varItemChange: true});

                          UpdateContext({varReadyToSubmit:false});
                        Width: =Self.Height
                        X: =(Gallery_Items_80.X + Gallery_Items_80.Width - Text_Extended_Cost_80.X - Text_Extended_Cost_80.Width - Self.Width)/2 + Text_Extended_Cost_80.X + Text_Extended_Cost_80.Width
                        Y: =Text_Item_Description_80.Y
                  - Text_Extended_Cost_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Extended Cost"
                        Width: =Text_Items_80.Width/10
                        X: =Text_QTY_80.X + Text_QTY_80.Width + 10
                        Y: =Text_Items_80.Y + Text_Items_80.Height
                  - Text_QTY_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="QTY"
                        Width: =Text_Items_80.Width/10
                        X: =Text_Unit_Price_80.X + Text_Unit_Price_80.Width + 10
                        Y: =Text_Items_80.Y + Text_Items_80.Height
                  - Text_Unit_Price_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Unit Price"
                        Width: =Text_Items_80.Width/10
                        X: =Text_Part_Num_80.X + Text_Part_Num_80.Width + 10
                        Y: =Text_Items_80.Y + Text_Items_80.Height
                  - Text_Part_Num_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Part Num"
                        Width: =Text_Items_80.Width/6
                        X: =Text_Item_Description_80.X + Text_Item_Description_80.Width + 10
                        Y: =Text_Items_80.Y + Text_Items_80.Height
                  - Text_Item_Description_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Description"
                        Width: =Text_Items_80.Width/3
                        X: =Text_Item_ID_80.X + Text_Item_ID_80.Width + 10
                        Y: =Text_Items_80.Y + Text_Items_80.Height
                  - Text_Item_ID_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Item ID"
                        Width: =Text_Items_80.Width/10
                        X: =Text_Items_80.X
                        Y: =Text_Items_80.Y + Text_Items_80.Height
                  - Text_Items_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Items"
                        Width: =Parent.Width
            - Text_Input_Total_Cost_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Right
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Abs(Index(colPurchase,1).purchase_cost)
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: =
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Text_Input_Invoice_Num_80.Width
                  X: =Text_Input_Shipping_Cost_80.X
                  Y: =Text_Total_Cost_80.Y
            - Text_Total_Cost_80:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Total Cost:"
                  Width: =Text_Item_Cost_80.Width
                  X: =Text_Item_Cost_80.X
                  Y: =Text_Vendor_80.Y
            - Text_Input_Item_Cost_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Right
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Abs(Index(colPurchase,1).items_cost)
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: =
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Text_Input_Invoice_Num_80.Width
                  X: =Text_Input_Shipping_Cost_80.X
                  Y: =Text_Item_Cost_80.Y
            - Text_Item_Cost_80:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Items Cost:"
                  Width: =Text_Shipping_Cost_80.Width
                  X: =Text_Shipping_Cost_80.X
                  Y: =Text_Recipient_80.Y
            - Text_Input_Shipping_Cost_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Right
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Abs(Index(colPurchase,1).shipping_cost)
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), 
                        {shipping_cost: -Abs(Value(Self.Text)), 
                        purchase_cost: -Abs(Sum(-Abs(Value(Self.Text)), Index(colPurchase,1).items_cost))});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange:true}); 

                    If(
                        Abs(Index(colPurchase,1).purchase_cost) > 10000, 
                        UpdateContext({varShow10KWarning:true}))
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Text_Input_Invoice_Num_80.Width
                  X: =Text_Shipping_Cost_80.X + Text_Shipping_Cost_80.Width
                  Y: =Text_Shipping_Cost_80.Y
            - Text_Shipping_Cost_80:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Shipping Cost:"
                  Width: =Text_Invoice_Num_80.Width
                  X: =Text_Input_Purpose_80.X + Text_Input_Purpose_80.Width + Parent.Width/40
                  Y: =Text_Requestor_80.Y
            - Text_Input_Invoice_Num_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =3
                  Default: =Index(colPurchase,1).invoice_num
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), 
                        {invoice_num: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange:true});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Width: =Dropdown_Requestor_80.Width
                  X: =Text_Invoice_Num_80.X + Text_Invoice_Num_80.Width
                  Y: =Text_Invoice_Num_80.Y
            - Text_Invoice_Num_80:
                Control: Text@0.0.51
                Properties:
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: |-
                    ="Invoice #:"
                  Width: =Text_Requestor_80.Width
                  X: =Text_Purpose_80.X
                  Y: =Text_Vendor_80.Y
            - Dropdown_Purchase_Type_80:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colPurchaseTypes, purchase_type = Index(colPurchase,1).purchase_type)
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_80.Height
                  Items: =colPurchaseTypes
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), {purchase_type: Self.Selected.purchase_type});

                    If(
                        Self.Selected.purchase_type = "INFORMATION TECHNOLOGY",
                        UpdateContext({varShowITWarning:true}));

                    If(
                        LookUp(colBudgets, budget_id = Index(colPurchase,1).budget_id).print_amount > 0 && 
                        Self.Selected.purchase_type = "PRINTING", 
                        Patch(colPurchase, Index(colPurchase,1), 
                            {purchase_category: "PRINT"}), 

                        Patch(colPurchase, Index(colPurchase,1), 
                            {purchase_category: "SUPPLY"}));


                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange:true});
                  Width: =Text_Input_Purpose_80.Width
                  X: =Text_Purchase_Type_80.X + Text_Purchase_Type_80.Width
                  Y: =Text_Purchase_Type_80.Y
                Children:
                  - purchase_type1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="purchase_type"
                        FieldName: ="purchase_type"
                        FieldType: ="s"
                        Order: =1
            - Text_Purchase_Type_80:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Purchase Type:"
                  Width: =Text_Vendor_80.Width
                  X: =Text_Purpose_80.X
                  Y: =Text_Recipient_80.Y
            - Text_Input_Purpose_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colPurchase,1).purpose
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HintText: |-
                    ="Ex: MA104 WPR 3 v2"
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =1000
                  Mode: =TextMode.MultiLine
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), {purpose: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange: true})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =2
                  Width: =Dropdown_Requestor_80.Width
                  X: =Text_Purpose_80.X + Text_Purpose_80.Width
                  Y: =Text_Purpose_80.Y
            - Text_Purpose_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Purpose"
                  Width: =Text_Requestor_80.Width
                  X: =Dropdown_Requestor_80.X + Dropdown_Requestor_80.Width + Parent.Width/40
                  Y: =Text_Requestor_80.Y
            - Text_Input_Vendor_80:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =Index(colPurchase,1).vendor_name
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_80.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =1000
                  Mode: =TextMode.MultiLine
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), {vendor_name: Upper(Self.Text)});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange: true});
                    UpdateContext({varShowVendorWarning:true})
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =2
                  Width: =Dropdown_Recipient_80.Width
                  X: =Dropdown_Recipient_80.X
                  Y: =Text_Vendor_80.Y
            - Text_Vendor_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Vendor:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Recipient_80.Width
                  X: =Text_Requestor_80.X
                  Y: =Text_Recipient_80.Y + Text_Recipient_80.Height + Parent.Height/40
            - Dropdown_Recipient_80:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colFaculty, name = Index(colPurchase,1).recipient_name)
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_80.Height
                  Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), 
                        {recipient_tour: Self.Selected.tour_id,
                        recipient_name: Self.Selected.name});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange: true})
                  Width: =Dropdown_Requestor_80.Width
                  X: =Dropdown_Requestor_80.X
                  Y: =Text_Recipient_80.Y
                Children:
                  - name2_1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="name"
                        FieldName: ="name"
                        FieldType: ="s"
                        Order: =1
                  - last_name3_1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="last_name"
                        FieldName: ="last_name"
                        FieldType: ="s"
                        Order: =2
                  - tour_id2_1:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="tour_id"
                        FieldName: ="tour_id"
                        FieldType: ="n"
                        Order: =3
            - Text_Recipient_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Recipient:"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Text_Requestor_80.Width
                  X: =Text_Requestor_80.X
                  Y: =Text_Requestor_80.Y + Text_Requestor_80.Height + Parent.Height/40
            - Dropdown_Requestor_80:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colFaculty, name = Index(colPurchase,1).requestor_name)
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Change_User_80.Height
                  Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                  OnChange: |-
                    =Patch(colPurchase, Index(colPurchase,1), 
                        {requestor_tour: Self.Selected.tour_id,
                        requestor_name: Self.Selected.name});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange: true})
                  Width: =Parent.Width/4 - Parent.Width*3/80
                  X: =Text_Requestor_80.X + Text_Requestor_80.Width
                  Y: =Text_Requestor_80.Y
                Children:
                  - name2:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="name"
                        FieldName: ="name"
                        FieldType: ="s"
                        Order: =1
                  - last_name3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="last_name"
                        FieldName: ="last_name"
                        FieldType: ="s"
                        Order: =2
                  - tour_id2:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="tour_id"
                        FieldName: ="tour_id"
                        FieldType: ="n"
                        Order: =3
            - Text_Requestor_80:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.View
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_80.Height
                  Size: =23
                  Text: ="Requestor:"
                  Width: =Parent.Width/12
                  X: =Parent.Width/40
                  Y: =Parent.Height/40
            - Rectangle_Disable_80:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Spinner_80.Visible ||
                        varShow10KWarning ||
                        varShowITWarning ||
                        varShowVendorWarning ||
                        varShowInvoiceWarning ||
                        varShowCancel ||
                        varGenerateMemo ||
                        Container_Add_Files_80.Visible,
                        true, false)
                  Width: =Parent.Width
            - Container_Add_Files_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.Bold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =varAddFiles
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Attachment_Control_Files_80:
                      Control: Attachments@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        Fill: =RGBA(0, 0, 0, 0.04)
                        Font: =Font.'Open Sans'
                        Height: =Parent.Height/4
                        HoverFill: =RGBA(186, 202, 226, 1)
                        ItemColor: =RGBA(255, 255, 255, 1)
                        ItemFill: =RGBA(56, 96, 178, 1)
                        ItemHoverFill: =RGBA(186, 202, 226, 1)
                        MaxAttachments: =1
                        NoAttachmentsText: ="Drag and drop 1 file at a time"
                        OnAddFile: "=If(\n    (Checkbox_Invoice_80.Value ||\n    Checkbox_GPC_80.Value ||\n    Checkbox_Other_80.Value),\n    \n    ForAll(\n    Attachment_Control_Files_80.Attachments As FILE, \n    If(\n        Not(IsNumeric(Find(\"pdf\", Lower(FILE.Name), Len(FILE.Name)-3))), \n        Reset(Self);\n        Notify(\"PLEASE ONLY UPLOAD .PDF FILES\",NotificationType.Error)));\n\n    UpdateContext({varShowSpinner: true});\n\n    'Math-PurchasesSendFile_V1'.Run(\n        {contentBytes:First(Attachment_Control_Files_80.Attachments).Value, name:First(Attachment_Control_Files_80.Attachments).Name}, \n        Index(colPurchase,1).purchase_cost_id, \n        Index(colPurchase,1).purpose, \n        LookUp(colFaculty, tour_id = Index(colPurchase,1).requestor_tour).wp_email, \n        If(\n            Checkbox_Invoice_80.Value, \n            \"Invoice\", \n            If(\n                Checkbox_GPC_80.Value, \n                \"GPC\", \n                \"Other\")), \n        Concat(colPermissionAdmin, wp_email, \"; \"),\n        If(\n            Month(Today()) < 10,\n            Year(Today()), \n            Year(Today()) + 1));\n                \n    Reset(Self);\n    Reset(Checkbox_Invoice_80);\n    Reset(Checkbox_GPC_80);\n    Reset(Checkbox_Other_80);\n\n    UpdateContext({varShowSpinner: false});\n    \n    Notify(\"FILE SUCCESSFULLY UPLOADED\", NotificationType.Success), \n\n    Notify(\"YOU MUST SELECT THE TYPE OF DOCUMENT YOU ARE UPLOADING\", NotificationType.Error);\n    Reset(Self))"
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(0, 18, 107, 1)
                        Width: =Parent.Width/2
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Checkbox_Invoice_80.Y + Checkbox_Invoice_80.Height + Parent.Height/10
                  - Button_Close_Add_Files_80:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varAddFiles: false});
                          Reset(Checkbox_Invoice_80);
                          Reset(Checkbox_GPC_80);
                          Reset(Checkbox_Other_80);
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Close"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Checkbox_Other_80:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Lighter
                        Height: =Text_Input_Change_User_80.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_Invoice_80);
                          Reset(Checkbox_GPC_80);
                        OnUncheck: =
                        Size: =10
                        Text: ="Other"
                        Width: =Parent.Width/5
                        X: =Parent.Width - Self.Width - Checkbox_Invoice_80.X
                        Y: =Checkbox_Invoice_80.Y
                  - Checkbox_GPC_80:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_Invoice_80);
                          Reset(Checkbox_Other_80);
                        OnUncheck: =
                        Size: =10
                        Text: ="Signed GPC"
                        Width: =Parent.Width/5
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Text_File_Type_80.Y + Text_File_Type_80.Height + Parent.Height/40
                  - Checkbox_Invoice_80:
                      Control: Classic/CheckBox@2.1.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        CheckboxBorderColor: =RGBA(0, 18, 107, 1)
                        CheckmarkFill: =RGBA(0, 0, 0, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HoverColor: =RGBA(0, 18, 107, 1)
                        OnCheck: |-
                          =Reset(Checkbox_GPC_80);
                          Reset(Checkbox_Other_80);
                        OnUncheck: =
                        Size: =10
                        Text: ="Invoice"
                        Width: =Parent.Width/5
                        X: =(Parent.Width - Self.Width*3)/4
                        Y: =Text_File_Type_80.Y + Text_File_Type_80.Height + Parent.Height/40
                  - Text_File_Type_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="What kind of file would you like to upload?"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/10
            - Container_Cancel_Request_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/4
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowCancel
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Keep_Request_80:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.tour_id = Index(colPurchase,1).requestor_tour,
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowCancel:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="No, Keep Request"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Request_81:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.tour_id = Index(colPurchase,1).requestor_tour,
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowSpinner:true});

                          Patch(purchase_costs, LookUp(purchase_costs, purchase_cost_id = Index(colPurchase,1).purchase_cost_id), 
                              {purchase_cost_status: "CANCELLED", 
                              updated_on: Today()});

                          Set(varPurchaseID, Blank());

                          UpdateContext({varPurchaseChange: Blank()});
                          UpdateContext({varItemChange: Blank()});
                          UpdateContext({varReadyToSubmit:Blank()});
                          UpdateContext({varShow10KWarning:Blank()});
                          UpdateContext({varShowITWarning:Blank()});
                          UpdateContext({varShowVendorWarning:Blank()});
                          UpdateContext({varShowInvoiceWarning:Blank()});
                          UpdateContext({varReadyToSubmit:Blank()});
                          UpdateContext({varShowCancel:Blank()});
                          UpdateContext({varGenerateMemo:false});

                          ClearCollect(colPurchase, 
                              {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()},
                              {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()});

                          Clear(colItems);
                          Clear(colPurchaseNotes);
                          Clear(colProjectPurchases);
                          Clear(colRemoveItems);
                          Clear(colRemovePurchaseNotes);
                          Clear(colRemoveProjectPurchases);

                          Refresh(purchase_cost_view);
                          Refresh(purchase_items); 
                          Refresh(purchase_notes_view); 
                          Refresh(project_purchases);

                          Reset(Gallery_Purchases_70);

                          UpdateContext({varShowSpinner:false});

                          If(
                              Not(IsBlank(varReturnScreen)), 
                              Navigate(varReturnScreen),
                              Navigate(Screen_Purchase_Overview_70))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Yes, Cancel Request"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Cancel_Warning_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/2
                        Size: =24
                        Text: |-
                          ="WARNING: You are about to cancel this request. This cannot be undone. Are you sure you want to cancel?"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Parent.Height/10
            - Container_Warning_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.Bold
                  Fill: =Color.LightGray
                  Height: =Parent.Height/3
                  Visible: =varShowVendorWarning || varShowITWarning || varShow10KWarning || varShowInvoiceWarning
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Button_Close_Warning_80:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |
                          =UpdateContext({varShowITWarning: false});
                          UpdateContext({varShowVendorWarning: false});
                          UpdateContext({varShow10KWarning: false});

                          If(
                              varShowInvoiceWarning,
                              UpdateContext({varShowSpinner:true});

                              'Math-PurchasesRequestFundsV1'.Run(
                                  Index(colPurchase,1).purchase_cost_id,
                                  Concat(colPermissionAdmin, wp_email, "; "));

                              Set(varPurchaseID, Blank());

                              UpdateContext({varPurchaseChange: Blank()});
                              UpdateContext({varItemChange: Blank()});
                              UpdateContext({varReadyToSubmit:Blank()});
                              UpdateContext({varShow10KWarning:Blank()});
                              UpdateContext({varShowITWarning:Blank()});
                              UpdateContext({varShowVendorWarning:Blank()});
                              UpdateContext({varShowInvoiceWarning:Blank()});
                              UpdateContext({varReadyToSubmit:Blank()});
                              UpdateContext({varShowCancel:Blank()});
                              UpdateContext({varGenerateMemo:false});

                              ClearCollect(colPurchase, 
                                  {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()},
                                  {purchase_cost_id: Blank(), cntrl_num: Blank(), budget_id: Blank(), invoice_num: Blank(), purpose: Blank(), vendor_name: Blank(), items_cost: Blank(), shipping_cost: Blank(), purchase_cost: Blank(), purchase_category: Blank(), purchase_type: Blank(), purchase_cost_status: Blank(), date_ordered: Blank(), certified_fund_date: Blank(), date_received: Blank(), gfebs_pr_num: Blank(), cardholder: Blank(), cardholder_name: Blank(), requestor_tour: Blank(), requestor_name: Blank(), recipient_tour: Blank(), recipient_name: Blank(), updated_on: Blank()});

                              Clear(colItems);
                              Clear(colPurchaseNotes);
                              Clear(colProjectPurchases);
                              Clear(colRemoveItems);
                              Clear(colRemovePurchaseNotes);
                              Clear(colRemoveProjectPurchases);

                              Refresh(purchase_cost_view);
                              Refresh(purchase_items); 
                              Refresh(purchase_notes_view); 
                              Refresh(project_purchases);

                              Reset(Gallery_Purchases_70);

                              UpdateContext({varShowSpinner:false});

                              If(
                                  Not(IsBlank(varReturnScreen)), 
                                  Navigate(varReturnScreen),
                                  Navigate(Screen_Purchase_Overview_70)))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="OK"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Text_Warning_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Button_Close_Warning_80.Y - Self.Y
                        Size: =23
                        Text: "=If(\n    varShowVendorWarning,\n    \"Please ensure that the vendor you chose is 889 compliant before going further with your request. Please see admin staff for assistance.\",\n    If(\n        varShowITWarning,\n        \"Purchasing IT or software requires special approval. Please see admin staff for further assistance.\",\n        \n        If(\n            varShow10KWarning,\n            \"Purchasing more than $10,000 of supplies requires a special process and approval. Please continue your request in the app. Once submitted, see admin staff for further assistance.\",\n            If(\n                varShowInvoiceWarning,\n                \"Before your request will get approved, you must submit an invoice or estimate\")\n            )))"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Parent.Height/10
            - Spinner_80:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
            - Container_Generate_Memo_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =varGenerateMemo
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Button_Generate_Memo_80:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\n    Not(IsBlank(Text_Input_Description_80.Text)), \n\n    UpdateContext({varShowSpinner:true});\n\n    'Math-PurchasesGenerateMemo_V1'.Run(\n        Index(colPurchase,1).requestor_name, \n        LookUp(colFaculty, tour_id = Index(colPurchase,1).requestor_tour).office_phone, \n        Upper(Text_Input_Description_80.Text), \n        Abs(Index(colPurchase,1).items_cost), \n        Abs(Index(colPurchase,1).shipping_cost), \n        LookUp(colBudgets, budget_id = Index(colPurchase,1).budget_id).wbs_cost_center, \n        Abs(Index(colPurchase,1).purchase_cost), \n        Index(colPurchase,1).vendor_name, \n        Index(colPurchase,1).purpose, \n        Concatenate(\n            LookUp(colFaculty, tour_id = LookUp(colBudgets, budget_id = Index(colPurchase,1).budget_id).director_tour).name, \"/\", LookUp(colBudgets, budget_id = Index(colPurchase,1).budget_id).center_abbrev, \" DIRECTOR\"), \n        Concatenate(\n            LookUp(colFaculty, dept_pos = \"XO\").name, \"/ BILLING OFFICIAL\"), \n        Index(colPurchase,1).purchase_type, \n        Index(colPurchase,1).purchase_cost_id, \n        Concatenate(LookUp(colFaculty, tour_id = Index(colPurchase,1).requestor_tour).wp_email, \"; \", varUser.wp_email));\n\n    UpdateContext({varShowSpinner: false});UpdateContext({varGenerateMemo: false});\n    Reset(Text_Input_Description_80);\n    \n    Notify(\"Form successfully generated. Please allow a few minutes to receive it via email\", NotificationType.Success),\n\n    Notify(\"PLEASE FILL OUT THE PURCHASE DESCRIPTION\", NotificationType.Error));\n\n"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Generate GPC Form"
                        Width: =Button_Cancel_Generate_Memo_80.Width
                        X: =Parent.Width/5 + Button_Cancel_Generate_Memo_80.X + Button_Cancel_Generate_Memo_80.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Button_Cancel_Generate_Memo_80:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Text_Input_Description_80);
                          UpdateContext({varShowSpinner: false});
                          UpdateContext({varGenerateMemo: false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Parent.Width/5
                        X: =Parent.Width/5
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Text_Input_Description_80:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_80.Height
                        HintText: ="Ex. Office supplies, tools, etc."
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width*19/20
                        X: =Parent.Width/40
                        Y: =Text_Description_80.Y + Text_Description_80.Height + Parent.Height/20
                  - Text_Description_80:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_80.Height
                        Size: =23
                        Text: ="Please provide a one line description of the items you would like to purchase"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/10
            - Container_Disburse_80:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Container_Traveler_Details_60.Height
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varDisburse
                  Width: =Container_Travelers_60.Width
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Disburse_Details_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=Patch(colTravelers, LookUp(colTravelers, travel_id = varTraveler.travel_id),\r\n    {voucher_submitted_on: Date_Picker_Voucher_Submitted_61.SelectedDate, \r\n    voucher_approved_on: Date_Picker_Voucher_Approved_61.SelectedDate, \r\n    travel_cost_disbursed: -Abs(Value(Text_Input_Disbursed_Cost_61.Text))});\r\n        \r\nSet(varTraveler, Patch(varTraveler, \r\n    {voucher_submitted_on: Date_Picker_Voucher_Submitted_61.SelectedDate, \r\n    voucher_approved_on: Date_Picker_Voucher_Approved_61.SelectedDate, \r\n    travel_cost_disbursed: -Abs(Value(Text_Input_Disbursed_Cost_61.Text))}));\r\n\r\nUpdateContext({varDisburse:false});\r\nUpdateContext({varReadyToSubmit:false});"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save Changes"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Disburse_Details_61:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_New_Cadet_Traveler_Search_60.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varResetDisbursed:true});
                          UpdateContext({varResetDisbursed:false});
                          UpdateContext({varDisburse:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Input_Disbursed_Cost_61:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Abs(varTraveler.travel_cost_disbursed)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Traveler_Name_62.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =varResetDisbursed
                        Width: =Date_Picker_Voucher_Submitted_61.Width
                        X: =Date_Picker_Voucher_Approved_61.X
                        Y: =Text_Amount_Disbursed_61.Y
                  - Text_Amount_Disbursed_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_62.Height
                        Size: =23
                        Text: ="Travel Amount Disbursed:"
                        Width: =Parent.Width/2.5
                        X: =Text_Traveler_Name_62.X
                        Y: =Text_Voucher_Approved_61.Y + Text_Voucher_Approved_61.Height + Parent.Height/20
                  - Date_Picker_Voucher_Approved_61:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Traveler_Name_62.Height
                        OnChange: =
                        SelectedDate: =varTraveler.voucher_approved_on
                        StartDate: =Date_Picker_Voucher_Submitted_61.SelectedDate
                        Width: =Date_Picker_Voucher_Submitted_61.Width
                        X: =Text_Voucher_Submitted_61.X + Text_Voucher_Submitted_61.Width
                        Y: =Text_Voucher_Approved_61.Y
                  - Text_Voucher_Approved_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_62.Height
                        Size: =23
                        Text: ="Voucher Approved On:"
                        Width: =Parent.Width/2.5
                        X: =Text_Traveler_Name_62.X
                        Y: =Text_Voucher_Submitted_61.Y + Text_Voucher_Submitted_61.Height + Parent.Height/20
                  - Date_Picker_Voucher_Submitted_61:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Traveler_Name_62.Height
                        OnChange: =
                        SelectedDate: =varTraveler.voucher_submitted_on
                        Width: =Parent.Width/4
                        X: =Text_Voucher_Submitted_61.X + Text_Voucher_Submitted_61.Width
                        Y: =Text_Voucher_Submitted_61.Y
                  - Text_Voucher_Submitted_61:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Traveler_Name_62.Height
                        Size: =23
                        Text: ="Voucher Submitted On:"
                        Width: =Parent.Width/2.5
                        X: =Text_Traveler_Name_62.X
                        Y: =Text_Traveler_Name_62.Y + Text_Traveler_Name_62.Height + Parent.Height/10
                  - Text_Input_travel_cost_id_63:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.travel_id
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_62.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Text_Input_Traveler_Name_62.Width
                        X: =Text_travel_cost_id_63.X + Text_travel_cost_id_63.Width
                        Y: =Text_travel_cost_id_63.Y
                  - Text_travel_cost_id_63:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Travel ID"
                        Width: =Parent.Width/5
                        X: =Text_Input_Traveler_Name_62.X + Text_Input_Traveler_Name_62.Width + Parent.Width/40
                        Y: =Text_Traveler_Name_62.Y
                  - Text_Input_Traveler_Name_62:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varTraveler.traveler_name
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Traveler_Name_62.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                              Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                              Reset(Self);
                              Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width/2 - Self.X - Parent.Width/80
                        X: =Text_Traveler_Name_62.X + Text_Traveler_Name_62.Width
                        Y: =Text_Traveler_Name_62.Y
                  - Text_Traveler_Name_62:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_60.Height
                        Size: =23
                        Text: ="Traveler"
                        Width: =Parent.Width/5
                        X: =Parent.Width/40
                        Y: =Text_Disburse_Travel_61.Y + Text_Disburse_Travel_61.Height + Parent.Height/50
                  - Text_Disburse_Travel_61:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/12
                        Size: =24
                        Text: ="Disburse Travel"
                        Width: =Parent.Width
      - Container_Header_Purchase_Details_80:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Purchase_Details_80:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Purchase Details"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_80:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_80:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40







// Screen_Salary_Overview_90

Screens:
  Screen_Salary_Overview_90:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Salary_Overview_90:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Salary_Header_90.Height
            Width: =Parent.Width
            Y: =Container_Salary_Header_90.Height
          Children:
            - Button_Edit_Salary_90:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=Set(varFacSalary, \r\n    {tour_id: Gallery_Salary_90.Selected.tour_id, \r\n    last_name: Gallery_Salary_90.Selected.last_name, \r\n    first_name: Gallery_Salary_90.Selected.first_name, \r\n    salary_id: Gallery_Salary_90.Selected.salary_id,\r\n    fy: Gallery_Salary_90.Selected.fy});\r\n\r\nIf(\r\n    Gallery_Salary_90.Selected.salary_type = \"BASE\", \r\n    \r\n    ClearCollect(colSalaryCost, \r\n        Sort(ShowColumns(Filter(salary_costs_view, tour_id = varFacSalary.tour_id, last_name = varFacSalary.last_name, first_name = varFacSalary.first_name, salary_type = \"BASE\"), salary_id, fy, budget_id, budget_name, cntrl_num, tour_id, last_name, first_name, step, projected_salary, disbursed_salary, salary_complete, salary_start_date, salary_end_date, updated_on), salary_start_date, SortOrder.Ascending));\r\n\r\n    ClearCollect(colPayPeriodCosts, \r\n        ShowColumns(Filter(pay_period_cost_view, tour_id = varFacSalary.tour_id, last_name = varFacSalary.last_name, first_name = varFacSalary.first_name), pay_period_cost_id, fy, salary_id, pay_period_id, budget_id, tour_id, last_name, first_name, pay_period, start_date, end_date, projected_amount, disbursed_amount));\r\n\r\n    ClearCollect(colPayPeriods, \r\n        ShowColumns(FirstN(Sort(pay_period_view, start_date, SortOrder.Descending),108), pay_period_id, fy, pay_period, start_date, end_date));\r\n\r\n    ClearCollect(colSalaryNotes, \r\n    ShowColumns(Filter(salary_notes_view, fac_tour = varFacSalary.tour_id, fac_last_name = varFacSalary.last_name, fac_first_name = varFacSalary.first_name), salary_note_id, salary_cost_id, notes, fac_tour, fac_last_name, fac_first_name, created_tour, created_name, updated_on));\r\n\r\n    Navigate(Screen_Base_Salary_Details_100),\r\n    \r\n    ClearCollect(colAddSalary, \r\n        ShowColumns(Filter(add_salary_view, salary_id = varFacSalary.salary_id), salary_id, budget_id, budget_name, cntrl_num, tour_id, projected_salary, disbursed_salary, salary_start_date, step, updated_on));\r\n\r\n    Set(varShowAddSalary, true))"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Edit Salary"
                  Width: =Parent.Width/11
                  X: =Gallery_Salary_90.X + Gallery_Salary_90.Width - Self.Width
                  Y: =Text_Input_Faculty_Search_90.Y
            - Button_New_Salary_90:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: =UpdateContext({varNewFacSalary:true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="New Fac"
                  Tooltip: ="Click here if the person you need to add salary for isn't in this list"
                  Width: =Parent.Width/11
                  X: =Button_Edit_Salary_90.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Faculty_Search_90.Y
            - Button_Home_90:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: =Navigate(Screen_Welcome_Add_Access_110)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Home"
                  Width: =Parent.Width/11
                  X: =Button_New_Salary_90.X - Self.Width - Parent.Width/50
                  Y: =Text_Input_Faculty_Search_90.Y
            - Text_Input_Cntrl_Num_Search_90:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HintText: ="Search Control Num"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Faculty_Search_90);
                    Reset(Text_Input_Budget_Search_90);
                    Reset(Text_Input_ID_Search_90);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Salary_90.Width/8
                  X: =Text_Input_Budget_Search_90.X + Text_Input_Budget_Search_90.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Cntrl_Num_Search_90:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Faculty_Search_90.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Cntrl_Num_Search_90);

                    Reset(Gallery_Salary_90)
                  Width: =Self.Height
                  X: =Text_Input_Cntrl_Num_Search_90.X + Text_Input_Cntrl_Num_Search_90.Width - Self.Width
                  Y: =Text_Input_Faculty_Search_90.Y + Text_Input_Faculty_Search_90.Height/8
            - Text_Input_Budget_Search_90:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HintText: ="Search Budget"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Faculty_Search_90);
                    Reset(Text_Input_ID_Search_90);
                    Reset(Text_Input_Cntrl_Num_Search_90);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Salary_90.Width/8
                  X: =Text_Input_Faculty_Search_90.X + Text_Input_Faculty_Search_90.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Budget_Search_90:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Faculty_Search_90.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Budget_Search_90);

                    Reset(Gallery_Salary_90)
                  Width: =Self.Height
                  X: =Text_Input_Budget_Search_90.X + Text_Input_Budget_Search_90.Width - Self.Width
                  Y: =Text_Input_Faculty_Search_90.Y + Text_Input_Faculty_Search_90.Height/8
            - Text_Input_Faculty_Search_90:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HintText: ="Search Faculty"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_ID_Search_90);
                    Reset(Text_Input_Budget_Search_90);
                    Reset(Text_Input_Cntrl_Num_Search_90);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Salary_90.Width/8
                  X: =Text_Input_ID_Search_90.X + Text_Input_ID_Search_90.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_Faculty_Search_90:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Faculty_Search_90.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_Faculty_Search_90);

                    Reset(Gallery_Salary_90)
                  Width: =Self.Height
                  X: =Text_Input_Faculty_Search_90.X + Text_Input_Faculty_Search_90.Width - Self.Width
                  Y: =Text_Input_Faculty_Search_90.Y + Text_Input_Faculty_Search_90.Height/8
            - Text_Input_ID_Search_90:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =0
                  Default: =""
                  Fill: =RGBA(177, 179, 179, 1)
                  Font: =Font.'Open Sans'
                  Format: =TextFormat.Number
                  Height: =Parent.Height/22
                  HintText: ="Search Salary ID"
                  HoverBorderColor: =
                  HoverFill: =RGBA(186, 202, 226, 1)
                  OnChange: |-
                    =Reset(Text_Input_Faculty_Search_90);
                    Reset(Text_Input_Budget_Search_90);
                    Reset(Text_Input_Cntrl_Num_Search_90);
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Gallery_Salary_90.Width/8
                  X: =Gallery_Salary_90.X
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Icon_Cancel_ID_Search_90:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(156, 156, 156, 1)
                  Height: =Text_Input_Faculty_Search_90.Height*3/4
                  Icon: =Icon.Cancel
                  OnSelect: |-
                    =Reset(Text_Input_ID_Search_90);

                    Reset(Gallery_Salary_90)
                  Width: =Self.Height
                  X: =Text_Input_ID_Search_90.X + Text_Input_ID_Search_90.Width - Self.Width
                  Y: =Text_Input_Faculty_Search_90.Y + Text_Input_Faculty_Search_90.Height/8
            - Gallery_Salary_90:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =1
                  Height: =Text_Input_Faculty_Search_90.Y - Text_Name_90.Y - Text_Name_90.Height - Parent.Height/40
                  Items: |-
                    =If(
                        Not(IsBlank(Text_Input_ID_Search_90.Text)), 
                        Sort(
                            Filter(salary_costs_view, Value(Text_Input_ID_Search_90.Text) = salary_id),
                            last_name, SortOrder.Ascending),

                        If(
                            Not(IsBlank(Text_Input_Faculty_Search_90.Text)),
                            Sort(
                                Filter(salary_costs_view, Text_Input_Faculty_Search_90.Text in name),
                                last_name, SortOrder.Ascending),
                            If(
                                Not(IsBlank(Text_Input_Budget_Search_90.Text)),
                                Sort(
                                    Filter(salary_costs_view, Text_Input_Budget_Search_90.Text in budget_name), 
                                    last_name, SortOrder.Ascending),
                                If(
                                    Not(IsBlank(Text_Input_Cntrl_Num_Search_90.Text)), 
                                    Sort(
                                        Filter(salary_costs_view, Text_Input_Cntrl_Num_Search_90.Text in cntrl_num), 
                                        last_name, SortOrder.Ascending), 
                                Sort(salary_costs_view, last_name, SortOrder.Ascending)))))
                  TemplateFill: |-
                    =If(
                        ThisItem.salary_complete = "NO", 
                        If(
                            ThisItem.IsSelected, 
                            Color.Yellow, 
                            ColorFade(Color.Yellow, .6)),  
                            If(
                                ThisItem.IsSelected, 
                                Color.LightGreen, 
                                ColorFade(Color.LightGreen, .6)))
                  TemplateSize: =60
                  Width: =Parent.Width*19/20
                  X: =(Parent.Width - Self.Width)/2
                  Y: =Text_Name_90.Y + Text_Name_90.Height
                Children:
                  - Text_Complete_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.salary_complete
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Cost_90.Width
                        X: =Text_Complete_90.X - Gallery_Salary_90.X
                  - Text_Cost_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: |-
                          =If(
                              ThisItem.salary_complete = "NO", 
                                  Concatenate("$", Abs(ThisItem.projected_salary)),
                                  Concatenate("$", Abs(ThisItem.disbursed_salary)))
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Cost_90.Width
                        X: =Text_Cost_90.X - Gallery_Salary_90.X
                  - Text_Salary_End_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.salary_end_date
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Salary_End_90.Width
                        X: =Text_Salary_End_90.X - Gallery_Salary_90.X
                  - Text_Salary_Start_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.salary_start_date
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Salary_Start_90.Width
                        X: =Text_Salary_Start_90.X - Gallery_Salary_90.X
                  - Text_Cntrl_Num_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.cntrl_num
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Cntrl_Num_90.Width
                        X: =Text_Cntrl_Num_90.X - Gallery_Salary_90.X
                  - Text_Budget_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: =ThisItem.budget_name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_90.Width
                        X: =Text_Budget_90.X - Gallery_Salary_90.X
                  - Text_Step_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: |
                          =ThisItem.salary_type
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Step_90.Width
                        Wrap: =false
                        X: =Text_Step_90.X - Gallery_Salary_90.X
                  - Text_Name_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        Size: =18
                        Text: |
                          =ThisItem.name
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Name_90.Width
                        Wrap: =false
                        X: =Text_Name_90.X - Gallery_Salary_90.X
                  - Text_Salary_ID_91:
                      Control: Text@0.0.51
                      Properties:
                        Height: =Parent.TemplateHeight
                        PaddingLeft: =10
                        Size: =18
                        Text: =ThisItem.salary_id
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Salary_ID_90.Width
                        Wrap: =false
                  - Separator_Gallery_Salary_90:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Text_Complete_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Complete"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width + Gallery_Salary_90.X - Self.X
                  X: =Text_Cost_90.X + Text_Cost_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Cost_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Cost"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/10
                  X: =Text_Salary_End_90.X + Text_Salary_End_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Salary_End_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Salary End"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/12
                  X: =Text_Salary_Start_90.X + Text_Salary_Start_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Salary_Start_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Salary Start"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/12
                  X: =Text_Cntrl_Num_90.X + Text_Cntrl_Num_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Cntrl_Num_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Control Num"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/8
                  X: =Text_Budget_90.X + Text_Budget_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Budget_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Budget"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/8
                  X: =Text_Step_90.X + Text_Step_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Step_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Salary Type"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/12
                  X: =Text_Name_90.X + Text_Name_90.Width + 10
                  Y: =Text_Name_90.Y
            - Text_Name_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Name"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/5
                  X: =Gallery_Salary_90.X + Text_Salary_ID_90.Width + 10
                  Y: =Parent.Height/40
            - Text_Salary_ID_90:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height/22
                  Size: =18
                  Text: ="Salary ID"
                  VerticalAlign: =VerticalAlign.Middle
                  Width: =Gallery_Salary_90.Width/15
                  X: =Gallery_Salary_90.X
                  Y: =Parent.Height/40
            - Rectangle_Disable_90:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Spinner_90.Visible ||
                        varShowAddSalary ||
                        varNewFacSalary,
                        true, false)
                  Width: =Parent.Width
            - Container_New_Fac_Salary_90:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowAddSalary
                  Width: =Parent.Width/2
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Add_Salary_90:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: =If(varReadyToSubmit, DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowSpinner: true});

                          If(
                              IsBlank(Index(colAddSalary,1).salary_id), 

                              // PATCH IN NEW ADDITIONAL SALARY TO ADD_SALARY_COSTS
                              Patch(add_salary_costs, Defaults(add_salary_costs), 
                                  {budget_id: Index(colAddSalary,1).budget_id, 
                                  cntrl_num: Index(colAddSalary,1).cntrl_num, 
                                  tour_id: Index(colAddSalary,1).tour_id, 
                                  projected_amount: Index(colAddSalary,1).projected_salary, 
                                  disbursed_amount: Index(colAddSalary,1).disbursed_salary, 
                                  spend_date: Index(colAddSalary,1).salary_start_date, 
                                  purpose: Index(colAddSalary,1).step, 
                                  updated_on: Today()}), 

                              // PATCH IN UPDATES TO EXISTING ADDITIONAL SALARY TO ADD_SALARY_COSTS
                              Patch(add_salary_costs, LookUp(add_salary_costs, add_salary_id = Index(colAddSalary,1).salary_id), 
                                  {budget_id: Index(colAddSalary,1).budget_id, 
                                  cntrl_num: Index(colAddSalary,1).cntrl_num, 
                                  tour_id: Index(colAddSalary,1).tour_id, 
                                  projected_amount: Index(colAddSalary,1).projected_salary, 
                                  disbursed_amount: Index(colAddSalary,1).disbursed_salary, 
                                  spend_date: Index(colAddSalary,1).salary_start_date, 
                                  purpose: Index(colAddSalary,1).step, 
                                  updated_on: Today()}));

                          ClearCollect(colAddSalary, 
                                  {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

                          Refresh(salary_costs_view);

                          Set(varFacSalary, Blank());

                          Set(varShowAddSalary,false);
                          UpdateContext({varReadyToSubmit:Blank()});

                          Reset(Gallery_Salary_90);

                          If(
                              Not(IsBlank(varReturnScreen)), 

                              Set(varFacSalary, Blank());

                              UpdateContext({varSalaryCostChange: Blank()});
                              UpdateContext({varSalaryNoteChange: Blank()});
                              UpdateContext({varAddNotes:Blank()});
                              UpdateContext({varAddPayPeriods:Blank()});
                              UpdateContext({varPayPeriodChange:Blank()});
                              UpdateContext({varReadyToSubmit:Blank()});
                              UpdateContext({varShowSpinner:false});
                              UpdateContext({varControlNum:Blank()});

                              ClearCollect(colSalaryCost, 
                                      {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});

                              ClearCollect(colAddSalary, 
                                      {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

                              Clear(colSalaryNotes);
                              Clear(colNewPayPeriods);
                              Clear(colPayPeriodCosts);
                              Clear(colPayPeriods);
                              Clear(colRemoveSalaryCost);
                              Clear(colRemoveSalaryNotes);

                              Refresh(pay_period_cost_view);
                              Refresh(salary_notes_view);
                              Refresh(salary_costs_view);

                              Navigate(varReturnScreen));

                          UpdateContext({varShowSpinner: false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Check_Add_Salary_90:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              IsBlank(varReadyToSubmit), 
                              DisplayMode.Disabled, 
                              If(
                                  Not(varReadyToSubmit), 
                                  DisplayMode.Edit, 
                                  DisplayMode.Disabled))
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              Not(IsBlank(Index(colAddSalary,1).tour_id)) &&
                              Not(IsBlank(Index(colAddSalary,1).step)), 

                              UpdateContext({varReadyToSubmit:true});
                              Notify("CLICK SAVE TO SUBMIT CHANGES", NotificationType.Success), 

                              UpdateContext({varReadyToSubmit:false});
                              Notify("PLEASE ENSURE YOU HAVE SELECTED A PERSON AND REASON", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Check"
                        Width: =Self.Height*3
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Add_Salary_90:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\r\n    IsBlank(varReturnScreen),\r\n    \r\n    Refresh(salary_costs_view);\r\n    ClearCollect(colAddSalary, \r\n            {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});\r\n\r\n    Set(varFacSalary, Blank());\r\n    Reset(Gallery_Salary_90);\r\n    Set(varShowAddSalary,false);\r\n    UpdateContext({varReadyToSubmit:Blank()}),\r\n\r\n\r\n    Set(varFacSalary, Blank());\r\n    UpdateContext({varSalaryCostChange: Blank()});\r\n    UpdateContext({varSalaryNoteChange: Blank()});\r\n    UpdateContext({varAddNotes:Blank()});\r\n    UpdateContext({varAddPayPeriods:Blank()});\r\n    UpdateContext({varPayPeriodChange:Blank()});\r\n    UpdateContext({varReadyToSubmit:Blank()});\r\n    UpdateContext({varShowSpinner:false});\r\n    UpdateContext({varControlNum:Blank()});\r\n\r\n    ClearCollect(colSalaryCost, \r\n        {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});\r\n\r\n    ClearCollect(colAddSalary, \r\n        {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});\r\n\r\n    Clear(colSalaryNotes);\r\n    Clear(colNewPayPeriods);\r\n    Clear(colPayPeriodCosts);\r\n    Clear(colPayPeriods);\r\n    Clear(colRemoveSalaryCost);\r\n    Clear(colRemoveSalaryNotes);\r\n\r\n    Refresh(pay_period_cost_view);\r\n    Refresh(salary_notes_view);\r\n    Refresh(salary_costs_view);\r\n\r\n    Navigate(varReturnScreen))"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Date_Picker_Spend_Date_90:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_90.Height
                        OnChange: |-
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {salary_start_date: Self.SelectedDate});

                          UpdateContext({varReadyToSubmit: false})
                        SelectedDate: =Index(colAddSalary,1).salary_start_date
                        Width: =Text_Input_Projected_90.Width
                        X: =Text_Spend_Date_90.X + Text_Spend_Date_90.Width
                        Y: =Text_Spend_Date_90.Y
                  - Text_Spend_Date_90:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_92.Height
                        Size: =20
                        Text: ="Spend Date:"
                        Width: =Text_Name_92.Width*1.5
                        X: =(Parent.Width - Self.Width - Date_Picker_Spend_Date_90.Width)/2
                        Y: =Text_Projected_90.Y + Text_Projected_90.Height + Parent.Height/40
                  - Text_Input_Disbursed_90:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =Concatenate("$", Abs(Index(colAddSalary,1).disbursed_salary))
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {disbursed_salary: -Abs(Self.Text)});

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =
                        Width: =Text_Input_Cntrl_Num_92.Width
                        X: |-
                          =//Text_New_Org_Abbrev_40.X + Text_New_Org_Abbrev_40.Width
                          Text_Input_Cntrl_Num_92.X
                        Y: =Text_Disbursed_90.Y
                  - Text_Disbursed_90:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_92.Height
                        Size: =20
                        Text: ="Disbursed:"
                        Width: =Text_Name_92.Width
                        X: |-
                          =//Text_New_Org_Name_40.X
                          Text_Cntrl_Num_92.X
                        Y: =Text_Budget_92.Y + Text_Budget_92.Height + Parent.Height/40
                  - Text_Input_Projected_90:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =Concatenate("$", Abs(Index(colAddSalary,1).projected_salary))
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {projected_salary: -Abs(Self.Text)});

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =
                        Width: =Dropdown_Budget_90.Width
                        X: =Dropdown_Budget_90.X
                        Y: =Text_Projected_90.Y
                  - Text_Projected_90:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_92.Height
                        Size: =20
                        Text: ="Projected:"
                        Width: =Text_Name_92.Width
                        X: =Text_Budget_92.X
                        Y: =Text_Budget_92.Y + Text_Budget_92.Height + Parent.Height/40
                  - Text_Input_Cntrl_Num_92:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        Default: =Index(colAddSalary,1).cntrl_num
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {cntrl_num: Upper(Self.Text)});

                          UpdateContext({varReadyToSubmit: false})
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =
                        Width: =Text_Input_Purpose_90.Width/2.5
                        X: =Text_Cntrl_Num_92.X + Text_Cntrl_Num_92.Width
                        Y: =Text_Cntrl_Num_92.Y
                  - Text_Cntrl_Num_92:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_92.Height
                        Size: =20
                        Text: |-
                          ="CNTRL #"
                        Width: =Text_Budget_92.Width
                        X: =Dropdown_Budget_90.X + Dropdown_Budget_90.Width + Parent.Width/40
                        Y: =Text_Budget_92.Y
                  - Dropdown_Budget_90:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colBudgets, budget_id = Index(colAddSalary,1).budget_id)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Name_92.Height
                        Items: =colBudgets
                        OnChange: |
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {budget_id: Self.Selected.budget_id});
                          UpdateContext({varReadyToSubmit:false});
                        Width: =Text_Input_Purpose_90.Width/2.5
                        X: =Text_Input_Purpose_90.X
                        Y: =Text_Budget_92.Y
                      Children:
                        - budget_name4:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_name"
                              FieldName: ="budget_name"
                              FieldType: ="s"
                              Order: =1
                        - budget_id4:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_id"
                              FieldName: ="budget_id"
                              FieldType: ="n"
                              Order: =2
                  - Text_Budget_92:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_92.Height
                        Size: =20
                        Text: ="Budget"
                        Width: =Text_Name_92.Width
                        X: =Text_Purpose_90.X
                        Y: =Text_Purpose_90.Y + Text_Purpose_90.Height + Parent.Height/40
                  - Text_Input_Purpose_90:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Index(colAddSalary,1).step
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_92.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {step: Upper(Self.Text)});
                          UpdateContext({varReadyToSubmit:false});
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_Purpose_90.X + Text_Purpose_90.Width
                        Y: =Text_Purpose_90.Y
                  - Text_Purpose_90:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_92.Height
                        Size: =20
                        Text: ="Purpose:"
                        Width: =Text_Name_92.Width
                        X: =Parent.Width/40
                        Y: =Text_Name_92.Y + Text_Name_92.Height + Parent.Height/40
                  - Dropdown_Name_92:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colFaculty, tour_id = varFacSalary.tour_id)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Name_92.Height
                        Items: =colFaculty
                        OnChange: |
                          =Patch(colAddSalary, Index(colAddSalary,1), 
                              {tour_id: Self.Selected.tour_id});
                          UpdateContext({varReadyToSubmit:false});
                        Width: =Parent.Width/2.5
                        X: =Text_Name_92.X + Text_Name_92.Width
                        Y: =Text_Name_92.Y
                      Children:
                        - name3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="name"
                              FieldName: ="name"
                              FieldType: ="s"
                              Order: =1
                        - tour_id3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="tour_id"
                              FieldName: ="tour_id"
                              FieldType: ="n"
                              Order: =2
                  - Text_Name_92:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Add_Salary_90.Height
                        Size: =20
                        Text: ="Faculty:"
                        Width: =Text_Add_Salary_90.Width/7
                        X: =(Parent.Width - Self.Width - Dropdown_Name_92.Width)/2
                        Y: =Text_Add_Salary_90.Y + Text_Add_Salary_90.Height + Parent.Height/20
                  - Text_Add_Salary_90:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Salary_ID_90.Height
                        Size: =22
                        Text: ="Additional Salary Details"
                        Width: =Parent.Width
                        Y: =Parent.Height/40
            - Container_New_Fac_90:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varNewFacSalary
                  Width: =Parent.Width/2
                  X: '=Parent.Width/2 - Self.Width/2 '
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_New_Salary_91:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              (Not(IsBlank(Dropdown_Name_90.Selected.tour_id)) ||

                              (Not(IsBlank(Text_Input_Last_Name_90.Text)) && 
                              Not(IsBlank(Text_Input_First_Name_90.Text)))) && 
                              Not(IsBlank(Dropdown_FY_90.Selected.Value)), 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_93.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\n    Radio_Existing_Fac_90.Selected.answer = \"YES\", \n\n    Set(varFacSalary, \n        {tour_id: Dropdown_Name_90.Selected.tour_id, \n        last_name: Dropdown_Name_90.Selected.last_name,\n        first_name: Dropdown_Name_90.Selected.first_name,\n        salary_id: Blank(), \n        fy: Dropdown_FY_90.Selected.Value}), \n\n    Set(varFacSalary, \n        {tour_id: Blank(), \n        last_name: Upper(Text_Input_Last_Name_90.Text),\n        first_name: Upper(Text_Input_First_Name_90.Text),\n        salary_id: Blank(), \n        fy: Dropdown_FY_90.Selected.Value}));\n\nClearCollect(colPayPeriods, \n    ShowColumns(FirstN(Sort(pay_period_view, start_date, SortOrder.Descending),108), pay_period_id, fy, pay_period, start_date, end_date));\nUpdateContext({varNewFacSalary:false});\nReset(Dropdown_Name_90);\nReset(Text_Input_Last_Name_90);\nReset(Text_Input_First_Name_90);\nReset(Dropdown_FY_90);\n\nClearCollect(colSalaryCost, \n    {budget_id: Blank(), \n    budget_name: Blank(), \n    cntrl_num: Blank(),  \n    disbursed_salary: Blank(), \n    projected_salary: Blank(), \n    first_name: varFacSalary.first_name, \n    last_name: varFacSalary.last_name, \n    fy: varFacSalary.fy, \n    tour_id: varFacSalary.tour_id, \n    salary_complete: \"NO\", \n    salary_start_date: Blank(), \n    salary_end_date: Blank(), \n    step: Blank(), \n    salary_id: Blank(),\n    new_salary_num: Max(colSalaryCost, new_salary_num) + 1});\n\nForAll(\n    Filter(colPayPeriods, fy = varFacSalary.fy) As period, \n    \n    Collect(colPayPeriodCosts, \n        {budget_id: Blank(),  \n        disbursed_amount: Blank(), \n        projected_amount: Blank(), \n        start_date: period.start_date,\n        end_date: period.end_date, \n        first_name: varFacSalary.first_name, \n        fy: varFacSalary.fy, \n        last_name: varFacSalary.last_name, \n        tour_id: varFacSalary.tour_id,\n        pay_period: period.pay_period, \n        pay_period_cost_id: Blank(), \n        pay_period_id: period.pay_period_id, \n        salary_id: Blank(), \n        new_salary_num: Max(colSalaryCost, new_salary_num), \n        new_pay_period_cost_num: Max(colPayPeriodCosts, new_pay_period_cost_num) + 1})); \n\nNavigate(Screen_Base_Salary_Details_100)"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Create"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_New_Salary_90:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_93.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Dropdown_Name_90);
                          Reset(Text_Input_Last_Name_90);
                          Reset(Text_Input_First_Name_90);
                          Reset(Dropdown_FY_90);
                          UpdateContext({varNewFacSalary:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Dropdown_FY_90:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colBudgets, budget_id = Index(colAddSalary,1).budget_id)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Name_93.Height
                        Items: =Sort(Distinct(salary_costs_view, fy), Value, SortOrder.Ascending)
                        OnChange: =
                        Width: =Parent.Width/5
                        X: =Text_FY_90.X + Text_FY_90.Width
                        Y: =Text_FY_90.Y
                      Children:
                        - Value3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="Value"
                              FieldName: ="Value"
                              FieldType: ="n"
                              Order: =1
                  - Text_FY_90:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_93.Height
                        Size: =20
                        Text: ="Please select an FY"
                        Width: =Parent.Width/3
                        X: =Parent.Width/40
                        Y: =Text_Name_93.Y + Text_Name_93.Height + Parent.Height/40 + 100
                  - Text_Input_First_Name_90:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Index(colAddSalary,1).step
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_93.Height
                        HintText: ="First Name"
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =
                        Visible: |-
                          =If(
                              Radio_Existing_Fac_90.Selected.answer = "YES", 
                              false, true)
                        Width: =Text_Input_Last_Name_90.Width
                        X: =Text_Input_Last_Name_90.X + Text_Input_Last_Name_90.Width + Parent.Width/40
                        Y: =Text_Name_94.Y + Text_Name_94.Height + Parent.Height/40
                  - Text_Input_Last_Name_90:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =Index(colAddSalary,1).step
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Name_93.Height
                        HintText: ="Last Name"
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Reset: =
                        Visible: |-
                          =If(
                              Radio_Existing_Fac_90.Selected.answer = "YES", 
                              false, true)
                        Width: =Parent.Width*37/80
                        X: =Parent.Width/40
                        Y: =Text_Name_94.Y + Text_Name_94.Height + Parent.Height/40
                  - Dropdown_Name_90:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colBudgets, budget_id = Index(colAddSalary,1).budget_id)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Name_93.Height
                        Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                        OnChange: =
                        Visible: =Not(Text_Input_First_Name_90.Visible)
                        Width: =Parent.Width/2.5
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Text_Input_First_Name_90.Y
                      Children:
                        - name5:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="name"
                              FieldName: ="name"
                              FieldType: ="s"
                              Order: =1
                        - tour_id5:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="tour_id"
                              FieldName: ="tour_id"
                              FieldType: ="n"
                              Order: =2
                  - Text_Name_94:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Name_93.Height
                        Size: =20
                        Text: |-
                          =If(
                              Radio_Existing_Fac_90.Selected.answer = "YES", 
                              "Please select the faculty from the dropdown below", 
                              "Please type the faculty's last name and first name in the boxes provided")
                        Width: =Text_New_Fac_90.Width*19/20
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Text_Name_93.Y + Text_Name_93.Height + Parent.Height/40
                  - Radio_Existing_Fac_90:
                      Control: Radio@0.0.25
                      Properties:
                        DefaultSelectedItems: =Filter(colYesNo, answer = "YES")
                        Height: =Text_New_Fac_90.Height
                        Items: =Filter(colYesNo, answer <> "N/A", answer <> Blank())
                        Layout: ='RadioGroupCanvas.Layout'.Horizontal
                        OnChange: |-
                          =UpdateContext({varReadyToSubmit:false});
                          Reset(Text_Input_New_Org_Country_40);
                          Reset(Text_Input_New_Org_State_40);
                          Reset(Dropdown_New_Org_State_40);
                        Width: =Parent.Width*39/40 - Self.X
                        X: =Text_Name_93.X + Text_Name_93.Width
                        Y: =Text_Name_93.Y
                      Children:
                        - answer6_1:
                            Control: RadioDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="answer"
                              FieldName: ="answer"
                              FieldType: ="s"
                              Order: =1
                  - Text_Name_93:
                      Control: Text@0.0.51
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_New_Fac_90.Height
                        Size: =20
                        Text: ="Is this person already in the department?"
                        Width: =Parent.Width/1.5
                        X: =Parent.Width/40
                        Y: =Text_New_Fac_90.Y + Text_New_Fac_90.Height + Parent.Height/20
                  - Text_New_Fac_90:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Salary_ID_90.Height
                        Size: =22
                        Text: ="Add Salary for New Faculty"
                        Width: =Parent.Width
                        Y: =Parent.Height/40
            - Spinner_90:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Salary_Header_90:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Salary_Header_90:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Salary Costs"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_90:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_90:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Base_Salary_Details_100


Screens:
  Screen_Base_Salary_Details_100:
    Properties:
      Fill: =RGBA(0, 0, 0, 0)
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Salary_Details_100:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Header_Salary_Details_100.Height
            Width: =Parent.Width
            Y: =Container_Header_Salary_Details_100.Height
          Children:
            - Text_Input_Salary_ID_100:
                Control: Classic/TextInput@2.3.2
                Properties:
                  Align: =Align.Center
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderStyle: =BorderStyle.None
                  BorderThickness: =0
                  Default: |-
                    =Concat(
                        Filter(colSalaryCost, Not(IsBlank(salary_id))), salary_id, ", ")

                    //Index(colPurchase,1).purchase_cost_id
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  Width: =Parent.Width/15
                  X: =Parent.Width - Self.Width
                  Y: =Parent.Height - Self.Height
            - Text_Salary_ID_100:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Start
                  DisplayMode: =DisplayMode.Disabled
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Last_Name_100.Height
                  Size: =23
                  Text: ="Salary ID(s)"
                  Width: =Parent.Width/12
                  X: =Text_Input_Salary_ID_100.X - Self.Width
                  Y: =Text_Input_Salary_ID_100.Y
            - Button_Arrive_Fac_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        IsBlank(Index(colSalaryCost,1).tour_id), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varArriveFac: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: ="Arrive Fac"
                  Width: =Button_Return_100.Width
                  X: =Button_Cancel_Salary_100.X + Button_Generate_Memo_100.Width + Parent.Width/50
                  Y: =Button_Return_100.Y
            - Button_Cancel_Salary_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varShowCancel: true})
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: ="Cancel Salary"
                  Width: =Button_Return_100.Width
                  X: =Button_Generate_Memo_100.X + Button_Generate_Memo_100.Width + Parent.Width/50
                  Y: =Button_Return_100.Y
            - Button_Generate_Memo_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: =UpdateContext({varGenerateRPF:true})
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: ="Generate RPF"
                  Visible: |-
                    =If(
                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) &&
                        CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers),
                        true, false)
                  Width: =Button_Return_100.Width
                  X: =Button_Add_FY_100.X + Button_Add_FY_100.Width + Parent.Width/50
                  Y: =Button_Return_100.Y
            - Button_Add_FY_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: "=UpdateContext({varAddPayPeriods:true});\r\n\r\nForAll( \r\n    Sequence(27),\r\n    \r\n    Collect(colNewPayPeriods, \r\n        {pay_period_id: Blank(), \r\n        pay_period: ThisRecord.Value,\r\n        new_pay_period_num: Max(colNewPayPeriods, new_pay_period_num) + 1,\r\n        fy: Max(Distinct(colPayPeriods, fy), Value) + 1,\r\n        start_date: \r\n            If(false, Today(), Blank()), \r\n        end_date: \r\n            If(false, Today(), Blank())}))"
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: ="Add Pay Periods"
                  Tooltip: =
                  Visible: |-
                    =If(
                        Self.Text = "Routing Complete" || Self.Text = "", 
                        false, true)
                  Width: =Button_Return_100.Width
                  X: =Button_Add_Salary_100.X + Button_Add_Salary_100.Width + Parent.Width/50
                  Y: =Button_Add_Salary_100.Y
            - Button_Add_Salary_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =Self.Color
                  HoverFill: =ColorFade(Self.Fill, -20%)
                  OnSelect: "=Collect(colSalaryCost, \r\n    {budget_id: Blank(), \r\n    budget_name: Blank(), \r\n    cntrl_num: Blank(),  \r\n    disbursed_salary: Blank(), \r\n    projected_salary: Blank(), \r\n    first_name: varFacSalary.first_name, \r\n    last_name: varFacSalary.last_name, \r\n    fy: Dropdown_FY_100.Selected.Value, \r\n    tour_id: varFacSalary.tour_id, \r\n    salary_complete: \"NO\", \r\n    salary_start_date: Blank(), \r\n    salary_end_date: Blank(), \r\n    step: Blank(), \r\n    salary_id: Blank(),\r\n    new_salary_num: Max(colSalaryCost, new_salary_num) + 1}); \r\n\r\nForAll(\r\n    Filter(colPayPeriods, fy = Dropdown_FY_100.Selected.Value) As period, \r\n    \r\n    Collect(colPayPeriodCosts, \r\n        {budget_id: Blank(),  \r\n        disbursed_amount: Blank(), \r\n        projected_amount: Blank(), \r\n        start_date: period.start_date,\r\n        end_date: period.end_date, \r\n        first_name: varFacSalary.first_name, \r\n        fy: period.fy, \r\n        last_name: varFacSalary.last_name, \r\n        tour_id: varFacSalary.tour_id,\r\n        pay_period: period.pay_period, \r\n        pay_period_cost_id: Blank(), \r\n        pay_period_id: period.pay_period_id, \r\n        salary_id: Blank(), \r\n        new_salary_num: Max(colSalaryCost, new_salary_num), \r\n        new_pay_period_cost_num: Max(colPayPeriodCosts, new_pay_period_cost_num) + 1}));\r\n\r\nUpdateContext({varReadyToSubmit:false})"
                  PressedBorderColor: =Self.Fill
                  PressedFill: =Self.Fill
                  Size: =12
                  Text: ="Add Cost"
                  Tooltip: =
                  Visible: |-
                    =If(
                        Self.Text = "Routing Complete" || Self.Text = "", 
                        false, true)
                  Width: =Button_Return_100.Width
                  X: =Button_Submit_100.X + Button_Submit_100.Width + Parent.Width/50
                  Y: =Button_Return_100.Y
            - Button_Submit_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit &&
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: "=UpdateContext({varShowSpinner:true});\r\n\r\n// REMOVE ANY DELETED NOTES\r\nIf(CountRows(colRemoveSalaryNotes)>0, \r\n    ForAll(colRemoveSalaryNotes As remove_note, \r\n        Remove(salary_cost_notes, LookUp(salary_cost_notes, salary_note_id = remove_note.salary_note_id))));\r\n\r\n// REMOVE ANY DELETED PAY PERIODS\r\nIf(CountRows(Filter(colPayPeriodCosts, Not(IsBlank(pay_period_cost_id)), projected_amount = 0)) > 0, \r\n    ForAll(Filter(colPayPeriodCosts, Not(IsBlank(pay_period_cost_id)), projected_amount = 0) As remove_cost, \r\n        Remove(pay_period_costs, LookUp(pay_period_costs, pay_period_cost_id = remove_cost.pay_period_cost_id))));\r\n\r\n// REMOVE ANY DELETED SALARY COSTS\r\nIf(CountRows(colRemoveSalaryCost)>0, \r\n    ForAll(colRemoveSalaryCost As remove_salary, \r\n        Remove(salary_costs, LookUp(salary_costs, salary_cost_id = remove_salary.salary_id))));\r\n\r\n// UPDATE SALARY COSTS TABLE\r\nForAll(\r\n    colSalaryCost As cost, \r\n    If(\r\n        IsBlank(cost.salary_id),\r\n        // PATCH IN COMPLETELY NEW SALARY COSTS AND USE SALARY COST ID\r\n        With(\r\n            {new_salary_cost_id: \r\n            Patch(salary_costs, Defaults(salary_costs), \r\n                {budget_id: cost.budget_id, \r\n                cntrl_num: cost.cntrl_num, \r\n                tour_id: cost.tour_id, \r\n                last_name: \r\n                    If(\r\n                        IsBlank(cost.tour_id), \r\n                        cost.last_name, Blank()), \r\n                first_name:\r\n                    If(\r\n                        IsBlank(cost.tour_id), \r\n                        cost.first_name, Blank()), \r\n                step: cost.step, \r\n                salary_complete: cost.salary_complete, \r\n                salary_start_date: cost.salary_start_date, \r\n                salary_end_date: cost.salary_end_date, \r\n                updated_on: Today()}).salary_cost_id}, \r\n            \r\n            // PATCH IN COMPLETELY NEW PAY PERIOD COSTS FOR NEW SALARY COST\r\n            ForAll(\r\n                Filter(colPayPeriodCosts, salary_id = cost.salary_id, new_salary_num = cost.new_salary_num, Not(IsBlank(projected_amount)), projected_amount <> 0) As period, \r\n                    Patch(pay_period_costs, Defaults(pay_period_costs), \r\n                        {salary_cost_id: new_salary_cost_id, \r\n                        pay_period_id: period.pay_period_id, \r\n                        projected_amount: period.projected_amount, \r\n                        disbursed_amount: period.disbursed_amount, \r\n                        updated_on: Today()})); \r\n            \r\n            // PATCH IN COMPLETELY NEW SALARY NOTES FOR NEW SALARY COST\r\n            ForAll(\r\n                Filter(colSalaryNotes, salary_cost_id = cost.salary_id, new_salary_num = cost.new_salary_num) As note, \r\n                    Patch(salary_cost_notes, Defaults(salary_cost_notes), \r\n                        {salary_cost_id: new_salary_cost_id, \r\n                        notes: note.notes, \r\n                        tour_id: note.created_tour, \r\n                        updated_on: Today()}))), \r\n\r\n        // PATCH IN UPDATES TO EXISTING SALARY COSTS\r\n        If(\r\n            varSalaryCostChange, \r\n            Patch(salary_costs, LookUp(salary_costs, salary_cost_id = cost.salary_id), \r\n                {budget_id: cost.budget_id, \r\n                cntrl_num: cost.cntrl_num,\r\n                tour_id: cost.tour_id, \r\n                last_name: \r\n                    If(\r\n                        IsBlank(cost.tour_id), \r\n                        cost.last_name, Blank()), \r\n                first_name:\r\n                    If(\r\n                        IsBlank(cost.tour_id), \r\n                        cost.first_name, Blank()),\r\n                step: cost.step, \r\n                salary_complete: cost.salary_complete, \r\n                salary_start_date: cost.salary_start_date, \r\n                salary_end_date: cost.salary_end_date, \r\n                updated_on: Today()}));\r\n\r\n        // PATCH IN UPDATES TO PAY PERIOD COSTS FOR EXISTING SALARY COSTS\r\n        If(\r\n            varPayPeriodChange, \r\n            ForAll(Filter(colPayPeriodCosts, salary_id = cost.salary_id, Not(IsBlank(projected_amount)), projected_amount <> 0) As ppc, \r\n                If(\r\n                    IsBlank(ppc.pay_period_cost_id),\r\n\r\n                    // PATCH IN NEW PAY PERIOD COSTS FOR EXISTING SALARY COSTS\r\n                    Patch(pay_period_costs, Defaults(pay_period_costs), \r\n                        {salary_cost_id: ppc.salary_id, \r\n                        pay_period_id: ppc.pay_period_id, \r\n                        projected_amount: ppc.projected_amount, \r\n                        disbursed_amount: ppc.disbursed_amount, \r\n                        updated_on: Today()}), \r\n\r\n                    // PATCH IN UPDATES TO EXISTING PAY PERIOD COSTS FOR EXISTING SALARY COSTS\r\n                    Patch(pay_period_costs, LookUp(pay_period_costs, pay_period_cost_id = ppc.pay_period_cost_id), \r\n                        {salary_cost_id: ppc.salary_id, \r\n                        pay_period_id: ppc.pay_period_id, \r\n                        projected_amount: ppc.projected_amount, \r\n                        disbursed_amount: ppc.disbursed_amount, \r\n                        updated_on: Today()}))));\r\n        \r\n        // PATCH IN UPDATES TO SALARY NOTES FOR EXISTING SALARY COSTS\r\n        If(\r\n            varSalaryNoteChange, \r\n            ForAll(Filter(colSalaryNotes, salary_cost_id = cost.salary_id) As note, \r\n                If(\r\n                    IsBlank(note.salary_note_id), \r\n\r\n                    // PATCH IN NEW NOTES FOR EXISTING SALARY COSTS\r\n                    Patch(salary_cost_notes, Defaults(salary_cost_notes), \r\n                        {salary_cost_id: note.salary_cost_id, \r\n                        notes: note.notes, \r\n                        tour_id: note.created_tour, \r\n                        updated_on: Today()}), \r\n\r\n                    // PATCH IN UPDATES TO EXISING SALARY NOTES FOR EXISTING SALARY COSTS\r\n                    Patch(salary_cost_notes, LookUp(salary_cost_notes, salary_note_id = note.salary_note_id), \r\n                        {notes: note.notes, \r\n                        tour_id: note.created_tour, \r\n                        updated_on: Today()}))))));\r\n\r\nSet(varFacSalary, Blank());\r\n\r\nUpdateContext({varSalaryCostChange: Blank()});\r\nUpdateContext({varSalaryNoteChange: Blank()});\r\nUpdateContext({varAddNotes:Blank()});\r\nUpdateContext({varAddPayPeriods:Blank()});\r\nUpdateContext({varPayPeriodChange:Blank()});\r\nUpdateContext({varReadyToSubmit:Blank()});\r\nUpdateContext({varShowSpinner:false});\r\nUpdateContext({varArriveFac:false});\r\nUpdateContext({varControlNum:Blank()});\r\n\r\nClearCollect(colSalaryCost, \r\n        {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});\r\n\r\nClearCollect(colAddSalary, \r\n        {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});\r\n\r\nClear(colSalaryNotes);\r\nClear(colNewPayPeriods);\r\nClear(colPayPeriodCosts);\r\nClear(colPayPeriods);\r\nClear(colRemoveSalaryCost);\r\nClear(colRemoveSalaryNotes);\r\n\r\nRefresh(pay_period_cost_view);\r\nRefresh(salary_notes_view);\r\nRefresh(salary_costs_view);\r\n\r\nReset(Gallery_Salary_90);\r\n\r\nUpdateContext({varShowSpinner:false});\r\n\r\nIf(\r\n    Not(IsBlank(varReturnScreen)), \r\n    Navigate(varReturnScreen),\r\n    Navigate(Screen_Salary_Overview_90))"
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: ="Save"
                  Visible: "=If(\r\n    (varUser.dept_pos = \"XO\" || varUser.dept_pos = \"P5\" || varUser.dept_pos = \"P6\") &&\r\n    \r\n    CountRows(Filter(colTravelers, Not(IsBlank(xo_approved_on)))) = CountRows(colTravelers) &&\r\n\r\n    CountRows(colTravelers) > 0 &&\r\n\r\n    CountRows(Filter(colTravelers, Not(IsBlank(p6_approved_on)))) = CountRows(colTravelers), false, true)"
                  Width: =Button_Return_100.Width
                  X: =Button_Check_100.X + Button_Check_100.Width + Parent.Width/50
                  Y: =Button_Return_100.Y
            - Button_Check_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        (varReadyToSubmit = false) &&
                        (varPermissions = "Master" ||
                        varPermissions = "Admin" ||
                        varPermissions = "Research" ||
                        varUser.tour_id = Index(colPurchase,1).requestor_tour), 
                        DisplayMode.Edit, DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(
                        (CountRows(Filter(colSalaryCost, IsBlank(tour_id))) = 0 ||
                        (CountRows(Filter(colSalaryCost, IsBlank(last_name))) = 0 &&
                        CountRows(Filter(colSalaryCost, IsBlank(first_name))) = 0)),

                        If(
                            CountRows(Filter(colSalaryCost, IsBlank(salary_start_date))) = 0 &&
                            CountRows(Filter(colSalaryCost, IsBlank(salary_end_date))) = 0 &&
                            CountRows(Filter(colSalaryCost, IsBlank(step))) = 0 && 
                            CountRows(Filter(colSalaryCost, IsBlank(salary_complete))) = 0,

                            UpdateContext({varReadyToSubmit:true});
                            Notify("CLICK SAVE TO SUBMIT CHANGES", NotificationType.Success), 

                            UpdateContext({varReadyToSubmit:false});
                            Notify("PLEASE ENSURE EVERY SALARY COST HAS A START DATE, END DATE, AND STEP", NotificationType.Error)), 

                        UpdateContext({varReadyToSubmit:false});
                            Notify("PLEASE ENSURE YOU HAVE IDENTIFIED A FACULTY FOR THIS COST", NotificationType.Error))
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: ="Check"
                  Width: =Button_Return_100.Width
                  X: =Button_Return_100.X + Button_Return_100.Width + Parent.Width/50
                  Y: =Button_Return_100.Y
            - Button_Return_100:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Last_Name_100.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Set(varFacSalary, Blank());

                    UpdateContext({varSalaryCostChange: Blank()});
                    UpdateContext({varSalaryNoteChange: Blank()});
                    UpdateContext({varAddNotes:Blank()});
                    UpdateContext({varAddPayPeriods:Blank()});
                    UpdateContext({varPayPeriodChange:Blank()});
                    UpdateContext({varReadyToSubmit:Blank()});
                    UpdateContext({varShowSpinner:false});
                    UpdateContext({varArriveFac:false});
                    UpdateContext({varControlNum:Blank()});

                    ClearCollect(colSalaryCost, 
                            {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});

                    ClearCollect(colAddSalary, 
                            {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

                    Clear(colSalaryNotes);
                    Clear(colNewPayPeriods);
                    Clear(colPayPeriodCosts);
                    Clear(colPayPeriods);
                    Clear(colRemoveSalaryCost);
                    Clear(colRemoveSalaryNotes);

                    Refresh(pay_period_cost_view);
                    Refresh(salary_notes_view);
                    Refresh(salary_costs_view);

                    Reset(Gallery_Salary_90);

                    UpdateContext({varShowSpinner:false});

                    If(
                        Not(IsBlank(varReturnScreen)), 
                        Navigate(varReturnScreen),
                        Navigate(Screen_Salary_Overview_90))
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Size: =12
                  Text: ="Return"
                  Width: =Parent.Width/12
                  X: =Parent.Width/40
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Container_Pay_Period_Details_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Height: =Button_Return_100.Y - Self.Y
                  Width: =Parent.Width*19/20
                  X: =Parent.Width/40
                  Y: =Text_Faculty_Name_100.Y
                Children:
                  - Gallery_Salary_Costs_100:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Height: =Parent.Height*39/40
                        Items: =Sort(Filter(colSalaryCost, fy = Dropdown_FY_100.Selected.Value), salary_start_date, SortOrder.Ascending)
                        TemplateSize: =400
                        Width: =Parent.Width - Self.X
                        X: =Gallery_Pay_Periods_100.Width + 10
                      Children:
                        - Gallery_Pay_Period_Costs_100:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Height: =Parent.Height - Self.Y - Parent.Height/20
                              Items: =Sort(Filter(colPayPeriodCosts, salary_id = ThisItem.salary_id, new_salary_num = ThisItem.new_salary_num), pay_period, SortOrder.Ascending)
                              Selectable: =false
                              ShowScrollbar: =false
                              TemplateSize: =22.5
                              Width: =Text_Disbursed_100.X + Text_Disbursed_100.Width - Text_Projected_100.X
                              X: =Text_Projected_100.X
                              Y: =Text_Pay_Period_100.Y + Text_Pay_Period_100.Height
                            Children:
                              - Text_Input_Disbursed_100:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    BorderThickness: =0
                                    Default: =Abs(ThisItem.disbursed_amount)
                                    Fill: =RGBA(0, 0, 0, 0)
                                    Font: =Font.'Open Sans'
                                    Format: =TextFormat.Number
                                    Height: =Parent.TemplateHeight
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnChange: |-
                                      =Patch(colPayPeriodCosts, ThisItem, 
                                          {disbursed_amount: -Abs(Self.Text)});

                                      UpdateContext({varPayPeriodChange:true});
                                      UpdateContext({varReadyToSubmit:false});
                                    OnSelect: |-
                                      =//UpdateContext({varTraveler: ThisItem});
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Size: =10
                                    Width: =Text_Disbursed_100.Width
                                    X: =Text_Disbursed_100.X - Gallery_Pay_Period_Costs_100.X
                              - Text_Input_Projected_100:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    BorderThickness: =0
                                    Default: =Abs(ThisItem.projected_amount)
                                    Fill: =RGBA(0, 0, 0, 0)
                                    Font: =Font.'Open Sans'
                                    Format: =TextFormat.Number
                                    Height: =Parent.TemplateHeight
                                    HintText: =ThisItem.pay_period
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    OnChange: |-
                                      =Patch(colPayPeriodCosts, ThisItem, {projected_amount: -Abs(Self.Text)});

                                      UpdateContext({varPayPeriodChange:true});
                                      UpdateContext({varReadyToSubmit:false});
                                    OnSelect: |-
                                      =//UpdateContext({varTraveler: ThisItem});
                                    PaddingBottom: =0
                                    PaddingTop: =0
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Size: =10
                                    Width: =Text_Projected_100.Width
                                    X: =Text_Projected_100.X - Gallery_Pay_Period_Costs_100.X
                              - Separator_Gallery_Pay_Period_Costs_100:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    BorderThickness: =1
                                    Fill: =Color.Black
                                    Height: =2
                                    OnSelect: =Select(Parent)
                                    Width: =Parent.TemplateWidth
                                    Y: =Parent.TemplateHeight - Self.Height
                        - Text_Disbursed_Total_100:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              BorderColor: =RGBA(0, 0, 0, 1)
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Text_Input_Last_Name_100.Height
                              Size: =23
                              Text: |-
                                =Abs(Sum(
                                    Filter(colPayPeriodCosts, budget_id = ThisItem.budget_id, fy = ThisItem.fy),disbursed_amount))
                              Width: =Text_Disbursed_100.Width
                              X: =Text_Disbursed_100.X
                              Y: =Container_Pay_Period_Details_100.Height - Self.Height - Parent.Height/30
                        - Text_Projected_Total_100:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              BorderColor: =RGBA(0, 0, 0, 1)
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              Height: =Text_Input_Last_Name_100.Height
                              Size: =23
                              Text: |-
                                =Abs(Sum(
                                    Filter(colPayPeriodCosts, budget_id = ThisItem.budget_id, fy = ThisItem.fy),projected_amount))
                              Width: =Text_Projected_100.Width
                              X: =Text_Projected_100.X
                              Y: =Container_Pay_Period_Details_100.Height - Self.Height - Parent.Height/30
                        - Text_Disbursed_100:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              BorderRadiusTopLeft: =10
                              BorderRadiusTopRight: =10
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(211, 188, 141, 1)
                              Height: =Text_Input_Last_Name_100.Height
                              Size: =23
                              Text: ="Disbursed"
                              Width: =(Parent.TemplateWidth - 30)/2
                              X: =Text_Projected_100.X + Text_Projected_100.Width + 10
                              Y: =Text_Pay_Period_100.Y
                        - Text_Projected_100:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              BorderRadiusTopLeft: =10
                              BorderRadiusTopRight: =10
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(211, 188, 141, 1)
                              Height: =Text_Input_Last_Name_100.Height
                              Size: =23
                              Text: ="Projected"
                              Width: =(Parent.TemplateWidth - 30)/2
                              X: =10
                              Y: =Text_Pay_Period_100.Y
                        - Button_Control_Num_100:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =Color.Black
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colPurchase,1).requestor_tour, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              Font: =Font.'Open Sans'
                              Height: =Text_Input_Last_Name_100.Height
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =Self.Color
                              HoverFill: =ColorFade(Self.Fill, -20%)
                              OnSelect: |-
                                =UpdateContext({varControlNum:
                                    {new_salary_num: ThisItem.new_salary_num, 
                                    salary_id: ThisItem.salary_id}})
                              PressedBorderColor: =Self.Fill
                              PressedFill: =Self.Fill
                              Size: =12
                              Text: |-
                                ="Control #"
                              Tooltip: =
                              Visible: |-
                                =If(
                                    Self.Text = "Routing Complete" || Self.Text = "", 
                                    false, true)
                              Width: =(Parent.TemplateWidth - 40)/3
                              X: =Button_Notes_100.X + Button_Notes_100.Width + 10
                              Y: =Button_Complete_Salary_100.Y
                        - Button_Notes_100:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =Color.Black
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colPurchase,1).requestor_tour, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(211, 188, 141, 1)
                              Font: =Font.'Open Sans'
                              Height: =Text_Input_Last_Name_100.Height
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =Self.Color
                              HoverFill: =ColorFade(Self.Fill, -20%)
                              OnSelect: |-
                                =UpdateContext({varAddNotes: 
                                    {salary_id: ThisItem.salary_id, 
                                    new_salary_num: ThisItem.new_salary_num}})
                              PressedBorderColor: =Self.Fill
                              PressedFill: =Self.Fill
                              Size: =12
                              Text: ="Notes"
                              Tooltip: =
                              Visible: |-
                                =If(
                                    Self.Text = "Routing Complete" || Self.Text = "", 
                                    false, true)
                              Width: =(Parent.TemplateWidth - 40)/3
                              X: =Button_Complete_Salary_100.X + Button_Complete_Salary_100.Width + 10
                              Y: =Button_Complete_Salary_100.Y
                        - Button_Complete_Salary_100:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =Color.White
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: |-
                                =If(
                                    Self.Text = "Incomplete", 
                                    Color.Red, 
                                    Color.Green)
                              Font: =Font.'Open Sans'
                              Height: =Text_Input_Last_Name_100.Height
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =Self.Color
                              HoverFill: =ColorFade(Self.Fill, -20%)
                              OnSelect: |-
                                =If(
                                    Self.Text = "Incomplete", 
                                    Patch(colSalaryCost, ThisItem, {salary_complete: "YES"}),
                                    Patch(colSalaryCost, ThisItem, {salary_complete: "NO"}));

                                UpdateContext({varSalaryCostChange:true});
                                UpdateContext({varReadyToSubmit:false})
                              PressedBorderColor: =Self.Fill
                              PressedFill: =Self.Fill
                              Size: =12
                              Text: |-
                                =If(
                                    ThisItem.salary_complete = "NO", 
                                    "Incomplete", 
                                    "Complete")
                              Tooltip: ="Button shows CURRENT status of salary cost"
                              Visible: |-
                                =If(
                                    Self.Text = "Routing Complete" || Self.Text = "", 
                                    false, true)
                              Width: =(Parent.TemplateWidth - 40)/3
                              X: =Dropdown_Budget_100.X
                              Y: =Text_FY_100.Y - Container_Pay_Period_Details_100.Y
                        - Text_Input_Step_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderThickness: =3
                              Default: =ThisItem.step
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Fill: =RGBA(211, 188, 141, 1)
                              Font: =Font.'Open Sans'
                              Height: =Text_Input_Last_Name_100.Height
                              HintText: ="Step"
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              OnChange: |-
                                =Patch(colSalaryCost, ThisItem, {step: Upper(Self.Text)});
                                UpdateContext({varSalaryCostChange:true});
                                UpdateContext({varReadyToSubmit:false});
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              TabIndex: =1
                              Width: =(Parent.TemplateWidth - 30)/2
                              X: =Dropdown_Budget_100.X + Dropdown_Budget_100.Width + 10
                              Y: =Dropdown_Budget_100.Y
                        - Dropdown_Budget_100:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              DefaultSelectedItems: =Filter(colBudgets, budget_id = ThisItem.budget_id)
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Height: =Text_Input_Last_Name_100.Height
                              Items: =colBudgets
                              OnChange: |-
                                =ForAll(
                                    Filter(colPayPeriodCosts, budget_id = ThisItem.budget_id) As period, 
                                    Patch(colPayPeriodCosts, LookUp(Filter(colPayPeriodCosts, pay_period_cost_id = period.pay_period_cost_id), new_pay_period_cost_num = period.new_pay_period_cost_num), 
                                        {budget_id: Self.Selected.budget_id}));

                                Patch(colSalaryCost, ThisItem, 
                                    {budget_id: Self.Selected.budget_id, 
                                    budget_name: Self.Selected.budget_name});

                                UpdateContext({varSalaryCostChange: true});
                                UpdateContext({varReadyToSubmit:false});
                              Width: =(Parent.TemplateWidth - 30)/2
                              X: =10
                              Y: =Dropdown_Fac_Name_100.Y - Container_Pay_Period_Details_100.Y
                            Children:
                              - budget_name3:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="budget_name"
                                    FieldName: ="budget_name"
                                    FieldType: ="s"
                                    Order: =1
                              - budget_id3:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="budget_id"
                                    FieldName: ="budget_id"
                                    FieldType: ="n"
                                    Order: =2
                        - Icon_Remove_Salary_100:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                              Height: =Text_Input_Last_Name_100.Height
                              Icon: =Icon.Cancel
                              OnSelect: "=If(\n    IsBlank(ThisItem.salary_id), \n\n    ForAll(\n        Filter(colSalaryNotes, salary_cost_id = ThisItem.salary_id, new_salary_num = ThisItem.new_salary_num) As note, \n        Remove(colSalaryNotes, LookUp(colSalaryNotes, new_note_num = note.new_note_num)));\n\n    ForAll(\n        Filter(colPayPeriodCosts, salary_id = ThisItem.salary_id, new_salary_num = ThisItem.new_salary_num) As ppc, \n        Remove(colPayPeriodCosts, LookUp(colPayPeriodCosts, new_pay_period_cost_num = ppc.new_pay_period_cost_num)));\n\n    Remove(colSalaryCost, ThisItem),\n\n    If(\n        IsBlank(ThisItem.cntrl_num), \n\n        ForAll(\n            Filter(colSalaryNotes, salary_cost_id = ThisItem.salary_id, new_salary_num = ThisItem.new_salary_num) As note, \n            \n            If(\n                Not(IsBlank(note.salary_note_id)),\n                Collect(\n                    colRemoveSalaryNotes, note));\n                Remove(colSalaryNotes, LookUp(colSalaryNotes, salary_note_id = note.salary_note_id && new_note_num = note.new_note_num)));\n\n        ForAll(\n            Filter(colPayPeriodCosts, salary_id = ThisItem.salary_id, new_salary_num = ThisItem.new_salary_num) As ppc, \n            Patch(colPayPeriodCosts, LookUp(colPayPeriodCosts, pay_period_cost_id = ppc.pay_period_cost_id && new_pay_period_cost_num = ppc.new_pay_period_cost_num), \n                {projected_amount: 0}));\n\n        Collect(colRemoveSalaryCost, ThisItem);\n\n        Remove(colSalaryCost, ThisItem), \n\n        ForAll(\n            Filter(colPayPeriodCosts, salary_id = ThisItem.salary_id, new_salary_num = ThisItem.new_salary_num, Not(IsBlank(projected_amount)), projected_amount <> 0) As ppc, \n            \n            If(\n                IsBlank(ppc.pay_period_cost_id),\n\n                Patch(colPayPeriodCosts, LookUp(colPayPeriodCosts, pay_period_cost_id = ppc.pay_period_cost_id && new_pay_period_cost_num = ppc.new_pay_period_cost_num), \n                    {projected_amount: 0}),\n\n                Patch(colPayPeriodCosts, LookUp(colPayPeriodCosts, pay_period_cost_id = ppc.pay_period_cost_id && new_pay_period_cost_num = ppc.new_pay_period_cost_num), \n                    {disbursed_amount: 0})));\n\n        Patch(colSalaryCost, ThisItem, \n            {disbursed_salary: 0, \n            salary_complete: \"YES\"})));\n\nUpdateContext({varPayPeriodChange: true});\nUpdateContext({varSalaryCostChange:true});\nUpdateContext({varReadyToSubmit: false})"
                              Tooltip: ="Delete this salary cost"
                              Width: =Self.Height
                              X: =Parent.TemplateWidth - Self.Width - 10
                              Y: =Date_Picker_Salary_Start_100.Y
                        - Date_Picker_Salary_End_100:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                                    DisplayMode.Edit, DisplayMode.Disabled)
                              EndDate: =Date(Dropdown_FY_100.Selected.Value, 09, 30)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Last_Name_100.Height
                              OnChange: |-
                                =Patch(colSalaryCost, ThisItem, {salary_end_date: Self.SelectedDate});
                                UpdateContext({varSalaryCostChange:true});
                                UpdateContext({varReadyToSubmit:false});
                              SelectedDate: =ThisItem.salary_end_date
                              StartDate: "=If(\r\n    IsBlank(Date_Picker_Salary_Start_100.SelectedDate), \r\n    \r\n    If(\r\n        IsBlank(Dropdown_FY_100.Selected.Value), \r\n        Blank(), \r\n        Date((Dropdown_FY_100.Selected.Value-1), 10, 01)), \r\n\r\n    Date_Picker_Salary_Start_100.SelectedDate)"
                              Width: =(Parent.TemplateWidth - 40)/2.25
                              X: =Date_Picker_Salary_Start_100.X + Date_Picker_Salary_Start_100.Width + 10
                              Y: =1
                        - Date_Picker_Salary_Start_100:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DisplayMode: |-
                                =If(
                                    varPermissions = "Master" || varPermissions = "Admin" || varPermissions = "Research",

                                    DisplayMode.Edit, DisplayMode.Disabled)
                              EndDate: |-
                                =If(
                                    IsBlank(Date_Picker_Salary_End_100.SelectedDate), 
                                    Date(Dropdown_FY_100.Selected.Value, 09, 30), 
                                    Date_Picker_Salary_End_100.SelectedDate)
                              Fill: =RGBA(211, 188, 141, 1)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Last_Name_100.Height
                              OnChange: |-
                                =Patch(colSalaryCost, ThisItem, {salary_start_date: Self.SelectedDate});
                                UpdateContext({varSalaryCostChange:true});
                                UpdateContext({varReadyToSubmit:false});
                              SelectedDate: =ThisItem.salary_start_date
                              StartDate: |-
                                =If(
                                    IsBlank(Dropdown_FY_100.Selected.Value), 
                                    Blank(), 
                                    Date((Dropdown_FY_100.Selected.Value-1), 10, 01))
                              Width: =(Parent.TemplateWidth - 40)/2.25
                              X: =10
                              Y: =1
                        - Separator_Gallery_Salary_Costs_100:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Fill: =RGBA(0, 0, 0, 1)
                              Height: =Parent.Height
                              OnSelect: =Select(Parent)
                              Width: =2
                              X: =Parent.TemplateWidth - Self.Width/2
                              Y: =0.6749999999999545
                  - Gallery_Pay_Periods_100:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Height: =Gallery_Pay_Period_Costs_100.Height
                        Items: =Sort(Filter(colPayPeriods, fy = Dropdown_FY_100.Selected.Value), pay_period, SortOrder.Ascending)
                        NavigationStep: =0
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        ShowScrollbar: =false
                        TemplateSize: =22.5
                        Width: =Text_End_Date_100.X + Text_End_Date_100.Width
                        Y: =Text_Pay_Period_100.Y + Text_Pay_Period_100.Height
                      Children:
                        - Text_Input_Pay_Period_End_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.end_date
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Size: =10
                              Width: =Text_End_Date_100.Width
                              X: =Text_End_Date_100.X
                        - Text_Input_Pay_Period_Start_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.start_date
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =/*
                                Patch(colItems, ThisItem, {item_desc:Upper(Self.Text)});

                                UpdateContext({varItemChange:true});

                                UpdateContext({varReadyToSubmit: false})
                                */
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Size: =10
                              Width: =Text_Start_Date_100.Width
                              X: =Text_Start_Date_100.X
                        - Text_Input_Pay_Period_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.pay_period
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =/*
                                Patch(colItems, ThisItem, {part_num:Upper(Self.Text)});

                                UpdateContext({varItemChange:true});

                                UpdateContext({varReadyToSubmit: false})
                                */
                              OnSelect: |-
                                =//UpdateContext({varTraveler: ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Size: =10
                              Width: =Text_Pay_Period_100.Width
                              X: =Text_Pay_Period_100.X
                        - Separator_Gallery_Items_82:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Text_End_Date_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="End"
                        Width: =Parent.Width/15
                        X: =Text_Start_Date_100.X + Text_Start_Date_100.Width + 10
                        Y: =Text_Pay_Period_100.Y
                  - Text_Start_Date_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="Start"
                        Width: =Parent.Width/15
                        X: =Text_Pay_Period_100.X + Text_Pay_Period_100.Width + 10
                        Y: =Text_Pay_Period_100.Y
                  - Text_Pay_Period_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="Period"
                        Width: =Parent.Width/15
                        Y: =Text_FY_100.Y + Text_FY_100.Height
            - Dropdown_FY_100:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: |-
                    =Filter(
                        Distinct(colPayPeriods, fy), Value = varFacSalary.fy)
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Last_Name_100.Height
                  Items: |-
                    =Sort(
                        Distinct(colPayPeriods, fy), Value, SortOrder.Ascending)
                  OnChange: |-
                    =/*
                    Patch(colPurchase, Index(colPurchase,1), 
                        {recipient_tour: Self.Selected.tour_id,
                        recipient_name: Self.Selected.name});
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varPurchaseChange: true})
                    */
                  Width: =Dropdown_Fac_Name_100.Width + Dropdown_Fac_Name_100.X - Self.X
                  X: =Text_Input_First_Name_100.X
                  Y: =Text_FY_100.Y
                Children:
                  - Value2:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Value"
                        FieldName: ="Value"
                        FieldType: ="n"
                        Order: =1
            - Text_FY_100:
                Control: Text@0.0.51
                Properties:
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Last_Name_100.Height
                  Size: =23
                  Text: ="FY:"
                  Width: =Text_Input_Last_Name_100.Width
                  X: =Text_Input_Last_Name_100.X
                  Y: =Text_Input_Last_Name_100.Y + Text_Input_Last_Name_100.Height + Parent.Height/50
            - Text_Input_First_Name_100:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =varFacSalary.first_name
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HintText: ="First Name"
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =ForAll(
                        colSalaryCost As cost,
                        Patch(colSalaryCost, cost, 
                            {first_name: Upper(Self.Text)}));

                    UpdateContext({varSalaryCostChange:true});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Tooltip: ="First Name"
                  Visible: =IsBlank(varFacSalary.tour_id)
                  Width: =Text_Input_Last_Name_100.Width
                  X: =Text_Input_Last_Name_100.X + Text_Input_Last_Name_100.Width + 10
                  Y: =Dropdown_Fac_Name_100.Y
            - Text_Input_Last_Name_100:
                Control: Classic/TextInput@2.3.2
                Properties:
                  BorderColor: =Color.Red
                  BorderThickness: =3
                  Default: =varFacSalary.last_name
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Parent.Height/22
                  HintText: ="Last Name"
                  HoverBorderColor: =RGBA(0, 18, 107, 1)
                  HoverFill: =RGBA(186, 202, 226, 1)
                  MaxLength: =255
                  OnChange: |-
                    =ForAll(
                        colSalaryCost As cost,
                        Patch(colSalaryCost, cost, 
                            {last_name: Upper(Self.Text)}));

                    UpdateContext({varSalaryCostChange:true});
                    UpdateContext({varReadyToSubmit:false});
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  TabIndex: =1
                  Tooltip: ="Last Name"
                  Visible: =IsBlank(varFacSalary.tour_id)
                  Width: =Parent.Width/10 - 5
                  X: =Parent.Width/40
                  Y: =Dropdown_Fac_Name_100.Y
            - Dropdown_Fac_Name_100:
                Control: DropDown@0.0.45
                Properties:
                  BorderColor: =Color.Red
                  BorderRadius: =10
                  BorderStyle: =BorderStyle.Solid
                  BorderThickness: =3
                  DefaultSelectedItems: =Filter(colFaculty, last_name = varFacSalary.last_name)
                  Fill: =RGBA(211, 188, 141, 1)
                  FontSize: =18
                  Height: =Text_Input_Last_Name_100.Height
                  Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                  OnChange: |-
                    =ForAll(
                        colSalaryCost As cost, 
                        Patch(colSalaryCost, cost, 
                            {tour_id: Self.Selected.tour_id, 
                            last_name: LookUp(colFaculty, tour_id = Self.Selected.tour_id).last_name, 
                            first_name: LookUp(colFaculty, tour_id = Self.Selected.tour_id).first_name}));
                    UpdateContext({varReadyToSubmit:false});
                    UpdateContext({varSalaryCostChange:true})
                  Visible: =Not(IsBlank(varFacSalary.tour_id))
                  Width: =Gallery_Pay_Periods_100.Width + Gallery_Pay_Periods_100.X + Container_Pay_Period_Details_100.X - Self.X
                  X: =Parent.Width/40
                  Y: =Text_Faculty_Name_100.Y +  Text_Faculty_Name_100.Height + Parent.Height/75
                Children:
                  - name2_3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="name"
                        FieldName: ="name"
                        FieldType: ="s"
                        Order: =1
                  - last_name3_3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="last_name"
                        FieldName: ="last_name"
                        FieldType: ="s"
                        Order: =2
                  - tour_id2_3:
                      Control: DropDownDataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="tour_id"
                        FieldName: ="tour_id"
                        FieldType: ="n"
                        Order: =3
            - Text_Faculty_Name_100:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Last_Name_100.Height
                  Size: =23
                  Text: ="Faculty"
                  Width: =Gallery_Pay_Periods_100.Width + Gallery_Pay_Periods_100.X + Container_Pay_Period_Details_100.X - Self.X
                  X: =Text_Input_Last_Name_100.X
                  Y: =11
            - Rectangle_Disable_100:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Spinner_100.Visible ||
                        Container_Salary_Notes_100.Visible ||
                        Container_Add_Pay_Periods_100.Visible || 
                        Container_Cancel_Salary_100.Visible || 
                        Container_Arrive_Fac_100.Visible || 
                        Not(IsBlank(varControlNum)),
                        true, false)
                  Width: =Parent.Width
            - Container_Cancel_Salary_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/4
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowCancel
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Keep_Salary_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: "=If(\n    (varPermissions = \"Master\" ||\n    varPermissions = \"Admin\" ||\n    varPermissions = \"Research\" ||\n    varUser.usma_pers_id = varTraveler.usma_pers_id ||\n\n    If(varTraveler.pers_type <> \"FACULTY\",\n        If(varUser.tour_id = Index(colTrip,2).trip_oic || varUser.tour_id = Index(colTrip,1).trip_oic, \n        true, false)) ||\n        \n        If(\n        IsBlank(LookUp(colFaculty, usma_pers_id = varTraveler.usma_pers_id)),\n        If(varUser.tour_id = Index(colTrip,2).trip_oic || varUser.tour_id = Index(colTrip,1).trip_oic, \n        true, false))), \n    DisplayMode.Edit, DisplayMode.Disabled)"
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowCancel:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="No, Keep Salary"
                        Width: =Self.Height*3
                        X: =Parent.Width - (Parent.Width - Self.Width*2)/3 - Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Cancel_Salary_101:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height*1.5
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowSpinner:true});

                          ForAll(
                              colPayPeriodCosts As ppc, 
                              Patch(pay_period_costs, LookUp(pay_period_costs, pay_period_cost_id = ppc.pay_period_cost_id), 
                                  {disbursed_amount: 0, 
                                  updated_on: Today()}));

                          ForAll(
                              colSalaryCost As cost, 
                              Patch(salary_costs, LookUp(salary_costs, salary_cost_id = cost.salary_id), 
                                  {salary_complete: "YES", 
                                  updated_on: Today()}));

                          Set(varFacSalary, Blank());

                          UpdateContext({varSalaryCostChange: Blank()});
                          UpdateContext({varSalaryNoteChange: Blank()});
                          UpdateContext({varAddNotes:Blank()});
                          UpdateContext({varAddPayPeriods:Blank()});
                          UpdateContext({varPayPeriodChange:Blank()});
                          UpdateContext({varReadyToSubmit:Blank()});
                          UpdateContext({varShowSpinner:false});
                          UpdateContext({varArriveFac:false});
                          UpdateContext({varControlNum:Blank()});

                          ClearCollect(colSalaryCost, 
                                  {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});

                          ClearCollect(colAddSalary, 
                                  {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

                          Clear(colSalaryNotes);
                          Clear(colNewPayPeriods);
                          Clear(colPayPeriodCosts);
                          Clear(colPayPeriods);
                          Clear(colRemoveSalaryCost);
                          Clear(colRemoveSalaryNotes);

                          Refresh(pay_period_cost_view);

                          Refresh(salary_costs_view);
                          Refresh(salary_notes_view);
                          Reset(Gallery_Salary_90);

                          UpdateContext({varShowSpinner:false});

                          If(
                              Not(IsBlank(varReturnScreen)), 
                              Navigate(varReturnScreen),
                              Navigate(Screen_Salary_Overview_90))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Yes, Cancel Salary"
                        Width: =Self.Height*3
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Cancel_Warning_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height/2
                        Size: =24
                        Text: |-
                          ="WARNING: You are about to cancel ALL salary for this person. This cannot be undone. Are you sure you want to cancel?"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width - Parent.Width/20
                        X: =Parent.Width/40
                        Y: =Parent.Height/10
            - Container_Add_Pay_Periods_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.25
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varAddPayPeriods
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Save_Pay_Periods_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\n    CountRows(Filter(colNewPayPeriods, IsBlank(start_date))) = 0 &&\n    CountRows(Filter(colNewPayPeriods, IsBlank(end_date))) = 0, \n    UpdateContext({varShowSpinner:true});\n    ForAll(\n        Sort(Filter(colNewPayPeriods, IsBlank(pay_period_id)), pay_period, SortOrder.Ascending) As period, \n        Patch(lookup_pay_periods, Defaults(lookup_pay_periods), \n            {pay_period: period.pay_period, \n            start_date: period.start_date, \n            end_date: period.end_date}));\n    Clear(colNewPayPeriods);\n    UpdateContext({varAddPayPeriods:false});\n    Set(varFacSalary, \n        Patch(varFacSalary, {fy: First(colNewPayPeriods).fy}));\n    Reset(Dropdown_FY_100);\n    \n    ClearCollect(colPayPeriods, \n        ShowColumns(FirstN(Sort(pay_period_view, start_date, SortOrder.Descending),108), pay_period_id, fy, pay_period, start_date, end_date));\n    \n    UpdateContext({varShowSpinner:false}), \n\n    Notify(\"PLEASE ENSURE ALL PAY PERIODS HAVE A START AND END DATE\", NotificationType.Error))"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Save"
                        Width: =Parent.Width/6
                        X: =(Parent.Width - Self.Width*2)*2/3 + Self.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Button_Cancel_Pay_Periods_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Clear(colNewPayPeriods);
                          UpdateContext({varAddPayPeriods:false})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Parent.Width/6
                        X: =(Parent.Width - Self.Width*2)/3
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Gallery_Add_Pay_Periods_100:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Button_Save_Pay_Periods_100.Y - Self.Y - Parent.Height/30
                        Items: =Sort(Filter(colNewPayPeriods, IsBlank(pay_period_id)), pay_period, SortOrder.Ascending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateSize: =Text_New_Pay_Periods_100.Height
                        Width: =Parent.Width*19/20
                        X: =Text_Pay_Period_102.X
                        Y: =Text_Pay_Period_102.Y + Text_Pay_Period_102.Height
                      Children:
                        - Date_Picker_Pay_Period_End_100:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =0
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Last_Name_100.Height
                              OnChange: |-
                                =Patch(colNewPayPeriods, ThisItem, {end_date: Self.SelectedDate});
                                UpdateContext({varSalaryCostChange:true});
                                UpdateContext({varReadyToSubmit:false});
                              SelectedDate: =ThisItem.end_date
                              StartDate: =ThisItem.start_date
                              Width: =Text_Pay_Period_End_101.Width
                              X: =Text_Pay_Period_End_101.X - Gallery_Add_Pay_Periods_100.X
                        - Date_Picker_Pay_Period_Start_100:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =0
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              EndDate: =ThisItem.end_date
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Text_Input_Last_Name_100.Height
                              OnChange: |-
                                =Patch(colNewPayPeriods, ThisItem, {start_date: Self.SelectedDate});
                                UpdateContext({varSalaryCostChange:true});
                                UpdateContext({varReadyToSubmit:false});
                              SelectedDate: =ThisItem.start_date
                              Width: =Text_Pay_Period_Start_101.Width
                              X: =Text_Pay_Period_Start_101.X - Gallery_Add_Pay_Periods_100.X
                        - Text_Input_FY_101:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.fy
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: =
                              OnSelect: =
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_FY_102.Width
                              X: =Text_FY_102.X - Gallery_Add_Pay_Periods_100.X
                        - Text_Input_Pay_Period_101:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.pay_period
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: =
                              OnSelect: =
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Pay_Period_102.Width
                              X: =Text_Pay_Period_102.X - Gallery_Add_Pay_Periods_100.X
                        - Separator_Gallery_Add_Pay_Periods_100:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Text_Pay_Period_End_101:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_New_Pay_Periods_100.Height
                        Size: =23
                        Text: ="End Date"
                        Width: =Text_Pay_Period_Start_101.Width
                        X: =Gallery_Add_Pay_Periods_100.Width + Gallery_Add_Pay_Periods_100.X - Self.Width
                        Y: =Text_New_Pay_Periods_100.Y + Text_New_Pay_Periods_100.Height
                  - Text_Pay_Period_Start_101:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_New_Pay_Periods_100.Height
                        Size: =23
                        Text: ="Start Date"
                        Width: =Parent.Width/4
                        X: =Text_Pay_Period_End_101.X - Self.Width - 10
                        Y: =Text_New_Pay_Periods_100.Y + Text_New_Pay_Periods_100.Height
                  - Text_FY_102:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_New_Pay_Periods_100.Height
                        Size: =23
                        Text: ="FY"
                        Width: =Text_Pay_Period_102.Width
                        X: =Text_Pay_Period_102.X + Text_Pay_Period_102.Width + 10
                        Y: =Text_New_Pay_Periods_100.Y + Text_New_Pay_Periods_100.Height
                  - Text_Pay_Period_102:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_New_Pay_Periods_100.Height
                        Size: =23
                        Text: ="Pay Period"
                        Width: =(Text_Pay_Period_Start_101.X - Self.X - 20)/2
                        X: =Parent.Width/40
                        Y: =Text_New_Pay_Periods_100.Y + Text_New_Pay_Periods_100.Height
                  - Text_New_Pay_Periods_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =24
                        Text: ="Add New Pay Periods"
                        Width: =Parent.Width
            - Container_Salary_Notes_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: |-
                    =If(
                        IsBlank(varAddNotes), false, true)
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Notes_Done_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              CountRows(Filter(colSalaryNotes, salary_cost_id = varAddNotes.salary_id, new_salary_num = varAddNotes.new_salary_num, IsBlank(notes))) = 0,
                              UpdateContext({varAddNotes:Blank()}),
                              Notify("PLEASE REMOVE ANY BLANK NOTES", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Gallery_Salary_Notes_100:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Button_Notes_Done_100.Y - Self.Y - Parent.Height/30
                        Items: =Sort(Filter(colSalaryNotes, salary_cost_id = varAddNotes.salary_id, new_salary_num = varAddNotes.new_salary_num), updated_on, SortOrder.Descending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateSize: =Text_Input_Change_User_100.Height
                        Width: =Parent.Width
                        Y: =Text_Note_100.Y + Text_Note_100.Height
                      Children:
                        - Icon_Remove_Note_100:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: |-
                                =If(
                                    varUser.tour_id = ThisItem.created_tour ||
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colTrip,1).trip_oic, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(IsBlank(ThisItem.salary_note_id), 
                                    Remove(colSalaryNotes, ThisItem),
                                    Collect(colRemoveSalaryNotes, ThisItem);
                                    Remove(colSalaryNotes, ThisItem));

                                UpdateContext({varReadyToSubmit:false});
                                UpdateContext({varSalaryNoteChange: true});
                              Width: =Self.Height
                              X: =Parent.TemplateWidth - Self.Width - 10
                        - Text_Input_Note_Date_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.updated_on
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_Date_100.Width
                              X: =Text_Note_Date_100.X
                        - Text_Input_Note_Creator_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.created_name
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_Creator_100.Width
                              X: =Text_Note_Creator_100.X
                        - Text_Input_Note_100:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.notes
                              DisplayMode: |-
                                =If(
                                    varUser.tour_id = ThisItem.created_tour ||
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colTrip,1).trip_oic, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: |-
                                =Patch(colSalaryNotes, ThisItem, 
                                    {notes: Upper(Self.Text),  
                                    updated_on: Today()});

                                UpdateContext({varSalaryNoteChange: true});
                                UpdateContext({varReadyToSubmit: false});
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_100.Width
                              X: =Text_Note_100.X
                        - Separator_Gallery_Salary_Notes_100:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Note_100:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Text_Input_Change_User_100.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colSalaryNotes,
                              {salary_note_id: Blank(), 
                              salary_cost_id: varAddNotes.salary_id,
                              new_salary_num: varAddNotes.new_salary_num,  
                              notes: Blank(), 
                              created_tour: varUser.tour_id,
                              created_name: varUser.name, 
                              updated_on: Blank(),
                              new_note_num: Max(colSalaryNotes, new_note_num) + 1});

                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varSalaryNoteChange: true});
                        Width: =Self.Height
                        X: =Gallery_Salary_Notes_100.Width - Self.Width - 10
                        Y: =Text_Note_Creator_100.Y
                  - Text_Note_Date_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_100.Height
                        Size: =23
                        Text: ="Updated On"
                        Width: =Parent.Width/6
                        X: =Icon_Add_Note_100.X - Self.Width - 10
                        Y: =Text_Traveler_Notes_100.Y + Text_Traveler_Notes_100.Height
                  - Text_Note_Creator_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_100.Height
                        Size: =23
                        Text: ="Created By"
                        Width: =Parent.Width/4
                        X: =Text_Note_Date_100.X - Self.Width - 10
                        Y: =Text_Traveler_Notes_100.Y + Text_Traveler_Notes_100.Height
                  - Text_Note_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_100.Height
                        Size: =23
                        Text: ="Notes"
                        Width: =Text_Note_Creator_100.X - 10
                        X: =Text_Traveler_Notes_100.X
                        Y: =Text_Traveler_Notes_100.Y + Text_Traveler_Notes_100.Height
                  - Text_Traveler_Notes_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_100.Height
                        Size: =24
                        Text: ="Notes"
                        Width: =Parent.Width
            - Container_Arrive_Fac_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =varArriveFac
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Button_Arrive_Fac_101:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |
                          =If(
                              Not(IsBlank(Dropdown_Name_101.Selected.tour_id)), 

                              UpdateContext({varShowSpinner:true});

                              ForAll(
                                  colSalaryCost As cost, 
                                  Patch(salary_costs, LookUp(salary_costs, salary_cost_id = cost.salary_id), 
                                      {tour_id: Dropdown_Name_101.Selected.tour_id, 
                                      last_name: Blank(), 
                                      first_name: Blank()}));

                              Set(varFacSalary, Blank());

                              UpdateContext({varSalaryCostChange: Blank()});
                              UpdateContext({varSalaryNoteChange: Blank()});
                              UpdateContext({varAddNotes:Blank()});
                              UpdateContext({varAddPayPeriods:Blank()});
                              UpdateContext({varPayPeriodChange:Blank()});
                              UpdateContext({varReadyToSubmit:Blank()});
                              UpdateContext({varShowSpinner:false});
                              UpdateContext({varArriveFac:false});
                              UpdateContext({varControlNum:Blank()});

                              ClearCollect(colSalaryCost, 
                                      {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});

                              ClearCollect(colAddSalary, 
                                      {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

                              Clear(colSalaryNotes);
                              Clear(colNewPayPeriods);
                              Clear(colPayPeriodCosts);
                              Clear(colPayPeriods);
                              Clear(colRemoveSalaryCost);
                              Clear(colRemoveSalaryNotes);

                              Refresh(pay_period_cost_view);

                              Refresh(salary_costs_view);
                              Refresh(salary_notes_view);
                              Reset(Gallery_Salary_90);

                              UpdateContext({varShowSpinner:false});

                              If(
                                  Not(IsBlank(varReturnScreen)), 
                                  Navigate(varReturnScreen),
                                  Navigate(Screen_Salary_Overview_90)), 

                              Notify("PLEASE ENSURE YOU HAVE SELECTED A NAME FROM THE DROPDOWN LIST", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="OK"
                        Width: =Button_Cancel_Arrive_Fac_100.Width
                        X: =Parent.Width/5 + Button_Cancel_Arrive_Fac_100.X + Button_Cancel_Arrive_Fac_100.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Button_Cancel_Arrive_Fac_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Dropdown_Name_101);
                          UpdateContext({varArriveFac: false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Parent.Width/5
                        X: =Parent.Width/5
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Text_Tour_ID_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height*2
                        Size: =23
                        Text: ="Please select the faculty in the dropdown below and click 'OK' to arrive him/her"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/10
                  - Dropdown_Name_101:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Last_Name_100.Height
                        Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                        OnChange: |-
                          =/*
                          Patch(colPurchase, Index(colPurchase,1), 
                              {recipient_tour: Self.Selected.tour_id,
                              recipient_name: Self.Selected.name});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                          */
                        Width: =Parent.Width/2
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Text_Tour_ID_100.Y + Text_Tour_ID_100.Height + Parent.Height/20
                      Children:
                        - name4:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="name"
                              FieldName: ="name"
                              FieldType: ="s"
                              Order: =1
                        - tour_id4:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="tour_id"
                              FieldName: ="tour_id"
                              FieldType: ="n"
                              Order: =2
            - Container_Generate_RPF_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =varGenerateRPF
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Text_Input_Description_81:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HintText: =
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_Generate_RPF_102.X + Text_Generate_RPF_102.Width
                        Y: =Text_Generate_RPF_102.Y
                  - Button_Cancel_Generate_Memo_81:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Dropdown_FY_101);
                          Reset(Text_Input_Description_81);
                          Reset(Text_Input_Description_82);
                          UpdateContext({varGenerateRPF: false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Parent.Width/5
                        X: =Parent.Width/5
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Button_Generate_Memo_81:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              Not(IsBlank(Dropdown_FY_101.Selected.reason)) &&
                              Not(IsBlank(Text_Input_Description_81.Text)) &&
                              Not(IsBlank(Text_Input_Description_82.Text)), 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =UpdateContext({varShowSpinner:true});
                          'Math-SalaryGenerateForm'.Run(
                              Dropdown_FY_101.Selected.reason,
                              Text_Input_Description_81.Text,  
                              Text_Input_Description_82.Text, 
                              If(
                                  CountRows(colSalaryCost) > 0,
                                  Index(colSalaryCost,1).salary_start_date, 
                                  ""), 
                              If(
                                  CountRows(colSalaryCost) > 0,
                                  Index(colSalaryCost,1).salary_end_date, 
                                  ""), 
                              If(
                                  CountRows(colSalaryCost) > 0,
                                  Concatenate("$", Abs(Index(colSalaryCost,1).projected_salary)), 
                                  ""), 
                              If(
                                  CountRows(colSalaryCost) > 0,
                                  LookUp(colBudgets, budget_id = Index(colSalaryCost,1).budget_id).mipr_num, 
                                  ""), 
                              If(
                                  CountRows(colSalaryCost) > 0,
                                  LookUp(colBudgets, budget_id = Index(colSalaryCost,1).budget_id).wbs_cost_center, 
                                  ""), 
                              Concatenate("$", Sum(colSalaryCost, Abs(projected_salary))),
                              Concatenate(
                                  LookUp(colFaculty, pos_title = "DIRECTOR" && center_id = 6).first_name, 
                                  " ", 
                                  LookUp(colFaculty, pos_title = "DIRECTOR" && center_id = 6).last_name),
                              Concatenate(
                                  LookUp(colFaculty, dept_pos = "XO").first_name, 
                                  " ", 
                                  LookUp(colFaculty, dept_pos = "XO").last_name),
                              LookUp(colFaculty, pos_title = "DIRECTOR" && center_id = 6).wp_email, 
                              {text_9: 
                                  If(
                                      CountRows(colSalaryCost) > 1,
                                      Index(colSalaryCost,2).salary_start_date, 
                                  ""), 
                              text_10:
                                  If(
                                      CountRows(colSalaryCost) > 1,
                                      Index(colSalaryCost,2).salary_end_date, 
                                  ""),
                              text_11:
                                  If(
                                      CountRows(colSalaryCost) > 1,
                                      Concatenate("$", Abs(Index(colSalaryCost,2).projected_salary)), 
                                  ""),
                              text_12:
                                  If(
                                      CountRows(colSalaryCost) > 1,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,2).budget_id).mipr_num, 
                                  ""),
                              text_13:
                                  If(
                                      CountRows(colSalaryCost) > 1,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,2).budget_id).wbs_cost_center, 
                                  ""),
                              text_14:
                                  If(
                                      CountRows(colSalaryCost) > 2,
                                      Index(colSalaryCost,3).salary_start_date, 
                                  ""),
                              text_15:
                                  If(
                                      CountRows(colSalaryCost) > 2,
                                      Index(colSalaryCost,3).salary_end_date, 
                                  ""),
                              text_16:
                                  If(
                                      CountRows(colSalaryCost) > 2,
                                      Concatenate("$", Abs(Index(colSalaryCost,3).projected_salary)), 
                                  ""),
                              text_17:
                                  If(
                                      CountRows(colSalaryCost) > 2,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,3).budget_id).mipr_num, 
                                  ""),
                              text_18:
                                  If(
                                      CountRows(colSalaryCost) > 2,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,3).budget_id).wbs_cost_center, 
                                  ""),
                              text_19: 
                                  If(
                                      CountRows(colSalaryCost) > 3,
                                      Index(colSalaryCost,4).salary_start_date, 
                                  ""),
                              text_20:
                                  If(
                                      CountRows(colSalaryCost) > 3,
                                      Index(colSalaryCost,4).salary_end_date, 
                                  ""),
                              text_21:
                                  If(
                                      CountRows(colSalaryCost) > 3,
                                      Concatenate("$", Abs(Index(colSalaryCost,4).projected_salary)), 
                                  ""),
                              text_22:
                                  If(
                                      CountRows(colSalaryCost) > 3,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,4).budget_id).mipr_num, 
                                  ""),
                              text_23:
                                  If(
                                      CountRows(colSalaryCost) > 3,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,4).budget_id).wbs_cost_center, 
                                  ""),
                              text_24:
                                  If(
                                      CountRows(colSalaryCost) > 4,
                                      Index(colSalaryCost,5).salary_start_date, 
                                  ""),
                              text_25:
                                  If(
                                      CountRows(colSalaryCost) > 4,
                                      Index(colSalaryCost,5).salary_end_date, 
                                  ""),
                              text_26:
                                  If(
                                      CountRows(colSalaryCost) > 4,
                                      Concatenate("$", Abs(Index(colSalaryCost,5).projected_salary)), 
                                  ""),
                              text_27:
                                  If(
                                      CountRows(colSalaryCost) > 4,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,5).budget_id).mipr_num, 
                                  ""),
                              text_28:
                                  If(
                                      CountRows(colSalaryCost) > 4,
                                      LookUp(colBudgets, budget_id = Index(colSalaryCost,5).budget_id).wbs_cost_center, 
                                  "")});

                          Reset(Dropdown_FY_101);
                          Reset(Text_Input_Description_81);
                          Reset(Text_Input_Description_82);

                          Set(varFacSalary, Blank());

                          UpdateContext({varSalaryCostChange: Blank()});
                          UpdateContext({varSalaryNoteChange: Blank()});
                          UpdateContext({varAddNotes:Blank()});
                          UpdateContext({varAddPayPeriods:Blank()});
                          UpdateContext({varPayPeriodChange:Blank()});
                          UpdateContext({varReadyToSubmit:Blank()});
                          UpdateContext({varShowSpinner:false});
                          UpdateContext({varArriveFac:false});
                          UpdateContext({varControlNum:Blank()});

                          ClearCollect(colSalaryCost, 
                                  {salary_id: Blank(), fy: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), step: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_complete: Blank(), salary_start_date: Blank(), salary_end_date: Blank(), updated_on: Blank()});

                          ClearCollect(colAddSalary, 
                                  {salary_id: Blank(), budget_id: Blank(), budget_name: Blank(), cntrl_num: Blank(), tour_id: Blank(), projected_salary: Blank(), disbursed_salary: Blank(), salary_start_date: Blank(), step: Blank(), updated_on: Blank()});

                          Clear(colSalaryNotes);
                          Clear(colNewPayPeriods);
                          Clear(colPayPeriodCosts);
                          Clear(colPayPeriods);
                          Clear(colRemoveSalaryCost);
                          Clear(colRemoveSalaryNotes);

                          Refresh(pay_period_cost_view);
                          Refresh(salary_notes_view);
                          Refresh(salary_costs_view);

                          Reset(Gallery_Salary_90);

                          UpdateContext({varShowSpinner:false});

                          If(
                              Not(IsBlank(varReturnScreen)), 
                              Navigate(varReturnScreen),
                              Navigate(Screen_Salary_Overview_90))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Generate RPF"
                        Width: =Button_Cancel_Generate_Memo_81.Width
                        X: =Parent.Width/5 + Button_Cancel_Generate_Memo_81.X + Button_Cancel_Generate_Memo_81.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/10
                  - Text_Generate_RPF_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="Please provide the following details to generate the RPF"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/40
                  - Dropdown_FY_101:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Last_Name_100.Height
                        Items: =Sort(colRPFReasons, reason, SortOrder.Ascending)
                        OnChange: |-
                          =/*
                          Patch(colPurchase, Index(colPurchase,1), 
                              {recipient_tour: Self.Selected.tour_id,
                              recipient_name: Self.Selected.name});
                          UpdateContext({varReadyToSubmit:false});
                          UpdateContext({varPurchaseChange: true})
                          */
                        Width: =Parent.Width/4
                        X: =Text_Generate_RPF_101.X + Text_Generate_RPF_101.Width
                        Y: =Text_Generate_RPF_101.Y
                      Children:
                        - reason1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="reason"
                              FieldName: ="reason"
                              FieldType: ="s"
                              Order: =1
                  - Text_Generate_RPF_101:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="Reason"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width/8
                        X: =Parent.Width/40
                        Y: =Text_Generate_RPF_100.Y + Text_Generate_RPF_100.Height + Parent.Height/40
                  - Text_Generate_RPF_102:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="Incumbent"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width/6
                        X: =Dropdown_FY_101.X + Dropdown_FY_101.Width + Parent.Width/40
                        Y: =Text_Generate_RPF_100.Y + Text_Generate_RPF_100.Height + Parent.Height/40
                  - Text_Generate_RPF_103:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height
                        Size: =23
                        Text: ="Position"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width/8
                        X: =(Parent.Width - Self.Width - Text_Input_Description_82.Width)/2
                        Y: =Text_Generate_RPF_101.Y + Text_Generate_RPF_101.Height + Parent.Height/10
                  - Text_Input_Description_82:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HintText: =
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width/3
                        X: =Text_Generate_RPF_103.X + Text_Generate_RPF_103.Width
                        Y: =Text_Generate_RPF_103.Y
            - Container_Control_Num_100:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  Visible: =Not(IsBlank(varControlNum))
                  Width: =Parent.Width/2
                  X: =(Parent.Width - Self.Width)/2
                  Y: =(Parent.Height - Self.Height)/2
                Children:
                  - Button_Close_Control_Num_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              Not(IsBlank(Text_Input_Control_Num_100.Text)),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Patch(colSalaryCost, LookUp(colSalaryCost, salary_id = varControlNum.salary_id && new_salary_num = varControlNum.new_salary_num), 
                              {cntrl_num: Upper(Text_Input_Control_Num_100.Text)});

                          Reset(Text_Input_Control_Num_100);

                          UpdateContext({varControlNum:Blank()});

                          UpdateContext({varReadyToSubmit:false});

                          UpdateContext({varSalaryCostChange:true});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="OK"
                        Width: =Button_Cancel_Control_Num_100.Width
                        X: =Parent.Width/5 + Button_Cancel_Control_Num_100.X + Button_Cancel_Control_Num_100.Width
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Button_Cancel_Control_Num_100:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Red
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Text_Input_Control_Num_100);
                          UpdateContext({varControlNum: Blank()});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Cancel"
                        Width: =Parent.Width/5
                        X: =Parent.Width/5
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Text_Input_Control_Num_100:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =LookUp(colSalaryCost, salary_id = varControlNum.salary_id && new_salary_num = varControlNum.new_salary_num).cntrl_num
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Last_Name_100.Height
                        HintText: =
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: =
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width/3
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Text_Generate_RPF_103.Y
                  - Text_Control_Num_100:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Last_Name_100.Height*2
                        Size: =23
                        Text: =Concatenate("Please enter a Control Number for Salary Cost ID ", varControlNum.salary_id)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width
                        Y: =Parent.Height/10
            - Spinner_100:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Header_Salary_Details_100:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Salary_Details_100:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Salary Details"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_100:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_100:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40





// Screen_Welcome_Add_Access_110

Screens:
  Screen_Welcome_Add_Access_110:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Add_Access_110:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height-Container_Add_Access_Header_110.Height
            Width: =Parent.Width
            Y: =Container_Add_Access_Header_110.Height
          Children:
            - Container_Supply_Print_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height - Self.Y - Parent.Height/20
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Visible: =false
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Container_Travel_TDY_1.X + Container_Travel_TDY_1.Width + Parent.Width/30
                  Y: =Container_Assign_APD_110.Y
                Children:
                  - Icon_Supply_Print_1:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              Not(IsBlank(varUser.tour_id)), DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.ShoppingCart
                        OnSelect: "=Refresh(purchase_cost_view);\r\n\r\nClearCollect(colFaculty, \r\n    {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});\r\n\r\nCollect(colFaculty, \r\n    ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));\r\n\r\nClearCollect(colPurchaseTypes, {purchase_type: Blank()});\r\n\r\nCollect(colPurchaseTypes, ShowColumns(lookup_purchase_types, purchase_type, special_instructions));\r\n\r\nClearCollect(colBudgets, \r\n    {budget_id: Blank(), budget_name: Blank(), budget_type: Blank(), funding_type: Blank(), loa: Blank(), mipr_num: Blank(), wbs_cost_center: Blank(), received_date: Blank(), expire_date: Blank(), pop_date: Blank(), center_id: Blank(), center_abbrev: Blank(), fee_amount: Blank(), gift_amount: Blank(), supply_amount: Blank(), print_amount: Blank(),salary_amount: Blank(), travel_amount: Blank(), total_amount: Blank(), director_tour: Blank(), director_name: Blank(), budget_updated_on: Blank(), spend_plan_updated_on: Blank()});\r\n    \r\nCollect(colBudgets, \r\n    Sort(ShowColumns(current_budget_view, budget_id, budget_name, budget_type, funding_type, loa, mipr_num, wbs_cost_center, received_date, expire_date, pop_date, center_id, center_abbrev, fee_amount, gift_amount, supply_amount, print_amount, salary_amount, travel_amount, total_amount, director_tour, director_name, budget_updated_on, days_to_expire),budget_name, SortOrder.Ascending));\r\n\r\nReset(Gallery_Purchases_70);\r\n\r\nNavigate(Screen_Purchase_Overview_70);"
                        Tooltip: ="Coming Soon"
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
                  - Text_Supply_Print_1:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Purchase Request"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Supply_Print_1.Height + Parent.Height/10
            - Container_Travel_TDY_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height - Self.Y - Parent.Height/20
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Container_Assign_APD_110.X + Container_Assign_APD_110.Width + Parent.Width/30
                  Y: =Container_Assign_APD_110.Y
                Children:
                  - Icon_Travel_TDY_1:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varUser.dept_pos = "P5" ||
                              varUser.dept_pos = "P6",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.Key
                        OnSelect: |-
                          =ClearCollect(colFaculty, 
                              {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});

                          Collect(colFaculty, 
                              ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));

                          Navigate(Screen_Assign_Permissions_140)
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
                  - Text_Travel_TDY_1:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Manage App Permissions"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Travel_TDY_1.Height + Parent.Height/10
            - Container_Assign_APD_110:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Parent.Height - Self.Y - Parent.Height/20
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Parent.Width/30
                  Y: =Container_Salary_110.Height + Container_Salary_110.Y + Parent.Height/20
                Children:
                  - Icon_Assign_APD_110:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "S1" ||
                              Not(IsBlank(varUser.apd)) ||
                              varUser.dept_pos = "P5" ||
                              varUser.dept_pos = "P6",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.LogJournal
                        OnSelect: |-
                          =ClearCollect(colFaculty, 
                              {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});

                          Collect(colFaculty, 
                              ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));

                          ClearCollect(colClassOfferings, 
                              {offering_id: Blank(), ay: Blank(), semester: Blank(), class_num: Blank(), class_name: Blank(), credit_hours: Blank(), name_program: Blank(), apd: Blank(), apd_name: Blank(), apd_email: Blank(), apd_num: 0});

                          Collect(colClassOfferings,
                              ShowColumns(current_classes_view, offering_id, ay, semester, class_num, class_name, credit_hours, name_program, apd, apd_name, apd_email));

                          ClearCollect(colPDs, 
                              {program_pos_id: Blank(), name_program: Blank(), pos_title: Blank(), tour_id: Blank(), pd_num: 0, updated_on: Blank()});

                          Collect(colPDs, 
                              ShowColumns(FirstN(Sort(program_pos, updated_on, SortOrder.Descending),20), program_pos_id, name_program, pos_title, tour_id, updated_on));

                          Navigate(Screen_Assign_APD_130);
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
                  - Text_Assign_APD_110:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="APD-Course Assignment"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Assign_APD_110.Height + Parent.Height/10
            - Container_Budget_Ledger_110:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =(Parent.Height - 3*Self.Y)/2
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Parent.Width/30 + Container_Salary_110.X + Container_Salary_110.Width
                  Y: =Parent.Height/20
                Children:
                  - Icon_Budget_Ledger_110:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.dept_pos = "P5" ||
                              varUser.dept_pos = "P6",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.Money
                        OnSelect: "=ClearCollect(colFaculty, \r\n    {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});\r\n\r\nCollect(colFaculty, \r\n    ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));\r\n\r\nClearCollect(colBudgets, \r\n    {budget_id: Blank(), new_budget_num: Blank(), budget_name: Blank(), budget_type: Blank(), funding_type: Blank(), loa: Blank(), mipr_num: Blank(), wbs_cost_center: Blank(), received_date: Blank(), expire_date: Blank(), pop_date: Blank(), center_id: Blank(), center_abbrev: Blank(), total_amount: Blank(), director_tour: Blank(), director_name: Blank(), budget_updated_on: Blank(), spend_plan_updated_on: Blank(), budget_sponsor_id: Blank()});\r\n    \r\nCollect(colBudgets, \r\n    Sort(ShowColumns(current_budget_view, budget_id, budget_name, budget_type, funding_type, loa, mipr_num, wbs_cost_center, received_date, expire_date, pop_date, center_id, center_abbrev, total_amount, director_tour, director_name, budget_updated_on, days_to_expire, budget_sponsor_id),budget_name, SortOrder.Ascending));\r\n\r\nClearCollect(colSpendPlans, \r\n    Sort(ShowColumns(current_budget_view, budget_id, budget_name, fee_amount, gift_amount, supply_amount, print_amount, salary_amount, travel_amount, total_amount, spend_plan_updated_on), spend_plan_updated_on, SortOrder.Descending));\r\n\r\nClearCollect(colTotalCosts, \r\n    ShowColumns(total_costs_view, budget_id, budget_name, fee_costs, gift_costs, print_costs, supply_costs, salary_costs, travel_costs, total_costs));\r\n\r\nClearCollect(colBudgetNotes, \r\n    ShowColumns(budget_notes_view, budget_note_id, budget_id, notes, created_tour, created_name, updated_on));\r\n\r\nClearCollect(colLookupCollaborators, \r\n    {collab_email: Blank(), collab_id: Blank(), collab_name: Blank(), first_name: Blank(), last_name: Blank(), org_and_parent: Blank(), org_id: Blank()});\r\n\r\nCollect(colLookupCollaborators, lookup_collab_view);\r\n\r\nClearCollect(colLookupOrgs, lookup_org_view);\r\n\r\nClearCollect(colBudgetSponsors, \r\n    ShowColumns(budget_sponsor_view, budget_sponsor_id, spon_collab_id, budget_id, budget_name, collab_email, last_name, first_name, collab_name, org_id, org_and_parent));\r\n\r\nClearCollect(colFeesDeposits,\r\n    ShowColumns(current_fees_deposits_view, category, fee_id, deposit_id, cntrl_num, budget_id, amount, spend_date, deposit_date, notes, updated_on));\r\n\r\nClearCollect(colCenters, {center_id: Blank(), center_abbrev: Blank(), center_name: Blank(), center_type: Blank()});\r\n\r\nCollect(colCenters, ShowColumns(lookup_center, center_id, center_abbrev, center_name, center_type));\r\n\r\nClearCollect(colPurchaseTypes, {purchase_type: Blank()});\r\nCollect(colPurchaseTypes, ShowColumns(lookup_purchase_types, purchase_type, special_instructions));\r\n\r\nClearCollect(colCostStatus, {cost_status: Blank()});\r\nCollect(colCostStatus, ShowColumns(lookup_cost_status, cost_status));\r\n\r\nClearCollect(colBudgetTypes, {budget_type: Blank()});\r\nCollect(colBudgetTypes, ShowColumns(lookup_budget_type, budget_type));\r\n\r\nClearCollect(colFundingTypes, {funding_type: Blank()});\r\nCollect(colFundingTypes, ShowColumns(lookup_funding_type, funding_type));\r\n\r\nClearCollect(colBudgetLedger,\r\n    ShowColumns(budget_ledger_view, category, fy, cntrl_num, trip_id, ID, budget_name, budget_id, budget_type, tour_id, last_name, first_name, name, email, purpose, doc_num, projected_cost, committed_cost, disbursed_cost, status, trip_start));\r\n\r\nCollect(colBudgetLedger, \r\n    {category: Blank(), fy: Blank(), cntrl_num: Blank(), trip_id: Blank(), ID: Blank(), budget_name: Blank(), budget_id: Blank(), budget_type: Blank(), tour_id: Blank(), last_name: Blank(), first_name: Blank(), name: Blank(), email: Blank(), purpose: Blank(), doc_num: Blank(), projected_cost: Blank(), committed_cost: Blank(), disbursed_cost: Blank(), status: Blank(), new_budget_num: Blank(), trip_start: Blank()});\r\n\r\nNavigate(Screen_Budget_Ledger_120)"
                        Tooltip: =
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
                  - Text_Budget_Ledger_110:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Budget Ledger"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Budget_Ledger_110.Height + Parent.Height/10
            - Container_Salary_110:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =(Parent.Height - 3*Self.Y)/2
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Container_Assign_APD_110.X + Container_Assign_APD_110.Width + Parent.Width/30
                  Y: =Parent.Height/20
                Children:
                  - Icon_Salary_110:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.dept_pos = "P5" ||
                              varUser.dept_pos = "P6",
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Self.Width
                        Icon: =Icon.People
                        OnSelect: "=Refresh(salary_costs_view);\n\nClearCollect(colFaculty, \n    {last_name: Blank(), first_name: Blank(), name: Blank(), tour_id: Blank(), usma_pers_id: Blank(), wp_email: Blank(), center_id: Blank(), center_abbrev: Blank(), pos_title: Blank(), rank_title: Blank(), program_pos_id: Blank(), name_program: Blank(), dept_pos: Blank(), office_phone: Blank()});\n\nCollect(colFaculty, \n    ShowColumns(current_fac_view, last_name, first_name, name, tour_id, usma_pers_id, wp_email, center_id, center_abbrev, pos_title, rank_title, program_pos_id, name_program, dept_pos, office_phone));\n\nClearCollect(colBudgets, \n    {budget_id: Blank(), budget_name: Blank(), budget_type: Blank(), funding_type: Blank(), loa: Blank(), mipr_num: Blank(), wbs_cost_center: Blank(), received_date: Blank(), expire_date: Blank(), pop_date: Blank(), center_id: Blank(), center_abbrev: Blank(), fee_amount: Blank(), gift_amount: Blank(), supply_amount: Blank(), print_amount: Blank(),salary_amount: Blank(), travel_amount: Blank(), total_amount: Blank(), director_tour: Blank(), director_name: Blank(), budget_updated_on: Blank(), spend_plan_updated_on: Blank()});\n    \nCollect(colBudgets, \n    Sort(ShowColumns(current_budget_view, budget_id, budget_name, budget_type, funding_type, loa, mipr_num, wbs_cost_center, received_date, expire_date, pop_date, center_id, center_abbrev, fee_amount, gift_amount, supply_amount, print_amount, salary_amount, travel_amount, total_amount, director_tour, director_name, budget_updated_on, days_to_expire),budget_name, SortOrder.Ascending));\n\nReset(Gallery_Salary_90);\n\nNavigate(Screen_Salary_Overview_90)"
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
                  - Text_Salary_110:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Salary"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Salary_110.Height + Parent.Height/10
            - Container_Home_110:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =(Parent.Height - 3*Self.Y)/2
                  RadiusBottomLeft: =30
                  RadiusBottomRight: =30
                  RadiusTopLeft: =30
                  RadiusTopRight: =30
                  Width: =(Parent.Width - 4*Parent.Width/30)/3
                  X: =Parent.Width/30
                  Y: =Parent.Height/20
                Children:
                  - Text_Home_110:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Height: =Parent.Height/10
                        Size: =20
                        Text: ="Home"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =Parent.Width
                        Y: =Icon_Home_110.Height + Parent.Height/10
                  - Icon_Home_110:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Black
                        Height: =Self.Width
                        Icon: =Icon.Home
                        OnSelect: =Navigate(Screen_Welcome_User_00)
                        Tooltip: =
                        Width: =Parent.Width/2.5
                        X: =(Parent.Width - Self.Width)/2
                        Y: =Parent.Height/10
      - Container_Add_Access_Header_110:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Add_Access_Header_110:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =
                  Style: ='Header.Style'.Primary
                  Title: ="Welcome to the Math App - Additional Access"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_110:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_110:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Budget_Ledger_120

Screens:
  Screen_Budget_Ledger_120:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Budget_Ledger_120:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height-Container_Budget_Ledger_Header_120.Height
            Width: =Parent.Width
            Y: =Container_Budget_Ledger_Header_120.Height
          Children:
            - Gallery_Budgets_120:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Height: =Text_Input_Change_User_120.Height*1.5
                  Items: =colBudgets
                  TemplateSize: =Self.Width/10
                  Width: =Parent.Width
                  Y: =Parent.Height - Self.Height
                Children:
                  - Button_Budget_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: |-
                          =If(
                              ThisItem.days_to_expire > 90, 
                              If(
                                  ThisItem.IsSelected, 
                                  Color.Green, 
                                  ColorFade(Color.Green, .6)), 

                              If(
                                  ThisItem.days_to_expire > 0, 
                                  If(
                                      ThisItem.IsSelected, 
                                      Color.Yellow, 
                                      ColorFade(Color.Yellow, .6)), 

                                  If(
                                      ThisItem.IsSelected, 
                                      Color.Red, 
                                      ColorFade(Color.Red, .6))))
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=Select(Parent);\r\n\r\nSet(varBudget, \r\n    {budget_id: ThisItem.budget_id, \r\n    new_budget_num: ThisItem.new_budget_num,\r\n    budget_name: ThisItem.budget_name, \r\n    budget_type: ThisItem.budget_type, \r\n    funding_type: ThisItem.funding_type, \r\n    loa: ThisItem.loa, \r\n    mipr_num: ThisItem.mipr_num, \r\n    wbs_cost_center: ThisItem.wbs_cost_center, \r\n    received_date: ThisItem.received_date, \r\n    expire_date: ThisItem.expire_date, \r\n    pop_date: ThisItem.pop_date, \r\n    center_id: ThisItem.center_id, \r\n    center_abbrev: ThisItem.center_abbrev, \r\n    director_tour: ThisItem.director_tour, \r\n    director_name: ThisItem.director_name,  \r\n    total_amount: ThisItem.total_amount, \r\n    budget_updated_on: ThisItem.budget_updated_on, \r\n    spend_plan_updated_on: ThisItem.spend_plan_updated_on, \r\n    budget_sponsor_id: ThisItem.budget_sponsor_id}) \r\n\r\n\r\n    "
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: =ThisItem.budget_name
                        Width: =Parent.TemplateWidth
            - Container_Budget_Costs_120:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Gallery_Budgets_120.Y - Self.Y - Parent.Height/50
                  Width: =Parent.Width*73/75
                  X: =Parent.Width/75
                  Y: =Container_Budget_Details_120.Height + Parent.Height/50
                Children:
                  - Text_Extended_Cost_81:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Extended Cost"
                        Width: =Text_Sponsor_Name_120.Width
                        X: =Text_Purpose_120.X + Text_Purpose_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Gallery_Ledger_120:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Height: =Parent.Height - Self.Y
                        Items: |-
                          =If(
                              Not(IsBlank(Text_Input_Budget_Search_120.Text)), 
                              Sort(Filter(colBudgetLedger, Upper(Text_Input_Budget_Search_120.Text) in budget_name), cntrl_num, SortOrder.Descending), 

                              If(
                                  Not(IsBlank(Text_Input_Control_Num_Search_120.Text)), 
                                  Sort(Filter(colBudgetLedger, Upper(Text_Input_Control_Num_Search_120.Text) in cntrl_num), cntrl_num, SortOrder.Ascending), 

                                  If(
                                      Not(IsBlank(Text_Input_Purpose_Search_120.Text)), 
                                      Sort(Filter(colBudgetLedger, Upper(Text_Input_Purpose_Search_120.Text) in purpose), cntrl_num, SortOrder.Ascending), 

                                      If(
                                          Not(IsBlank(Text_Input_Name_Search_120.Text)), 
                                          Sort(Filter(colBudgetLedger, Upper(Text_Input_Name_Search_120.Text) in name), cntrl_num, SortOrder.Ascending), 

                                          Sort(Filter(colBudgetLedger, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), cntrl_num, SortOrder.Ascending)))))
                        TemplateSize: =Text_Input_Change_User_120.Height
                        Width: =Parent.Width
                        X: =Text_Category_120.X
                        Y: =Text_Category_120.Y + Text_Category_120.Height
                      Children:
                        - Icon_Details_120:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(0, 18, 107, 1)
                              Height: =Text_Input_Change_User_120.Height
                              Icon: =Icon.DetailList
                              OnSelect: "=Set(varReturnScreen, App.ActiveScreen);\r\n\r\nIf(\r\n    ThisItem.category = \"DEPOSIT\" || ThisItem.category = \"FEE\", \r\n    UpdateContext({varShowFeeDep:true}), \r\n\r\n    If(\r\n        ThisItem.category = \"PRINT\" || ThisItem.category = \"SUPPLY\", \r\n        Set(varPurchaseID, ThisItem.ID);\r\n    \r\n        ClearCollect(colPurchase, \r\n            With({\r\n            purchaseRecord: \r\n                ShowColumns(\r\n                    Filter(purchase_cost_view, purchase_cost_id = varPurchaseID), purchase_cost_id, cntrl_num, budget_id, budget_assigned_by, invoice_num, purpose, vendor_name, items_cost, shipping_cost, purchase_cost, purchase_category, purchase_type, purchase_cost_status, date_ordered, certified_fund_date, date_received, gfebs_pr_num, cardholder, cardholder_name, requestor_tour, requestor_name, recipient_tour, recipient_name, updated_on)}, \r\n                Table(purchaseRecord, \r\n                    purchaseRecord)));\r\n\r\n        ClearCollect(colItems, \r\n            ShowColumns(Filter(purchase_items, purchase_cost_id = varPurchaseID), purchase_item_id, purchase_cost_id, item_desc, part_num, quantity, unit_price, total_cost, updated_on));\r\n\r\n        ClearCollect(colPurchaseNotes, \r\n            ShowColumns(Filter(purchase_notes_view, purchase_cost_id = varPurchaseID), purchase_note_id, purchase_cost_id, notes, tour_id, name, updated_on));\r\n\r\n        ClearCollect(colProjectPurchases, \r\n            ShowColumns(Filter(project_purchases, purchase_cost_id = varPurchaseID), project_purchase_id, purchase_cost_id, project_id));\r\n\r\n        Navigate(Screen_Purchase_Details_80),\r\n        \r\n        If(\r\n            ThisItem.category = \"SALARY\",\r\n\r\n            Set(varFacSalary, \r\n            {tour_id: Gallery_Ledger_120.Selected.tour_id, \r\n            last_name: Gallery_Ledger_120.Selected.last_name, \r\n            first_name: Gallery_Ledger_120.Selected.first_name, \r\n            salary_id: Gallery_Ledger_120.Selected.ID,\r\n            fy: Gallery_Ledger_120.Selected.fy});\r\n\r\n            If(\r\n                ThisItem.purpose = \"BASE SALARY\", \r\n\r\n                ClearCollect(colSalaryCost, \r\n                    Sort(ShowColumns(Filter(salary_costs_view, tour_id = varFacSalary.tour_id, last_name = varFacSalary.last_name, first_name = varFacSalary.first_name, salary_type = \"BASE\"), salary_id, fy, budget_id, budget_name, cntrl_num, tour_id, last_name, first_name, step, projected_salary, disbursed_salary, salary_complete, salary_start_date, salary_end_date, updated_on), salary_start_date, SortOrder.Ascending));\r\n\r\n                ClearCollect(colPayPeriodCosts, \r\n                    ShowColumns(Filter(pay_period_cost_view, tour_id = varFacSalary.tour_id, last_name = varFacSalary.last_name, first_name = varFacSalary.first_name), pay_period_cost_id, fy, salary_id, pay_period_id, budget_id, tour_id, last_name, first_name, pay_period, start_date, end_date, projected_amount, disbursed_amount));\r\n\r\n                ClearCollect(colPayPeriods, \r\n                    ShowColumns(FirstN(Sort(pay_period_view, start_date, SortOrder.Descending),108), pay_period_id, fy, pay_period, start_date, end_date));\r\n\r\n                ClearCollect(colSalaryNotes, \r\n                    ShowColumns(Filter(salary_notes_view, fac_tour = varFacSalary.tour_id, fac_last_name = varFacSalary.last_name, fac_first_name = varFacSalary.first_name), salary_note_id, salary_cost_id, notes, fac_tour, fac_last_name, fac_first_name, created_tour, created_name, updated_on));\r\n\r\n                Navigate(Screen_Base_Salary_Details_100), \r\n                \r\n                ClearCollect(colAddSalary, \r\n                    ShowColumns(Filter(add_salary_view, salary_id = varFacSalary.salary_id), salary_id, budget_id, budget_name, cntrl_num, tour_id, projected_salary, disbursed_salary, salary_start_date, step, updated_on));\r\n                \r\n                Navigate(Screen_Salary_Overview_90);\r\n\r\n                Set(varShowAddSalary,true)), \r\n\r\n            If(\r\n                ThisItem.category = \"TRAVEL\", \r\n\r\n                Set(varTrip, \r\n                    {trip_id: ThisItem.trip_id, \r\n                    trip_event: ThisItem.purpose, \r\n                    trip_start: ThisItem.trip_start});\r\n    \r\n                ClearCollect(colTrip, \r\n                    With({\r\n                    tripRecord: \r\n                        ShowColumns(\r\n                            Filter(current_trips_view, trip_id = varTrip.trip_id), trip_id, trip_type, trip_event, trip_start, trip_end, trip_oic, oic_last_name, oic_first_name, oic_name, purpose, trip_summary, destination_city, destination_state, destination_country, destination, gik_approved, gik_submitted, dean_approved, dean_submitted, xo_approved_on, p6_approved_on)}, \r\n                        Table(tripRecord, \r\n                            tripRecord)));\r\n\r\n                ClearCollect(colTravelers, \r\n                    Filter(ShowColumns(current_travel_view, travel_id, trip_id, cntrl_num, usma_pers_id, traveler_last_name, traveler_first_name, traveler_name, pers_type, traveler_email, budget_id, budget_name, loa, split_loa, budget_assigned_by, meal_cost, lodging_cost, rental_cost, pov_cost, airfare_cost, other_cost, cost_desc, travel_cost_committed, travel_cost_disbursed, travel_cost_status, travel_start, travel_end, voucher_submitted_on, voucher_approved_on, travel_doc_num, missing_class, trip_event, trip_start, pd_tour, pd_approved_on, cd_tour, cd_approved_on, xo_tour, xo_approved_on, p6_tour, p6_approved_on), trip_id = varTrip.trip_id));\r\n\r\n                ClearCollect(colTripTypes, \r\n                    {trip_type: Blank()});\r\n                Collect(colTripTypes, lookup_trip_type);\r\n\r\n                ClearCollect(colSections, \r\n                    view_current_sections_procedure.dboviewcurrentsectionsprocedure({travel_start_date:varTrip.trip_start}).ResultSets.Table1);\r\n                        \r\n                ClearCollect(colClassesMissed,\r\n                    Filter(ShowColumns(missed_classes_travel_view, missed_class_id, section_id, missed_date, trip_id, travel_cost_id, covering_fac_tour, class_num, apd, apd_name, approved_on, instructor_tour, apd_tour), trip_id = varTrip.trip_id));\r\n\r\n                ClearCollect(colTravelNotes, \r\n                    Filter(ShowColumns(travel_notes_view, travel_note_id, trip_id, travel_cost_id, notes, tour_id, name, updated_on), trip_id = varTrip.trip_id));\r\n\r\n                ClearCollect(colProjectTravel, \r\n                    ShowColumns(project_travel, project_travel_id, travel_cost_id, project_id));\r\n\r\n                ClearCollect(colAddLocs, \r\n                    Filter(ShowColumns(add_locs_view, add_loc_id, travel_cost_id, trip_id, traveler_last_name, traveler_first_name, traveler_name, leg_start, leg_end, destination_city, destination_state, destination_country), trip_id = varTrip.trip_id));\r\n\r\n                Navigate(Screen_Trip_Details_60)))));\r\n\r\n                            "
                              Width: =Self.Height
                              X: =Parent.Width - Self.Width - 10
                        - Text_Input_Status_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.status
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Status_120.Width
                              X: =Text_Status_120.X
                        - Text_Input_Disbursed_Amount_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =Abs(ThisItem.disbursed_cost)
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Disbursed_Amount_120.Width
                              X: =Text_Disbursed_Amount_120.X
                        - Text_Input_Committed_Amount_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =Abs(ThisItem.committed_cost)
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Committed_Amount_120.Width
                              X: =Text_Committed_Amount_120.X
                        - Text_Input_Projected_Amount_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =Abs(ThisItem.projected_cost)
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Projected_Amount_120.Width
                              X: =Text_Projected_Amount_120.X
                        - Text_Input_Name_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.category = "FEE",
                                    "N/A",
                                    ThisItem.name)
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Name_120.Width
                              X: =Text_Name_120.X
                        - Text_Input_Purpose_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.purpose
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              Mode: =TextMode.MultiLine
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Purpose_120.Width
                              X: =Text_Purpose_120.X
                        - Text_Input_ID_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.ID
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_ID_120.Width
                              X: =Text_ID_120.X
                        - Text_Input_Doc_Num_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.category = "SALARY" ||
                                    ThisItem.category = "FEE",
                                    "N/A",
                                    ThisItem.doc_num)
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Doc_Num_120.Width
                              X: =Text_Doc_Num_120.X
                        - Text_Input_Control_Num_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.cntrl_num
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              Mode: =TextMode.MultiLine
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Control_Num_120.Width
                              X: =Text_Control_Num_120.X
                        - Text_Input_Category_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.category
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: =
                              OnSelect: =//UpdateContext({varTraveler:ThisItem});
                              RadiusBottomLeft: =0
                              RadiusBottomRight: =0
                              RadiusTopLeft: =0
                              RadiusTopRight: =0
                              Width: =Text_Category_120.Width
                              X: =Text_Category_120.X
                        - Separator_Gallery_Ledger_120:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Text_Status_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Status"
                        Width: =Parent.Width/13
                        X: =Text_Disbursed_Amount_120.X + Text_Disbursed_Amount_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Disbursed_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Disbursed"
                        Width: =Parent.Width/13
                        X: =Text_Committed_Amount_120.X + Text_Committed_Amount_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Committed_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Committed"
                        Width: =Parent.Width/12
                        X: =Text_Projected_Amount_120.X + Text_Projected_Amount_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Projected_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Projected"
                        Width: =Parent.Width/13
                        X: =Text_Name_120.X + Text_Name_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Name_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Parent.Width/7
                        X: =Text_Purpose_120.X + Text_Purpose_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Purpose_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Purpose"
                        Width: =Parent.Width/7
                        X: =Text_ID_120.X + Text_ID_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_ID_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="ID"
                        Width: =Parent.Width/20
                        X: =Text_Doc_Num_120.X + Text_Doc_Num_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Doc_Num_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: |-
                          ="Doc #"
                        Width: =Parent.Width/13
                        X: =Text_Control_Num_120.X + Text_Control_Num_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Control_Num_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: |-
                          ="Control #"
                        Width: =Parent.Width/10
                        X: =Text_Category_120.X + Text_Category_120.Width + 10
                        Y: =Text_Category_120.Y
                  - Text_Category_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Category"
                        Width: =Parent.Width/14
            - Container_Budget_Details_120:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Parent.Height/2.5
                  Width: =Parent.Width
                Children:
                  - Button_Save_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              varReadyToSubmit,
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=UpdateContext({varShowSpinner: true});\r\n// REMOVE ANY DELETED BUDGET NOTES\r\nForAll(colRemoveBudgetNotes As note,\r\n    Remove(budget_notes, LookUp(budget_notes, budget_note_id = note.budget_id)));\r\n\r\nForAll(colBudgets As budget, \r\n    If(\r\n        Not(IsBlank(budget.new_budget_num)) && IsBlank(budget.budget_id),\r\n        // CREATE NEW BUDGETS IN BUDGETS TABLE AND CAPTURE BUDGET ID\r\n        With(\r\n            {new_budget_id:\r\n                Patch(budgets, Defaults(budgets), \r\n                    {budget_name: budget.budget_name, \r\n                    budget_type: budget.budget_type, \r\n                    funding_type: budget.funding_type, \r\n                    loa: budget.loa, \r\n                    mipr_num: budget.mipr_num, \r\n                    wbs_cost_center: budget.wbs_cost_center, \r\n                    total_amount: Abs(LookUp(colSpendPlans, budget_id = budget.budget_id && new_budget_num = budget.new_budget_num).total_amount), \r\n                    received_date: budget.received_date, \r\n                    expire_date: budget.expire_date, \r\n                    pop_date: budget.pop_date, \r\n                    center_id: budget.center_id, \r\n                    updated_on: Today()}).budget_id}, \r\n            \r\n            // CREATE NEW BUDGET NOTES FOR NEW BUDGETS\r\n            ForAll(Filter(colBudgetNotes, budget_id = budget.budget_id, new_budget_num = budget.new_budget_num) As note, \r\n                Patch(budget_notes, Defaults(budget_notes), \r\n                    {budget_id: new_budget_id, \r\n                    notes: note.notes, \r\n                    tour_id: note.created_tour, \r\n                    updated_on: Today()}));\r\n            \r\n            // CREATE NEW BUDGET SPONSORS FOR NEW BUDGETS\r\n            ForAll(Filter(colBudgetSponsors, budget_id = budget.budget_id, new_budget_num = budget.new_budget_num) As sponsor, \r\n                Patch(budget_sponsors, Defaults(budget_sponsors), \r\n                    {budget_id: new_budget_id, \r\n                    spon_collab_id: sponsor.spon_collab_id}));\r\n\r\n            // CREATE NEW DEPOSITS FOR NEW BUDGETS\r\n            ForAll(Filter(colFeesDeposits, budget_id = budget.budget_id, new_budget_num = budget.new_budget_num, category = \"DEPOSIT\") As dep, \r\n                Patch(add_deposits, Defaults(add_deposits), \r\n                    {cntrl_num: dep.cntrl_num, \r\n                    budget_id: new_budget_id, \r\n                    deposit_amount: Abs(dep.amount), \r\n                    deposit_date: dep.deposit_date, \r\n                    notes: dep.notes, \r\n                    updated_on: Today()})); \r\n\r\n            // CREATE NEW FEES FOR NEW BUDGETS\r\n            ForAll(Filter(colFeesDeposits, budget_id = budget.budget_id, new_budget_num = budget.new_budget_num, category = \"FEE\") As fee, \r\n                Patch(fee_costs, Defaults(fee_costs), \r\n                    {cntrl_num: fee.cntrl_num, \r\n                    budget_id: new_budget_id, \r\n                    fee_cost: -Abs(fee.amount), \r\n                    spend_date: fee.spend_date, \r\n                    notes: fee.notes, \r\n                    updated_on: Today()}));\r\n\r\n            // CREATE NEW SPEND PLAN FOR NEW BUDGETS\r\n            With(\r\n                {new_spend_plan: LookUp(colSpendPlans, budget_id = budget.budget_id && new_budget_num = budget.new_budget_num && Not(IsBlank(new_spend_plan_num)))}, \r\n                    Patch(spend_plan, Defaults(spend_plan), \r\n                        {budget_id: new_budget_id, \r\n                        fee_amount: Abs(new_spend_plan.fee_amount), \r\n                        gift_amount: Abs(new_spend_plan.gift_amount), \r\n                        print_amount: Abs(new_spend_plan.print_amount), \r\n                        salary_amount: Abs(new_spend_plan.salary_amount), \r\n                        supply_amount: Abs(new_spend_plan.supply_amount), \r\n                        travel_amount: Abs(new_spend_plan.travel_amount), \r\n                        total_amount: Abs(new_spend_plan.total_amount), \r\n                        updated_on: Today()}))),\r\n\r\n        // IDENTIFY EXISTING BUDGETS\r\n        If(\r\n            Not(IsBlank(budget.budget_id)) && IsBlank(budget.new_budget_num), \r\n\r\n            If(\r\n                Not(IsBlank(LookUp(colBudgetChanges, budget_id = budget.budget_id))), \r\n\r\n                // PATCH IN CHANGES TO EXISTING BUDGETS\r\n                Patch(budgets, LookUp(budgets, budget_id = budget.budget_id), \r\n                    {budget_name: budget.budget_name, \r\n                    budget_type: budget.budget_type, \r\n                    funding_type: budget.funding_type, \r\n                    loa: budget.loa, \r\n                    mipr_num: budget.mipr_num, \r\n                    wbs_cost_center: budget.wbs_cost_center, \r\n                    received_date: budget.received_date, \r\n                    expire_date: budget.expire_date, \r\n                    pop_date: budget.pop_date, \r\n                    center_id: budget.center_id, \r\n                    updated_on: Today()}));\r\n\r\n            ForAll(Filter(colBudgetNotes, budget_id = budget.budget_id, Not(IsBlank(new_note_num))) As note, \r\n\r\n                // PATCH IN NEW NOTES FOR EXISTING BUDGETS\r\n                Patch(budget_notes, Defaults(budget_notes), \r\n                    {budget_id: budget.budget_id, \r\n                    notes: note.notes, \r\n                    tour_id: note.created_tour, \r\n                    updated_on: Today()}));\r\n\r\n            ForAll(Filter(colBudgetNoteChanges, budget_id = budget.budget_id) As note, \r\n\r\n                // PATCH IN UPDATES TO EXISTING NOTES FOR EXISTING BUDGETS\r\n                Patch(budget_notes, LookUp(budget_notes, budget_note_id = note.budget_note_id), \r\n                    {budget_id: budget.budget_id, \r\n                    notes: note.notes, \r\n                    tour_id: note.created_tour, \r\n                    updated_on: Today()})); \r\n            \r\n            If(\r\n                Not(IsBlank(LookUp(colBudgetSponsorChanges, budget_id = budget.budget_id))), \r\n\r\n                    // PATCH IN UPDATES TO EXISTING SPONSOR FOR EXISTING BUDGET\r\n                    Patch(budget_sponsors, LookUp(budget_sponsors, budget_sponsor_id = budget.budget_sponsor_id), \r\n                        {spon_collab_id: LookUp(colBudgetSponsorChanges, budget_id = budget.budget_id).spon_collab_id, \r\n                        budget_id: budget.budget_id}));\r\n                \r\n            If(\r\n                Not(IsBlank(LookUp(colBudgetSponsors, budget_id = budget.budget_id && Not(IsBlank(new_budget_sponsor_num))))),\r\n\r\n                // PATCH IN NEW SPONSOR FOR EXISTING BUDGET\r\n                Patch(budget_sponsors, Defaults(budget_sponsors), \r\n                    {spon_collab_id: LookUp(colBudgetSponsors, budget_id = budget.budget_id && Not(IsBlank(new_budget_sponsor_num))).spon_collab_id,\r\n                    budget_id: budget.budget_id})); \r\n            \r\n            ForAll(Filter(colFeesDeposits, budget_id = budget.budget_id, Not(IsBlank(new_fee_dep_num)), category = \"DEPOSIT\") As dep, \r\n\r\n                // PATCH IN NEW DEPOSITS FOR EXISTING BUDGETS\r\n                Patch(add_deposits, Defaults(add_deposits), \r\n                    {cntrl_num: dep.cntrl_num, \r\n                    budget_id: budget.budget_id, \r\n                    deposit_amount: Abs(dep.amount), \r\n                    deposit_date: dep.deposit_date, \r\n                    notes: dep.notes, \r\n                    updated_on: Today()}));\r\n\r\n            ForAll(Filter(colFeesDepositsChanges, budget_id = budget.budget_id, category = \"DEPOSIT\") As dep, \r\n\r\n                // PATCH IN UPDATES TO EXISTING DEPOSITS FOR EXISTING BUDGETS\r\n                Patch(add_deposits, LookUp(add_deposits, deposit_id = dep.deposit_id), \r\n                    {cntrl_num: dep.cntrl_num, \r\n                    budget_id: budget.budget_id, \r\n                    deposit_amount: Abs(dep.amount), \r\n                    deposit_date: dep.deposit_date, \r\n                    notes: dep.notes, \r\n                    updated_on: Today()}));\r\n\r\n            ForAll(Filter(colFeesDeposits, budget_id = budget.budget_id, Not(IsBlank(new_fee_dep_num)), category = \"FEE\") As fee, \r\n\r\n                // PATCH IN NEW FEES FOR EXISTING BUDGETS\r\n                Patch(fee_costs, Defaults(fee_costs), \r\n                    {cntrl_num: fee.cntrl_num, \r\n                    budget_id: budget.budget_id, \r\n                    fee_cost: -Abs(fee.amount), \r\n                    spend_date: fee.spend_date, \r\n                    notes: fee.notes, \r\n                    updated_on: Today()}));\r\n\r\n            ForAll(Filter(colFeesDepositsChanges, budget_id = budget.budget_id, category = \"DEPOSIT\") As fee, \r\n\r\n                // PATCH IN UPDATES TO EXISTING FEES FOR EXISTING BUDGETS\r\n                Patch(fee_costs, LookUp(fee_costs, fee_id = fee.fee_id), \r\n                    {cntrl_num: fee.cntrl_num, \r\n                    budget_id: budget.budget_id, \r\n                    fee_cost: -Abs(fee.amount), \r\n                    spend_date: fee.spend_date, \r\n                    notes: fee.notes, \r\n                    updated_on: Today()}));\r\n\r\n            If(\r\n                Not(IsBlank(LookUp(colSpendPlans, budget_id = budget.budget_id && new_budget_num = budget.new_budget_num && Not(IsBlank(new_spend_plan_num))))), \r\n\r\n                // PATCH IN NEW SPEND PLANS FOR EXISTING BUDGETS\r\n                With({new_spend_plan: LookUp(colSpendPlans, budget_id = budget.budget_id && new_budget_num = budget.new_budget_num && Not(IsBlank(new_spend_plan_num)))},\r\n                    Patch(spend_plan, Defaults(spend_plan), \r\n                        {budget_id: budget.budget_id, \r\n                        fee_amount: Abs(new_spend_plan.fee_amount), \r\n                        gift_amount: Abs(new_spend_plan.gift_amount), \r\n                        print_amount: Abs(new_spend_plan.print_amount), \r\n                        salary_amount: Abs(new_spend_plan.salary_amount), \r\n                        supply_amount: Abs(new_spend_plan.supply_amount), \r\n                        travel_amount: Abs(new_spend_plan.travel_amount), \r\n                        total_amount: Abs(new_spend_plan.total_amount), \r\n                        updated_on: Today()}))))));\r\n\r\nSet(varBudget, Blank());\r\nSet(varReturnScreen, Blank());\r\n\r\nUpdateContext({varAddNotes:Blank()});\r\nUpdateContext({varAddSponsor:Blank()});\r\nUpdateContext({varReadyToSubmit:Blank()});\r\nUpdateContext({varShowFeeDep:Blank()});\r\n\r\nClear(colBudgetSponsorChanges);\r\nClear(colRemoveBudgetNotes);\r\nClear(colBudgetNoteChanges);\r\nClear(colFeesDepositsChanges);\r\nClear(colBudgetChanges);\r\nClear(colBudgetLedger);\r\nClear(colFundingTypes);\r\nClear(colBudgetTypes);\r\nClear(colCenters);\r\nClear(colFeesDeposits);\r\nClear(colBudgetSponsors);\r\nClear(colLookupOrgs);\r\nClear(colLookupCollaborators);\r\nClear(colBudgetNotes);\r\nClear(colTotalCosts);\r\nClear(colSpendPlans);\r\nClear(colBudgets);\r\n\r\nReset(Text_Input_Control_Num_Search_120);\r\nReset(Text_Input_Purpose_Search_120);\r\nReset(Text_Input_Name_Search_120);\r\nReset(Text_Input_Budget_Search_120);\r\nReset(Gallery_Budgets_120);\r\nReset(Gallery_Ledger_120);\r\n\r\nUpdateContext({varShowSpinner: false});\r\nNavigate(Screen_Welcome_Add_Access_110)"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Save"
                        Visible: =varReadyToSubmit
                        Width: =Button_Home_120.Width
                        X: =Button_Add_Budget_120.X
                        Y: =Text_Input_Control_Num_Search_120.Y
                  - Button_Check_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              varReadyToSubmit = false || 
                              CountRows(colBudgetChanges) > 0 ||
                              CountRows(Filter(colBudgets, Not(IsBlank(new_budget_num)))) > 0 ||
                              CountRows(colBudgetSponsorChanges) > 0 ||
                              CountRows(Filter(colBudgetSponsors, Not(IsBlank(new_budget_sponsor_num)))) > 0 ||
                              CountRows(colBudgetNoteChanges) > 0 ||
                              CountRows(Filter(colBudgetNotes, Not(IsBlank(new_note_num)))) > 0 ||
                              CountRows(colFeesDepositsChanges) > 0 ||
                              CountRows(Filter(colFeesDeposits, Not(IsBlank(new_fee_dep_num)))) > 0 ||
                              CountRows(Filter(colSpendPlans, Not(IsBlank(new_spend_plan_num)))) > 0, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: "=If(\r\n    // MINIMUM INFORMATION FOR BUDGETS (EXCEPT TOTAL AMOUNT)\r\n    CountRows(Filter(colBudgets, IsBlank(budget_name))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(budget_type))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(funding_type))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(wbs_cost_center))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(received_date))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(expire_date))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(pop_date))) = 1 &&\r\n    CountRows(Filter(colBudgets, IsBlank(center_id))) = 1,\r\n\r\n    If(\r\n        // MINIMUM INFORMATION FOR SPEND PLANS (EXCEPT TOTAL AMOUNT)\r\n        CountRows(Filter(colSpendPlans, IsBlank(fee_costs))) = 0 &&\r\n        CountRows(Filter(colSpendPlans, IsBlank(gift_amount))) = 0 &&\r\n        CountRows(Filter(colSpendPlans, IsBlank(print_amount))) = 0 &&\r\n        CountRows(Filter(colSpendPlans, IsBlank(salary_amount))) = 0 &&\r\n        CountRows(Filter(colSpendPlans, IsBlank(supply_amount))) = 0 &&\r\n        CountRows(Filter(colSpendPlans, IsBlank(travel_amount))) = 0,\r\n\r\n        If(\r\n            // MAKE SURE SPEND PLAN TOTAL = INITIAL BUDGET TOTAL + ALL DEPOSITS\r\n            CountRows(Filter(colBudgets As budget, \r\n                Not(IsBlank(budget.total_amount)) &&\r\n                First(\r\n                    Sort(\r\n                        Filter(colSpendPlans, budget_id = budget.budget_id, new_budget_num = budget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).total_amount\r\n                \r\n                \r\n//                LookUp(colSpendPlans, budget_id = budget.budget_id && new_budget_num = budget.new_budget_num).total_amount\r\n                <>\r\n                budget.total_amount + \r\n                Sum(\r\n                    Filter(colFeesDeposits, budget_id = budget.budget_id && new_budget_num = budget.new_budget_num && category = \"DEPOSIT\" && Not(IsBlank(new_fee_dep_num))), amount))) = 0,\r\n\r\n            UpdateContext({varReadyToSubmit:true});\r\n            Notify(\"CLICK SAVE TO SUBMIT CHANGES\",NotificationType.Success), \r\n            UpdateContext({varReadyToSubmit:Blank()});\r\n            Notify(\"THE SPEND PLAN TOTAL IS NOT EQUAL TO THE INITIAL BUDGET AMOUNT + ALL DEPOSITS FOR EACH BUDGET. PLEASE CORRECT THE SPEND PLAN(S)\", NotificationType.Error)),\r\n\r\n        UpdateContext({varReadyToSubmit:Blank()});\r\n        Notify(\"PLEASE ENSURE YOU FILL OUT ALL CATEGORIES OF THE SPEND PLAN FOR EACH BUDGET\", NotificationType.Error)),\r\n    \r\n    UpdateContext({varReadyToSubmit:Blank()});\r\n    Notify(\"PLEASE ENSURE EACH BUDGET HAS A NAME, BUDGET TYPE, FUNDING TYPE, WBS, RECEIVED DATE, EXPIRATION DATE, POP DATE, AND CENTER\", NotificationType.Error))"
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Check"
                        Visible: =Not(varReadyToSubmit)
                        Width: =Button_Home_120.Width
                        X: =Button_Add_Budget_120.X
                        Y: =Text_Input_Control_Num_Search_120.Y
                  - Button_Fee_Deposit_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varShowFeeDep:true})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Fees/Deposits"
                        Width: =Button_Home_120.Width
                        X: =Button_Add_Budget_120.X
                        Y: =Text_Budget_Type_120.Y
                  - Button_Add_Sponsor_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varAddSponsor:true})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Add Sponsor"
                        Width: =Button_Home_120.Width
                        X: =Button_Add_Budget_120.X
                        Y: =Text_MIPR_Num_120.Y
                  - Button_Notes_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: =UpdateContext({varAddNotes:true})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Notes"
                        Width: =Button_Home_120.Width
                        X: =Button_Add_Budget_120.X
                        Y: =Text_WBS_120.Y
                  - Button_Add_Budget_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Set(varBudget, 
                              Patch(varBudget, 
                              {budget_id: Blank(), 
                              new_budget_num: Max(colBudgets, new_budget_num) + 1,
                              budget_name: Blank(), 
                              budget_type: Blank(), 
                              funding_type: Blank(), 
                              loa: Blank(), 
                              mipr_num: Blank(), 
                              wbs_cost_center: Blank(), 
                              received_date: Blank(), 
                              expire_date: Blank(), 
                              pop_date: Blank(), 
                              center_id: Blank(), 
                              center_abbrev: Blank(), 
                              fee_amount: Blank(), 
                              gift_amount: Blank(), 
                              supply_amount: Blank(), 
                              print_amount: Blank(),
                              salary_amount: Blank(), 
                              travel_amount: Blank(), 
                              total_amount: Blank(), 
                              director_tour: Blank(), 
                              director_name: Blank(),
                              budget_sponsor_id: Blank(), 
                              budget_updated_on: Blank(), 
                              spend_plan_updated_on: Blank()}));

                          Collect(colBudgets, 
                              {budget_id: Blank(), 
                              new_budget_num: Max(colBudgets, new_budget_num) + 1,
                              budget_name: Blank(), 
                              budget_type: Blank(), 
                              funding_type: Blank(), 
                              loa: Blank(), 
                              mipr_num: Blank(), 
                              wbs_cost_center: Blank(), 
                              received_date: Blank(), 
                              expire_date: Blank(), 
                              pop_date: Blank(), 
                              center_id: Blank(), 
                              center_abbrev: Blank(), 
                              fee_amount: Blank(), 
                              gift_amount: Blank(), 
                              supply_amount: Blank(), 
                              print_amount: Blank(),
                              salary_amount: Blank(), 
                              travel_amount: Blank(), 
                              total_amount: Blank(), 
                              director_tour: Blank(), 
                              director_name: Blank(), 
                              budget_sponsor_id: Blank(),
                              budget_updated_on: Blank(), 
                              spend_plan_updated_on: Blank()});

                          Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Blank(), 
                                  gift_amount: Blank(), 
                                  print_amount: Blank(), 
                                  salary_amount: Blank(), 
                                  supply_amount: Blank(), 
                                  travel_amount: Blank(), 
                                  total_amount:Blank()})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Add Budget"
                        Width: =Button_Home_120.Width
                        X: =Parent.Width - Self.Width - Parent.Width/75
                        Y: =Text_LOA_120.Y
                  - Button_Home_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.Black
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =32
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Set(varBudget, Blank());
                          Set(varReturnScreen, Blank());

                          UpdateContext({varAddNotes:Blank()});
                          UpdateContext({varAddSponsor:Blank()});
                          UpdateContext({varReadyToSubmit:Blank()});
                          UpdateContext({varShowFeeDep:Blank()});

                          Clear(colBudgetSponsorChanges);
                          Clear(colRemoveBudgetNotes);
                          Clear(colBudgetNoteChanges);
                          Clear(colFeesDepositsChanges);
                          Clear(colBudgetChanges);
                          Clear(colBudgetLedger);
                          Clear(colFundingTypes);
                          Clear(colBudgetTypes);
                          Clear(colCenters);
                          Clear(colFeesDeposits);
                          Clear(colBudgetSponsors);
                          Clear(colLookupOrgs);
                          Clear(colLookupCollaborators);
                          Clear(colBudgetNotes);
                          Clear(colTotalCosts);
                          Clear(colSpendPlans);
                          Clear(colBudgets);

                          Reset(Text_Input_Control_Num_Search_120);
                          Reset(Text_Input_Purpose_Search_120);
                          Reset(Text_Input_Name_Search_120);
                          Reset(Text_Input_Budget_Search_120);
                          Reset(Gallery_Budgets_120);
                          Reset(Gallery_Ledger_120);

                          Navigate(Screen_Welcome_Add_Access_110)
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Size: =12
                        Text: ="Home"
                        Width: =Parent.Width/11
                        X: =Parent.Width - Self.Width - Parent.Width/75
                        Y: =Text_Budget_Name_120.Y
                  - Text_Total_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Total_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).total_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Total_Amount_120.Y
                  - Text_Travel_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Travel_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).travel_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Travel_Amount_120.Y
                  - Text_Supply_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Supply_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).supply_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Supply_Amount_120.Y
                  - Text_Salary_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Salary_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).salary_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Salary_Amount_120.Y
                  - Text_Print_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Print_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).print_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Print_Amount_120.Y
                  - Text_Gift_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Gift_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).gift_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Gift_Amount_120.Y
                  - Text_Fee_Remaining_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.End
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: |-
                          =If(
                              Value(Self.Text) > 0,
                              Color.Green,
                              Color.Red)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Value(Text_Input_Fee_Amount_120.Text) - Abs(LookUp(colTotalCosts, budget_id = varBudget.budget_id).fee_costs)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Remaining_Amount_120.Width
                        X: =Text_Remaining_Amount_120.X
                        Y: =Text_Input_Fee_Amount_120.Y
                  - Text_Input_Total_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).total_amount
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =Reset(Text_Input_Fee_Amount_120);
                          Reset(Text_Input_Gift_Amount_120);
                          Reset(Text_Input_Print_Amount_120);
                          Reset(Text_Input_Salary_Amount_120);
                          Reset(Text_Input_Supply_Amount_120);
                          Reset(Text_Input_Travel_Amount_120);
                          Reset(Text_Input_Total_Amount_120);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Total_Amount_120.Y
                  - Text_Input_Travel_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).travel_amount
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =If(
                              IsBlank(LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num)))),

                              Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Abs(Value(Text_Input_Fee_Amount_120.Text)), 
                                  gift_amount: Abs(Value(Text_Input_Gift_Amount_120.Text)), 
                                  print_amount: Abs(Value(Text_Input_Print_Amount_120.Text)), 
                                  salary_amount: Abs(Value(Text_Input_Salary_Amount_120.Text)), 
                                  supply_amount: Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  travel_amount: Abs(Value(Self.Text)), 
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}), 

                              Patch(colSpendPlans, LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num))),
                                  {travel_amount: Abs(Value(Self.Text)),  
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}));

                          UpdateContext({varReadyToSubmit:false})
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Travel_Amount_120.Y
                  - Text_Input_Supply_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).supply_amount
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =If(
                              IsBlank(LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num)))),

                              Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Abs(Value(Text_Input_Fee_Amount_120.Text)), 
                                  gift_amount: Abs(Value(Text_Input_Gift_Amount_120.Text)), 
                                  print_amount: Abs(Value(Text_Input_Print_Amount_120.Text)), 
                                  salary_amount: Abs(Value(Text_Input_Salary_Amount_120.Text)), 
                                  supply_amount: Abs(Value(Self.Text)), 
                                  travel_amount: Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}), 

                              Patch(colSpendPlans, LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num))),
                                  {supply_amount: Abs(Value(Self.Text)),  
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}));

                          UpdateContext({varReadyToSubmit:false})
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Supply_Amount_120.Y
                  - Text_Input_Salary_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).salary_amount
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =If(
                              IsBlank(LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num)))),

                              Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Abs(Value(Text_Input_Fee_Amount_120.Text)), 
                                  gift_amount: Abs(Value(Text_Input_Gift_Amount_120.Text)), 
                                  print_amount: Abs(Value(Text_Input_Print_Amount_120.Text)), 
                                  salary_amount: Abs(Value(Self.Text)), 
                                  supply_amount: Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  travel_amount: Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}), 

                              Patch(colSpendPlans, LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num))),
                                  {salary_amount: Abs(Value(Self.Text)),  
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}));

                          UpdateContext({varReadyToSubmit:false})
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Salary_Amount_120.Y
                  - Text_Input_Print_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).print_amount
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =If(
                              IsBlank(LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num)))),

                              Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Abs(Value(Text_Input_Fee_Amount_120.Text)), 
                                  gift_amount: Abs(Value(Text_Input_Gift_Amount_120.Text)), 
                                  print_amount: Abs(Value(Self.Text)), 
                                  salary_amount: Abs(Value(Text_Input_Salary_Amount_120.Text)), 
                                  supply_amount: Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  travel_amount: Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}), 

                              Patch(colSpendPlans, LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num))),
                                  {print_amount: Abs(Value(Self.Text)),  
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}));

                          UpdateContext({varReadyToSubmit:false})
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Print_Amount_120.Y
                  - Text_Input_Gift_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).gift_amount
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =If(
                              IsBlank(LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num)))),

                              Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Abs(Value(Text_Input_Fee_Amount_120.Text)), 
                                  gift_amount: Abs(Value(Self.Text)), 
                                  print_amount: Abs(Value(Text_Input_Print_Amount_120.Text)), 
                                  salary_amount: Abs(Value(Text_Input_Salary_Amount_120.Text)), 
                                  supply_amount: Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  travel_amount: Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}), 

                              Patch(colSpendPlans, LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num))),
                                  {gift_amount: Abs(Value(Self.Text)),  
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Fee_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}));

                          UpdateContext({varReadyToSubmit:false})
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Gift_Amount_120.Y
                  - Text_Input_Fee_Amount_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        Align: =Align.Right
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: |-
                          =First(
                              Sort(
                                  Filter(
                                      colSpendPlans, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), spend_plan_updated_on, SortOrder.Descending)).fee_amount
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        OnChange: |-
                          =If(
                              IsBlank(LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num)))),

                              Collect(colSpendPlans, 
                                  {budget_id: varBudget.budget_id,
                                  new_budget_num: varBudget.new_budget_num,
                                  new_spend_plan_num: Max(colSpendPlans, new_spend_plan_num) + 1,
                                  fee_amount: Abs(Value(Self.Text)), 
                                  gift_amount: Abs(Value(Text_Input_Gift_Amount_120.Text)), 
                                  print_amount: Abs(Value(Text_Input_Print_Amount_120.Text)), 
                                  salary_amount: Abs(Value(Text_Input_Salary_Amount_120.Text)), 
                                  supply_amount: Abs(Value(Text_Input_Supply_Amount_120.Text)), 
                                  travel_amount: Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}), 

                              Patch(colSpendPlans, LookUp(colSpendPlans, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num && Not(IsBlank(new_spend_plan_num))),
                                  {fee_amount: Abs(Value(Self.Text)),  
                                  total_amount: 
                                      Abs(Value(Self.Text)) + Abs(Value(Text_Input_Gift_Amount_120.Text)) + Abs(Value(Text_Input_Print_Amount_120.Text)) + Abs(Value(Text_Input_Salary_Amount_120.Text)) + Abs(Value(Text_Input_Supply_Amount_120.Text)) + Abs(Value(Text_Input_Travel_Amount_120.Text)), 
                                  spend_plan_updated_on: Today()}));

                          UpdateContext({varReadyToSubmit:false})
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        TabIndex: =2
                        Width: =Text_Spend_Plan_Date_120.Width
                        X: =Text_Spend_Plan_Date_120.X
                        Y: =Text_Fee_Amount_120.Y
                  - Text_Total_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Total"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Travel_Amount_120.Y + Text_Travel_Amount_120.Height
                  - Text_Travel_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Travel"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Supply_Amount_120.Y + Text_Supply_Amount_120.Height
                  - Text_Supply_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Supply"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Salary_Amount_120.Y + Text_Salary_Amount_120.Height
                  - Text_Salary_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Salary"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Print_Amount_120.Y + Text_Print_Amount_120.Height
                  - Text_Print_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Print"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Gift_Amount_120.Y + Text_Gift_Amount_120.Height
                  - Text_Gift_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Gift"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Fee_Amount_120.Y + Text_Fee_Amount_120.Height
                  - Text_Fee_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Fee"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Category_122.Width
                        X: =Text_Category_122.X
                        Y: =Text_Category_122.Y + Text_Category_122.Height
                  - Text_Remaining_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Remaining"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =(Button_Home_120.X - (Dropdown_Fund_Type_120.X + Dropdown_Fund_Type_120.Width + Parent.Width/50) - Parent.Width/75)*2/5
                        X: =Text_Spend_Plan_Date_120.X + Text_Spend_Plan_Date_120.Width
                        Y: =Text_Budget_Name_120.Y
                  - Text_Spend_Plan_Date_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: =Concatenate("As of ", LookUp(colSpendPlans, budget_id = varBudget.budget_id).spend_plan_updated_on)
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =(Button_Home_120.X - (Dropdown_Fund_Type_120.X + Dropdown_Fund_Type_120.Width + Parent.Width/50) - Parent.Width/75)*2/5
                        X: =Text_Category_122.X + Text_Category_122.Width
                        Y: =Text_Remaining_Amount_120.Y
                  - Text_Category_122:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =20
                        Text: ="Category"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: |+
                          =(Button_Home_120.X - (Dropdown_Fund_Type_120.X + Dropdown_Fund_Type_120.Width + Parent.Width/50) - Parent.Width/75)/5
                        X: |-
                          =Dropdown_Center_120.X + Dropdown_Center_120.Width + Parent.Width/50
                          //Text_Budget_Name_132.X - Self.Width
                        Y: =Text_Remaining_Amount_120.Y
                  - Text_Input_Name_Search_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =0
                        Default: =""
                        Fill: =RGBA(177, 179, 179, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HintText: ="Search Name"
                        HoverBorderColor: =
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Reset(Text_Input_Control_Num_Search_120);
                          Reset(Text_Input_Purpose_Search_120);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Size: =11
                        Width: |
                          =(Text_Total_Amount_120.X - Parent.Width/75 - Parent.Width*4/50)/4
                        X: =Text_Input_Purpose_Search_120.X + Text_Input_Purpose_Search_120.Width + Parent.Width/40
                        Y: =Text_Input_Control_Num_Search_120.Y
                  - Icon_Cancel_Name_Search_120:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(156, 156, 156, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Reset(Text_Input_Name_Search_120);

                          Reset(Gallery_Salary_90)
                        Width: =Self.Height
                        X: =Text_Input_Name_Search_120.X + Text_Input_Name_Search_120.Width - Self.Width
                        Y: =Text_Input_Name_Search_120.Y
                  - Text_Input_Purpose_Search_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =0
                        Default: =""
                        Fill: =RGBA(177, 179, 179, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HintText: ="Search Purpose"
                        HoverBorderColor: =
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Reset(Text_Input_Control_Num_Search_120);
                          Reset(Text_Input_Name_Search_120);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Size: =11
                        Width: |
                          =(Text_Total_Amount_120.X - Parent.Width/75 - Parent.Width*4/50)/4
                        X: |+
                          =Text_Input_Control_Num_Search_120.X + Text_Input_Control_Num_Search_120.Width + Parent.Width/40
                        Y: =Text_Input_Control_Num_Search_120.Y
                  - Icon_Cancel_Purpose_Search_120:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(156, 156, 156, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Reset(Text_Input_Purpose_Search_120);

                          Reset(Gallery_Salary_90)
                        Width: =Self.Height
                        X: =Text_Input_Purpose_Search_120.X + Text_Input_Purpose_Search_120.Width - Self.Width
                        Y: =Text_Input_Purpose_Search_120.Y
                  - Text_Input_Control_Num_Search_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =0
                        Default: =""
                        Fill: =RGBA(177, 179, 179, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HintText: |-
                          ="Search CNTRL #"
                        HoverBorderColor: =
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Reset(Text_Input_Purpose_Search_120);
                          Reset(Text_Input_Name_Search_120);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Size: =11
                        Width: |+
                          =(Text_Total_Amount_120.X - Parent.Width/75 - Parent.Width*4/50)/4
                        X: =Text_Input_Budget_Search_120.X + Text_Input_Budget_Search_120.Width + Parent.Width/40
                        Y: |-
                          =Text_Budget_Type_120.Y + Text_Budget_Type_120.Height + Parent.Height/20

                          //Parent.Height - Self.Height - Parent.Height/40
                  - Icon_Cancel_Control_Num_Search_120:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(156, 156, 156, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Reset(Text_Input_Control_Num_Search_120);

                          Reset(Gallery_Salary_90)
                        Width: =Self.Height
                        X: =Text_Input_Control_Num_Search_120.X + Text_Input_Control_Num_Search_120.Width - Self.Width
                        Y: =Text_Input_Control_Num_Search_120.Y
                  - Text_Input_Budget_Search_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =0
                        Default: =""
                        Fill: =RGBA(177, 179, 179, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HintText: ="Search Budget"
                        HoverBorderColor: =
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: |-
                          =Reset(Text_Input_Control_Num_Search_120);
                          Reset(Text_Input_Purpose_Search_120);
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Size: =11
                        Width: |
                          =(Text_Total_Amount_120.X - Parent.Width/75 - Parent.Width*4/50)/4
                        X: =Parent.Width/75
                        Y: =Text_Input_Control_Num_Search_120.Y
                  - Icon_Cancel_Budget_Search_120:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(156, 156, 156, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Reset(Text_Input_Budget_Search_120);

                          Reset(Gallery_Salary_90)
                        Width: =Self.Height
                        X: =Text_Input_Budget_Search_120.X + Text_Input_Budget_Search_120.Width - Self.Width
                        Y: =Text_Input_Budget_Search_120.Y
                  - Dropdown_Center_120:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colCenters, center_id = varBudget.center_id)
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_120.Height
                        Items: =Sort(colCenters, center_abbrev, SortOrder.Ascending)
                        OnChange: "=Set(varBudget, \r\n    Patch(varBudget, \r\n    {center_id: Self.Selected.center_id, \r\n    center_abbrev: Self.Selected.center_abbrev}));\r\n\r\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \r\n    {center_id: Self.Selected.center_id, \r\n    center_abbrev: Self.Selected.center_abbrev});\r\n\r\nIf(\r\n    Not(IsBlank(varBudget.budget_id)), \r\n    If(\r\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\r\n        \r\n        Collect(colBudgetChanges, \r\n            {budget_id: varBudget.budget_id, \r\n            center_id: Self.Selected.center_id, \r\n            center_abbrev: Self.Selected.center_abbrev}), \r\n\r\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \r\n            {center_id: Self.Selected.center_id, \r\n            center_abbrev: Self.Selected.center_abbrev})));\r\n\r\nUpdateContext({varReadyToSubmit:false});"
                        Width: =Dropdown_Fund_Type_120.Width
                        X: =Dropdown_Fund_Type_120.X
                        Y: =Text_Budget_Type_120.Y
                      Children:
                        - center_abbrev2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="center_abbrev"
                              FieldName: ="center_abbrev"
                              FieldType: ="s"
                              Order: =1
                        - center_id2:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="center_id"
                              FieldName: ="center_id"
                              FieldType: ="n"
                              Order: =2
                  - Text_Center_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Center:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Text_Fund_Type_120.X
                        Y: =Text_Budget_Type_120.Y
                  - Date_Picker_POP_Date_120:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_120.Height
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {pop_date: Self.SelectedDate}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {pop_date: Self.SelectedDate});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            pop_date: Self.SelectedDate}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {pop_date: Self.SelectedDate})));\n\nUpdateContext({varReadyToSubmit:false});"
                        SelectedDate: =varBudget.pop_date
                        Width: =Dropdown_Fund_Type_120.Width
                        X: =Dropdown_Fund_Type_120.X
                        Y: =Text_POP_Date_120.Y
                  - Text_POP_Date_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="POP Date:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Text_Fund_Type_120.X
                        Y: =Text_MIPR_Num_120.Y
                  - Date_Picker_Expire_Date_120:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_120.Height
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {expire_date: Self.SelectedDate}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {expire_date: Self.SelectedDate});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            expire_date: Self.SelectedDate}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {expire_date: Self.SelectedDate})));\n\nUpdateContext({varReadyToSubmit:false});"
                        SelectedDate: =varBudget.expire_date
                        Width: =Dropdown_Fund_Type_120.Width
                        X: =Dropdown_Fund_Type_120.X
                        Y: =Text_Expire_Date_120.Y
                  - Text_Expire_Date_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Expiration:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Text_Fund_Type_120.X
                        Y: =Text_WBS_120.Y
                  - Date_Picker_Date_Received_120:
                      Control: DatePicker@0.0.46
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Format: ='DatePickerCanvas.Format'.Short
                        Height: =Text_Input_Change_User_120.Height
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {received_date: Self.SelectedDate}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {received_date: Self.SelectedDate});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            received_date: Self.SelectedDate}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {received_date: Self.SelectedDate})));\n\nUpdateContext({varReadyToSubmit:false});"
                        SelectedDate: =varBudget.received_date
                        Width: =Dropdown_Fund_Type_120.Width
                        X: =Dropdown_Fund_Type_120.X
                        Y: =Text_Date_Received_120.Y
                  - Text_Date_Received_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Received:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Text_Fund_Type_120.X
                        Y: =Text_LOA_120.Y
                  - Dropdown_Fund_Type_120:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colFundingTypes, funding_type = varBudget.funding_type)
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_120.Height
                        Items: =Sort(colFundingTypes, funding_type, SortOrder.Ascending)
                        OnChange: "=Set(varBudget, \r\n    Patch(varBudget, \r\n    {funding_type: Self.Selected.funding_type}));\r\n\r\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \r\n    {funding_type: Self.Selected.funding_type});\r\n\r\nIf(\r\n    Not(IsBlank(varBudget.budget_id)), \r\n    If(\r\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\r\n        \r\n        Collect(colBudgetChanges, \r\n            {budget_id: varBudget.budget_id, \r\n            funding_type: Self.Selected.funding_type}), \r\n\r\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \r\n            {funding_type: Self.Selected.funding_type})));\r\n\r\nUpdateContext({varReadyToSubmit:false});"
                        Width: =Parent.Width/10
                        X: =Text_Fund_Type_120.X + Text_Fund_Type_120.Width
                        Y: =Text_Fund_Type_120.Y
                      Children:
                        - funding_type1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="funding_type"
                              FieldName: ="funding_type"
                              FieldType: ="s"
                              Order: =1
                  - Text_Fund_Type_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Fund Type:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Text_Input_Budget_Name_120.X + Text_Input_Budget_Name_120.Width + Parent.Width/50
                        Y: =Parent.Height/20
                  - Dropdown_Budget_Type_120:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colBudgetTypes, budget_type = varBudget.budget_type)
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        FontSize: =18
                        Height: =Text_Input_Change_User_120.Height
                        Items: =Sort(colBudgetTypes, budget_type, SortOrder.Ascending)
                        OnChange: "=Set(varBudget, \r\n    Patch(varBudget, \r\n    {budget_type: Self.Selected.budget_type}));\r\n\r\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \r\n    {budget_type: Self.Selected.budget_type});\r\n\r\nIf(\r\n    Not(IsBlank(varBudget.budget_id)), \r\n    If(\r\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\r\n        \r\n        Collect(colBudgetChanges, \r\n            {budget_id: varBudget.budget_id, \r\n            budget_type: Self.Selected.budget_type}), \r\n\r\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \r\n            {budget_type: Self.Selected.budget_type})));\r\n\r\nUpdateContext({varReadyToSubmit:false});"
                        Width: =Text_Input_MIPR_Num_120.Width
                        X: =Text_Input_MIPR_Num_120.X
                        Y: =Text_Budget_Type_120.Y
                      Children:
                        - budget_type3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="budget_type"
                              FieldName: ="budget_type"
                              FieldType: ="s"
                              Order: =1
                  - Text_Budget_Type_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Budget Type:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Parent.Width/75
                        Y: =Text_MIPR_Num_120.Y + Text_MIPR_Num_120.Height + Parent.Height/20
                  - Text_Input_MIPR_Num_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =varBudget.mipr_num
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {mipr_num: Upper(Self.Text)}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {mipr_num: Upper(Self.Text)});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            mipr_num: Upper(Self.Text)}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {mipr_num: Upper(Self.Text)})));\n\nUpdateContext({varReadyToSubmit:false});"
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width/6
                        X: =Text_Input_Budget_Name_120.X
                        Y: =Text_MIPR_Num_120.Y
                  - Text_MIPR_Num_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="MIPR:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Parent.Width/75
                        Y: =Text_WBS_120.Y + Text_WBS_120.Height + Parent.Height/20
                  - Text_Input_WBS_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varBudget.wbs_cost_center
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {wbs_cost_center: Upper(Self.Text)}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {wbs_cost_center: Upper(Self.Text)});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            wbs_cost_center: Upper(Self.Text)}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {wbs_cost_center: Upper(Self.Text)})));\n\nUpdateContext({varReadyToSubmit:false});"
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width/6
                        X: =Text_Input_Budget_Name_120.X
                        Y: =Text_WBS_120.Y
                  - Text_WBS_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="WBS:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Parent.Width/75
                        Y: =Text_LOA_120.Y + Text_LOA_120.Height + Parent.Height/20
                  - Text_Input_LOA_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =varBudget.loa
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {loa: Upper(Self.Text)}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {loa: Upper(Self.Text)});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            loa: Upper(Self.Text)}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {loa: Upper(Self.Text)})));\n\nUpdateContext({varReadyToSubmit:false});"
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width/6
                        X: =Text_Input_Budget_Name_120.X
                        Y: =Text_LOA_120.Y
                  - Text_LOA_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="LOA:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Text_Budget_Name_120.Width
                        X: =Parent.Width/75
                        Y: =Text_Budget_Name_120.Y + Text_Budget_Name_120.Height + Parent.Height/20
                  - Text_Input_Budget_Name_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Color.Red
                        BorderThickness: =3
                        Default: =varBudget.budget_name
                        DisplayMode: |-
                          =If(
                              IsBlank(varBudget.budget_id) && IsBlank(varBudget.new_budget_num),
                              DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =RGBA(211, 188, 141, 1)
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =1000
                        Mode: =TextMode.MultiLine
                        OnChange: "=Set(varBudget, \n    Patch(varBudget, \n    {budget_name: Upper(Self.Text)}));\n\nPatch(colBudgets, LookUp(colBudgets, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num), \n    {budget_name: Upper(Self.Text)});\n\nIf(\n    Not(IsBlank(varBudget.budget_id)), \n    If(\n        IsBlank(LookUp(colBudgetChanges, budget_id = varBudget.budget_id)),\n        \n        Collect(colBudgetChanges, \n            {budget_id: varBudget.budget_id, \n            budget_name: Upper(Self.Text)}), \n\n        Patch(colBudgetChanges, LookUp(colBudgetChanges, budget_id = varBudget.budget_id), \n            {budget_name: Upper(Self.Text)})));\n\nUpdateContext({varReadyToSubmit:false});"
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        TabIndex: =2
                        Width: =Parent.Width/6
                        X: =Text_Budget_Name_120.X + Text_Budget_Name_120.Width
                        Y: =Text_Budget_Name_120.Y
                  - Text_Budget_Name_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Start
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Name:"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =Parent.Width/10
                        X: =Parent.Width/75
                        Y: =Parent.Height/20
            - Rectangle_Disable_120:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: |-
                    =If(
                        Spinner_120.Visible ||
                        Container_Fee_Deposits_120.Visible || 
                        Container_Budget_Sponsor_120.Visible ||
                        Container_Budget_Notes_120.Visible,
                        true, false)
                  Width: =Parent.Width
            - Container_Budget_Notes_120:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varAddNotes
                  Width: =Parent.Width/2
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Notes_Done_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              CountRows(Filter(colBudgetNotes, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num, IsBlank(notes))) = 0,
                              UpdateContext({varAddNotes: false}),
                              Notify("PLEASE REMOVE ANY BLANK NOTES", NotificationType.Error))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Gallery_Budget_Notes_120:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Button_Notes_Done_120.Y - Self.Y - Parent.Height/30
                        Items: =Sort(Filter(colBudgetNotes, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), updated_on, SortOrder.Descending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateSize: =Text_Input_Change_User_120.Height
                        Width: =Parent.Width
                        Y: =Text_Note_120.Y + Text_Note_120.Height
                      Children:
                        - Icon_Remove_Note_120:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: |-
                                =If(
                                    varUser.tour_id = ThisItem.created_tour ||
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colTrip,1).trip_oic, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(IsBlank(ThisItem.budget_note_id), 
                                    Remove(colBudgetNotes, ThisItem),
                                    Collect(colRemoveBudgetNotes, ThisItem);
                                    Remove(colBudgetNotes, ThisItem));

                                UpdateContext({varReadyToSubmit:false});
                              Width: =Self.Height
                              X: =Parent.TemplateWidth - Self.Width - 10
                        - Text_Input_Note_Date_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.updated_on
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_Date_120.Width
                              X: =Text_Note_Date_120.X
                        - Text_Input_Note_Creator_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.created_name
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              OnChange: |-
                                =If(Len(Self.Text) = 4 && IsMatch(Self.Text,"[0-9]+"),
                                    Patch(colPerson, Index(colPerson,1), {year_group:Value(Self.Text)}),
                                    Reset(Self);
                                    Notify("PLEASE ENTER A 4 DIGIT YEAR",NotificationType.Warning));

                                UpdateContext({varReadyToSubmit: false})
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_Creator_120.Width
                              X: =Text_Note_Creator_120.X
                        - Text_Input_Note_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.notes
                              DisplayMode: |-
                                =If(
                                    varUser.tour_id = ThisItem.created_tour ||
                                    varPermissions = "Master" ||
                                    varPermissions = "Admin" ||
                                    varPermissions = "Research" ||
                                    varUser.tour_id = Index(colTrip,1).trip_oic, 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: |-
                                =Patch(colBudgetNotes, ThisItem, 
                                    {notes: Upper(Self.Text), 
                                    created_tour: varUser.tour_id, 
                                    created_name: varUser.name, 
                                    updated_on: Today()});

                                If(
                                    Not(IsBlank(ThisItem.budget_note_id)), 

                                    If(
                                        IsBlank(LookUp(colBudgetNoteChanges, budget_note_id = ThisItem.budget_note_id)), 

                                        Collect(colBudgetNoteChanges, 
                                            {budget_note_id: ThisItem.budget_note_id, 
                                            budget_id: ThisItem.budget_id, 
                                            notes: ThisItem.notes, 
                                            created_tour: varUser.tour_id, 
                                            created_name: varUser.name, 
                                            updated_on: Today()}), 

                                        Patch(colBudgetNoteChanges, LookUp(colBudgetNoteChanges, budget_note_id = ThisItem.budget_note_id), 
                                            {budget_id: ThisItem.budget_id, 
                                            notes: ThisItem.notes, 
                                            created_tour: varUser.tour_id, 
                                            created_name: varUser.name, 
                                            updated_on: Today()})));

                                UpdateContext({varReadyToSubmit: false});
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Note_120.Width
                              X: =Text_Note_120.X
                        - Separator_Gallery_Budget_Notes_120:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Note_120:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Text_Input_Change_User_120.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colBudgetNotes,
                              {budget_note_id: Blank(), 
                              budget_id: varBudget.budget_id,
                              new_budget_num: varBudget.new_budget_num,  
                              notes: Blank(), 
                              created_tour: varUser.tour_id,
                              created_name: varUser.name, 
                              updated_on: Blank(),
                              new_note_num: Max(colBudgetNotes, new_note_num) + 1});

                          UpdateContext({varReadyToSubmit:false});
                        Width: =Self.Height
                        X: =Gallery_Budget_Notes_120.Width - Self.Width - 10
                        Y: =Text_Note_Creator_120.Y
                  - Text_Note_Date_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Updated On"
                        Width: =Parent.Width/6
                        X: =Icon_Add_Note_120.X - Self.Width - 10
                        Y: =Text_Budget_Notes_120.Y + Text_Budget_Notes_120.Height
                  - Text_Note_Creator_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Created By"
                        Width: =Parent.Width/4
                        X: =Text_Note_Date_120.X - Self.Width - 10
                        Y: =Text_Budget_Notes_120.Y + Text_Budget_Notes_120.Height
                  - Text_Note_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Notes"
                        Width: =Text_Note_Creator_120.X - 10
                        X: =Text_Budget_Notes_120.X
                        Y: =Text_Budget_Notes_120.Y + Text_Budget_Notes_120.Height
                  - Text_Budget_Notes_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =24
                        Text: ="Notes"
                        Width: =Parent.Width
            - Container_Budget_Sponsor_120:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/3
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varAddSponsor
                  Width: =Parent.Width/1.5
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Sponsor_Done_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Reset(Dropdown_Sponsor_Name_120);
                          Reset(Text_Input_Sponsor_Email_120);
                          Reset(Text_Input_Sponsor_Org_120);

                          UpdateContext({varAddSponsor:false});
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Text_Input_Sponsor_Org_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =LookUp(colBudgetSponsors, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num).org_and_parent
                        DisplayMode: =DisplayMode.Disabled
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =
                        Tooltip: =Self.Text
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Dropdown_Sponsor_Name_120.X
                        Y: =Text_Sponsor_Org_120.Y
                  - Text_Sponsor_Org_120:
                      Control: Text@0.0.51
                      Properties:
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Sponsor Org:"
                        Width: =Text_Sponsor_Name_120.Width
                        X: =Text_Sponsor_Name_120.X
                        Y: =Text_Sponsor_Name_120.Y + Text_Sponsor_Name_120.Height + Parent.Height/10
                  - Text_Input_Sponsor_Email_120:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =LookUp(colBudgetSponsors, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num).collab_email
                        DisplayMode: =DisplayMode.Disabled
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        OnChange: =
                        OnSelect: =
                        Tooltip: =Self.Text
                        Width: =Parent.Width - Self.X - Parent.Width/40
                        X: =Text_Sponsor_Email_120.X + Text_Sponsor_Email_120.Width
                        Y: =Text_Sponsor_Name_120.Y
                  - Text_Sponsor_Email_120:
                      Control: Text@0.0.51
                      Properties:
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Sponsor Email:"
                        Width: =Text_Sponsor_Name_120.Width
                        X: =Dropdown_Sponsor_Name_120.X + Dropdown_Sponsor_Name_120.Width + Parent.Width/40
                        Y: =Text_Sponsor_Name_120.Y
                  - Dropdown_Sponsor_Name_120:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Color.Red
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =3
                        DefaultSelectedItems: =Filter(colLookupCollaborators, collab_id = LookUp(colBudgetSponsors, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num).spon_collab_id)
                        DisplayMode: |-
                          =If(
                              CountRows(colProjectFaculty)>0, 
                              If(
                                  CountRows(Filter(colProjectFaculty, tour_id = varUser.tour_id)) > 0 ||
                                  varPermissions = "Master" ||
                                  varPermissions = "Research", 
                                  DisplayMode.Edit, DisplayMode.Disabled),
                              DisplayMode.Edit)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Text_Input_Change_User_120.Height
                        Items: =Sort(colLookupCollaborators, last_name, SortOrder.Ascending)
                        OnChange: "=If(\n    IsBlank(varBudget.budget_sponsor_id),\n\n    Collect(colBudgetSponsors, \n        {budget_id: varBudget.budget_id, \n        budget_name: varBudget.budget_name,\n        new_budget_num: varBudget.new_budget_num, \n        budget_sponsor_id: Blank(), \n        new_budget_sponsor_num: Max(colBudgetSponsors, new_budget_sponsor_num) + 1, \n        spon_collab_id: Self.Selected.collab_id,\n        collab_email: Self.Selected.collab_email, \n        first_name: Self.Selected.first_name, \n        last_name: Self.Selected.last_name, \n        collab_name: Self.Selected.collab_name,\n        org_id: Self.Selected.org_id,\n        org_and_parent: Self.Selected.org_and_parent}), \n\n    Patch(colBudgetSponsors, LookUp(colBudgetSponsors, budget_sponsor_id = varBudget.budget_sponsor_id),\n        {budget_id: varBudget.budget_id, \n        budget_name: varBudget.budget_name,  \n        new_budget_num: varBudget.new_budget_num, \n        spon_collab_id: Self.Selected.collab_id,\n        collab_email: Self.Selected.collab_email, \n        first_name: Self.Selected.first_name, \n        last_name: Self.Selected.last_name, \n        collab_name: Self.Selected.collab_name,\n        org_id: Self.Selected.org_id,\n        org_and_parent: LookUp(colLookupOrgs, org_id = Self.Selected.org_id).org_and_parent});\n        \n    If(\n        IsBlank(LookUp(colBudgetSponsorChanges, budget_sponsor_id = LookUp(colBudgetSponsors, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num).budget_sponsor_id)), \n\n        Collect(colBudgetSponsorChanges, \n            {budget_sponsor_id: LookUp(colBudgetSponsors, budget_id = varBudget.budget_id && new_budget_num = varBudget.new_budget_num).budget_sponsor_id,\n            budget_id: varBudget.budget_id, \n            new_budget_num: varBudget.new_budget_num,\n            spon_collab_id: Self.Selected.collab_id})));\n\nUpdateContext({varReadyToSubmit:false});"
                        Width: =Parent.Width/5
                        X: =Text_Sponsor_Name_120.X + Text_Sponsor_Name_120.Width
                        Y: =Text_Sponsor_Name_120.Y
                      Children:
                        - collab_email1_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="collab_email"
                              FieldName: ="collab_email"
                              FieldType: ="s"
                              Order: =2
                        - collab_id1_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="collab_id"
                              FieldName: ="collab_id"
                              FieldType: ="n"
                              Order: =3
                        - collab_name1_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="collab_name"
                              FieldName: ="collab_name"
                              FieldType: ="s"
                              Order: =1
                        - first_name1_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="first_name"
                              FieldName: ="first_name"
                              FieldType: ="s"
                              Order: =5
                        - last_name1_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="last_name"
                              FieldName: ="last_name"
                              FieldType: ="s"
                              Order: =6
                        - org_id2_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_id"
                              FieldName: ="org_id"
                              FieldType: ="n"
                              Order: =7
                        - org_and_parent3:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="org_and_parent"
                              FieldName: ="org_and_parent"
                              FieldType: ="s"
                              Order: =7
                  - Text_Sponsor_Name_120:
                      Control: Text@0.0.51
                      Properties:
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Sponsor Name:"
                        Width: =Parent.Width/5
                        X: =Parent.Width/40
                        Y: =Text_Sponsors_120.Y + Text_Sponsors_120.Height + Parent.Height/10
                  - Text_Sponsors_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Add A Sponsor"
                        Width: =Parent.Width
            - Container_Fee_Deposits_120:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Color.Black
                  BorderThickness: =2
                  DropShadow: =DropShadow.ExtraBold
                  Fill: =Color.White
                  Height: =Parent.Height/1.5
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Visible: =varShowFeeDep
                  Width: =Parent.Width/1.25
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
                Children:
                  - Button_Fee_Deposits_Done_120:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =Color.White
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =Color.Green
                        Font: =Font.'Open Sans'
                        Height: =Text_Input_Change_User_120.Height
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =If(
                              CountRows(Filter(colFeesDeposits, IsBlank(category))) > 0 ||
                              CountRows(Filter(colFeesDeposits, IsBlank(cntrl_num))) > 0 ||
                              CountRows(Filter(colFeesDeposits, IsBlank(amount))) > 0 ||
                              CountRows(Filter(colFeesDeposits, IsBlank(spend_date), IsBlank(deposit_date))) > 0, 

                              Notify("PLEASE ENSURE EACH FEE/DEPOSIT HAS A CATEGORY, CONTROL NUMBER, AMOUNT, AND SPEND/DEPOSIT DATE", NotificationType.Error), 

                              UpdateContext({varShowFeeDep:false}))
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Done"
                        Width: =Parent.Width/6
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height - Self.Height - Parent.Height/20
                  - Gallery_Fee_Deposits_120:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =2
                        Height: =Button_Fee_Deposits_Done_120.Y - Self.Y - Parent.Height/30
                        Items: =Sort(Filter(colFeesDeposits, budget_id = varBudget.budget_id, new_budget_num = varBudget.new_budget_num), updated_on, SortOrder.Descending)
                        OnSelect: |-
                          =//UpdateContext({varTraveler: ThisItem});
                        Selectable: =false
                        TemplateSize: =Text_Input_Change_User_120.Height
                        Width: =Parent.Width*19/20
                        X: =Text_Category_121.X
                        Y: =Text_Category_121.Y + Text_Category_121.Height
                      Children:
                        - Icon_Remove_Fee_Deposit_120:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: |-
                                =If(
                                    ThisItem.category = "FEE", 
                                    If(
                                        IsBlank(ThisItem.fee_id), 
                                        DisplayMode.Edit, 
                                        DisplayMode.Disabled), 

                                    If(
                                        ThisItem.category = "DEPOSIT", 
                                        If(
                                            IsBlank(ThisItem.deposit_id), 
                                            DisplayMode.Edit, 
                                            DisplayMode.Disabled), 
                                        DisplayMode.Edit))
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =Remove(colFeesDeposits, ThisItem);

                                UpdateContext({varReadyToSubmit:false});
                              Width: =Self.Height
                              X: =Icon_Add_Fee_Deposit_120.X - Gallery_Fee_Deposits_120.X
                        - Date_Picker_Updated_120:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderRadius: =10
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: =
                              SelectedDate: =ThisItem.updated_on
                              Width: =Text_Updated_On_120.Width
                              X: =Text_Updated_On_120.X - Gallery_Fee_Deposits_120.X
                        - Text_Input_Notes_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: =ThisItem.notes
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: |-
                                =Patch(colFeesDeposits, ThisItem, 
                                    {notes: Upper(Self.Text), 
                                    updated_on: Today()});

                                If(
                                    Not(IsBlank(ThisItem.new_fee_dep_num)), 
                                    If(
                                        IsBlank(LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id)), 
                                        Collect(colFeesDepositsChanges, 
                                            {category: ThisItem.category, 
                                            fee_id: ThisItem.fee_id, 
                                            deposit_id: ThisItem.deposit_id, 
                                            cntrl_num: ThisItem.cntrl_num, 
                                            budget_id: ThisItem.budget_id, 
                                            amount: ThisItem.amount,
                                            spend_date: ThisItem.spend_date, 
                                            deposit_date: ThisItem.deposit_date,
                                            notes: Upper(Self.Text), 
                                            updated_on: Today()}), 

                                        Patch(colFeesDepositsChanges, LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id), 
                                            {category: ThisItem.category, 
                                            fee_id: ThisItem.fee_id, 
                                            deposit_id: ThisItem.deposit_id, 
                                            cntrl_num: ThisItem.cntrl_num, 
                                            budget_id: ThisItem.budget_id, 
                                            amount: ThisItem.amount, 
                                            spend_date: ThisItem.spend_date, 
                                            deposit_date: ThisItem.deposit_date, 
                                            notes: Upper(Self.Text), 
                                            updated_on: Today()})))
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Notes_120.Width
                              X: =Text_Notes_120.X - Gallery_Fee_Deposits_120.X
                        - Date_Picker_Fee_Deposit_Date_120:
                            Control: DatePicker@0.0.46
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Format: ='DatePickerCanvas.Format'.Short
                              Height: =Parent.TemplateHeight
                              OnChange: |-
                                =If(
                                    ThisItem.category = "FEE", 
                                    Patch(colFeesDeposits, ThisItem, 
                                        {spend_date: Self.SelectedDate, 
                                        updated_on: Today()}), 
                                    Patch(colFeesDeposits, ThisItem, 
                                        {deposit_date: Self.SelectedDate, 
                                        updated_on: Today()}));

                                If(
                                    Not(IsBlank(ThisItem.new_fee_dep_num)), 
                                    If(
                                        IsBlank(LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id)), 
                                        Collect(colFeesDepositsChanges, 
                                            {category: ThisItem.category, 
                                            fee_id: ThisItem.fee_id, 
                                            deposit_id: ThisItem.deposit_id, 
                                            cntrl_num: ThisItem.cntrl_num, 
                                            budget_id: ThisItem.budget_id, 
                                            amount: ThisItem.amount,
                                            spend_date: 
                                                If(
                                                    ThisItem.category = "FEE", 
                                                    Self.SelectedDate, 
                                                    Blank()), 
                                            deposit_date: 
                                                If(
                                                    ThisItem.category = "FEE", 
                                                    Blank(), 
                                                    Self.SelectedDate),
                                            notes: ThisItem.notes, 
                                            updated_on: Today()}), 

                                        Patch(colFeesDepositsChanges, LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id), 
                                            {category: ThisItem.category, 
                                            fee_id: ThisItem.fee_id, 
                                            deposit_id: ThisItem.deposit_id, 
                                            cntrl_num: ThisItem.cntrl_num, 
                                            budget_id: ThisItem.budget_id, 
                                            amount: ThisItem.amount, 
                                            spend_date: 
                                                If(
                                                    ThisItem.category = "FEE", 
                                                    Self.SelectedDate, 
                                                    Blank()), 
                                            deposit_date: 
                                                If(
                                                    ThisItem.category = "FEE", 
                                                    Blank(), 
                                                    Self.SelectedDate), 
                                            notes: ThisItem.notes, 
                                            updated_on: Today()})))
                              SelectedDate: |-
                                =If(
                                    ThisItem.category = "FEE", 
                                    ThisItem.spend_date, 

                                    If(
                                        ThisItem.category = "DEPOSIT", 
                                        ThisItem.deposit_date, 
                                        Blank()))
                              Width: =Text_Fee_Deposit_Date_120.Width
                              X: =Text_Fee_Deposit_Date_120.X - Gallery_Fee_Deposits_120.X
                              Y: =0.5
                        - Text_Input_Amount_120:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderThickness: =3
                              Default: =Abs(ThisItem.amount)
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Format: =TextFormat.Number
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: |-
                                =If(
                                    ThisItem.category = "FEE", 
                                    Patch(colFeesDeposits, ThisItem, 
                                        {amount: -Abs(Round(Value(Self.Text),2)), 
                                        updated_on: Today()}), 
                                    Patch(colFeesDeposits, ThisItem, 
                                        {amount: Abs(Round(Value(Self.Text),2)), 
                                        updated_on: Today()}));

                                If(
                                    Not(IsBlank(ThisItem.new_fee_dep_num)), 
                                    If(
                                        IsBlank(LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id)), 
                                        Collect(colFeesDepositsChanges, 
                                            {category: ThisItem.category, 
                                            fee_id: ThisItem.fee_id, 
                                            deposit_id: ThisItem.deposit_id, 
                                            cntrl_num: ThisItem.cntrl_num, 
                                            budget_id: ThisItem.budget_id, 
                                            amount: 
                                                If(
                                                    ThisItem.category = "FEE", 
                                                    -Abs(Round(Value(Self.Text),2)),
                                                    Abs(Round(Value(Self.Text),2))),
                                            spend_date: ThisItem.spend_date, 
                                            deposit_date: ThisItem.deposit_date, 
                                            notes: ThisItem.notes, 
                                            updated_on: Today()}), 

                                        Patch(colFeesDepositsChanges, LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id), 
                                            {category: ThisItem.category, 
                                            fee_id: ThisItem.fee_id, 
                                            deposit_id: ThisItem.deposit_id, 
                                            cntrl_num: ThisItem.cntrl_num, 
                                            budget_id: ThisItem.budget_id, 
                                            amount: 
                                                If(
                                                    ThisItem.category = "FEE", 
                                                    -Abs(Round(Value(Self.Text),2)),
                                                    Abs(Round(Value(Self.Text),2))), 
                                            spend_date: ThisItem.spend_date, 
                                            deposit_date: ThisItem.deposit_date, 
                                            notes: ThisItem.notes, 
                                            updated_on: Today()})))
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Amount_120.Width
                              X: =Text_Amount_120.X - Gallery_Fee_Deposits_120.X
                        - Text_Input_Control_Num_121:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderThickness: =3
                              Default: =ThisItem.cntrl_num
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: "=If(\r\n    IsBlank(Self.Text), \r\n    Reset(Self);\r\n    Notify(\"YOU CANNOT REMOVE A CONTROL NUMBER ONCE ONE HAS BEEN ASSIGNED\", NotificationType.Error), \r\n    \r\n    Patch(colFeesDeposits, ThisItem, \r\n        {cntrl_num: Upper(Self.Text), \r\n        updated_on: Today()});\r\n        \r\n    If(\r\n        Not(IsBlank(ThisItem.new_fee_dep_num)), \r\n        If(\r\n            IsBlank(LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id)), \r\n            Collect(colFeesDepositsChanges, \r\n                {category: ThisItem.category, \r\n                fee_id: ThisItem.fee_id, \r\n                deposit_id: ThisItem.deposit_id, \r\n                cntrl_num: Upper(Self.Text), \r\n                budget_id: ThisItem.budget_id, \r\n                amount: ThisItem.amount, \r\n                spend_date: ThisItem.spend_date, \r\n                deposit_date: ThisItem.deposit_date, \r\n                notes: ThisItem.notes, \r\n                updated_on: Today()}), \r\n\r\n            Patch(colFeesDepositsChanges, LookUp(colFeesDepositsChanges, fee_id = ThisItem.fee_id && deposit_id = ThisItem.deposit_id), \r\n                {category: ThisItem.category, \r\n                fee_id: ThisItem.fee_id, \r\n                deposit_id: ThisItem.deposit_id, \r\n                cntrl_num: Upper(Self.Text), \r\n                budget_id: ThisItem.budget_id, \r\n                amount: ThisItem.amount, \r\n                spend_date: ThisItem.spend_date, \r\n                deposit_date: ThisItem.deposit_date, \r\n                notes: ThisItem.notes, \r\n                updated_on: Today()}))))"
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_Control_Num_121.Width
                              X: =Text_Control_Num_121.X - Gallery_Fee_Deposits_120.X
                        - Text_Input_ID_121:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              Align: =Align.Center
                              BorderColor: =Color.Red
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =3
                              Default: |-
                                =If(
                                    ThisItem.category = "FEE", 
                                    ThisItem.fee_id, 

                                    If(
                                        ThisItem.category = "DEPOSIT", 
                                        ThisItem.deposit_id, 
                                        Blank()))
                              DisplayMode: =DisplayMode.Disabled
                              Fill: =RGBA(0, 0, 0, 0)
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              MaxLength: =255
                              Mode: =TextMode.MultiLine
                              OnChange: |-
                                =/*
                                Patch(colBudgetNotes, ThisItem, 
                                    {notes: Upper(Self.Text), 
                                    created_tour: varUser.tour_id, 
                                    created_name: varUser.name, 
                                    updated_on: Today()});

                                If(
                                    Not(IsBlank(ThisItem.budget_note_id)), 

                                    If(
                                        IsBlank(LookUp(colBudgetNoteChanges, budget_note_id = ThisItem.budget_note_id)), 

                                        Collect(colBudgetNoteChanges, 
                                            {budget_note_id: ThisItem.budget_note_id, 
                                            budget_id: ThisItem.budget_id, 
                                            notes: ThisItem.notes, 
                                            created_tour: varUser.tour_id, 
                                            created_name: varUser.name, 
                                            updated_on: Today()}), 

                                        Patch(colBudgetNoteChanges, LookUp(colBudgetNoteChanges, budget_note_id = ThisItem.budget_note_id), 
                                            {budget_id: ThisItem.budget_id, 
                                            notes: ThisItem.notes, 
                                            created_tour: varUser.tour_id, 
                                            created_name: varUser.name, 
                                            updated_on: Today()})));

                                UpdateContext({varReadyToSubmit: false});
                                */
                              OnSelect: =
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Text_ID_121.Width
                              X: =Text_ID_121.X - Gallery_Fee_Deposits_120.X
                        - Dropdown_Category_122:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Color.Red
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =3
                              DefaultSelectedItems: =Filter(Distinct(colBudgetLedger, category), Value = ThisItem.category)
                              DisplayMode: "=If(\n    (Upper(Self.Selected.Value) = \"FEE\" && Not(IsBlank(ThisItem.fee_id))) || \n    (Upper(Self.Selected.Value) = \"DEPOSIT\" && Not(IsBlank(ThisItem.deposit_id))), \n    DisplayMode.Disabled, DisplayMode.Edit) "
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: |-
                                =If(
                                    IsBlank(varBudget.budget_id), 

                                    Filter(Distinct(colBudgetLedger, category), Value <> "TRAVEL", Value <> "SUPPLY", Value <> "SALARY", Value <> "PRINT", Value <> "DEPOSIT"),

                                    Filter(Distinct(colBudgetLedger, category), Value <> "TRAVEL", Value <> "SUPPLY", Value <> "SALARY", Value <> "PRINT"))
                              OnChange: |-
                                =Patch(colFeesDeposits, ThisItem, 
                                    {category: Self.Selected.Value, 
                                    amount: Blank(), 
                                    spend_date: Blank(), 
                                    deposit_date: Blank()});

                                UpdateContext({varReadyToSubmit:false});
                              Width: =Text_Category_121.Width
                              X: =Text_Category_121.X - Gallery_Fee_Deposits_120.X
                            Children:
                              - Value4:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Value"
                                    FieldName: ="Value"
                                    FieldType: ="s"
                                    Order: =1
                        - Separator_Gallery_Salary_Notes_103:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Fee_Deposit_120:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: |-
                          =If(
                              varPermissions = "Master" ||
                              varPermissions = "Admin" ||
                              varPermissions = "Research" ||
                              varUser.usma_pers_id = varTraveler.usma_pers_id ||
                              varUser.tour_id = Index(colTrip,1).trip_oic, 
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Height: =Text_Input_Change_User_120.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colFeesDeposits,
                              {category: Blank(), 
                              fee_id: Blank(), 
                              deposit_id: Blank(), 
                              new_fee_dep_num: Max(colFeesDeposits, new_fee_dep_num) + 1,
                              cntrl_num: Blank(), 
                              budget_id: varBudget.budget_id,
                              new_budget_num: varBudget.new_budget_num, 
                              amount: Blank(), 
                              spend_date: Blank(), 
                              deposit_date: Blank(), 
                              notes: Blank(), 
                              updated_on: Today()});

                          UpdateContext({varReadyToSubmit:false});
                        Width: =Self.Height
                        X: =Gallery_Fee_Deposits_120.Width + Gallery_Fee_Deposits_120.X - Self.Width - 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Updated_On_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Updated"
                        Width: =Icon_Add_Fee_Deposit_120.X - Self.X - 10
                        X: =Text_Notes_120.X + Text_Notes_120.Width + 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Notes_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Notes"
                        Width: =Parent.Width/4
                        X: =Text_Fee_Deposit_Date_120.X + Text_Fee_Deposit_Date_120.Width + 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Fee_Deposit_Date_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Date"
                        Width: =Parent.Width/9
                        X: =Text_Amount_120.X + Text_Amount_120.Width + 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Amount_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Amount"
                        Width: =Parent.Width/10
                        X: =Text_Control_Num_121.X + Text_Control_Num_121.Width + 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Control_Num_121:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: |-
                          ="Control #"
                        Width: =Parent.Width/8
                        X: =Text_ID_121.X + Text_ID_121.Width + 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_ID_121:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="ID"
                        Width: =Parent.Width/15
                        X: =Text_Category_121.X + Text_Category_121.Width + 10
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Category_121:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =23
                        Text: ="Category"
                        Width: =Parent.Width/10
                        X: =Parent.Width/40
                        Y: =Text_Fee_Deposits_120.Y + Text_Fee_Deposits_120.Height + Parent.Height/40
                  - Text_Fee_Deposits_120:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        DisplayMode: =DisplayMode.View
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_120.Height
                        Size: =24
                        Text: ="Fees and Deposits"
                        Width: =Parent.Width
            - Spinner_120:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Budget_Ledger_Header_120:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Budget_Ledger_Header_120:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math Budget Ledger"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_120:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_120:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Assign_APD_130

Screens:
  Screen_Assign_APD_130:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Assign_APD_130:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Assign_APD_Header_130.Height
            Width: =Parent.Width
            Y: =Container_Assign_APD_Header_130.Height
          Children:
            - Button_Submit_130:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit && 
                        (varPermissions = "Master" ||
                        varPermissions = "S1"), 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_130.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =UpdateContext({varShowSpinner:true});

                    // LOOKUP_CLASS_OFFERINGS TABLE
                    ForAll(
                        Filter(colClassOfferings, Not(IsBlank(apd)), apd_num > 0) As class, 
                        Patch(lookup_class_offerings, LookUp(lookup_class_offerings, offering_id = class.offering_id),
                            {apd: class.apd}));

                    // UPDATE PROGRAM_POS TABLE
                    ForAll(
                        Filter(colPDs, Not(IsBlank(name_program)), Not(IsBlank(tour_id)), Not(IsBlank(pos_title)), pd_num > 0) As class, 
                        Patch(program_pos, Defaults(program_pos), 
                            {name_program: class.name_program,
                            pos_title: class.pos_title, 
                            tour_id: class.tour_id, 
                            updated_on: Today()}));

                    UpdateContext({varShowSpinner:false});

                    Refresh(current_fac_view);
                    Refresh(current_classes_view);
                    Refresh(program_pos);

                    Clear(colFaculty);
                    Clear(colClassOfferings);
                    Clear(colPDs);

                    Navigate(Screen_Welcome_Add_Access_110)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Save"
                  Width: =Parent.Width/11
                  X: =Button_Check_130.X + Button_Check_130.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Check_130:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit = false &&
                        (varPermissions = "Master" ||
                        varPermissions = "S1"), 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_130.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(
                        CountRows(Filter(colPDs, IsBlank(name_program), pd_num > 0)) = 0 &&
                        CountRows(Filter(colPDs, IsBlank(tour_id), pd_num > 0)) = 0 &&
                        CountRows(Filter(colPDs, IsBlank(pos_title), pd_num > 0)) = 0,
                        Notify("CLICK SAVE TO SUBMIT CHANGES", NotificationType.Success);
                        UpdateContext({varReadyToSubmit:true}), 

                        Notify("PLEASE ENSURE ALL PROGRAMS, NAMES, AND POSITIONS IN THE RIGHT TABLE ARE COMPLETE",NotificationType.Error); 
                        UpdateContext({varReadyToSubmit: Blank()}));
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Check"
                  Width: =Parent.Width/11
                  X: =Button_Return_130.X + Button_Return_130.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Return_130:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_130.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =Refresh(current_fac_view);
                    Refresh(current_classes_view);
                    Refresh(program_pos);

                    Clear(colFaculty);
                    Clear(colClassOfferings);
                    Clear(colPDs);

                    Navigate(Screen_Welcome_Add_Access_110)
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Return"
                  Width: =Parent.Width/11
                  X: =40
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Gallery_PD_APD_130:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =1
                  Height: =Parent.Height/1.5
                  Items: =Sort(Sort(Sort(Sort(Filter(colPDs, pd_num <> 0), pos_title, SortOrder.Descending), name_program, SortOrder.Ascending), updated_on, SortOrder.Descending), pd_num, SortOrder.Descending)
                  TemplateSize: =Text_Input_Change_User_130.Height
                  Width: =Text_PD_APD_131.Width
                  X: =Text_PD_APD_131.X
                  Y: =Text_AY_130.Y + Text_AY_130.Height
                Children:
                  - Icon_Remove_PD_APD_130:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: =Remove(colPDs, ThisItem)
                        Visible: |-
                          =If(
                              Not(IsBlank(ThisItem.program_pos_id)), 
                              false, true)
                        Width: =Self.Height
                        X: =Icon_Add_PD_APD_130.X - Gallery_PD_APD_130.X
                  - Dropdown_Pos_Title_130:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        DefaultSelectedItems: =Filter(Distinct(colPDs, pos_title), Value = ThisItem.pos_title)
                        DisplayMode: |-
                          =If(
                              IsBlank(ThisItem.program_pos_id),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =Distinct(colPDs, pos_title)
                        OnChange: |-
                          =Patch(colPDs, ThisItem, 
                              {pos_title: Self.Selected.Value,  
                              pd_num: Max(colPDs, pd_num) + 1});

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Text_Pos_Title_130.Width
                        X: =Text_Pos_Title_130.X - Gallery_PD_APD_130.X
                      Children:
                        - Value7:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="Value"
                              FieldName: ="Value"
                              FieldType: ="s"
                              Order: =1
                  - Dropdown_Name_130:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        DefaultSelectedItems: =Filter(colFaculty, tour_id = ThisItem.tour_id)
                        DisplayMode: |-
                          =If(
                              IsBlank(ThisItem.program_pos_id),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                        OnChange: |-
                          =Patch(colPDs, ThisItem, 
                              {tour_id: Self.Selected.tour_id,  
                              pd_num: Max(colPDs, pd_num) + 1});

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Text_Name_130.Width
                        X: =Text_Name_130.X - Gallery_PD_APD_130.X
                      Children:
                        - name6_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="name"
                              FieldName: ="name"
                              FieldType: ="s"
                              Order: =1
                        - program_pos_id1_1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="program_pos_id"
                              FieldName: ="program_pos_id"
                              FieldType: ="n"
                              Order: =2
                  - Dropdown_Program_130:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        DefaultSelectedItems: =Filter(Distinct(colPDs, name_program), Value = ThisItem.name_program)
                        DisplayMode: |-
                          =If(
                              IsBlank(ThisItem.program_pos_id),
                              DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =Distinct(colPDs, name_program)
                        OnChange: |-
                          =Patch(colPDs, ThisItem, 
                              {name_program: Self.Selected.Value,  
                              pd_num: Max(colPDs, pd_num) + 1});

                          UpdateContext({varReadyToSubmit: false})
                        Width: =Text_Program_131.Width
                        X: =Text_Program_131.X - Gallery_PD_APD_130.X
                      Children:
                        - Value6:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="Value"
                              FieldName: ="Value"
                              FieldType: ="s"
                              Order: =1
                  - Separator_Gallery_PD_APD_130:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Icon_Add_PD_APD_130:
                Control: Classic/Icon@2.5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Color: =RGBA(0, 18, 107, 1)
                  DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                  Height: =Text_Input_Change_User_80.Height
                  Icon: =Icon.Add
                  OnSelect: |-
                    =Collect(colPDs, 
                        {name_program: Blank(), 
                        pd_num: Max(colPDs, pd_num) + 1, 
                        pos_title: Blank(), 
                        program_pos_id: Blank(), 
                        tour_id: Blank(), 
                        updated_on:Today()});

                    UpdateContext({varReadyToSubmit:false})
                  Width: =Self.Height
                  X: =Text_PD_APD_131.X + Text_PD_APD_131.Width - Self.Width - 10
                  Y: =Text_PD_APD_131.Y + Text_PD_APD_131.Height
            - Text_Pos_Title_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Position"
                  Width: =Icon_Add_PD_APD_130.X - Self.X - 10
                  X: =Text_Name_130.X + Text_Name_130.Width + 10
                  Y: =Text_PD_APD_131.Y + Text_PD_APD_131.Height
            - Text_Name_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Name"
                  Width: =Text_PD_APD_131.Width/3
                  X: =Text_Program_131.X + Text_Program_131.Width + 10
                  Y: =Text_PD_APD_131.Y + Text_PD_APD_131.Height
            - Text_Program_131:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Program"
                  Width: =Text_PD_APD_131.Width/2.25
                  X: =Text_PD_APD_131.X
                  Y: =Text_PD_APD_131.Y + Text_PD_APD_131.Height
            - Text_PD_APD_131:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="PD/APDs"
                  Width: =Parent.Width - Self.X - Parent.Width/40
                  X: =Text_Courses_130.X + Text_Courses_130.Width + Parent.Width/40
                  Y: =Parent.Height/20
            - Gallery_Courses_130:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  BorderThickness: =1
                  Height: =Parent.Height/1.5
                  Items: =Sort(Sort(Sort(colClassOfferings, class_num, SortOrder.Ascending), semester, SortOrder.Descending), ay, SortOrder.Descending)
                  TemplateSize: =Text_Input_Change_User_130.Height
                  Width: =Text_Courses_130.Width
                  X: =Text_Courses_130.X
                  Y: =Text_AY_130.Y + Text_AY_130.Height
                Children:
                  - Dropdown_PD_APD_130:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderRadius: =10
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        DefaultSelectedItems: =Filter(colFaculty, program_pos_id = ThisItem.apd)
                        Fill: =RGBA(0, 0, 0, 0)
                        FontSize: =18
                        Height: =Parent.TemplateHeight
                        Items: =Filter(colFaculty, Not(IsBlank(program_pos_id)))
                        OnChange: |-
                          =Patch(colClassOfferings, LookUp(colClassOfferings, offering_id = ThisItem.offering_id), 
                              {apd: Self.Selected.program_pos_id, 
                              apd_email: Self.Selected.wp_email, 
                              apd_name: Self.Selected.name, 
                              name_program: Self.Selected.name_program, 
                              apd_num: Max(colClassOfferings, apd_num) + 1});

                          UpdateContext({varReadyToSubmit:false})
                        Width: =Text_PD_APD_130.Width - Icon_Remove_PD_APD_131.Width
                        X: =Icon_Remove_PD_APD_131.X + Icon_Remove_PD_APD_131.Width
                      Children:
                        - name6:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="name"
                              FieldName: ="name"
                              FieldType: ="s"
                              Order: =1
                        - program_pos_id1:
                            Control: DropDownDataField@1.5.0
                            Variant: textualColumn
                            IsLocked: true
                            Properties:
                              FieldDisplayName: ="program_pos_id"
                              FieldName: ="program_pos_id"
                              FieldType: ="n"
                              Order: =2
                  - Icon_Remove_PD_APD_131:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =Color.Red
                        DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                        Height: =Parent.TemplateHeight
                        Icon: =Icon.Cancel
                        OnSelect: |-
                          =Patch(colClassOfferings, ThisItem, 
                              {apd: Blank(), 
                              apd_email: Blank(), 
                              apd_name: Blank(), 
                              apd_num: Blank(), 
                              name_program: Blank()})
                        Visible: |-
                          =If(
                              IsBlank(ThisItem.apd) || IsBlank(ThisItem.apd_num), 
                              false, true)
                        Width: =Self.Height
                        X: =Text_PD_APD_130.X - Gallery_Courses_130.X
                  - Text_Input_Program_130:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: |-
                          =If(
                              ThisItem.name_program = "APPLIED SYSTEMS AND DATA SCIENCE", "ASDS",
                              If(
                                  ThisItem.name_program = "MATHEMATICAL SCIENCES CENTER", "MSC", 
                                  If(
                                      ThisItem.name_program = "OPERATIONS RESEARCH", "OR", 
                                      If(
                                          ThisItem.name_program = "RESEARCH", "RESEARCH",
                                          Blank()))))
                        DisplayMode: =DisplayMode.Disabled
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        Mode: =TextMode.MultiLine
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Program_130.Width
                        X: =Text_Program_130.X - Gallery_Courses_130.X
                  - Text_Input_Class_Num_130:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.class_num
                        DisplayMode: =DisplayMode.Disabled
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Class_Num_130.Width
                        X: =Text_Class_Num_130.X - Gallery_Courses_130.X
                  - Text_Input_Semester_130:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.semester
                        DisplayMode: =DisplayMode.Disabled
                        Font: =Font.'Open Sans'
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: =
                        OnSelect: =Select(Parent)
                        Width: =Text_Semester_130.Width
                        X: =Text_Semester_130.X - Gallery_Courses_130.X
                  - Text_Input_AY_130:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =0
                        Default: =ThisItem.ay
                        DisplayMode: =DisplayMode.Disabled
                        Font: =Font.'Open Sans'
                        Format: =TextFormat.Number
                        Height: =Parent.TemplateHeight
                        HoverBorderColor: =RGBA(0, 18, 107, 1)
                        HoverFill: =RGBA(186, 202, 226, 1)
                        MaxLength: =255
                        OnChange: |-
                          =

                          UpdateContext({varReadyToSubmit: false});

                          UpdateContext({varDegreeChange: true});
                        OnSelect: =Select(Parent)
                        Width: =Text_AY_130.Width
                        X: =Text_AY_130.X - Gallery_Courses_130.X
                  - Separator_Gallery_Degree_Info_21:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =Color.Black
                        BorderThickness: =1
                        Fill: =Color.Black
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
            - Text_PD_APD_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="PD/APD"
                  Width: =Text_Courses_130.Width + Text_Courses_130.X - Self.X
                  X: =Text_Program_130.X + Text_Program_130.Width + 10
                  Y: =Text_Courses_130.Y + Text_Courses_130.Height
            - Text_Program_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Program"
                  Width: =Text_Courses_130.Width/5
                  X: =Text_Class_Num_130.X + Text_Class_Num_130.Width + 10
                  Y: =Text_Courses_130.Y + Text_Courses_130.Height
            - Text_Class_Num_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Class Num"
                  Width: =Text_Courses_130.Width/7
                  X: =Text_Semester_130.X + Text_Semester_130.Width + 10
                  Y: =Text_Courses_130.Y + Text_Courses_130.Height
            - Text_Semester_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Semester"
                  Width: =Text_Courses_130.Width/8
                  X: =Text_AY_130.X + Text_AY_130.Width + 10
                  Y: =Text_Courses_130.Y + Text_Courses_130.Height
            - Text_AY_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  BorderRadiusTopLeft: =10
                  BorderRadiusTopRight: =10
                  Fill: =RGBA(211, 188, 141, 1)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="AY"
                  Width: =Text_Courses_130.Width/12
                  X: =Text_Courses_130.X
                  Y: =Text_Courses_130.Y + Text_Courses_130.Height
            - Text_Courses_130:
                Control: Text@0.0.51
                Properties:
                  Align: ='TextCanvas.Align'.Center
                  Fill: =RGBA(0, 0, 0, 0)
                  Height: =Text_Input_Change_User_130.Height
                  Size: =23
                  Text: ="Courses"
                  Width: =Parent.Width/2
                  X: =Parent.Width/40
                  Y: =Parent.Height/20
            - Rectangle_Disable_130:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: =Spinner_130.Visible
                  Width: =Parent.Width
            - Spinner_130:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Assign_APD_Header_130:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Assign_APD_130:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math APD-Course Assignments"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_130:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_130:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40






// Screen_Assign_Permissions140

Screens:
  Screen_Assign_Permissions_140:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container_Assign_Permissions_140:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Height: =Parent.Height - Container_Header_Assign_Permissions_140.Height
            Width: =Parent.Width
            Y: =Container_Header_Assign_Permissions_140.Height
          Children:
            - Button_Submit_140:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit && 
                        (varPermissions = "Master" ||
                        varPermissions = "S1"), 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_140.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |
                    =UpdateContext({varShowSpinner:true});

                    // UPDATE PERMISSIONS_MASTER
                    ForAll(colRemovePermissionMaster As rm_master, 
                        Remove(permissions_master, LookUp(permissions_master, permission_id = rm_master.permission_id)));

                    ForAll(
                        Filter(colPermissionMaster, Not(IsBlank(perm_num)), Not(IsBlank(wp_email))) As master, 
                        Patch(permissions_master, Defaults(permissions_master), 
                            {wp_email: master.wp_email}));

                    // UPDATE PERMISSIONS_ADMIN
                    ForAll(colRemovePermissionAdmin As rm_admin, 
                        Remove(permissions_admin, LookUp(permissions_admin, permission_id = rm_admin.permission_id)));

                    ForAll(
                        Filter(colPermissionAdmin, Not(IsBlank(perm_num)), Not(IsBlank(wp_email))) As admin, 
                        Patch(permissions_admin, Defaults(permissions_admin), 
                            {wp_email: admin.wp_email}));

                    // UPDATE PERMISSIONS_RESEARCH
                    ForAll(colRemovePermissionResearch As rm_research, 
                        Remove(permissions_research, LookUp(permissions_research, permission_id = rm_research.permission_id)));

                    ForAll(
                        Filter(colPermissionResearch, Not(IsBlank(perm_num)), Not(IsBlank(wp_email))) As research, 
                        Patch(permissions_research, Defaults(permissions_research), 
                            {wp_email: research.wp_email}));

                    // UPDATE PERMISSIONS_S1
                    ForAll(colRemovePermissionS1 As rm_S1, 
                        Remove(permissions_S1, LookUp(permissions_S1, permission_id = rm_S1.permission_id)));

                    ForAll(
                        Filter(colPermissionS1, Not(IsBlank(perm_num)), Not(IsBlank(wp_email))) As S1, 
                        Patch(permissions_S1, Defaults(permissions_S1), 
                            {wp_email: S1.wp_email}));

                    UpdateContext({varShowSpinner:false});

                    Refresh(current_permissions_view);

                    Clear(colFaculty);
                    Clear(colRemovePermissionAdmin);
                    Clear(colRemovePermissionResearch);
                    Clear(colRemovePermissionMaster);
                    Clear(colRemovePermissionS1);

                    Navigate(Screen_Welcome_Add_Access_110); 

                    ClearCollect(colPermissionAdmin, 
                        ShowColumns(Filter(current_permissions_view, permission = "ADMIN"), permission_id, wp_email, name));

                    ClearCollect(colPermissionS1, 
                        ShowColumns(Filter(current_permissions_view, permission = "S1"), permission_id, wp_email, name));

                    ClearCollect(colPermissionMaster, 
                        ShowColumns(Filter(current_permissions_view, permission = "MASTER"), permission_id, wp_email, name));

                    ClearCollect(colPermissionResearch, 
                        ShowColumns(Filter(current_permissions_view, permission = "RESEARCH"), permission_id, wp_email, name));
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Save"
                  Width: =Parent.Width/11
                  X: =Button_Check_140.X + Button_Check_140.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Check_140:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  DisplayMode: |-
                    =If(
                        varReadyToSubmit = false &&
                        (varPermissions = "Master" ||
                        varPermissions = "S1"), 
                        DisplayMode.Edit, 
                        DisplayMode.Disabled)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_140.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |-
                    =If(
                        CountRows(Filter(colPermissionAdmin, IsBlank(wp_email))) > 0 ||
                        CountRows(Filter(colPermissionResearch, IsBlank(wp_email))) > 0 ||
                        CountRows(Filter(colPermissionS1, IsBlank(wp_email))) > 0 ||
                        CountRows(Filter(colPermissionMaster, IsBlank(wp_email))) > 0, 

                        Notify("PLEASE DELETE ANY BLANK ROWS",NotificationType.Error); 
                        UpdateContext({varReadyToSubmit: Blank()}), 

                        Notify("CLICK SAVE TO SUBMIT CHANGES", NotificationType.Success);
                        UpdateContext({varReadyToSubmit:true}))
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Check"
                  Width: =Parent.Width/11
                  X: =Button_Return_140.X + Button_Return_140.Width + Parent.Width/50
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Button_Return_140:
                Control: Classic/Button@2.2.0
                Properties:
                  BorderColor: =ColorFade(Self.Fill, -15%)
                  Color: =Color.Black
                  DisabledBorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =RGBA(211, 188, 141, 1)
                  Font: =Font.'Open Sans'
                  Height: =Text_Input_Change_User_140.Height
                  HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                  HoverColor: =RGBA(255, 255, 255, 1)
                  HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                  OnSelect: |
                    =Refresh(current_permissions_view);

                    Clear(colFaculty);
                    Clear(colRemovePermissionAdmin);
                    Clear(colRemovePermissionResearch);
                    Clear(colRemovePermissionMaster);
                    Clear(colRemovePermissionS1);

                    Navigate(Screen_Welcome_Add_Access_110); 

                    ClearCollect(colPermissionAdmin, 
                        ShowColumns(Filter(current_permissions_view, permission = "ADMIN"), permission_id, wp_email, name));

                    ClearCollect(colPermissionS1, 
                        ShowColumns(Filter(current_permissions_view, permission = "S1"), permission_id, wp_email, name));

                    ClearCollect(colPermissionMaster, 
                        ShowColumns(Filter(current_permissions_view, permission = "MASTER"), permission_id, wp_email, name));

                    ClearCollect(colPermissionResearch, 
                        ShowColumns(Filter(current_permissions_view, permission = "RESEARCH"), permission_id, wp_email, name));
                  PressedBorderColor: =Self.Fill
                  PressedColor: =Self.Fill
                  PressedFill: =Self.Color
                  Text: ="Return"
                  Width: =Parent.Width/11
                  X: =40
                  Y: =Parent.Height - Self.Height - Parent.Height/40
            - Container_S1_Permissions_140:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Parent.Height/2
                  Width: =(Parent.Width - Parent.Width/40*5)/4
                  X: =Parent.Width/40 + Container_Research_Permissions_140.X + Container_Research_Permissions_140.Width
                  Y: =Container_Admin_Permissions_140.Y
                Children:
                  - Gallery_S1_Permissions_140:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =1
                        Height: =Parent.Height/1.5
                        Items: =Sort(colPermissionS1, name, SortOrder.Ascending)
                        TemplateSize: =Text_Input_Change_User_140.Height
                        Width: =Text_S1_140.Width
                        X: =Text_S1_140.X
                        Y: =Text_S1_Name_140.Y + Text_S1_Name_140.Height
                      Children:
                        - Icon_Remove_S1_140:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.permission_id)),
                                    Collect(colRemovePermissionS1, ThisItem));

                                Remove(colPermissionS1, ThisItem);

                                UpdateContext({varReadyToSubmit:false})
                              Width: =30.719999999999942
                              X: =Icon_Add_S1_140.X - Gallery_S1_Permissions_140.X
                        - Dropdown_S1_Name_140:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              DefaultSelectedItems: =Filter(colFaculty, wp_email = ThisItem.wp_email)
                              DisplayMode: |-
                                =If(
                                    IsBlank(ThisItem.permission_id), 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                              OnChange: |-
                                =Patch(
                                    colPermissionS1, ThisItem, 
                                    {wp_email: Self.Selected.wp_email, 
                                    name: Self.Selected.name}); 

                                UpdateContext({varReadyToSubmit:false})
                              Width: =Text_S1_Name_140.Width
                              X: =Text_S1_Name_140.X - Gallery_S1_Permissions_140.X
                            Children:
                              - name6_6:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="name"
                                    FieldName: ="name"
                                    FieldType: ="s"
                                    Order: =1
                              - program_pos_id1_6:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="program_pos_id"
                                    FieldName: ="program_pos_id"
                                    FieldType: ="n"
                                    Order: =2
                        - Separator_Gallery_S1_Permissions_140:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_S1_140:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Height: =Text_Input_Change_User_80.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colPermissionS1, 
                              {wp_email: Blank(), 
                              name: Blank(), 
                              permission_id: Blank(),
                              perm_num: Max(colPermissionS1, perm_num) + 1});

                          UpdateContext({varReadyToSubmit:false})
                        Width: =Self.Height
                        X: =Text_S1_140.Width + Text_S1_140.X - Self.Width
                        Y: =Text_S1_Name_140.Y
                  - Text_S1_Name_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Icon_Add_S1_140.X - Parent.Width/40
                        X: =Text_S1_140.X
                        Y: =Text_S1_140.Y + Text_S1_140.Height
                  - Text_S1_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="S1 Permissions"
                        Width: =Parent.Width*19/20
                        X: =Parent.Width/40
            - Container_Research_Permissions_140:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Parent.Height/2
                  Width: =(Parent.Width - Parent.Width/40*5)/4
                  X: =Parent.Width/40 + Container_Master_Permissions_140.X + Container_Master_Permissions_140.Width
                  Y: =Container_Admin_Permissions_140.Y
                Children:
                  - Gallery_Research_Permissions_140:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =1
                        Height: =Parent.Height/1.5
                        Items: =Sort(colPermissionResearch, name, SortOrder.Ascending)
                        TemplateSize: =Text_Input_Change_User_140.Height
                        Width: =Text_Research_140.Width
                        X: =Text_Research_140.X
                        Y: =Text_Research_Name_140.Y + Text_Research_Name_140.Height
                      Children:
                        - Icon_Remove_Research_140:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.permission_id)),
                                    Collect(colRemovePermissionResearch, ThisItem));

                                Remove(colPermissionResearch, ThisItem);

                                UpdateContext({varReadyToSubmit:false})
                              Width: =30.719999999999942
                              X: =Icon_Add_Research_140.X - Gallery_Research_Permissions_140.X
                        - Dropdown_Research_Name_140:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              DefaultSelectedItems: =Filter(colFaculty, wp_email = ThisItem.wp_email)
                              DisplayMode: |-
                                =If(
                                    IsBlank(ThisItem.permission_id), 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                              OnChange: |-
                                =Patch(
                                    colPermissionResearch, ThisItem, 
                                    {wp_email: Self.Selected.wp_email, 
                                    name: Self.Selected.name}); 

                                UpdateContext({varReadyToSubmit:false})
                              Width: =Text_Research_Name_140.Width
                              X: =Text_Research_Name_140.X - Gallery_Research_Permissions_140.X
                            Children:
                              - name6_5:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="name"
                                    FieldName: ="name"
                                    FieldType: ="s"
                                    Order: =1
                              - program_pos_id1_5:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="program_pos_id"
                                    FieldName: ="program_pos_id"
                                    FieldType: ="n"
                                    Order: =2
                        - Separator_Gallery_Research_Permissions_140:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Research_140:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Height: =Text_Input_Change_User_80.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colPermissionResearch, 
                              {wp_email: Blank(), 
                              name: Blank(), 
                              permission_id: Blank(),
                              perm_num: Max(colPermissionResearch, perm_num) + 1});

                          UpdateContext({varReadyToSubmit:false})
                        Width: =Self.Height
                        X: =Text_Research_140.Width + Text_Research_140.X - Self.Width
                        Y: =Text_Research_Name_140.Y
                  - Text_Research_Name_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Icon_Add_Research_140.X - Parent.Width/40
                        X: =Text_Research_140.X
                        Y: =Text_Research_140.Y + Text_Research_140.Height
                  - Text_Research_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Research Permissions"
                        Width: =Parent.Width*19/20
                        X: =Parent.Width/40
            - Container_Master_Permissions_140:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Parent.Height/2
                  Width: =(Parent.Width - Parent.Width/40*5)/4
                  X: =Parent.Width/40 + Container_Admin_Permissions_140.X + Container_Admin_Permissions_140.Width
                  Y: =Container_Admin_Permissions_140.Y
                Children:
                  - Gallery_Master_Permissions_140:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =1
                        Height: =Parent.Height/1.5
                        Items: =Sort(colPermissionMaster, name, SortOrder.Ascending)
                        TemplateSize: =Text_Input_Change_User_140.Height
                        Width: =Text_Master_140.Width
                        X: =Text_Master_140.X
                        Y: =Text_Master_Name_140.Y + Text_Master_Name_140.Height
                      Children:
                        - Icon_Remove_Master_140:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.permission_id)),
                                    Collect(colRemovePermissionMaster, ThisItem));

                                Remove(colPermissionMaster, ThisItem);

                                UpdateContext({varReadyToSubmit:false})
                              Width: =30.719999999999942
                              X: =Icon_Add_Master_140.X - Gallery_Master_Permissions_140.X
                        - Dropdown_Master_Name_140:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              DefaultSelectedItems: =Filter(colFaculty, wp_email = ThisItem.wp_email)
                              DisplayMode: |-
                                =If(
                                    IsBlank(ThisItem.permission_id), 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                              OnChange: |-
                                =Patch(
                                    colPermissionMaster, ThisItem, 
                                    {wp_email: Self.Selected.wp_email, 
                                    name: Self.Selected.name}); 

                                UpdateContext({varReadyToSubmit:false})
                              Width: =Text_Master_Name_140.Width
                              X: =Text_Master_Name_140.X - Gallery_Master_Permissions_140.X
                            Children:
                              - name6_4:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="name"
                                    FieldName: ="name"
                                    FieldType: ="s"
                                    Order: =1
                              - program_pos_id1_4:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="program_pos_id"
                                    FieldName: ="program_pos_id"
                                    FieldType: ="n"
                                    Order: =2
                        - Separator_Gallery_Master_Permissions_140:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Master_140:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Height: =Text_Input_Change_User_80.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colPermissionMaster, 
                              {wp_email: Blank(), 
                              name: Blank(), 
                              permission_id: Blank(),
                              perm_num: Max(colPermissionMaster, perm_num) + 1});

                          UpdateContext({varReadyToSubmit:false})
                        Width: =Self.Height
                        X: =Text_Master_140.Width + Text_Master_140.X - Self.Width
                        Y: =Text_Master_Name_140.Y
                  - Text_Master_Name_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Icon_Add_Master_140.X - Parent.Width/40
                        X: =Text_Master_140.X
                        Y: =Text_Master_140.Y + Text_Master_140.Height
                  - Text_Master_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Master Permissions"
                        Width: =Parent.Width*19/20
                        X: =Parent.Width/40
            - Container_Admin_Permissions_140:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Height: =Parent.Height/2
                  Width: =(Parent.Width - Parent.Width/40*5)/4
                  X: =Parent.Width/40
                  Y: =Parent.Height/5
                Children:
                  - Gallery_Admin_Permissions_140:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        BorderThickness: =1
                        Height: =Parent.Height/1.5
                        Items: =Sort(colPermissionAdmin, name, SortOrder.Ascending)
                        TemplateSize: =Text_Input_Change_User_140.Height
                        Width: =Text_Admin_140.Width
                        X: =Text_Admin_140.X
                        Y: =Text_Admin_Name_140.Y + Text_Admin_Name_140.Height
                      Children:
                        - Icon_Remove_Admin_140:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Color.Red
                              DisplayMode: "=If(\n    varPermissions = \"Master\" || \n    varPermissions = \"Admin\" || \n    varPermissions = \"Research\" ||\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \n    \n    DisplayMode.Edit, \n    DisplayMode.Disabled)"
                              Height: =Parent.TemplateHeight
                              Icon: =Icon.Cancel
                              OnSelect: |-
                                =If(
                                    Not(IsBlank(ThisItem.permission_id)),
                                    Collect(colRemovePermissionAdmin, ThisItem));

                                Remove(colPermissionAdmin, ThisItem);

                                UpdateContext({varReadyToSubmit:false})
                              Width: =Self.Height
                              X: =Icon_Add_Admin_140.X - Gallery_Admin_Permissions_140.X
                        - Dropdown_Admin_Name_140:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.None
                              BorderThickness: =0
                              DefaultSelectedItems: =Filter(colFaculty, wp_email = ThisItem.wp_email)
                              DisplayMode: |-
                                =If(
                                    IsBlank(ThisItem.permission_id), 
                                    DisplayMode.Edit, DisplayMode.Disabled)
                              Fill: =RGBA(0, 0, 0, 0)
                              FontSize: =18
                              Height: =Parent.TemplateHeight
                              Items: =Sort(colFaculty, last_name, SortOrder.Ascending)
                              OnChange: |-
                                =Patch(
                                    colPermissionAdmin, ThisItem, 
                                    {wp_email: Self.Selected.wp_email, 
                                    name: Self.Selected.name}); 

                                UpdateContext({varReadyToSubmit:false})
                              Width: =Text_Admin_Name_140.Width
                              X: =Text_Admin_Name_140.X - Gallery_Admin_Permissions_140.X
                            Children:
                              - name6_3:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="name"
                                    FieldName: ="name"
                                    FieldType: ="s"
                                    Order: =1
                              - program_pos_id1_3:
                                  Control: DropDownDataField@1.5.0
                                  Variant: textualColumn
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="program_pos_id"
                                    FieldName: ="program_pos_id"
                                    FieldType: ="n"
                                    Order: =2
                        - Separator_Gallery_Admin_Permissions_140:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =Color.Black
                              BorderThickness: =1
                              Fill: =Color.Black
                              Height: =2
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =Parent.TemplateHeight - Self.Height
                  - Icon_Add_Admin_140:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(0, 18, 107, 1)
                        DisplayMode: "=If(\r\n    varPermissions = \"Master\" || \r\n    varPermissions = \"Admin\" || \r\n    varPermissions = \"Research\" ||\r\n    varUser.tour_id = Index(colPurchase,1).requestor_tour, \r\n    \r\n    DisplayMode.Edit, \r\n    DisplayMode.Disabled)"
                        Height: =Text_Input_Change_User_80.Height
                        Icon: =Icon.Add
                        OnSelect: |-
                          =Collect(colPermissionAdmin, 
                              {wp_email: Blank(), 
                              name: Blank(), 
                              permission_id: Blank(),
                              perm_num: Max(colPermissionAdmin, perm_num) + 1});

                          UpdateContext({varReadyToSubmit:false})
                        Width: =Self.Height
                        X: =Text_Admin_140.Width + Text_Admin_140.X - Self.Width
                        Y: =Text_Admin_Name_140.Y
                  - Text_Admin_Name_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        BorderRadiusTopLeft: =10
                        BorderRadiusTopRight: =10
                        Fill: =RGBA(211, 188, 141, 1)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Name"
                        Width: =Icon_Add_Admin_140.X - Parent.Width/40
                        X: =Text_Admin_140.X
                        Y: =Text_Admin_140.Y + Text_Admin_140.Height
                  - Text_Admin_140:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Text_Input_Change_User_140.Height
                        Size: =23
                        Text: ="Admin Permissions"
                        Width: =Parent.Width*19/20
                        X: =Parent.Width/40
            - Rectangle_Disable_140:
                Control: Rectangle@2.3.0
                Properties:
                  BorderColor: =RGBA(0, 18, 107, 1)
                  Fill: =RGBA(255, 255, 255, .7)
                  Height: =Parent.Height
                  Visible: =Spinner_140.Visible
                  Width: =Parent.Width
            - Spinner_140:
                Control: Spinner@1.4.6
                Properties:
                  Appearance: ='Spinner.Appearance'.Primary
                  BasePaletteColor: =RGBA(189, 178, 176, 1)
                  Height: =100
                  SpinnerSize: ="Huge"
                  Visible: =varShowSpinner
                  Width: =Self.Height
                  X: =Parent.Width/2 - Self.Width/2
                  Y: =Parent.Height/2 - Self.Height/2
      - Container_Header_Assign_Permissions_140:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =75
            LayoutDirection: =LayoutDirection.Horizontal
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =Parent.Width
          Children:
            - Header_Assign_Permissions_140:
                Control: Header@0.0.44
                Properties:
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(178, 180, 179, 1)
                  Fill: =Color.Black
                  FontColor: =RGBA(255, 255, 255, 1)
                  Logo: ='Math Crest with Date'
                  LogoTooltip: =""
                  Style: ='Header.Style'.Primary
                  Title: ="D/Math App Permissions"
                  TitleFontSize: =26
      - Text_Input_Change_Permissions_140:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varPermissions
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: =Set(varPermissions, Self.Text)
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width - Self.Width - Parent.Width/10
            Y: =Parent.Height/40
      - Text_Input_Change_User_140:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =varUser.wp_email
            Font: =Font.'Open Sans'
            Height: =Parent.Height/25
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            OnChange: |-
              =Set(
                  varUser,
                      With(
                          {userRecord: LookUp(current_fac_view, wp_email = Upper(Self.Text))},
                          {name: userRecord.name,
                          wp_email: userRecord.wp_email,
                          usma_pers_id: userRecord.usma_pers_id,
                          dept_pos: userRecord.dept_pos,
                          apd: userRecord.program_pos_id,
                          tour_id: userRecord.tour_id}))
            Visible: =Not(IsBlank(LookUp(colPermissionMaster, wp_email = Upper(User().Email))))
            X: =Parent.Width/10
            Y: =Parent.Height/40
